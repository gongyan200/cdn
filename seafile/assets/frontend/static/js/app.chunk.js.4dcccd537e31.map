{"version":3,"sources":["components/context-menu/context-menu.js","components/dialog/create-folder-dialog.js","components/dialog/zip-download-dialog.js","components/dropdown-menu/item-dropdown-menu.js","../node_modules/babel-preset-react-app/node_modules/regenerator-runtime/runtime.js","../node_modules/socket.io-client/node_modules/debug/src/browser.js","../node_modules/parseqs/index.js","../node_modules/component-inherit/index.js","../node_modules/engine.io-client/node_modules/debug/src/browser.js","models/repo-tag.js","components/dialog/image-dialog.js","components/system-notification.js","models/group.js","components/main-side-nav.js","components/dialog/about-dialog.js","components/side-nav-footer.js","components/side-panel.js","components/main-panel.js","pages/drafts/drafts-view.js","components/draft-list-view/draft-list-item.js","components/draft-list-view/draft-list-view.js","pages/drafts/draft-content.js","models/activity.js","components/dialog/list-created-files-dialog.js","pages/dashboard/files-activities.js","pages/starred/starred.js","components/dialog/confirm-unlink-device.js","pages/linked-devices/linked-devices.js","models/shared-repo-info.js","components/dialog/perm-select.js","pages/share-admin/libraries.js","models/shared-folder-info.js","pages/share-admin/folders.js","components/dialog/share-link-permission-select.js","pages/share-admin/share-links.js","pages/share-admin/upload-links.js","models/repo.js","components/libs-mobile-thead.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/nonIterableRest.js","components/dialog/sort-options.js","pages/shared-libs/shared-libs.js","pages/share-with-ocm/shared-with-ocm.js","pages/share-with-ocm/remote-dir-topbar.js","pages/share-with-ocm/remote-dir-path.js","pages/share-with-ocm/remote-dir-content.js","pages/share-with-ocm/remote-dir-view.js","components/dialog/create-repo-dialog.js","components/toolbar/repo-view-toobar.js","components/dirent-detail/lib-details.js","components/dialog/lib-history-setting-dialog.js","components/dialog/change-repo-password-dialog.js","components/dialog/reset-encrypted-repo-password-dialog.js","components/dialog/label-repo-state-dialog.js","components/dialog/lib-sub-folder-set-user-permission-dialog.js","components/dialog/lib-sub-folder-set-group-permission-dialog.js","components/dialog/lib-sub-folder-permission-dialog.js","components/rename.js","pages/my-libs/mylib-repo-menu.js","components/select-editor/repo-api-token-permission-editor.js","components/dialog/repo-api-token-dialog.js","components/dialog/repo-share-upload-links-dialog.js","components/dialog/lib-old-files-auto-del-dialog.js","pages/my-libs/mylib-repo-list-item.js","pages/my-libs/mylib-repo-list-view.js","components/dialog/guide-for-new-dialog.js","pages/my-libs/my-libs.js","pages/my-libs/my-libs-deleted.js","components/dialog/share-repo-dialog.js","components/shared-repo-list-view/shared-repo-list-item.js","components/shared-repo-list-view/shared-repo-list-view.js","pages/shared-with-all/public-shared-view.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","utils/collab-server.js","components/dialog/lib-decrypt-dialog.js","components/toolbar/view-mode-toolbar.js","components/dialog/create-file-dialog.js","components/toolbar/dir-operation-toolbar.js","components/dialog/move-dirent-dialog.js","components/dialog/copy-dirent-dialog.js","components/dialog/rename-dirent.js","components/toolbar/multiple-dir-operation-toolbar.js","components/toolbar/view-file-toolbar.js","pages/lib-content-view/lib-content-toolbar.js","components/cur-dir-path/dir-path.js","components/dialog/list-tag-dialog.js","components/dialog/update-tag-dialog.js","components/dialog/list-taggedfiles-dialog.js","components/cur-dir-path/dir-tool.js","components/cur-dir-path/index.js","components/dirent-detail/detail-comments-list.js","components/dirent-detail/detail-list-view.js","components/dirent-detail/dirent-details.js","components/dirent-list-view/dirent-none-view.js","models/draft.js","components/dialog/list-repo-drafts-dialog.js","components/dialog/readme-dialog.js","components/repo-info-bar.js","components/dirent-list-view/dirent-list-item.js","components/draggable/dirents-dragged-preview.js","components/dirent-list-view/dirent-list-view.js","components/dir-view-mode/dir-list-view.js","components/dirent-grid-view/dirent-grid-item.js","components/dirent-grid-view/dirent-grid-view.js","components/dir-view-mode/dir-grid-view.js","components/dialog/rename-dialog.js","components/dir-view-mode/dir-column-nav.js","components/dir-view-mode/dir-column-file.js","components/dir-view-mode/dir-column-view.js","pages/lib-content-view/lib-content-container.js","components/file-uploader/upload-list-item.js","components/file-uploader/forbid-upload-list-item.js","components/file-uploader/upload-progress-dialog.js","components/dialog/upload-remind-dialog.js","components/file-uploader/file-uploader.js","components/dialog/copy-move-dirent-progress-dialog.js","pages/lib-content-view/lib-content-view.js","components/dialog/dismiss-group-dialog.js","components/dialog/create-department-repo-dialog.js","components/dialog/rename-group-dialog.js","components/dialog/transfer-group-dialog.js","components/dialog/import-members-dialog.js","components/dialog/manage-members-dialog.js","components/dialog/leave-group-dialog.js","pages/groups/group-view.js","components/toolbar/groups-toolbar.js","components/dialog/create-group-dialog.js","pages/groups/groups-view.js","components/toolbar/invitations-toolbar.js","components/dialog/invite-people-dialog.js","components/dialog/invitation-revoke-dialog.js","pages/invitations/invitations-view.js","components/dialog/new-wiki-dialog.js","components/dialog/wiki-select-dialog.js","components/dialog/wiki-delete-dialog.js","components/wiki-list-view/wiki-list-item.js","components/wiki-list-view/wiki-list-view.js","pages/wikis/wikis.js","components/toolbar/general-toolbar.js","components/main-content-wrapper.js","app.js","components/dialog/add-related-file-dialog.js","components/dialog/list-related-file-dialog.js","components/dialog/related-file-dialogs.js","../node_modules/ms/index.js","../node_modules/socket.io-parser/index.js","../node_modules/engine.io-client/lib/xmlhttprequest.js","../node_modules/engine.io-client/lib/transport.js","../node_modules/@seafile/react-image-lightbox/node_modules/react-modal/lib/helpers/safeHTMLElement.js","components/dialog/create-tag-dialog.js","components/dialog/share-admin-link.js","../node_modules/parseuri/index.js","../node_modules/socket.io-parser/node_modules/isarray/index.js","../node_modules/socket.io-parser/is-buffer.js","../node_modules/socket.io-client/lib/manager.js","../node_modules/engine.io-client/lib/transports/index.js","../node_modules/engine.io-client/lib/transports/polling.js","../node_modules/has-binary2/index.js","../node_modules/yeast/index.js","../node_modules/indexof/index.js","../node_modules/socket.io-client/lib/socket.js","../node_modules/socket.io-client/lib/on.js","../node_modules/component-bind/index.js","../node_modules/@seafile/react-image-lightbox/node_modules/react-modal/lib/helpers/tabbable.js","../node_modules/@seafile/react-image-lightbox/node_modules/react-modal/lib/helpers/ariaAppHider.js","../node_modules/socket.io-client/lib/index.js","components/wiki-markdown-viewer.js","../node_modules/@seafile/react-image-lightbox/dist/index.es.js","../node_modules/@seafile/react-image-lightbox/node_modules/react-modal/lib/index.js","components/tree-view/tree-node-view.js","components/tree-view/tree-view.js","components/empty-tip.js","../node_modules/socket.io-client/lib/url.js","../node_modules/socket.io-client/node_modules/debug/src/debug.js","../node_modules/socket.io-parser/node_modules/debug/src/browser.js","../node_modules/socket.io-parser/node_modules/debug/src/debug.js","../node_modules/socket.io-parser/binary.js","../node_modules/engine.io-client/lib/index.js","../node_modules/engine.io-client/lib/socket.js","../node_modules/has-cors/index.js","../node_modules/engine.io-client/lib/transports/polling-xhr.js","../node_modules/engine.io-parser/lib/keys.js","../node_modules/has-binary2/node_modules/isarray/index.js","../node_modules/arraybuffer.slice/index.js","../node_modules/after/index.js","../node_modules/engine.io-parser/lib/utf8.js","../node_modules/base64-arraybuffer/lib/base64-arraybuffer.js","../node_modules/blob/index.js","../node_modules/engine.io-client/node_modules/debug/src/debug.js","../node_modules/engine.io-client/lib/transports/polling-jsonp.js","../node_modules/engine.io-client/lib/transports/websocket.js","../node_modules/to-array/index.js","../node_modules/backo2/index.js","../node_modules/@seafile/react-image-lightbox/node_modules/react-modal/lib/components/Modal.js","../node_modules/@seafile/react-image-lightbox/node_modules/react-modal/lib/components/ModalPortal.js","../node_modules/@seafile/react-image-lightbox/node_modules/react-modal/lib/helpers/focusManager.js","../node_modules/@seafile/react-image-lightbox/node_modules/react-modal/lib/helpers/scopeTab.js","../node_modules/@seafile/react-image-lightbox/node_modules/warning/warning.js","../node_modules/exenv/index.js","../node_modules/@seafile/react-image-lightbox/node_modules/react-modal/lib/helpers/classList.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator/index.js","components/context-menu/actions.js","components/context-menu/helpers.js","../node_modules/component-emitter/index.js","../node_modules/engine.io-parser/lib/browser.js","components/dialog/edit-filetag-dialog.js","components/context-menu/globalEventListener.js"],"names":["ContextMenu","props","registerHandlers","document","addEventListener","handleOutsideClick","handleHide","handleKeyNavigation","window","unregisterHandlers","removeEventListener","handleShow","e","detail","id","state","isVisible","position","x","y","currentObject","menuList","setState","callIfExists","onShowMenu","onHideMenu","menu","contains","target","hideMenu","handleMouseLeave","event","preventDefault","hideOnLeave","handleContextMenu","keyCode","getMenuPosition","menuStyles","top","left","innerWidth","innerHeight","rect","getBoundingClientRect","height","width","getRTLMenuPosition","onMenuItemClick","stopPropagation","operation","Utils","getEventData","onContextMenu","this","listenId","listener","register","wrapper","requestAnimationFrame","setTimeout","rtl","style","opacity","pointerEvents","unregister","role","className","display","ref","map","menuItem","index","key","data-operation","onClick","value","React","Component","CreateForder","handleChange","trim","isSubmitBtnActive","childName","handleSubmit","newName","checkDuplicatedName","errMessage","gettext","replace","HTMLescape","path","parentPath","onAddFolder","handleKeyPress","toggle","addFolderCancel","newInput","createRef","length","focus","setSelectionRange","isOpen","for","innerRef","input","onKeyPress","onChange","color","disabled","interval","ZipDownloadDialog","queryZipProgress","zipToken","seafileAPI","then","res","data","zipProgress","total","zipped","toFixed","clearInterval","toggleDialog","location","href","fileServerRoot","catch","error","errorMsg","getErrorMsg","isLoading","cancelZipTask","token","repoID","getShareLinkDirentsZipTask","getShareLinkZipTask","zipDownload","setInterval","Content","ItemDropdownMenu","isItemMenuShow","unfreezeItem","onDropdownToggleClick","toggleOperationMenu","freezeItem","item","isHandleContextMenuEvent","listenerId","getMenuList","nextProps","name","toggleClass","tagName","title","data-toggle","aria-expanded","divider","tag","defaultProps","runtime","exports","undefined","Op","Object","prototype","hasOwn","hasOwnProperty","$Symbol","Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","define","obj","defineProperty","enumerable","configurable","writable","err","wrap","innerFn","outerFn","self","tryLocsList","protoGenerator","Generator","generator","create","context","Context","_invoke","GenStateSuspendedStart","method","arg","GenStateExecuting","Error","GenStateCompleted","doneResult","delegate","delegateResult","maybeInvokeDelegate","ContinueSentinel","sent","_sent","dispatchException","abrupt","record","tryCatch","type","done","GenStateSuspendedYield","makeInvokeMethod","fn","call","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","getProto","getPrototypeOf","NativeIteratorPrototype","values","Gp","defineIteratorMethods","forEach","AsyncIterator","PromiseImpl","invoke","resolve","reject","result","__await","unwrapped","previousPromise","callInvokeWithMethodAndArg","TypeError","info","resultName","next","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","iterable","iteratorMethod","isNaN","i","constructor","displayName","isGeneratorFunction","genFun","ctor","mark","setPrototypeOf","__proto__","awrap","async","Promise","iter","toString","keys","object","reverse","pop","skipTempReset","prev","charAt","slice","stop","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","thrown","delegateYield","module","regeneratorRuntime","accidentalStrictMode","Function","load","r","storage","debug","process","DEBUG","require","log","console","apply","arguments","formatArgs","args","useColors","namespace","humanize","diff","c","splice","lastC","match","save","namespaces","removeItem","navigator","userAgent","toLowerCase","documentElement","WebkitAppearance","firebug","table","parseInt","RegExp","$1","chrome","local","localStorage","localstorage","colors","formatters","j","v","JSON","stringify","message","enable","encode","str","encodeURIComponent","decode","qs","qry","pairs","split","l","pair","decodeURIComponent","a","b","RepoTag","repo_tag_id","fileCount","files_count","tag_name","tag_color","ImageDialog","imageItems","imageIndex","imageItemsLength","imageCaption","url","mainSrc","src","imageTitle","nextSrc","prevSrc","onCloseRequest","closeImagePopup","onMovePrevRequest","moveToPrevImage","onMoveNextRequest","moveToNextImage","imagePadding","imageLoadErrorMessage","prevLabel","nextLabel","closeLabel","zoomInLabel","zoomOutLabel","SystemNotification","close","isClosed","cookieEnabled","date","Date","cookies","cookie","infoIDExist","newInfoID","curNoteID","setTime","getTime","toGMTString","siteRoot","len","curNoteMsg","Group","owner","admins","avatar_url","created_at","parent_group_id","wiki_enabled","repos","group_quota","group_quota_usage","MainSideNav","grpsExtend","groupsExtended","loadGroups","shExtend","sharedExtended","_this","listGroups","groupList","groupsHeight","listHeight","groupItems","sort","toaster","danger","tabItemClick","param","uploader","isUploadProgressDialogShow","totalProgress","confirm","onDTableClick","dtableWebServer","open","getActiveClass","tab","currentTab","closeSideBar","adminHeight","to","aria-hidden","linksNavItem","canGenerateShareLink","canGenerateUploadLink","canAddRepo","customNavItems","idx","link","desc","icon","showActivity","isDocs","isPro","canViewOrg","renderSharedGroups","enableOCM","canPublishRepo","draftCounts","pill","canInvitePeople","renderSharedAdmin","renderCustomNavItems","AboutDialog","onCloseAboutDialog","renderExternalAboutLinks","additionalAboutDialogLinks","lang","aboutDialogCustomHtml","dangerouslySetInnerHTML","__html","mediaUrl","logoPath","logoHeight","logoWidth","siteTitle","alt","seafileVersion","getFullYear","SideNavFooter","onAboutDialogToggle","isAboutDialogShow","renderExternalAppLinks","additionalAppBottomLinks","sideNavFooterCustomHtml","rel","enableTC","SidePanel","isSidePanelClosed","onCloseSidePanel","MainPanel","children","DraftsView","moment","locale","DraftListItem","onMouseEnter","isItemFreezed","isMenuIconShow","highlight","onMouseLeave","onFreezedItem","onUnfreezedItem","onDeleteHandler","draft","onPublishHandler","origin_repo_id","filePath","draft_file_path","fileName","getFileName","draftUrl","libraryUrl","repo_name","localTime","utc","updated_at","toDate","fromNow","iconUrl","getFileIconUrl","status","DraftListView","drafts","draftList","DraftContent","draft_name","editUtilities","deleteDraft","updateDraftsList","msg_s","success","publishDraft","getDrafts","isLoadingDraft","Acticity","json","repo_id","obj_type","commit_id","author_email","author_name","author_contact_email","time","op_type","createdFilesCount","createdFilesList","days","old_repo_name","includes","old_path","old_name","endsWith","draft_id","ListCreatedFileDialog","activity","toggleCancel","fileURL","encodePath","serviceURL","fileLink","bind","app","config","FileActivitiesContent","isDesktop","items","isLoadingMore","desktopThead","mobileThead","ActivityItem","onListCreatedFilesToggle","isListCreatedFiles","op","details","moreDetails","userProfileURL","libURL","libLink","smallLibLink","firstLine","isDraft","filePathLink","dirURL","dirLink","dirPathLink","isShowDate","lastEventTime","isSame","colSpan","format","datetime","is","FilesActivities","mergePublishEvents","events","curPathList","oldPathList","actuallyEvents","indexOf","mergeFileCreateEvents","multiFilesActivity","isFulfilCondition","Activity","handleScroll","hasMore","clientHeight","scrollHeight","scrollTop","getMore","isFirstLoading","currentPage","avatarSize","listActivities","onScroll","loading","emptyTip","TableBody","getThumbnails","filter","imageCheck","obj_name","repo_encrypted","getThumbnail","curItem","createThumbnail","encoded_thumbnail_src","listItems","item_icon_url","getDefaultLibIconUrl","is_dir","getFolderIconUrl","encoded_path","thumbnail_url","dirent_view_url","mtime_relative","mtime","Item","toggleOpMenu","isOpMenuOpen","handleMouseOver","showOpIcon","handleMouseOut","unstar","unstarItem","unstarred","visitItem","navigate","opClasses","desktopItem","onMouseOver","onMouseOut","aria-label","mobileItem","Starred","listStarredItems","starred_item_list","ConfirmUnlinkDevice","executeOperation","isChecked","onInputChange","checked","check","isOpIconShown","isConfirmUnlinkDialogOpen","handleClick","is_desktop_client","unlinkDevice","wipeDevice","platform","device_id","unlinked","msg","device_name","last_login_ip","last_accessed","Fragment","LinkedDevices","listLinkedDevices","SharedRepoInfo","share_type","share_permission","modifier_name","modifier_email","modifier_contact_email","encrypted","is_admin","user_name","user_email","contact_email","group_id","group_name","PermSelect","switchOption","currentOption","changePerm","currentPerm","options","permissions","htmlFor","sharePerms","sharePermsExplanation","sortByName","sortOrder","sortItems","sortBy","sortIcon","togglePermSelectDialog","isPermSelectDialogOpen","permission","user","updateRepoSharePerm","unshare","unshareRepo","unshared","showAdmin","assign","shareTo","getLibIconUrl","iconTitle","getLibIconTitle","repoUrl","shareType","isTextMode","isEditIconShow","currentPermission","onPermissionChanged","ShareAdminLibraries","sortRepos","listSharedRepos","SharedFolderInfo","folder_name","unshareFolder","postData","updateFolderSharePerm","is_readonly","getFolderIconTitle","folderUrl","ShareAdminFolders","_sortItems","comparator","compareTwoWord","listSharedFolders","ShareLinkPermissionSelect","getShareLinkPermissionObject","text","sortByTime","columnWidths","onRemoveLink","updatePermissionOptions","itemType","repo_folder_permission","permissionOptions","getShareLinkPermissionList","can_edit","getShareLinkPermissionStr","toggleLinkDialog","isLinkDialogOpen","viewLink","removeLink","renderExpiration","expire_date","expire_time","is_expired","permissionDetails","updateShareLink","objUrl","view_cnt","ShareAdminShareLinks","deleteShareLink","uploadItem","listUserShareLinks","ShareLink","ShareAdminUploadLinks","deleteUploadLink","listUserUploadLinks","UploadLink","Repo","size_original","size","bytesToSize","owner_name","owner_email","owner_contact_email","last_modified","starred","storage_name","LibsMobileThead","_slicedToArray","arr","Array","isArray","_arr","_n","_d","_e","_s","_i","unsupportedIterableToArray","SortOptions","sortOptions","sortBySize","share","isShowSharedDialog","leaveShare","request","leaveShareRepo","leaveShareGroupOwnedRepo","toggleShareDialog","onStarRepo","repoName","isStarred","starItem","visitRepo","repoURL","icon_url","icon_title","iconVisibility","shareIconClassName","leaveShareIconClassName","shareRepoUrl","itemName","itemPath","repoEncrypted","enableDirPrivateShare","userPerm","isAdmin","SharedLibraries","toggleSortOptionsDialog","isSortOptionsDialogOpen","listRepos","repoList","provider_id","from_user","from_server_url","ctime","SharedWithOCM","deleteOCMShareReceived","listOCMSharesReceived","ocm_share_received_list","MainPanelTopbar","isAdminPanel","DirPath","onPathClick","turnPathToLink","pathList","nodePath","data-path","currentPath","pathElem","onTabNavClick","DirentItem","openFolder","dirent","downloadDirent","getDirentIcon","is_file","DirContent","direntList","deleteDirent","fromSystemRepo","Dirent","DirView","loadDirentList","direntPath","joinPath","providerID","listOCMRepoDir","dirent_list","user_perm","history","replaceState","getOCMRepoDownloadURL","openFileInput","fileInput","current","click","onFileInputChange","files","file","getOCMRepoUploadURL","formData","FormData","append","post","fileObj","newDirent","dirs","isNewFolderDialogOpen","CreateRepoDialog","handleRepoNameChange","handlePassword1Change","password1","handlePassword2Change","password2","validateInputParams","repoData","prepareRepoData","libraryType","onCreateRepo","onCreateToggle","onPermissionChange","handleStorageInputChange","selectedItem","storage_id","handlelibraryTemplatesInputChange","library_template","onEncrypted","encrypt","password","repo","passwd","storages","libraryTemplates","repoPasswordMinLength","defaultValue","label","enableEncryptedLibrary","autoComplete","RepoViewToolbar","isCreateRepoDialogShow","toggleMore","onShowSidePanel","LibDetail","getFileCounts","getRepoInfo","file_count","currentRepo","smallIconUrl","bigIconUrl","closeDetails","LibHistorySetting","submit","keepDays","autoHistory","expireDays","test","setRepoHistoryLimit","keep_days","errorInfo","num","setLimitDays","allHistory","noHistory","getRepoHistoryLimit","enableRepoHistorySetting","onKeyDown","ChangeRepoPasswordDialog","handleOldPasswordInputChange","oldPassword","handleNewPasswordInputChange","newPassword","handleNewPasswordAgainInputChange","newPasswordAgain","formSubmit","submitBtnDisabled","changeEncryptedRepoPassword","centered","generateDialogTitle","action","ResetEncryptedRepoPasswordDialog","showLoading","showSuccess","showError","resetAndSendEncryptedRepoPassword","response","error_msg","contactEmail","LabelRepoStateDialog","handleInputChange","inputValue","labels","join","addNewRepoLabels","formErrorMsg","existingLabels","getAllRepoSnapshotLabels","isMulti","placeholder","UserItem","isOperationShow","deleteUserFolderPermission","onChangeUserFolderPerm","folder_path","showPath","LibSubFolderSetUserPermissionDialog","handleUserSelectChange","option","selectedUsers","setPermission","addUserFolderPerm","folderPath","users","email","isDepartmentRepo","addDepartmentRepoUserFolderPerm","failed","userFolderPermItems","concat","refs","userSelect","clearSelect","deleteUserFolderPermItem","deleteDepartmentRepoUserFolderPerm","deleteUserFolderPerm","deletedItem","userEmail","updateDepartmentRepoUserFolderPerm","updateUserFolderPerm","onSetSubFolder","toggleFileChooser","showFileChooser","toggleSubFolder","handleFileChooserSubmit","onRepoItemClick","listDepartmentRepoUserFolderPerm","listUserFolderPerm","mode","onDirentItemClick","thead","onSelectChange","addonType","GroupItem","deleteGroupPermissionItem","onChangeGroupPermission","NoOptionsMessage","innerProps","margin","textAlign","LibSubFolderSerGroupPermissionDialog","handleSelectChange","selectedOption","loadOptions","shareableGroups","listGroupPermissionItems","listDepartmentRepoGroupFolderPerm","listGroupFolderPerm","groupPermissionItems","addGroupFolderPerm","addDepartmentRepoGroupFolderPerm","deleteDepartmentRepoGroupFolderPerm","deleteGroupFolderPerm","updateDepartmentRepoGroupFolderPerm","updateGroupFolderPerm","updateGroupPermission","groupID","sharedItem","sharedItemGroupID","maxMenuHeight","inputId","components","LibSubFolderPermissionDialog","activeTab","renderContent","pills","tabId","folderName","maxWidth","Rename","nativeEvent","stopImmediatePropagation","onRenameConfirm","validateInput","isValid","onRenameCancel","renameInput","hasSuffix","endIndex","lastIndexOf","MylibRepoMenu","dataset","generatorOperations","showResetPasswordMenuItem","enableResetEncryptedRepoPassword","isEmailConfigured","operations","folderPermEnabled","isPC","enableRepoSnapshotLabel","translateOperations","translateResult","unshift","RepoAPITokenPermissionEditor","onHideSelect","isEditing","onEditPermission","onSelectHandler","optionTranslation","captureMenuScroll","APITokenItem","onDeleteAPIToken","deleteAPIToken","app_name","onUpdateAPIToken","updateAPIToken","onCopyAPIToken","api_token","copy","RepoAPITokenDialog","listAPITokens","listRepoAPITokens","apiTokenList","repo_api_tokens","handleError","appName","addAPIToken","addRepoAPIToken","deleteRepoAPIToken","updateRepoAPIToken","duration","renderAPITokenList","minHeight","maxHeight","onRepoAPITokenToggle","RepoShareUploadLinkItem","onDeleteLink","deleteItem","creator_name","RepoShareUploadLinksDialog","getItems","listRepoShareLinks","listRepoUploadLinks","repoShareUploadLinkList","deleteRepoShareLink","deleteRepoUploadLink","forDialog","LibOldFilesAutoDelDialog","daysNeedTobeSet","autoDelDays","isAutoDel","setRepoOldFilesAutoDelDays","updateRadioCheck","getRepoOldFilesAutoDelDays","auto_delete_days","MylibRepoListItem","isOpIconShow","onShareToggle","onDeleteToggle","onRenameToggle","onTransferToggle","onHistorySettingToggle","onChangePasswordToggle","onResetPasswordToggle","onFolderPermissionToggle","onLabelToggle","onAPITokenToggle","toggleRepoShareUploadLinksDialog","toggleOldFilesAutoDelDialog","isRenaming","onRepoClick","isShareDialogShow","isDeleteDialogShow","isTransferDialogShow","isHistorySettingDialogShow","isChangePasswordDialogShow","isResetPasswordDialogShow","isLabelRepoStateDialogOpen","isFolderPermissionDialogShow","isAPITokenDialogShow","isRepoShareUploadLinksDialogOpen","isOldFilesAutoDelDialogOpen","renameRepo","onRenameRepo","onTransferRepo","transferRepo","onDeleteRepo","deleteRepo","isRepoDeleted","renderPCUI","renderMobileUI","query","MylibRepoListView","sortRepoList","renderRepoListView","showStorageBackend","GuideForNewDialog","siteName","MyLibraries","createMineRepo","newRepo","repo_size","isShowDetails","onRepoDetails","toggleGuideForNewDialog","pageOptions","guideEnabled","isGuideForNewDialogOpen","onSearchedClick","MyLibsDeleted","refreshDeletedRepoList","deletedRepoList","listDeletedRepo","trashReposExpireDays","DeletedRepoTable","deletedRepos","DeletedRepoItem","hideRestoreMenu","restoreDeletedRepo","del_time","ShareRepoListItem","onRepoSelect","padding","sharePermission","ShareRepoDialog","selectedRepoList","onRepoSelectedHandler","onCloseDialog","onShareRepoDialogClose","SharedRepoListItem","clickOperationMenuToggle","getRepoComputeParams","libPath","onItemRenameToggle","onItemFolderPermissionToggle","onItemDetails","onItemShare","onItemUnshare","onItemRename","isFolderPermissionDialogOpen","onItemDeleteToggle","onItemDelete","currentGroup","deleteGroupOwnedLibrary","translateMenuItem","isStaff","username","isRepoOwner","isDeparementOnwerGroupMember","generatorMobileMenu","isSystemStaff","generatorPCMenu","shareOperation","unshareOperation","deleteOperation","isGroupOwnedRepo","SharedRepoListView","getSortMetaData","some","isShowTableThread","hasNextPage","PublicSharedView","createPublicRepo","addRepoItem","onCreateRepoToggle","selectOwnedRepoToPublic","isExist","repoIndex","newRepoList","onAddRepoToggle","isCreateMenuShow","onSelectRepoToggle","isSelectRepoDialpgShow","canAddPublicRepo","asyncGeneratorStep","gen","_next","_throw","socket","seafileCollabServer","io","collabServer","emit","on","off","LibDecryptDialog","setRepoDecryptPassword","onLibDecryptDialog","ViewModeToolbar","switchViewMode","currentMode","baseClass","CreateFile","isDuplicated","onAddFile","handleCheck","pos","p","substring","fileType","isdraft","addFileCancel","DirOperationToolbar","toggleMobileOpMenu","isMobileOpMenuOpen","hideOperationMenu","isUploadMenuShow","targetRect","bottom","operationMenuStyle","onUploadClick","onUploadFile","onUploadFolder","onCreateClick","onShareClick","onCreateFolderToggle","isCreateFolderDialogShow","onCreateFileToggle","isCreateFileDialogShow","onCreateMarkdownToggle","onCreateExcelToggle","onCreatePPTToggle","onCreateWordToggle","dirPath","getFolderName","content","showShareBtn","isSupportUploadFolder","MoveDirent","isMutipleOperation","moveItems","moveItem","selectedPath","selectedDirentList","direntPaths","moveDirentPath","flag","onItemsMove","onItemMove","onCancelMove","nextState","CopyDirent","copyItems","copyItem","copyDirentPath","onItemsCopy","onItemCopy","onCancelCopy","onRename","changeState","MultipleDirOperationToolbar","onMoveToggle","isMoveDialogShow","onCopyToggle","isCopyDialogShow","onItemsDelete","onItemsDownload","isDir","URLDecorator","getUrl","isZipDialogOpen","closeZipDialog","checkDuplicatedNameInList","onPermissionItem","showLibContentViewDialogs","isPermissionDialogOpen","onCommentItem","showDirentDetail","getDirentMenuList","currentRepoInfo","opList","getDirentOperationList","list","showShareDialog","isRenameDialogOpen","listFileTags","lockFile","unlockFile","openRelatedFilesDialog","onHistory","onAccessLog","onOpenViaClient","getDirentPath","lockfile","is_locked","updateDirent","unSelectDirent","unlockfile","listRelatedFiles","relatedFiles","related_files","showRelatedFileDialog","viewMode","showEditFileTagDialog","fileTagList","file_tags","file_tag_id","onMenuFileTagChanged","onFilesTagChanged","onRelatedFileChange","multiFileTagList","onFileTagChanged","ViewFileToolbar","onEditClick","onNewDraft","createDraft","onDraftHover","isDraftMessageShow","isMoreMenuShow","onEditFileTagToggle","isEditTagDialogShow","onListRelatedFileToggle","isRelatedFileDialogShow","onHistoryClick","historyUrl","filePermission","hasDraft","placement","fileTags","LibContentToolbar","isViewFile","onSideNavMenuClick","isLibView","searchPlaceholder","isDirentSelected","tabName","tagTitle","pathPrefix","showName","fileTag","zIndex","backgroundColor","TagListItem","showSelectedTag","onTagUpdate","onListTaggedFiles","drakColor","getDarkColor","fileTranslation","ListTagDialog","onListTagCancel","createNewTag","onCreateRepoTag","repotagList","listRepoTags","repo_tags","repo_tag","repoTag","onUpdateRepoTag","UpdateTagDialog","inputNewName","selectNewcolor","newColor","updateTag","tag_id","currentTag","updateRepoTag","updateUsedRepoTags","deleteTagClick","deleteRepoTag","onDeleteTag","onDeleteRepoTag","colorList","onClose","defaultChecked","ListTaggedFilesDialog","TaggedFile","parent_path","filename","onDeleteTaggedFile","taggedFile","fileTagID","deleteFileTag","getTaggedFiles","file_deleted","listTaggedFiles","taggedFileList","tagged_files","active","unix","DirTool","onShowListRepoTag","isRepoTagDialogShow","isListRepoTagShow","isUpdateRepoTagShow","isCreateRepoTagShow","isListTaggedFileShow","onCloseRepoTagDialog","onCreateRepoTagToggle","onUpdateRepoTagToggle","onListTaggedFileToggle","isFile","isMarkdownFile","trashUrl","CurDirPath","DetailCommentList","handleCommentChange","comment","listComments","commentsList","comments","addComment","postComment","onSubmit","addParticipant","toBeAddedParticipant","addFileParticipants","onParticipantsChange","resolveComment","updateComment","deleteComment","editComment","commentID","newComment","listRepoRelatedUsers","user_list","relatedUsers","checkParticipant","fileParticipantList","participant","renderUserSuggestion","search","highlightedDisplay","focused","oldTime","participants","showIconTip","defaultStyle","trigger","displayTransform","renderSuggestion","defaultMentionStyle","onAdd","appendSpaceOnAdd","CommentItem","convertComment","mdFile","processor","html","String","toggleDropDownMenu","dropdownOpen","toggleEditComment","editable","onCommentClick","nodeName","preNode","previousSibling","nodeType","nodeValue","renderInfo","clos","rows","warp","resolved","DetailListView","getDirentPostion","repoInfo","isEditFileTagShow","direntType","direntDetail","relatedFile","DirentDetail","loadDirentInfo","updateDetailView","getDirName","listDir","folderDirent","parent_dir","getFileInfo","file_tag","FileTag","listParticipants","getDirInfo","listFileParticipants","participant_list","renderNavItem","showTab","classnames","renderHeader","direntName","onItemDetailsClose","renderDetailBody","direntDetailPanelTab","tabs","DirentNodeView","onCreateNewFile","isDirentListLoading","Draft","created","createdStr","ownerNickname","owner_nickname","originRepoID","draftFilePath","ListRepoDraftsDialog","onDeleteDraftItem","editorUtilities","listRepoDrafts","draftItem","DraftItem","ReadmeDialog","readmeContent","getFileDownloadLink","getFileContent","markdownContent","showTOC","scriptSource","RepoInfoBar","toggleDrafts","showRepoDrafts","toggleReadme","showReadmeDialog","usedRepoTags","readmeMarkdown","usedRepoTag","DirentListItem","isDragTipShow","onItemSelected","onItemStarred","onDirentClick","onItemClick","isRenameing","showImagePopup","closeSharedDialog","onMobileMenuItemClick","getAttribute","onItemDownload","onItemMoveToggle","onItemCopyToggle","onUnlockItem","onLockItem","lockName","onTagTooltipToggle","isShowTagTooltip","destRepo","onItemDragStart","isIEBrower","dataTransfer","effectAllowed","onShowDirentsDraggablePreview","setDragImage","empty_content","selectedList","nodeRootPath","nodeDirent","nodeParentPath","setData","drag_icon","dragStartItemData","onItemDragEnter","isDropTipshow","onItemDragOver","dropEffect","onItemDragLeave","onItemDragDrop","getData","parse","draggedItem","dropItemData","onItemMouseDown","onItemContextMenu","renderItemOperation","isHasPermissionToShare","isSelected","getDirentItemMenuList","activeDirent","dirHref","fileHref","toolTipID","MD5","trClass","lockedInfo","lock_owner_name","draggable","onDragStart","onDragEnter","onDragOver","onDragLeave","onDrop","onMouseDown","data-op","DirentsDraggedPreview","handleDragEnd","element","onHideDirentsDraggablePreview","handleDragOver","clientY","clientX","handleDrop","inlineStyle","overflow","DirentListView","prepareImageItem","useThumbnail","isGIF","substr","thumbnailSizeForOriginal","isImagePopupOpen","prevState","selectedDirentNames","isProgressDialogShow","downloadItems","onCloseZipDownloadDialog","button","handleContextClick","touches","pageX","pageY","posX","posY","showMenuConfig","showMenu","onContainerClick","onContainerMouseDown","onContainerContextMenu","TextTranslation","NEW_FOLDER","NEW_FILE","persist","MOVE","COPY","DOWNLOAD","DELETE","onContainerMenuItemClick","onDirentsMenuItemClick","onThreadMouseDown","onThreadContextMenu","setDirentItemRef","direntItems","getDirentIndex","isContextmenu","onTableDragEnter","enteredCounter","isListDropTipShow","onTableDragOver","onTableDragLeave","tableDrop","isShowDirentsDraggablePreview","clickedDirent","currentItemRef","onAllItemSelected","isAllItemSelected","dragStartPosition","DirListView","isRepoInfoBarShow","DirentGridItem","isGridSelected","onGridItemClick","onItemLinkClick","onGridItemDragStart","onGridItemDragEnter","isGridDropTipShow","onGridItemDragOver","onGridItemDragLeave","onGridItemDragDrop","onGridItemMouseDown","getFileUrl","fileUrlArr","onGridItemContextMenu","fileUrl","gridClass","gridIcon","DirentGridView","isRenameDialogShow","onGridContainerMouseDown","gridContainerClick","isDirentDetailShow","onGridContainerContextMenu","isGridItemFreezed","DirGridView","onRenameNode","currentNode","DirColumnNav","onNodeClick","node","opNode","showNodeImagePopup","onAddFolderToggle","onAddFileToggle","onDeleteNode","onOpenFile","root","treeData","isAddFileDialogShow","isAddFolderDialogShow","onAddFolderNode","onAddFileNode","newUrl","parentNode","imageNames","isNodeImagePopupOpen","imageNodeItems","prepareImageItems","prepareItem","closeNodeImagePopup","stopTreeScrollPropagation","isNodeMenuShow","flex","navRate","select","inResizing","isTreeDataLoading","repoPermission","onNodeExpanded","onNodeCollapse","onUnFreezedItem","DirColumnFile","goDraftPage","hash","isFileLoadedErr","isTOCShow","isFileLoading","lastModified","latestContributor","onLinkClick","DirColumnView","onResizeMouseUp","setCookie","onResizeMouseDown","containerWidth","viewModeContainer","clientWidth","onResizeMouseMove","sizeNavWidth","rate","getCookie","cookiename","onResizeMove","mainFlex","onMouseMove","onMouseUp","LibContentContainer","onMainNavBarClick","closeDirentDetail","currentDirent","checkCurrentDirent","deletedDirent","onItemsScroll","onListContainerScroll","updateDetail","pathExist","isAllDirentSelected","onAllDirentSelected","UPLOAD_UPLOADING","UPLOAD_ERROR","UPLOAD_ISSAVING","UPLOAD_UPLOADED","UploadListItem","onUploadCancel","resumableFile","onUploadRetry","formatFileSize","uploadState","remainingTime","isSaved","progress","Math","round","newFileName","isUploading","aria-valuenow","aria-valuemin","aria-valuemax","formatTime","ForbidUploadListItem","maxUploadFileSize","UploadProgressDialog","onCancelAllUploading","onMinimizeUpload","isMinimized","onCloseUpload","onCloseUploadDialog","uploadBitrate","formatBitRate","uploadedMessage","uploadingMessage","uploadingOptions","uploadedOptions","allFilesUploaded","retryFileList","onUploadRetryAll","forbidUploadFileList","uploadFileList","UploadRemindDialog","cancelFileUpload","replaceRepetitionFile","uploadFile","currentResumableFile","FileUploader","componentWillUnmount","onbeforeunload","dragAndDrop","resumable","disableDropOnDocument","bindCallbackHandler","minFileSizeErrorCallback","fileTypeErrorCallback","maxFilesErrorCallback","opts","maxFileSizeErrorCallback","bindEventHandler","onChunkingComplete","onFileAdded","filesAddedComplete","onFileProgress","onFileUploadSuccess","onProgress","onComplete","onPause","onFileRetry","onFileError","onError","onBeforeCancel","onCancel","errorCount","maxFiles","maxNumberOfFilesForFileupload","relativePath","relative_path","hasRepetition","isUploadRemindDialogShow","setUploadFileList","getFileServerUploadLink","resumableUpload","isUploadLinkLoaded","upload","getFileUploadedBytes","uploadedBytes","blockSize","resumableUploadFileBlockSize","offset","floor","markChunksCompleted","registerGlobalVariable","getBitrate","uniqueIdentifier","lastSize","loaded","now","timestamp","timeDiff","bitrateInterval","currentTime","dir_name","notifiedFolders","getFileServerErrorMessage","errorMessage","setHeaders","chunkSize","getOpt","fileSize","startByte","endByte","min","encodeURI","setQuery","generateUniqueIdentifier","webkitRelativePath","onFileUpload","uploadInput","removeAttribute","onFolderUpload","setAttribute","uploadingItem","cancel","retryUploadFile","bootstrap","firedRetry","resumableObj","getUpdateLink","Resumablejs","filetypes","maxFileSize","testMethod","testChunks","headers","withCredentials","simultaneousUploads","fileParameterName","forceChunkSize","maxChunkRetries","minFileSize","assignBrowse","enableDropOnDocument","CopyMoveDirentProgressDialog","asyncOperationProgress","asyncOperatedFilesLength","progressStyle","lineHeight","LibContentView","toggleDirentDetail","onpopstate","showFile","onRepoUpdateEvent","parseFloat","lastModifyTime","dirID","updataColumnMarkdownData","dirMetaData","updateReadmeMarkdown","last_modifier_name","is_draft","has_draft","draftID","loadDirData","watchRepo","getRepoDraftCounts","draft_counts","loadSidePanel","showDir","tree","addResponseListToNode","loadNodeAndParentsByPath","isSessionExpired","resetShowLength","isNeedUpdateHistoryState","pushState","errMsg","markdownItem","sortDirents","dir_id","itemsShowLength","curItemPath","updateMoveCopyTreeNode","nodeChildrenNames","clone","getNodeByPath","addNodeToTree","cancelCopyMoveDirent","taskId","asyncCopyMoveTaskId","cancelCopyMoveOperation","currentMoveItemName","currentMoveItemPath","onMoveProgressDialogToggle","isCopyMoveProgressDialogShow","onMoveItems","destDirentPath","asyncOperationType","dirNames","getSelectedDirentNames","getSelectedDirentPaths","moveDir","task_id","getAsyncCopyMoveProgress","deleteTreeNodes","moveDirents","getMoveSuccessMessage","getMoveFailedMessage","onCopyItems","copyDir","getCopySuccessfulMessage","getCopyFailedMessage","onDeleteItems","deleteMutipleDirents","deleteDirents","createDir","addDirent","createFile","paths","getPaths","isWeChat","resetSelected","expandNode","isInternalMarkdownLink","getPathFromInternalMarkdownLink","isInternalDirLink","getPathFromInternalDirLink","onMainPanelItemRename","renameItem","onMainPanelItemDelete","onRenameTreeNode","onDeleteTreeNode","renameDir","renameItemAjaxCallback","renameFile","onMoveItem","moveToDirentPath","dirName","deleteTreeNode","moveDirent","onCopyItem","copyToDirentPath","loadTreeNodeByPath","showColumnMarkdownFile","onDirentSelected","direntObject","createDirent","renameDirent","newDirentPath","isChildPath","oldName","isAncestorPath","newPath","renameAncestorPath","direntNames","recaculateSelectedStateAfterDirentDeleted","paramKey","paramValue","newDirentList","isLoaded","isExpanded","with_parents","results","parentDir","isLoadFailed","onTreeNodeClick","collapseNode","treeHelper","w","onTreeNodeCollapse","onTreeNodeExpanded","createTreeNode","addNodeToParentByPath","renameTreeNode","renameNodeByPath","deleteNodeByPath","deleteNodeListByPaths","moveTreeNode","moveToPath","moveToRepo","moveNodeByPath","copyTreeNode","copyToPath","copyNodeByPath","nodeList","TreeNode","addChildren","selectedDirent","names","libNeedDecrypt","onToolbarFileTagChanged","onToolbarRelatedFileChange","deletedTagID","buildTree","oldonpopstate","RepoInfo","lib_need_decrypt","unwatchRepo","queryAsyncOperationProgress","successful","deleteDir","deleteItemAjaxCallback","deleteFile","isVirtual","is_virtual","direntItemsList","onMenuClick","DismissGroupDialog","dismissGroup","that","deleteGroup","onGroupChanged","showDismissGroupDialog","toggleDismissGroupDialog","RenameGroupDialog","handleGroupNameChange","newGroupName","renameGroup","loadGroup","toggleRenameGroupDialog","handleKeyDown","currentGroupName","showRenameGroupDialog","TransferGroupDialog","transferGroup","toggleTransferGroupDialog","ImportMembersDialog","toggleImportMembersDialog","fileInputRef","importMembersInBatch","groupImportMembersExtraMsg","ManageMembersDialog","listGroupMembers","page","perPage","groupMembers","members","addGroupMember","emails","addGroupMembers","newMembers","toggleItemFreezed","isFreezed","toggleManageMembersDialog","changeMember","targetMember","deleteMember","isOwner","Member","onChangeUserRole","setGroupAdmin","deleteGroupMember","translateRole","roles","deleteAuthority","scope","currentRole","onRoleChanged","PureComponent","LeaveGroupDialog","leaveGroup","quitGroup","toggleLeaveGroupDialog","GroupView","getGroup","getEmptyTip","isDepartmentGroup","loadRepos","listGroupRepos","groupOwnerType","groupId","createGroupOwnedLibrary","createGroupRepo","group","unshareRepoToGroup","renameGroupOwnedLibrary","toggleGroupDropdown","showGroupDropdown","showTransferGroupDialog","showImportMembersDialog","notify","importGroupMembersViaFile","showManageMembersDialog","isLeaveGroupDialogOpen","toggleGroupMembersPopover","showGroupMembersPopover","isShowSettingIcon","useRate","hideArrow","GroupsToolbar","canAddGroup","toggleAddGroupModal","CreateGroupDialog","handleGroupChange","groupName","handleSubmitGroup","createGroup","onCreateGroup","showAddGroupModal","RepoListViewPanel","isShowRepoOwner","GroupsView","InvitationsToolbar","toggleInvitePeopleDialog","InvitePeopleDialog","handleSubmitInvite","emailsArray","isSubmitting","invitePeople","successMsg","accepter","onInvitePeople","failedMsg","InvitationRevokeDialog","onRevokeInvitation","revokeInvitation","invitation","deleteInvitation","deleted","revokeItem","toggleRevokeDialog","isRevokeDialogOpen","invite_time","accept_time","invitationsList","InvitationsView","invitationsArray","isInvitePeopleDialogOpen","listInvitations","NewWikiDialog","addWiki","WikiSelectDialog","WikiDeleteDialog","WikiListItem","isShowDeleteDialog","onDeleteCancel","deleteWiki","wiki","fileIconUrl","deleteIcon","WikiListView","wikis","renameWiki","Wikis","getWikis","listWikis","clickMenuToggle","onMenuToggle","isShowAddWikiMenu","onSelectToggle","isShowSelectDialog","isShowCreateDialog","slug","GeneralToolbar","MainContentWrapper","WrapperedComponent","FilesActivitiesWrapper","DraftsViewWrapper","StarredWrapper","LinkedDevicesWrapper","SharedLibrariesWrapper","SharedWithOCMWrapper","ShareWithOCM","ShareAdminLibrariesWrapper","ShareAdminFoldersWrapper","ShareAdminShareLinksWrapper","ShareAdminUploadLinksWrapper","App","navigateClientUrlToLib","splitUrlArray","repalce","listDrafts","dirViewPanels","generatorPrefix","navTab1","navTab2","navTab","getTabShowName","toggleSidePanel","home","contentClassName","ReactDOM","render","getElementById","AddRelatedFileDialog","onAddRelatedFile","oRepoID","rRepoID","oFilePath","rFilePath","addRelatedFile","isShowFile","subtitle","ListRelatedFileDialog","onDeleteRelatedFile","relatedID","related_id","deleteRelatedFile","getDirentList","hover","addRelatedFileToggle","RelatedFile","RelatedFileDialogs","onAddRelatedFileToggle","showListRelatedFileDialog","onCloseAddRelatedFileDialog","s","m","h","d","plural","ms","n","ceil","val","exec","long","fmtShort","Emitter","binary","isBuf","Encoder","protocol","types","CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK","Decoder","ERROR_PACKET","encodeAsString","attachments","nsp","payload","tryStringify","reconstructor","BinaryReconstructor","packet","reconPack","buffers","callback","writeEncoding","bloblessData","deconstruction","deconstructPacket","pack","removeBlobs","encodeAsBinary","add","Number","buf","tryParse","decodeString","base64","takeBinaryData","destroy","finishedReconstruction","binData","reconstructPacket","hasCORS","xdomain","xscheme","enablesXDR","XMLHttpRequest","XDomainRequest","parser","Transport","hostname","port","secure","timestampParam","timestampRequests","readyState","agent","pfx","passphrase","cert","ca","ciphers","rejectUnauthorized","forceNode","isReactNative","extraHeaders","localAddress","description","doOpen","doClose","send","packets","write","onOpen","onData","decodePacket","binaryType","onPacket","canUseDOM","_exenv","EE","__esModule","default","SafeHTMLElement","HTMLElement","CreateTagDialog","selectTagcolor","tagColor","createTag","createRepoTag","repoTagID","onRepoTagCreated","newTag","canSave","ShareAdminLink","copyToClipboard","re","parts","uri","source","host","authority","ipv6uri","withNativeBuffer","Buffer","isBuffer","withNativeArrayBuffer","ArrayBuffer","isView","buffer","eio","Socket","Backoff","has","Manager","nsps","subs","reconnection","reconnectionAttempts","Infinity","reconnectionDelay","reconnectionDelayMax","randomizationFactor","backoff","max","jitter","timeout","connecting","lastPing","encoding","packetBuffer","_parser","encoder","decoder","autoConnect","emitAll","updateSocketIds","generateId","engine","_reconnection","_reconnectionAttempts","_reconnectionDelay","setMin","_randomizationFactor","setJitter","_reconnectionDelayMax","setMax","_timeout","maybeReconnectOnOpen","reconnecting","attempts","reconnect","connect","skipReconnect","openSub","onopen","errorSub","cleanup","timer","clearTimeout","onping","onpong","ondata","ondecoded","onerror","onConnecting","encodedPackets","processPacketQueue","shift","subsLength","disconnect","onclose","reason","delay","onreconnect","attempt","XHR","JSONP","websocket","polling","xd","xs","jsonp","isSSL","forceJSONP","parseqs","inherit","yeast","Polling","hasXHR2","responseType","forceBase64","supportsBinary","poll","pause","once","doPoll","decodePayload","callbackfn","encodePayload","doWrite","schema","sid","b64","withNativeBlob","Blob","withNativeFile","File","hasBinary","toJSON","alphabet","seed","encoded","decoded","toArray","hasBin","connect_error","connect_timeout","reconnect_attempt","reconnect_failed","reconnect_error","ping","pong","ids","acks","receiveBuffer","sendBuffer","connected","disconnected","flags","subEvents","ev","compress","onpacket","sameNamespace","rootNamespaceError","onconnect","onevent","onack","ondisconnect","ack","emitBuffered","removeListener","querySelectorAll","tabbable","tabbableNode","hidesContents","zeroSize","offsetWidth","offsetHeight","innerHTML","getComputedStyle","getPropertyValue","scrollWidth","focusable","isTabIndexNotNaN","parentElement","body","visible","tabIndex","isTabIndexNaN","assertNodeList","setElement","useElement","_safeHTMLElement","el","globalElement","validateElement","hide","appElement","show","documentNotReadyOrSSRTesting","resetForTesting","_warning","_warning2","selector","lookup","cache","managers","parsed","forceNew","multiplex","contentClass","WikiMarkdownViewer","onContentRendered","markdownViewer","titlesInfo","onScrollHandler","activeTitleIndex","contentScrollTop","markdownContainer","titlesLength","changeInlineNode","imagePath","isPublicWiki","index2","originalPath","pathNormalize","isInternalFileLink","p1","p2","p3","sharedToken","modifyValueBeforeRender","changeMarkdownNodes","renderMarkdown","isWiki","renderRelatedFiles","links","MarkdownViewer","_defineProperties","descriptor","_createClass","Constructor","protoProps","staticProps","_defineProperty","_extends","ownKeys","enumerableOnly","getOwnPropertySymbols","symbols","sym","getOwnPropertyDescriptor","_objectSpread2","getOwnPropertyDescriptors","defineProperties","_getPrototypeOf","o","_setPrototypeOf","_assertThisInitialized","ReferenceError","_arrayWithHoles","_iterableToArrayLimit","_nonIterableRest","_toConsumableArray","arr2","_arrayWithoutHoles","from","_iterableToArray","_nonIterableSpread","translate","replaceStrings","translated","getWindowWidth","global","getHighestSafeWindowContext","referrer","getOrigin","parent","MAX_ZOOM_LEVEL","KEYS","ReactImageLightbox","_Component","instance","_classCallCheck","_possibleConstructorReturn","isClosing","animationDisabled","shouldAnimate","zoomLevel","offsetX","offsetY","loadErrorStatus","outerEl","zoomInBtn","zoomOutBtn","caption","closeIfClickInner","handleImageDoubleClick","handleImageMouseWheel","handleKeyInput","handleMouseUp","handleMouseDown","handleMouseMove","handleOuterMousewheel","handleTouchStart","handleTouchMove","handleTouchEnd","handlePointerEvent","handleCaptionMousewheel","handleWindowResize","handleZoomInButtonClick","handleZoomOutButtonClick","requestClose","requestMoveNext","requestMovePrev","subClass","superClass","_inherits","mouseEvent","touchPointer","identifier","pointerEvent","pointerId","_ref","_ref$x","_ref$y","_ref$zoom","zoom","targetWidth","nextX","windowWidth","scaleFactor","transform","timeouts","currentAction","eventsSource","pointerList","preventInnerClose","preventInnerCloseTimeout","keyPressed","imageCache","lastKeyDownTime","resizeTimeout","wheelActionTimeout","resetScrollTimeout","scrollX","scrollY","moveStartX","moveStartY","moveStartOffsetX","moveStartOffsetY","swipeStartX","swipeStartY","swipeEndX","swipeEndY","pinchTouchList","pinchDistance","keyCounter","moveRequested","_this2","windowContext","listeners","resize","mouseup","touchend","touchcancel","pointerdown","pointermove","pointerup","pointercancel","handleWheel","passive","loadAllImages","_this3","sourcesChanged","prevSrcDict","nextSrcDict","getSrcTypes","srcType","_this4","didUnmount","tid","_setTimeout","_x","_x2","func","_this5","_this6","imageSrc","fitSizes","isImageLoaded","getFitSizes","targetHeight","stretch","boxSize","getLightboxRect","currentImageInfo","getBestImageForType","maxX","minX","maxY","minY","zoomMultiplier","getZoomMultiplier","keyEnding","pow","right","_clearTimeout","_x3","enableZoom","nextZoomLevel","imageBaseSize","currentZoomMultiplier","nextZoomMultiplier","boxRect","pointerX","pointerY","currentImageOffsetX","currentImageOffsetY","nextImageRealOffsetX","nextImageRealOffsetY","nextOffsetX","nextOffsetY","maxOffsets","getMaxOffsets","isAnimating","which","keyRepeatLimit","keyRepeatKeyupBonus","_this7","deltaY","abs","deltaX","changeZoom","newOffsetY","newOffsetX","filterPointersBySource","pointer","_ref2","_this8","_ref3","shouldHandleEvent","isTargetMatchImage","addPointer","parseMouseEvent","multiPointerStart","multiPointerMove","removePointer","multiPointerEnd","parsePointerEvent","_this9","changedTouches","eventTouch","parseTouchPointer","_this10","touch","handleSwipeStart","handleMoveStart","handleEnd","decideMoveOrSwipe","handlePinchStart","handleMove","handleSwipe","handlePinch","setPreventInnerClose","handleMoveEnd","handleSwipeEnd","handlePinchEnd","_ref4","_ref5","_this11","animationDuration","_ref6","_ref7","xDiff","xDiffAbs","yDiffAbs","_ref8","_ref9","sqrt","_ref10","_ref11","_ref12","calculatePinchDistance","oldPointer","newDistance","_this$calculatePinchC","calculatePinchCenter","forceUpdate","_this$caption$current2","_this12","inMemoryImage","Image","imageCrossOrigin","crossOrigin","errorEvent","onImageLoadError","onload","onImageLoad","_this13","generateLoadDoneCallback","loadImage","_this14","closeLightbox","animationOnKeyInput","direction","_this15","requestMove","_this16","_this$props","clickOutsideToClose","discourageDownloads","toolbarButtons","reactModalStyle","_onAfterOpen","onAfterOpen","reactModalProps","_this$state","transitionStyle","transition","keyEndings","_ref13","images","addImage","imageClass","transforms","bestImageInfo","imageStyle","getTransform","cursor","createElement","backgroundImage","onDoubleClick","onWheel","loadingIcon","_","modalStyle","overlay","border","borderRadius","Modal","onRequestClose","contentLabel","wrapperClassName","animationDirection","onTouchStart","onTouchMove","onKeyUp","propTypes","PropTypes","string","isRequired","mainSrcThumbnail","prevSrcThumbnail","nextSrcThumbnail","bool","number","arrayOf","shape","_Modal","_Modal2","TreeNodeView","isShowOperationMenu","isHighlight","onLoadToggle","onNodeDragStart","onNodeDragEnter","isNodeDropShow","onNodeDragMove","onNodeDragLeave","onNodeDrop","getNodeTypeAndIcon","suffix","renderChildren","paddingLeft","hasChildren","RENAME","OPEN_VIA_CLIENT","hlClass","caculateMenuList","TreeView","dragStartNodeData","isTreeViewDropTipShow","dropNodeData","EmptyTip","parseuri","createDebug","prevTime","enabled","curr","coerce","formatter","logFn","charCodeAt","selectColor","init","instances","stack","disable","skips","_deconstructPacket","_placeholder","newData","_reconstructPacket","packetData","pendingBlobs","_removeBlobs","curKey","containingObject","fileReader","FileReader","readAsArrayBuffer","transports","upgrade","transportOptions","writeBuffer","prevBufferLen","policyPort","rememberUpgrade","onlyBinaryUpgrades","perMessageDeflate","threshold","product","upgrades","pingInterval","pingTimeout","pingIntervalTimer","pingTimeoutTimer","priorWebsocketSuccess","createTransport","EIO","transport","requestTimeout","protocols","setTransport","removeAllListeners","onDrain","probe","onTransportOpen","upgradeLosesBinary","upgrading","flush","freezeTransport","onTransportClose","onupgrade","onHandshake","setPing","code","filterUpgrades","onHeartbeat","sendPacket","waitForUpgrade","cleanupAndClose","filteredUpgrades","empty","Request","isBinary","req","sendXhr","pollXhr","xhr","setDisableHeaderCheck","setRequestHeader","hasXDR","onLoad","responseText","onreadystatechange","contentType","getResponseHeader","requestsCount","requests","onSuccess","fromError","abort","attachEvent","unloadHandler","terminationEvent","arraybuffer","start","end","bytes","byteLength","abv","Uint8Array","ii","noop","count","err_cb","bail","proxy","byteArray","byteCount","byteIndex","stringFromCharCode","fromCharCode","ucs2decode","extra","output","counter","checkScalarValue","codePoint","strict","toUpperCase","createByte","encodeCodePoint","symbol","readContinuationByte","continuationByte","decodeSymbol","byte1","version","codePoints","byteString","tmp","array","ucs2encode","chars","encoded1","encoded2","encoded3","encoded4","bufferLength","BlobBuilder","WebKitBlobBuilder","MSBlobBuilder","MozBlobBuilder","blobSupported","blobSupportsArrayBufferView","blobBuilderSupported","getBlob","mapArrayBufferViews","ary","chunk","set","byteOffset","BlobBuilderConstructor","bb","part","BlobConstructor","JSONPPolling","callbacks","rNewline","rEscapedNewline","glob","___eio","script","removeChild","form","iframe","insertAt","getElementsByTagName","insertBefore","head","appendChild","area","iframeId","initIframe","BrowserWebSocket","NodeWebSocket","WebSocket","MozWebSocket","WS","usingBrowserWebSocket","ws","supports","addEventListeners","onmessage","encodePacket","factor","rand","random","deviation","bodyOpenClassName","portalClassName","_react","_react2","_interopRequireDefault","_reactDom2","_propTypes2","_ModalPortal2","ariaAppHider","newObj","_interopRequireWildcard","_safeHTMLElement2","_reactLifecyclesCompat","isReact16","createPortal","getCreatePortal","unstable_renderSubtreeIntoContainer","getParentElement","parentSelector","_temp","_len","_key","removePortal","unmountComponentAtNode","portalRef","portal","renderPortal","defaultStyles","prevProps","prevParent","nextParent","snapshot","_props","closesAt","closeTimeoutMS","beforeClose","closeWithTimeout","htmlOpenClassName","oneOfType","base","afterOpen","overlayClassName","instanceOf","ariaHideApp","shouldFocusAfterRender","shouldCloseOnOverlayClick","shouldReturnFocusAfterClose","aria","shouldCloseOnEsc","overlayRef","contentRef","background","WebkitOverflowScrolling","outline","polyfill","_typeof","focusManager","_scopeTab2","classList","CLASS_NAMES","ariaHiddenInstances","ModalPortal","setOverlayRef","setContentRef","afterClose","remove","returnFocus","teardownScopedFocus","popWithoutFocus","onAfterClose","beforeOpen","closeTimer","setupScopedFocus","markForFocusLater","overlayEl","contentEl","closeWithoutTimeout","focusContent","contentHasFocus","handleOverlayOnClick","shouldClose","ownerHandlesClose","handleContentOnMouseUp","handleOverlayOnMouseDown","handleContentOnClick","handleContentOnMouseDown","shouldBeClosed","activeElement","buildClassName","additional","classNames","attributesFromObject","prefix","reduce","acc","moveFromContentToOverlay","_props2","contentStyles","overlayStyles","testId","handleBlur","handleFocus","focusLaterElements","toFocus","warn","modalElement","detachEvent","_tabbable","_tabbable2","needToFocus","shiftKey","tail","checkSafari","warning","ExecutionEnvironment","canUseWorkers","Worker","canUseEventListeners","canUseViewport","screen","dumpClassLists","htmlClassList","docBodyClassList","classString","classListRef","incrementReference","decrementReference","MENU_SHOW","MENU_HIDE","dispatchGlobalEvent","eventName","CustomEvent","createEvent","initCustomEvent","dispatchEvent","store","hasOwnProp","prop","uniqueId","Boolean","mixin","_callbacks","cb","hasListeners","base64encoder","sliceBuffer","after","utf8","isAndroid","isPhantomJS","dontSendBlobs","packetslist","each","eachWithIndex","utf8encode","encodeBase64Packet","contentArray","resultBuffer","encodeArrayBuffer","fr","encodeBlobAsArrayBuffer","blob","encodeBlob","encodeBase64Object","b64data","readAsDataURL","typed","basic","btoa","utf8decode","decodeBase64Packet","tryDecode","rest","encodePayloadAsBlob","encodePayloadAsArrayBuffer","doneCallback","setLengthHeader","decodePayloadAsBinary","chr","totalLength","resultArray","bufferIndex","isString","ab","view","lenStr","binaryIdentifier","lengthAry","bufferTail","tailArray","msgLength","TagItem","getRepoTagIdList","repoTagIdList","onEditFileTag","addFileTag","TagList","getRepoTagList","EditFileTagDialog","handleShowEvent","handleHideEvent","showCallback","hideCallback"],"mappings":"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","file":"static/js/app.chunk.js","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport listener from './globalEventListener';\nimport { hideMenu } from './actions';\nimport { callIfExists } from './helpers';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  id: PropTypes.string.isRequired,\n  rtl: PropTypes.bool,\n  onMenuItemClick: PropTypes.func.isRequired,\n  onShowMenu: PropTypes.func,\n  onHideMenu: PropTypes.func,\n};\n\nclass ContextMenu extends React.Component {\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      x: 0,\n      y: 0,\n      isVisible: false,\n      currentObject: null,\n      menuList: [],\n    };\n  }\n\n  componentDidMount() {\n    this.listenId = listener.register(this.handleShow, this.handleHide);\n  }\n\n  componentDidUpdate () {\n    if (this.state.isVisible) {\n      const wrapper = window.requestAnimationFrame || setTimeout;\n\n      wrapper(() => {\n        const { x, y } = this.state;\n        const { top, left } = this.props.rtl ? this.getRTLMenuPosition(x, y) : this.getMenuPosition(x, y);\n\n        wrapper(() => {\n          if (!this.menu) return;\n          this.menu.style.top = `${top}px`;\n          this.menu.style.left = `${left}px`;\n          this.menu.style.opacity = 1;\n          this.menu.style.pointerEvents = 'auto';\n        });\n      });\n    } else {\n      if (!this.menu) return;\n      this.menu.style.opacity = 0;\n      this.menu.style.pointerEvents = 'none';\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.listenId) {\n      listener.unregister(this.listenId);\n    }\n\n    this.unregisterHandlers();\n  }\n\n  registerHandlers = () => {\n    document.addEventListener('mousedown', this.handleOutsideClick);\n    document.addEventListener('touchstart', this.handleOutsideClick);\n    document.addEventListener('scroll', this.handleHide);\n    document.addEventListener('contextmenu', this.handleHide);\n    document.addEventListener('keydown', this.handleKeyNavigation);\n    window.addEventListener('resize', this.handleHide);\n  }\n\n  unregisterHandlers = () => {\n    document.removeEventListener('mousedown', this.handleOutsideClick);\n    document.removeEventListener('touchstart', this.handleOutsideClick);\n    document.removeEventListener('scroll', this.handleHide);\n    document.removeEventListener('contextmenu', this.handleHide);\n    document.removeEventListener('keydown', this.handleKeyNavigation);\n    window.removeEventListener('resize', this.handleHide);\n  }\n\n  handleShow = (e) => {\n    if (e.detail.id !== this.props.id || this.state.isVisible) return;\n\n    const { x, y } = e.detail.position;\n    const { currentObject, menuList} = e.detail;\n\n    this.setState({ isVisible: true, x, y, currentObject, menuList });\n    this.registerHandlers();\n    callIfExists(this.props.onShowMenu, e);\n  }\n\n  handleHide = (e) => {\n    if (this.state.isVisible && (!e.detail || !e.detail.id || e.detail.id === this.props.id)) {\n      this.unregisterHandlers();\n      this.setState({ isVisible: false});\n      callIfExists(this.props.onHideMenu, e);\n    }\n  }\n\n  handleOutsideClick = (e) => {\n    if (!this.menu.contains(e.target)) hideMenu();\n  }\n\n  handleMouseLeave = (event) => {\n    event.preventDefault();\n\n    if (this.props.hideOnLeave) hideMenu();\n  }\n\n  handleContextMenu = (e) => {\n    this.handleHide(e);\n  }\n\n  handleKeyNavigation = (e) => {\n    if (this.state.isVisible === false) {\n      return;\n    }\n    e.preventDefault();\n    this.hideMenu(e);\n  }\n\n  hideMenu = (e) => {\n    if (e.keyCode === 27 || e.keyCode === 13) { // ECS or enter\n      hideMenu();\n    }\n  }\n\n  getMenuPosition = (x = 0, y = 0) => {\n    let menuStyles = {\n      top: y,\n      left: x\n    };\n\n    if (!this.menu) return menuStyles;\n\n    const { innerWidth, innerHeight } = window;\n    const rect = this.menu.getBoundingClientRect();\n\n    if (y + rect.height > innerHeight) {\n      menuStyles.top -= rect.height;\n    }\n\n    if (x + rect.width > innerWidth) {\n      menuStyles.left -= rect.width;\n    }\n\n    if (menuStyles.top < 0) {\n      menuStyles.top = rect.height < innerHeight ? (innerHeight - rect.height) / 2 : 0;\n    }\n\n    if (menuStyles.left < 0) {\n      menuStyles.left = rect.width < innerWidth ? (innerWidth - rect.width) / 2 : 0;\n    }\n\n    return menuStyles;\n  }\n\n  getRTLMenuPosition = (x = 0, y = 0) => {\n    let menuStyles = {\n      top: y,\n      left: x\n    };\n\n    if (!this.menu) return menuStyles;\n\n    const { innerWidth, innerHeight } = window;\n    const rect = this.menu.getBoundingClientRect();\n\n    // Try to position the menu on the left side of the cursor\n    menuStyles.left = x - rect.width;\n\n    if (y + rect.height > innerHeight) {\n      menuStyles.top -= rect.height;\n    }\n\n    if (menuStyles.left < 0) {\n      menuStyles.left += rect.width;\n    }\n\n    if (menuStyles.top < 0) {\n      menuStyles.top = rect.height < innerHeight ? (innerHeight - rect.height) / 2 : 0;\n    }\n\n    if (menuStyles.left + rect.width > innerWidth) {\n      menuStyles.left = rect.width < innerWidth ? (innerWidth - rect.width) / 2 : 0;\n    }\n\n    return menuStyles;\n  }\n\n\n  onMenuItemClick = (event) => {\n    event.stopPropagation();\n    let operation = Utils.getEventData(event, 'operation');\n    let currentObject = this.state.currentObject;\n    this.props.onMenuItemClick(operation, currentObject, event);\n  }\n\n  onContextMenu = (event) => {\n    event.stopPropagation();\n  }\n\n  render() {\n    const inlineStyle = { position: 'fixed', opacity: 0, pointerEvents: 'none', display: 'block' };\n    return (\n      <div role=\"menu\" className=\"seafile-contextmenu dropdown-menu\" style={inlineStyle} ref={menu => { this.menu = menu; }}>\n        {this.state.menuList.map((menuItem, index) => {\n          if (menuItem === 'Divider') {\n            return <div key={index} className=\"seafile-divider dropdown-divider\"></div>;\n          } else {\n            return (\n              <button\n                key={index}\n                className=\"seafile-contextmenu-item dropdown-item\"\n                data-operation={menuItem.key}\n                onClick={this.onMenuItemClick}\n                onContextMenu={this.onContextMenu}\n              >\n                {menuItem.value}\n              </button>\n            );\n          }\n        })}\n      </div>\n    );\n  }\n}\n\nContextMenu.propTypes = propTypes;\n\nexport default ContextMenu;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Modal, ModalHeader, Input, ModalBody, ModalFooter, Form, FormGroup, Label, Alert } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  fileType: PropTypes.string,\n  parentPath: PropTypes.string.isRequired,\n  onAddFolder: PropTypes.func.isRequired,\n  checkDuplicatedName: PropTypes.func.isRequired,\n  addFolderCancel: PropTypes.func.isRequired,\n};\n\nclass CreateForder extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      parentPath: '',\n      childName: '',\n      errMessage: '',\n      isSubmitBtnActive: false,\n    };\n    this.newInput = React.createRef();\n  }\n\n  componentDidMount() {\n    let parentPath = this.props.parentPath;\n    if (parentPath[parentPath.length - 1] === '/') {  // mainPanel\n      this.setState({parentPath: parentPath});\n    } else {\n      this.setState({parentPath: parentPath + '/'}); // sidePanel\n    }\n    this.newInput.focus();\n    this.newInput.setSelectionRange(0,0);\n  }\n\n  handleChange = (e) => {\n    if (!e.target.value.trim()) {\n      this.setState({isSubmitBtnActive: false});\n    } else {\n      this.setState({isSubmitBtnActive: true});\n    }\n\n    this.setState({childName: e.target.value});\n  }\n\n  handleSubmit = () => {\n    if (!this.state.isSubmitBtnActive) {\n      return;\n    }\n\n    let newName = this.state.childName;\n    let isDuplicated = this.checkDuplicatedName();\n\n    if (isDuplicated) {\n      let errMessage = gettext('The name \"{name}\" is already taken. Please choose a different name.');\n      errMessage = errMessage.replace('{name}', Utils.HTMLescape(newName));\n      this.setState({errMessage: errMessage});\n    } else {\n      let path = this.state.parentPath + newName;\n      this.props.onAddFolder(path);\n    }\n  }\n\n  handleKeyPress = (e) => {\n    if (e.key === 'Enter') {\n      this.handleSubmit();\n      e.preventDefault();\n    }\n  }\n\n  toggle = () => {\n    this.props.addFolderCancel();\n  }\n\n  checkDuplicatedName = () => {\n    let isDuplicated = this.props.checkDuplicatedName(this.state.childName);\n    return isDuplicated;\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true} toggle={this.toggle}>\n        <ModalHeader toggle={this.toggle}>{gettext('New Folder')}</ModalHeader>\n        <ModalBody>\n          <Form>\n            <FormGroup>\n              <Label for=\"folderName\">{gettext('Name')}</Label>\n              <Input\n                id=\"folderName\"\n                value={this.state.childName}\n                innerRef={input => {this.newInput = input;}}\n                onKeyPress={this.handleKeyPress}\n                onChange={this.handleChange}\n              />\n            </FormGroup>\n          </Form>\n          {this.state.errMessage && <Alert color=\"danger\" className=\"mt-2\">{this.state.errMessage}</Alert>}\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.handleSubmit} disabled={!this.state.isSubmitBtnActive}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nCreateForder.propTypes = propTypes;\n\nexport default CreateForder;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalHeader, ModalBody } from 'reactstrap';\nimport { gettext, fileServerRoot } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport Loading from '../loading';\n\nconst propTypes = {\n  token: PropTypes.string,\n  path: PropTypes.string.isRequired,\n  repoID: PropTypes.string,\n  target: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.array\n  ]),\n  toggleDialog: PropTypes.func.isRequired\n};\n\nlet interval;\n\nclass ZipDownloadDialog extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isLoading: true,\n      errorMsg: '',\n      zipProgress: null\n    };\n  }\n\n  componentDidMount() {\n    const { token, path, repoID, target } = this.props;\n    let getZipTask;\n    if (token) {\n      getZipTask = target.length ?\n        seafileAPI.getShareLinkDirentsZipTask(token, path, target) :\n        seafileAPI.getShareLinkZipTask(token, path);\n    } else {\n      getZipTask = seafileAPI.zipDownload(repoID, path, target);\n    }\n    getZipTask.then((res) => {\n      const zipToken = res.data['zip_token'];\n      this.setState({\n        isLoading: false,\n        errorMsg: '',\n        zipToken: zipToken\n      });\n      this.queryZipProgress();\n      interval = setInterval(this.queryZipProgress, 1000);\n    }).catch((error) => {\n      let errorMsg = Utils.getErrorMsg(error);\n      this.setState({\n        isLoading: false,\n        errorMsg: errorMsg\n      });\n    });\n  }\n\n  queryZipProgress = () => {\n    const zipToken = this.state.zipToken;\n    seafileAPI.queryZipProgress(zipToken).then((res) => {\n      const data = res.data;\n      this.setState({\n        zipProgress: data.total == 0 ? '100%' : (data.zipped/data.total*100).toFixed(2) + '%'\n      });\n      if (data['total'] == data['zipped']) {\n        clearInterval(interval);\n        this.props.toggleDialog();\n        location.href = `${fileServerRoot}zip/${zipToken}`;\n      }\n    }).catch((error) => {\n      clearInterval(interval);\n      let errorMsg = Utils.getErrorMsg(error);\n      this.setState({\n        isLoading: false,\n        errorMsg: errorMsg\n      });\n    });\n  }\n\n  cancelZipTask = () => {\n    const zipToken = this.state.zipToken;\n    seafileAPI.cancelZipTask(zipToken).then((res) => {\n    // do nothing\n    }).catch((error) => {\n    // do nothing\n    });\n  }\n\n  toggleDialog = () => {\n    const zipProgress = this.state.zipProgress;\n    if (zipProgress && zipProgress != '100%') {\n      clearInterval(interval);\n      this.cancelZipTask();\n    }\n    this.props.toggleDialog();\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true} toggle={this.toggleDialog}>\n        <ModalHeader toggle={this.toggleDialog}>{gettext('Download')}</ModalHeader>\n        <ModalBody>\n          <Content data={this.state} />\n        </ModalBody>\n      </Modal>\n    );\n  }\n}\n\nclass Content extends React.Component {\n\n  render() {\n    const {isLoading, errorMsg, zipProgress} = this.props.data;\n\n    if (isLoading) {\n      return <Loading />;\n    }\n\n    if (errorMsg) {\n      return <p className=\"error mt-4 text-center\">{errorMsg}</p>;\n    }\n\n    return <p className=\"mt-4 text-center\">{`${gettext('Packaging...')} ${zipProgress}`}</p>;\n  }\n}\n\nZipDownloadDialog.propTypes = propTypes;\n\nexport default ZipDownloadDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport listener from '../context-menu/globalEventListener';\nimport { Dropdown, ButtonDropdown, DropdownMenu, DropdownToggle, DropdownItem } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  tagName: PropTypes.string,\n  item: PropTypes.object.isRequired,\n  toggleClass: PropTypes.string,\n  isHandleContextMenuEvent: PropTypes.bool,\n  getMenuList: PropTypes.func.isRequired,\n  onMenuItemClick: PropTypes.func.isRequired,\n  freezeItem: PropTypes.func,\n  unfreezeItem: PropTypes.func,\n};\n\nclass ItemDropdownMenu extends React.Component {\n\n  static defaultProps = {\n    isHandleContextMenuEvent: true,\n    toggleClass: 'sf2-icon-caret-down'\n  };\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      menuList: [],\n      isItemMenuShow: false,\n    };\n  }\n\n  componentDidMount() {\n    if (this.props.isHandleContextMenuEvent) {\n      this.listenerId = listener.register(this.onShowMenu, this.onHideMenu);\n    }\n    let { item } = this.props;\n    let menuList = this.props.getMenuList(item);\n    this.setState({menuList: menuList});\n  }\n\n  componentWillReceiveProps(nextProps) {  // for toolbar item operation\n    let { item } = nextProps;\n    if (item.name !== this.props.item.name) {\n      let menuList = this.props.getMenuList(item);\n      this.setState({menuList: menuList});\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.props.isHandleContextMenuEvent && this.listenerId) {\n      listener.unregister(this.listenerId);\n    }\n  }\n\n  onShowMenu = () => {\n    // nothing todo\n  }\n\n  onHideMenu = () => {\n    if (this.state.isItemMenuShow) {\n      this.setState({isItemMenuShow: false});\n      if (typeof(this.props.unfreezeItem) === 'function') {\n        this.props.unfreezeItem();\n      }\n    }\n  }\n\n  onDropdownToggleClick = (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n\n    this.toggleOperationMenu();\n  }\n\n  toggleOperationMenu = () => {\n    this.setState(\n      {isItemMenuShow: !this.state.isItemMenuShow},\n      () => {\n        if (this.state.isItemMenuShow && typeof(this.props.freezeItem) === 'function') {\n          this.props.freezeItem();\n        } else if (!this.state.isItemMenuShow && typeof(this.props.unfreezeItem) === 'function') {\n          this.props.unfreezeItem();\n        }\n      }\n    );\n  }\n\n  onMenuItemClick = (event) => {\n    let operation = Utils.getEventData(event, 'toggle');\n    let item = this.props.item;\n    this.props.onMenuItemClick(operation, event, item);\n  }\n\n  render() {\n    let menuList = this.state.menuList;\n    let { toggleClass, tagName } = this.props;\n    toggleClass = 'sf-dropdown-toggle ' + toggleClass;\n\n    if (!menuList.length) {\n      return '';\n    }\n\n    if (tagName && tagName === 'button') {\n      return (\n        <ButtonDropdown isOpen={this.state.isItemMenuShow} toggle={this.onDropdownToggleClick} title={gettext('More Operations')}>\n          <DropdownToggle\n            className={toggleClass}\n            data-toggle=\"dropdown\"\n            title={gettext('More Operations')}\n            aria-expanded={this.state.isItemMenuShow}\n            // onClick={this.onDropdownToggleClick}\n          >\n          </DropdownToggle>\n          <DropdownMenu>\n            {menuList.map((menuItem, index) => {\n              if (menuItem === 'Divider') {\n                return <DropdownItem key={index} divider />;\n              } else {\n                return (\n                  <DropdownItem key={index} data-toggle={menuItem.key} onClick={this.onMenuItemClick}>{menuItem.value}</DropdownItem>\n                );\n              }\n            })}\n          </DropdownMenu>\n        </ButtonDropdown>\n      );\n    }\n\n    return (\n      <Dropdown isOpen={this.state.isItemMenuShow} toggle={this.onDropdownToggleClick}>\n        <DropdownToggle\n          tag={tagName || 'i'}\n          className={toggleClass}\n          title={gettext('More Operations')}\n          data-toggle=\"dropdown\"\n          aria-expanded={this.state.isItemMenuShow}\n          // onClick={this.onDropdownToggleClick}\n        />\n        <DropdownMenu>\n          {menuList.map((menuItem, index) => {\n            if (menuItem === 'Divider') {\n              return <DropdownItem key={index} divider />;\n            } else {\n              return (\n                <DropdownItem key={index} data-toggle={menuItem.key} onClick={this.onMenuItemClick}>{menuItem.value}</DropdownItem>\n              );\n            }\n          })}\n        </DropdownMenu>\n      </Dropdown>\n    );\n  }\n}\n\nItemDropdownMenu.propTypes = propTypes;\n\nexport default ItemDropdownMenu;\n","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function define(obj, key, value) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n    return obj[key];\n  }\n  try {\n    // IE 8 has a broken Object.defineProperty that only works on DOM objects.\n    define({}, \"\");\n  } catch (err) {\n    define = function(obj, key, value) {\n      return obj[key] = value;\n    };\n  }\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  IteratorPrototype[iteratorSymbol] = function () {\n    return this;\n  };\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunction.displayName = define(\n    GeneratorFunctionPrototype,\n    toStringTagSymbol,\n    \"GeneratorFunction\"\n  );\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      define(prototype, method, function(arg) {\n        return this._invoke(method, arg);\n      });\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      define(genFun, toStringTagSymbol, \"GeneratorFunction\");\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return PromiseImpl.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return PromiseImpl.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new PromiseImpl(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  AsyncIterator.prototype[asyncIteratorSymbol] = function () {\n    return this;\n  };\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    if (PromiseImpl === void 0) PromiseImpl = Promise;\n\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList),\n      PromiseImpl\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        // Note: [\"return\"] must be used for ES3 parsing compatibility.\n        if (delegate.iterator[\"return\"]) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  define(Gp, toStringTagSymbol, \"Generator\");\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n  typeof module === \"object\" ? module.exports : {}\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you've misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you're not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n}\n","/**\n * This is the web browser implementation of `debug()`.\n *\n * Expose `debug()` as the module.\n */\n\nexports = module.exports = require('./debug');\nexports.log = log;\nexports.formatArgs = formatArgs;\nexports.save = save;\nexports.load = load;\nexports.useColors = useColors;\nexports.storage = 'undefined' != typeof chrome\n               && 'undefined' != typeof chrome.storage\n                  ? chrome.storage.local\n                  : localstorage();\n\n/**\n * Colors.\n */\n\nexports.colors = [\n  '#0000CC', '#0000FF', '#0033CC', '#0033FF', '#0066CC', '#0066FF', '#0099CC',\n  '#0099FF', '#00CC00', '#00CC33', '#00CC66', '#00CC99', '#00CCCC', '#00CCFF',\n  '#3300CC', '#3300FF', '#3333CC', '#3333FF', '#3366CC', '#3366FF', '#3399CC',\n  '#3399FF', '#33CC00', '#33CC33', '#33CC66', '#33CC99', '#33CCCC', '#33CCFF',\n  '#6600CC', '#6600FF', '#6633CC', '#6633FF', '#66CC00', '#66CC33', '#9900CC',\n  '#9900FF', '#9933CC', '#9933FF', '#99CC00', '#99CC33', '#CC0000', '#CC0033',\n  '#CC0066', '#CC0099', '#CC00CC', '#CC00FF', '#CC3300', '#CC3333', '#CC3366',\n  '#CC3399', '#CC33CC', '#CC33FF', '#CC6600', '#CC6633', '#CC9900', '#CC9933',\n  '#CCCC00', '#CCCC33', '#FF0000', '#FF0033', '#FF0066', '#FF0099', '#FF00CC',\n  '#FF00FF', '#FF3300', '#FF3333', '#FF3366', '#FF3399', '#FF33CC', '#FF33FF',\n  '#FF6600', '#FF6633', '#FF9900', '#FF9933', '#FFCC00', '#FFCC33'\n];\n\n/**\n * Currently only WebKit-based Web Inspectors, Firefox >= v31,\n * and the Firebug extension (any Firefox version) are known\n * to support \"%c\" CSS customizations.\n *\n * TODO: add a `localStorage` variable to explicitly enable/disable colors\n */\n\nfunction useColors() {\n  // NB: In an Electron preload script, document will be defined but not fully\n  // initialized. Since we know we're in Chrome, we'll just detect this case\n  // explicitly\n  if (typeof window !== 'undefined' && window.process && window.process.type === 'renderer') {\n    return true;\n  }\n\n  // Internet Explorer and Edge do not support colors.\n  if (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/(edge|trident)\\/(\\d+)/)) {\n    return false;\n  }\n\n  // is webkit? http://stackoverflow.com/a/16459606/376773\n  // document is undefined in react-native: https://github.com/facebook/react-native/pull/1632\n  return (typeof document !== 'undefined' && document.documentElement && document.documentElement.style && document.documentElement.style.WebkitAppearance) ||\n    // is firebug? http://stackoverflow.com/a/398120/376773\n    (typeof window !== 'undefined' && window.console && (window.console.firebug || (window.console.exception && window.console.table))) ||\n    // is firefox >= v31?\n    // https://developer.mozilla.org/en-US/docs/Tools/Web_Console#Styling_messages\n    (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/firefox\\/(\\d+)/) && parseInt(RegExp.$1, 10) >= 31) ||\n    // double check webkit in userAgent just in case we are in a worker\n    (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/applewebkit\\/(\\d+)/));\n}\n\n/**\n * Map %j to `JSON.stringify()`, since no Web Inspectors do that by default.\n */\n\nexports.formatters.j = function(v) {\n  try {\n    return JSON.stringify(v);\n  } catch (err) {\n    return '[UnexpectedJSONParseError]: ' + err.message;\n  }\n};\n\n\n/**\n * Colorize log arguments if enabled.\n *\n * @api public\n */\n\nfunction formatArgs(args) {\n  var useColors = this.useColors;\n\n  args[0] = (useColors ? '%c' : '')\n    + this.namespace\n    + (useColors ? ' %c' : ' ')\n    + args[0]\n    + (useColors ? '%c ' : ' ')\n    + '+' + exports.humanize(this.diff);\n\n  if (!useColors) return;\n\n  var c = 'color: ' + this.color;\n  args.splice(1, 0, c, 'color: inherit')\n\n  // the final \"%c\" is somewhat tricky, because there could be other\n  // arguments passed either before or after the %c, so we need to\n  // figure out the correct index to insert the CSS into\n  var index = 0;\n  var lastC = 0;\n  args[0].replace(/%[a-zA-Z%]/g, function(match) {\n    if ('%%' === match) return;\n    index++;\n    if ('%c' === match) {\n      // we only are interested in the *last* %c\n      // (the user may have provided their own)\n      lastC = index;\n    }\n  });\n\n  args.splice(lastC, 0, c);\n}\n\n/**\n * Invokes `console.log()` when available.\n * No-op when `console.log` is not a \"function\".\n *\n * @api public\n */\n\nfunction log() {\n  // this hackery is required for IE8/9, where\n  // the `console.log` function doesn't have 'apply'\n  return 'object' === typeof console\n    && console.log\n    && Function.prototype.apply.call(console.log, console, arguments);\n}\n\n/**\n * Save `namespaces`.\n *\n * @param {String} namespaces\n * @api private\n */\n\nfunction save(namespaces) {\n  try {\n    if (null == namespaces) {\n      exports.storage.removeItem('debug');\n    } else {\n      exports.storage.debug = namespaces;\n    }\n  } catch(e) {}\n}\n\n/**\n * Load `namespaces`.\n *\n * @return {String} returns the previously persisted debug modes\n * @api private\n */\n\nfunction load() {\n  var r;\n  try {\n    r = exports.storage.debug;\n  } catch(e) {}\n\n  // If debug isn't set in LS, and we're in Electron, try to load $DEBUG\n  if (!r && typeof process !== 'undefined' && 'env' in process) {\n    r = process.env.DEBUG;\n  }\n\n  return r;\n}\n\n/**\n * Enable namespaces listed in `localStorage.debug` initially.\n */\n\nexports.enable(load());\n\n/**\n * Localstorage attempts to return the localstorage.\n *\n * This is necessary because safari throws\n * when a user disables cookies/localstorage\n * and you attempt to access it.\n *\n * @return {LocalStorage}\n * @api private\n */\n\nfunction localstorage() {\n  try {\n    return window.localStorage;\n  } catch (e) {}\n}\n","/**\r\n * Compiles a querystring\r\n * Returns string representation of the object\r\n *\r\n * @param {Object}\r\n * @api private\r\n */\r\n\r\nexports.encode = function (obj) {\r\n  var str = '';\r\n\r\n  for (var i in obj) {\r\n    if (obj.hasOwnProperty(i)) {\r\n      if (str.length) str += '&';\r\n      str += encodeURIComponent(i) + '=' + encodeURIComponent(obj[i]);\r\n    }\r\n  }\r\n\r\n  return str;\r\n};\r\n\r\n/**\r\n * Parses a simple querystring into an object\r\n *\r\n * @param {String} qs\r\n * @api private\r\n */\r\n\r\nexports.decode = function(qs){\r\n  var qry = {};\r\n  var pairs = qs.split('&');\r\n  for (var i = 0, l = pairs.length; i < l; i++) {\r\n    var pair = pairs[i].split('=');\r\n    qry[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1]);\r\n  }\r\n  return qry;\r\n};\r\n","\nmodule.exports = function(a, b){\n  var fn = function(){};\n  fn.prototype = b.prototype;\n  a.prototype = new fn;\n  a.prototype.constructor = a;\n};","/**\n * This is the web browser implementation of `debug()`.\n *\n * Expose `debug()` as the module.\n */\n\nexports = module.exports = require('./debug');\nexports.log = log;\nexports.formatArgs = formatArgs;\nexports.save = save;\nexports.load = load;\nexports.useColors = useColors;\nexports.storage = 'undefined' != typeof chrome\n               && 'undefined' != typeof chrome.storage\n                  ? chrome.storage.local\n                  : localstorage();\n\n/**\n * Colors.\n */\n\nexports.colors = [\n  '#0000CC', '#0000FF', '#0033CC', '#0033FF', '#0066CC', '#0066FF', '#0099CC',\n  '#0099FF', '#00CC00', '#00CC33', '#00CC66', '#00CC99', '#00CCCC', '#00CCFF',\n  '#3300CC', '#3300FF', '#3333CC', '#3333FF', '#3366CC', '#3366FF', '#3399CC',\n  '#3399FF', '#33CC00', '#33CC33', '#33CC66', '#33CC99', '#33CCCC', '#33CCFF',\n  '#6600CC', '#6600FF', '#6633CC', '#6633FF', '#66CC00', '#66CC33', '#9900CC',\n  '#9900FF', '#9933CC', '#9933FF', '#99CC00', '#99CC33', '#CC0000', '#CC0033',\n  '#CC0066', '#CC0099', '#CC00CC', '#CC00FF', '#CC3300', '#CC3333', '#CC3366',\n  '#CC3399', '#CC33CC', '#CC33FF', '#CC6600', '#CC6633', '#CC9900', '#CC9933',\n  '#CCCC00', '#CCCC33', '#FF0000', '#FF0033', '#FF0066', '#FF0099', '#FF00CC',\n  '#FF00FF', '#FF3300', '#FF3333', '#FF3366', '#FF3399', '#FF33CC', '#FF33FF',\n  '#FF6600', '#FF6633', '#FF9900', '#FF9933', '#FFCC00', '#FFCC33'\n];\n\n/**\n * Currently only WebKit-based Web Inspectors, Firefox >= v31,\n * and the Firebug extension (any Firefox version) are known\n * to support \"%c\" CSS customizations.\n *\n * TODO: add a `localStorage` variable to explicitly enable/disable colors\n */\n\nfunction useColors() {\n  // NB: In an Electron preload script, document will be defined but not fully\n  // initialized. Since we know we're in Chrome, we'll just detect this case\n  // explicitly\n  if (typeof window !== 'undefined' && window.process && window.process.type === 'renderer') {\n    return true;\n  }\n\n  // Internet Explorer and Edge do not support colors.\n  if (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/(edge|trident)\\/(\\d+)/)) {\n    return false;\n  }\n\n  // is webkit? http://stackoverflow.com/a/16459606/376773\n  // document is undefined in react-native: https://github.com/facebook/react-native/pull/1632\n  return (typeof document !== 'undefined' && document.documentElement && document.documentElement.style && document.documentElement.style.WebkitAppearance) ||\n    // is firebug? http://stackoverflow.com/a/398120/376773\n    (typeof window !== 'undefined' && window.console && (window.console.firebug || (window.console.exception && window.console.table))) ||\n    // is firefox >= v31?\n    // https://developer.mozilla.org/en-US/docs/Tools/Web_Console#Styling_messages\n    (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/firefox\\/(\\d+)/) && parseInt(RegExp.$1, 10) >= 31) ||\n    // double check webkit in userAgent just in case we are in a worker\n    (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/applewebkit\\/(\\d+)/));\n}\n\n/**\n * Map %j to `JSON.stringify()`, since no Web Inspectors do that by default.\n */\n\nexports.formatters.j = function(v) {\n  try {\n    return JSON.stringify(v);\n  } catch (err) {\n    return '[UnexpectedJSONParseError]: ' + err.message;\n  }\n};\n\n\n/**\n * Colorize log arguments if enabled.\n *\n * @api public\n */\n\nfunction formatArgs(args) {\n  var useColors = this.useColors;\n\n  args[0] = (useColors ? '%c' : '')\n    + this.namespace\n    + (useColors ? ' %c' : ' ')\n    + args[0]\n    + (useColors ? '%c ' : ' ')\n    + '+' + exports.humanize(this.diff);\n\n  if (!useColors) return;\n\n  var c = 'color: ' + this.color;\n  args.splice(1, 0, c, 'color: inherit')\n\n  // the final \"%c\" is somewhat tricky, because there could be other\n  // arguments passed either before or after the %c, so we need to\n  // figure out the correct index to insert the CSS into\n  var index = 0;\n  var lastC = 0;\n  args[0].replace(/%[a-zA-Z%]/g, function(match) {\n    if ('%%' === match) return;\n    index++;\n    if ('%c' === match) {\n      // we only are interested in the *last* %c\n      // (the user may have provided their own)\n      lastC = index;\n    }\n  });\n\n  args.splice(lastC, 0, c);\n}\n\n/**\n * Invokes `console.log()` when available.\n * No-op when `console.log` is not a \"function\".\n *\n * @api public\n */\n\nfunction log() {\n  // this hackery is required for IE8/9, where\n  // the `console.log` function doesn't have 'apply'\n  return 'object' === typeof console\n    && console.log\n    && Function.prototype.apply.call(console.log, console, arguments);\n}\n\n/**\n * Save `namespaces`.\n *\n * @param {String} namespaces\n * @api private\n */\n\nfunction save(namespaces) {\n  try {\n    if (null == namespaces) {\n      exports.storage.removeItem('debug');\n    } else {\n      exports.storage.debug = namespaces;\n    }\n  } catch(e) {}\n}\n\n/**\n * Load `namespaces`.\n *\n * @return {String} returns the previously persisted debug modes\n * @api private\n */\n\nfunction load() {\n  var r;\n  try {\n    r = exports.storage.debug;\n  } catch(e) {}\n\n  // If debug isn't set in LS, and we're in Electron, try to load $DEBUG\n  if (!r && typeof process !== 'undefined' && 'env' in process) {\n    r = process.env.DEBUG;\n  }\n\n  return r;\n}\n\n/**\n * Enable namespaces listed in `localStorage.debug` initially.\n */\n\nexports.enable(load());\n\n/**\n * Localstorage attempts to return the localstorage.\n *\n * This is necessary because safari throws\n * when a user disables cookies/localstorage\n * and you attempt to access it.\n *\n * @return {LocalStorage}\n * @api private\n */\n\nfunction localstorage() {\n  try {\n    return window.localStorage;\n  } catch (e) {}\n}\n","class RepoTag {\n  constructor(object) {\n    this.id = object.repo_tag_id;\n    this.fileCount = object.files_count;\n    this.name = object.tag_name;\n    this.color = object.tag_color;\n  }\n}\n\nexport default RepoTag;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\n\nimport Lightbox from '@seafile/react-image-lightbox';\nimport '@seafile/react-image-lightbox/style.css';\n\nconst propTypes = {\n  imageItems: PropTypes.array.isRequired,\n  imageIndex: PropTypes.number.isRequired,\n  closeImagePopup: PropTypes.func.isRequired,\n  moveToPrevImage: PropTypes.func.isRequired,\n  moveToNextImage: PropTypes.func.isRequired\n};\n\nclass ImageDialog extends React.Component {\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    const imageItems = this.props.imageItems;\n    const imageIndex = this.props.imageIndex;\n    const imageItemsLength = imageItems.length;\n    const imageCaption = imageItemsLength && (\n      <Fragment>\n        <span>{gettext('%curr% of %total%').replace('%curr%', imageIndex + 1).replace('%total%', imageItemsLength)}</span>\n        <br />\n        <a href={imageItems[imageIndex].url} target=\"_blank\">{gettext('Open in New Tab')}</a>\n      </Fragment>\n    );\n\n    return (\n      <Lightbox\n        mainSrc={imageItems[imageIndex].src}\n        imageTitle={imageItems[imageIndex].name}\n        imageCaption={imageCaption}\n        nextSrc={imageItems[(imageIndex + 1) % imageItemsLength].src}\n        prevSrc={imageItems[(imageIndex + imageItemsLength - 1) % imageItemsLength].src}\n        onCloseRequest={this.props.closeImagePopup}\n        onMovePrevRequest={this.props.moveToPrevImage}\n        onMoveNextRequest={this.props.moveToNextImage}\n        imagePadding={70}\n        imageLoadErrorMessage={gettext('The image could not be loaded.')}\n        prevLabel={gettext('Previous (Left arrow key)')}\n        nextLabel={gettext('Next (Right arrow key)')}\n        closeLabel={gettext('Close (Esc)')}\n        zoomInLabel={gettext('Zoom in')}\n        zoomOutLabel={gettext('Zoom out')}\n      />\n    );\n  }\n}\n\nImageDialog.propTypes = propTypes;\n\nexport default ImageDialog;\n","import React from 'react';\nimport { curNoteMsg, curNoteID, siteRoot, gettext } from '../utils/constants';\n\nimport '../css/system-notification.css';\n\nclass SystemNotification extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isClosed: false\n    };\n  }\n\n  close = () => {\n    this.setState({isClosed: true});\n\n    if (navigator.cookieEnabled) {\n      let date = new Date(),\n        cookies = document.cookie.split('; '),\n        infoIDExist = false,\n        newInfoID = curNoteID + '_';\n      date.setTime(date.getTime() + 14*24*60*60*1000);\n      newInfoID += '; expires=' + date.toGMTString() + '; path=' + siteRoot;\n      for (var i = 0, len = cookies.length; i < len; i++) {\n        if (cookies[i].split('=')[0] == 'info_id') {\n          infoIDExist = true;\n          document.cookie = 'info_id=' + cookies[i].split('=')[1] + newInfoID;\n          break;\n        }\n      }\n      if (!infoIDExist) {\n        document.cookie = 'info_id=' + newInfoID;\n      }\n    }\n  }\n\n  render() {\n    if (!curNoteMsg || this.state.isClosed) {\n      return null;\n    }\n\n    return (\n      <div id=\"info-bar\">\n        <p id=\"info-bar-info\">{curNoteMsg}</p>\n        <span className=\"close sf2-icon-x1\" title={gettext('Close')} onClick={this.close}></span>\n      </div>\n    );\n  }\n}\n\nexport default SystemNotification;\n","class Group {\n  constructor(object) {\n    this.id= object.id;\n    this.name = object.name;\n    this.owner = object.owner;\n    this.admins = object.admins || [];\n    this.avatar_url = object.avatar_url;\n    this.created_at = object.created_at;\n    this.parent_group_id = object.parent_group_id;\n    this.wiki_enabled = object.wiki_enabled;\n    this.repos = object.repos || [];\n    this.group_quota = object.group_quota;\n    this.group_quota_usage = object.group_quota_usage;\n  }\n}\n\nexport default Group;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Link } from '@reach/router';\nimport { Badge } from 'reactstrap';\nimport { gettext, siteRoot, canPublishRepo, canAddRepo, canGenerateShareLink, canGenerateUploadLink, canInvitePeople, dtableWebServer, enableOCM } from '../utils/constants';\nimport { seafileAPI } from '../utils/seafile-api';\nimport { Utils } from '../utils/utils';\nimport toaster from './toast';\nimport Group from '../models/group';\n\nimport { canViewOrg, isDocs, isPro, customNavItems } from '../utils/constants';\n\nconst propTypes = {\n  currentTab: PropTypes.oneOfType([PropTypes.string, PropTypes.number]).isRequired,\n  tabItemClick: PropTypes.func.isRequired,\n  draftCounts: PropTypes.number,\n};\n\nclass MainSideNav extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      groupsExtended: false,\n      sharedExtended: false,\n      closeSideBar:false,\n      groupItems: [],\n    };\n\n    this.listHeight = 24; //for caculate tabheight\n    this.groupsHeight = 0;\n    this.adminHeight = 0;\n  }\n\n  grpsExtend = () => {\n    this.setState({\n      groupsExtended: !this.state.groupsExtended,\n    });\n    this.loadGroups();\n  }\n\n  shExtend = () => {\n    this.setState({\n      sharedExtended: !this.state.sharedExtended,\n    });\n  }\n\n  loadGroups = () => {\n    let _this = this;\n    seafileAPI.listGroups().then(res =>{\n      let groupList = res.data.map(item => {\n        let group = new Group(item);\n        return group;\n      });\n\n      this.groupsHeight = (groupList.length + 1) * _this.listHeight;\n      _this.setState({\n        groupItems: groupList.sort((a, b) => {\n          return a.name.toLowerCase() < b.name.toLowerCase() ? -1 : 1;\n        })\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  tabItemClick = (e, param, id) => {\n    if (window.uploader &&\n      window.uploader.isUploadProgressDialogShow &&\n      window.uploader.totalProgress !== 100) {\n      if (!window.confirm(gettext('A file is being uploaded. Are you sure you want to leave this page?'))) {\n        e.preventDefault();\n        return false;\n      }\n      window.uploader.isUploadProgressDialogShow = false;\n    }\n    this.props.tabItemClick(param, id);\n  }\n\n  onDTableClick = () => {\n    let url = dtableWebServer;\n    window.open(url);\n  }\n\n  getActiveClass = (tab) => {\n    return this.props.currentTab === tab ? 'active' : '';\n  }\n\n  renderSharedGroups() {\n    let style = {height: 0};\n    if (this.state.groupsExtended) {\n      style = {height: this.groupsHeight};\n    }\n    return (\n      <ul className={`nav sub-nav nav-pills flex-column grp-list ${this.state.groupsExtended ? 'side-panel-slide' : 'side-panel-slide-up'}`} style={style}>\n        <li className=\"nav-item\">\n          <Link to={siteRoot + 'groups/'}  className={`nav-link ellipsis ${this.getActiveClass('groups')}`} onClick={(e) => this.tabItemClick(e, 'groups')}>\n            <span className=\"sharp\" aria-hidden=\"true\">#</span>\n            <span className=\"nav-text\">{gettext('All Groups')}</span>\n          </Link>\n        </li>\n        {this.state.groupItems.map(item => {\n          return (\n            <li key={item.id} className=\"nav-item\">\n              <Link to={siteRoot + 'group/' + item.id + '/'} className={`nav-link ellipsis ${this.getActiveClass(item.name)}`} onClick={(e) => this.tabItemClick(e, item.name, item.id)}>\n                <span className=\"sharp\" aria-hidden=\"true\">#</span>\n                <span className=\"nav-text\">{item.name}</span>\n              </Link>\n            </li>\n          );\n        })}\n      </ul>\n    );\n  }\n\n  renderSharedAdmin() {\n    let height = 0;\n    if (this.state.sharedExtended) {\n      if (!this.adminHeight) {\n        this.adminHeight = 3 * this.listHeight;\n      }\n      height = this.adminHeight;\n    }\n    let style = {height: height};\n\n    let linksNavItem = null;\n    if (canGenerateShareLink) {\n      linksNavItem = (\n        <li className=\"nav-item\">\n          <Link to={siteRoot + 'share-admin-share-links/'} className={`nav-link ellipsis ${this.getActiveClass('share-admin-share-links')}`} title={gettext('Links')} onClick={(e) => this.tabItemClick(e, 'share-admin-share-links')}>\n            <span aria-hidden=\"true\" className=\"sharp\">#</span>\n            <span className=\"nav-text\">{gettext('Links')}</span>\n          </Link>\n        </li>\n      );\n    } else if (canGenerateUploadLink) {\n      linksNavItem = (\n        <li className=\"nav-item\">\n          <Link to={siteRoot + 'share-admin-upload-links/'} className={`nav-link ellipsis ${this.getActiveClass('share-admin-upload-links')}`} title={gettext('Links')} onClick={(e) => this.tabItemClick(e, 'share-admin-upload-links')}>\n            <span aria-hidden=\"true\" className=\"sharp\">#</span>\n            <span className=\"nav-text\">{gettext('Links')}</span>\n          </Link>\n        </li>\n      );\n    }\n    return (\n      <ul className={`nav sub-nav nav-pills flex-column ${this.state.sharedExtended ? 'side-panel-slide' : 'side-panel-slide-up'}`} style={style} >\n        {canAddRepo && (\n          <li className=\"nav-item\">\n            <Link to={siteRoot + 'share-admin-libs/'} className={`nav-link ellipsis ${this.getActiveClass('share-admin-libs')}`} title={gettext('Libraries')} onClick={(e) => this.tabItemClick(e, 'share-admin-libs')}>\n              <span aria-hidden=\"true\" className=\"sharp\">#</span>\n              <span className=\"nav-text\">{gettext('Libraries')}</span>\n            </Link>\n          </li>\n        )}\n        <li className=\"nav-item\">\n          <Link to={siteRoot + 'share-admin-folders/'} className={`nav-link ellipsis ${this.getActiveClass('share-admin-folders')}`} title={gettext('Folders')} onClick={(e) => this.tabItemClick(e, 'share-admin-folders')}>\n            <span aria-hidden=\"true\" className=\"sharp\">#</span>\n            <span className=\"nav-text\">{gettext('Folders')}</span>\n          </Link>\n        </li>\n        {linksNavItem}\n      </ul>\n    );\n  }\n\n  renderCustomNavItems() {\n    return (\n      customNavItems.map((item, idx) => {\n        return (\n          <li key={idx} className=\"nav-item\">\n            <a href={item.link} className=\"nav-link ellipsis\" title={item.desc}>\n              <span className={item.icon} aria-hidden=\"true\"></span>\n              <span className=\"nav-text\">{item.desc}</span>\n            </a>\n          </li>\n        );\n      })\n    );\n  }\n\n  render() {\n    let showActivity = isDocs || isPro;\n    return (\n      <div className=\"side-nav\">\n        <div className=\"side-nav-con\">\n          <h3 className=\"sf-heading\">{gettext('Files')}</h3>\n          <ul className=\"nav nav-pills flex-column nav-container\">\n            {canAddRepo && (\n              <li className=\"nav-item\">\n                <Link to={ siteRoot + 'my-libs/' } className={`nav-link ellipsis ${this.getActiveClass('my-libs') || this.getActiveClass('deleted') }`} title={gettext('My Libraries')} onClick={(e) => this.tabItemClick(e, 'my-libs')}>\n                  <span className=\"sf2-icon-user\" aria-hidden=\"true\"></span>\n                  <span className=\"nav-text\">{gettext('My Libraries')}</span>\n                </Link>\n              </li>\n            )}\n            <li className=\"nav-item\">\n              <Link to={siteRoot + 'shared-libs/'} className={`nav-link ellipsis ${this.getActiveClass('shared-libs')}`} title={gettext('Shared with me')} onClick={(e) => this.tabItemClick(e, 'shared-libs')}>\n                <span className=\"sf2-icon-share\" aria-hidden=\"true\"></span>\n                <span className=\"nav-text\">{gettext('Shared with me')}</span>\n              </Link>\n            </li>\n            { canViewOrg &&\n              <li className=\"nav-item\" onClick={(e) => this.tabItemClick(e, 'org')}>\n                <Link to={ siteRoot + 'org/' } className={`nav-link ellipsis ${this.getActiveClass('org')}`} title={gettext('Shared with all')}>\n                  <span className=\"sf2-icon-organization\" aria-hidden=\"true\"></span>\n                  <span className=\"nav-text\">{gettext('Shared with all')}</span>\n                </Link>\n              </li>\n            }\n            <li className=\"nav-item flex-column\" id=\"group-nav\">\n              <a className=\"nav-link ellipsis\" title={gettext('Shared with groups')} onClick={this.grpsExtend}>\n                <span className={`toggle-icon float-right fas ${this.state.groupsExtended ?'fa-caret-down':'fa-caret-left'}`} aria-hidden=\"true\"></span>\n                <span className=\"sf2-icon-group\" aria-hidden=\"true\"></span>\n                <span className=\"nav-text\">{gettext('Shared with groups')}</span>\n              </a>\n              {this.renderSharedGroups()}\n            </li>\n            {enableOCM &&\n              <li className=\"nav-item\">\n                <Link to={siteRoot + 'shared-with-ocm/'} className={`nav-link ellipsis ${this.getActiveClass('shared-with-ocm')}`} title={gettext('Shared from other servers')} onClick={(e) => this.tabItemClick(e, 'shared-with-ocm')}>\n                  <span className=\"sf3-font-share-from-other-servers sf3-font\" aria-hidden=\"true\"></span>\n                  <span className=\"nav-text\">{gettext('Shared from other servers')}</span>\n                </Link>\n              </li>\n            }\n          </ul>\n\n\n          <h3 className=\"sf-heading\">{gettext('Tools')}</h3>\n          <ul className=\"nav nav-pills flex-column nav-container\">\n            <li className=\"nav-item\">\n              <Link className={`nav-link ellipsis ${this.getActiveClass('starred')}`} to={siteRoot + 'starred/'} title={gettext('Favorites')} onClick={(e) => this.tabItemClick(e, 'starred')}>\n                <span className=\"sf2-icon-star\" aria-hidden=\"true\"></span>\n                <span className=\"nav-text\">{gettext('Favorites')}</span>\n              </Link>\n            </li>\n            {showActivity &&\n              <li className=\"nav-item\">\n                <Link className={`nav-link ellipsis ${this.getActiveClass('dashboard')}`} to={siteRoot + 'dashboard/'} title={gettext('Activities')} onClick={(e) => this.tabItemClick(e, 'dashboard')}>\n                  <span className=\"sf2-icon-clock\" aria-hidden=\"true\"></span>\n                  <span className=\"nav-text\">{gettext('Activities')}</span>\n                </Link>\n              </li>\n            }\n            {canPublishRepo &&\n              <li className=\"nav-item\">\n                <Link className={`nav-link ellipsis ${this.getActiveClass('published')}`} to={siteRoot + 'published/'} title={gettext('Published Libraries')} onClick={(e) => this.tabItemClick(e, 'published')}>\n                  <span className=\"sf2-icon-wiki-view\" aria-hidden=\"true\"></span>\n                  <span className=\"nav-text\">{gettext('Published Libraries')}</span>\n                </Link>\n              </li>\n            }\n            {isDocs &&\n              <li className=\"nav-item\" onClick={(e) => this.tabItemClick(e, 'drafts')}>\n                <Link className={`nav-link ellipsis ${this.getActiveClass('drafts')}`} to={siteRoot + 'drafts/'} title={gettext('Drafts')}>\n                  <span className=\"sf2-icon-edit\" aria-hidden=\"true\"></span>\n                  <span className=\"draft-info nav-text\">\n                    {gettext('Drafts')}\n                    {this.props.draftCounts === 0 ? '' : <Badge color=\"info\" pill>{this.props.draftCounts}</Badge>}\n                  </span>\n                </Link>\n              </li>\n            }\n            <li className=\"nav-item\">\n              <Link className={`nav-link ellipsis ${this.getActiveClass('linked-devices')}`} to={siteRoot + 'linked-devices/'} title={gettext('Linked Devices')} onClick={(e) => this.tabItemClick(e, 'linked-devices')}>\n                <span className=\"sf2-icon-monitor\" aria-hidden=\"true\"></span>\n                <span className=\"nav-text\">{gettext('Linked Devices')}</span>\n              </Link>\n            </li>\n            {canInvitePeople &&\n              <li className=\"nav-item\">\n                <Link className={`nav-link ellipsis ${this.getActiveClass('invitations')}`} to={siteRoot + 'invitations/'} title={gettext('Invite Guest')} onClick={(e) => this.tabItemClick(e, 'invitations')}>\n                  <span className=\"sf2-icon-invite\" aria-hidden=\"true\"></span>\n                  <span className=\"nav-text\">{gettext('Invite Guest')}</span>\n                </Link>\n              </li>\n            }\n            <li className=\"nav-item flex-column\" id=\"share-admin-nav\">\n              <a className=\"nav-link ellipsis\" title={gettext('Share Admin')} onClick={this.shExtend}>\n                <span className={`toggle-icon float-right fas ${this.state.sharedExtended ? 'fa-caret-down':'fa-caret-left'}`} aria-hidden=\"true\"></span>\n                <span className=\"sf2-icon-wrench\" aria-hidden=\"true\"></span>\n                <span className=\"nav-text\">{gettext('Share Admin')}</span>\n              </a>\n              {this.renderSharedAdmin()}\n            </li>\n            {customNavItems && this.renderCustomNavItems()}\n          </ul>\n        </div>\n\n        {dtableWebServer &&\n          <div className=\"side-nav-link\" onClick={this.onDTableClick}>\n            <span className=\"link-icon icon-left sf3-font sf3-font-dtable-logo\" aria-hidden=\"true\"></span>\n            <span className=\"link-text\">SeaTable</span>\n            <span className=\"link-icon icon-right sf3-font sf3-font-arrow\"></span>\n          </div>\n        }\n      </div>\n    );\n  }\n}\n\nMainSideNav.propTypes = propTypes;\n\nexport default MainSideNav;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalBody } from 'reactstrap';\nimport { gettext, lang, mediaUrl, logoPath, logoWidth, logoHeight, siteTitle, seafileVersion, additionalAboutDialogLinks, aboutDialogCustomHtml } from '../../utils/constants';\n\nconst propTypes = {\n  onCloseAboutDialog: PropTypes.func.isRequired,\n};\n\nclass AboutDialog extends React.Component {\n\n  toggle = () => {\n    this.props.onCloseAboutDialog();\n  }\n\n  renderExternalAboutLinks = () => {\n    if (additionalAboutDialogLinks && (typeof additionalAboutDialogLinks) === 'object') {\n      let keys = Object.keys(additionalAboutDialogLinks);\n      return keys.map((key, index) => {\n        return <a key={index} className=\"d-block\" href={additionalAboutDialogLinks[key]}>{key}</a>;\n      });\n    }\n    return null;\n  }\n\n  render() {\n\n    let href = lang === lang == 'zh-cn' ? 'http://seafile.com/about/' : 'http://seafile.com/en/about/';\n\n    if (aboutDialogCustomHtml) {\n      return (\n        <Modal isOpen={true} toggle={this.toggle}>\n          <ModalBody>\n            <button type=\"button\" className=\"close\" onClick={this.toggle}><span aria-hidden=\"true\">×</span></button>\n            <div className=\"about-content\" dangerouslySetInnerHTML={{__html: aboutDialogCustomHtml}}></div>\n          </ModalBody>\n        </Modal>\n      );\n    } else {\n      return (\n        <Modal isOpen={true} toggle={this.toggle}>\n          <ModalBody>\n            <button type=\"button\" className=\"close\" onClick={this.toggle}><span aria-hidden=\"true\">×</span></button>\n            <div className=\"about-content\">\n              <p><img src={mediaUrl + logoPath} height={logoHeight} width={logoWidth} title={siteTitle} alt=\"logo\" /></p>\n              <p>{gettext('Server Version: ')}{seafileVersion}<br />© {(new Date()).getFullYear()} {gettext('Seafile')}</p>\n              <p>{this.renderExternalAboutLinks()}</p>\n              <p><a href={href} target=\"_blank\">{gettext('About Us')}</a></p>\n            </div>\n          </ModalBody>\n        </Modal>\n      );\n    }\n  }\n}\n\nAboutDialog.propTypes = propTypes;\n\nexport default AboutDialog;\n","import React, { Fragment } from 'react';\nimport { gettext, siteRoot, enableTC, sideNavFooterCustomHtml, additionalAppBottomLinks } from '../utils/constants';\nimport ModalPortal from './modal-portal';\nimport AboutDialog from './dialog/about-dialog';\n\nclass SideNavFooter extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isAboutDialogShow: false,\n    };\n  }\n\n  onAboutDialogToggle = () => {\n    this.setState({isAboutDialogShow: !this.state.isAboutDialogShow});\n  }\n\n  renderExternalAppLinks = () => {\n    if (additionalAppBottomLinks && (typeof additionalAppBottomLinks) === 'object') {\n      let keys = Object.keys(additionalAppBottomLinks);\n      return keys.map((key, index) => {\n        return <a key={index} className=\"item\" href={additionalAppBottomLinks[key]}>{key}</a>;\n      });\n    }\n    return null;\n  }\n\n  render() {\n\n    if (sideNavFooterCustomHtml) {\n      return (<div className='side-nav-footer' dangerouslySetInnerHTML={{__html: sideNavFooterCustomHtml}}></div>);\n    }\n    return (\n      <Fragment>\n        <div className=\"side-nav-footer flex-wrap\">\n          <a href={siteRoot + 'help/'} target=\"_blank\" rel=\"noopener noreferrer\" className=\"item\">{gettext('Help')}</a>\n          <a className=\"item cursor-pointer\" onClick={this.onAboutDialogToggle}>{gettext('About')}</a>\n          {enableTC && <a href={`${siteRoot}terms/`} className=\"item\">{gettext('Terms')}</a>}\n          {this.renderExternalAppLinks()}\n          <a href={siteRoot + 'download_client_program/'} className={`item ${additionalAppBottomLinks ? '' : 'last-item'}`}>\n            <span aria-hidden=\"true\" className=\"sf2-icon-monitor vam\"></span>{' '}\n            <span className=\"vam\">{gettext('Clients')}</span>\n          </a>\n        </div>\n        {this.state.isAboutDialogShow && (\n          <ModalPortal>\n            <AboutDialog onCloseAboutDialog={this.onAboutDialogToggle} />\n          </ModalPortal>\n        )}\n      </Fragment>\n    );\n  }\n}\n\nexport default SideNavFooter;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Logo from './logo';\nimport MainSideNav from './main-side-nav';\nimport SideNavFooter from './side-nav-footer';\n\nconst propTypes = {\n  isSidePanelClosed: PropTypes.bool.isRequired,\n  currentTab: PropTypes.oneOfType([PropTypes.string, PropTypes.number]).isRequired,\n  onCloseSidePanel: PropTypes.func.isRequired,\n  tabItemClick: PropTypes.func.isRequired,\n  draftCounts: PropTypes.number,\n};\n\nclass SidePanel extends React.Component {\n\n  render() {\n    return (\n      <div className={`side-panel ${this.props.isSidePanelClosed ? '' : 'left-zero'}`}>\n        <div className=\"side-panel-north\">\n          <Logo onCloseSidePanel={this.props.onCloseSidePanel}/>\n        </div>\n        <div className=\"side-panel-center\">\n          <MainSideNav tabItemClick={this.props.tabItemClick} currentTab={this.props.currentTab} draftCounts={this.props.draftCounts}/>\n        </div>\n        <div className=\"side-panel-footer\">\n          <SideNavFooter />\n        </div>\n      </div>\n    );\n  }\n}\n\nSidePanel.propTypes = propTypes;\n\nexport default SidePanel;\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\n\nconst propTypes = {\n  children: PropTypes.object.isRequired,\n};\n\nclass MainPanel extends Component {\n\n  render() {\n    return (\n      <div className=\"main-panel o-hidden\">\n        {this.props.children}\n      </div>\n    );\n  }\n}\n\nMainPanel.propTypes = propTypes;\n\nexport default MainPanel;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\n\nconst propTypes = {\n  children: PropTypes.oneOfType([\n    PropTypes.array,\n    PropTypes.object\n  ]).isRequired,\n};\n\nclass DraftsView extends React.Component {\n  render() {\n    return (\n      <div className=\"main-panel-center\">\n        <div className=\"cur-view-container\">\n          <div className=\"cur-view-path\">\n            <div className=\"path-container\">\n              <h3 className=\"sf-heading\">{gettext('Drafts')}</h3>\n            </div>\n          </div>\n          {this.props.children}\n        </div>\n      </div>\n    );\n  }\n}\n\nDraftsView.propTypes = propTypes;\n\nexport default DraftsView;\n","import React from 'react';\nimport moment from 'moment';\nimport PropTypes from 'prop-types';\nimport { Dropdown, DropdownMenu, DropdownToggle, DropdownItem } from 'reactstrap';\nimport { gettext, siteRoot, lang } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n\nmoment.locale(lang);\nconst propTypes = {\n  draft: PropTypes.object.isRequired,\n  isItemFreezed: PropTypes.bool.isRequired,\n  onFreezedItem: PropTypes.func.isRequired,\n  onUnfreezedItem: PropTypes.func.isRequired,\n  onDeleteHandler: PropTypes.func.isRequired,\n  onPublishHandler: PropTypes.func.isRequired,\n};\n\nclass DraftListItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isMenuIconShow: false,\n      isItemMenuShow: false,\n      highlight: false,\n    };\n  }\n\n  onMouseEnter = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        isMenuIconShow: true,\n        highlight: true,\n      });\n    }\n  }\n\n  onMouseLeave = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        isMenuIconShow: false,\n        highlight: false,\n      });\n    }\n  }\n\n  onDropdownToggleClick = (e) => {\n    e.preventDefault();\n    this.toggleOperationMenu(e);\n  }\n\n  toggleOperationMenu = (e) => {\n    e.stopPropagation();\n    this.setState(\n      {isItemMenuShow: !this.state.isItemMenuShow }, () => {\n        if (this.state.isItemMenuShow) {\n          this.props.onFreezedItem();\n        } else {\n          this.setState({\n            highlight: false,\n            isMenuIconShow: false,\n          });\n          this.props.onUnfreezedItem();\n        }\n      }\n    );\n  }\n\n  onDeleteHandler = () => {\n    this.props.onDeleteHandler(this.props.draft);\n  }\n\n  onPublishHandler = () => {\n    this.props.onPublishHandler(this.props.draft);\n  }\n\n  render() {\n    let draft = this.props.draft;\n    let repoID = draft.origin_repo_id;\n    let filePath = draft.draft_file_path;\n    let fileName = Utils.getFileName(filePath);\n    let draftUrl = siteRoot + 'drafts/' + draft.id + '/';\n    let libraryUrl = siteRoot + 'library/' + repoID + '/' + encodeURIComponent(draft.repo_name) + '/' ;\n    let localTime = moment.utc(draft.updated_at).toDate();\n    localTime = moment(localTime).fromNow();\n\n    let iconUrl = Utils.getFileIconUrl(fileName);\n    return (\n      <tr className={this.state.highlight ? 'tr-highlight' : ''} onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave}>\n        <td className=\"text-center\"><img src={iconUrl} width=\"24\" alt='' /></td>\n        <td className=\"name\" >\n          <a href={draftUrl} target=\"_blank\">{fileName}</a>\n        </td>\n        <td className=\"library\">\n          <a href={libraryUrl} target=\"_blank\">{draft.repo_name}</a>\n        </td>\n        <td className=\"update\">{localTime}</td>\n        <td className=\"text-center\">\n          {this.state.isMenuIconShow && (\n            <Dropdown isOpen={this.state.isItemMenuShow} toggle={this.toggleOperationMenu}>\n              <DropdownToggle\n                tag=\"i\"\n                className=\"fas fa-ellipsis-v attr-action-icon\"\n                title={gettext('More Operations')}\n                onClick={this.onDropdownToggleClick}\n                data-toggle=\"dropdown\"\n                aria-expanded={this.state.isItemMenuShow}\n              />\n              <DropdownMenu>\n                <DropdownItem onClick={this.onDeleteHandler}>{gettext('Delete')}</DropdownItem>\n                {draft.status == 'open' &&\n                  <DropdownItem onClick={this.onPublishHandler}>{gettext('Publish')}</DropdownItem>\n                }\n              </DropdownMenu>\n            </Dropdown>\n          )}\n        </td>\n      </tr>\n    );\n  }\n}\n\nDraftListItem.propTypes = propTypes;\n\nexport default DraftListItem;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport DraftListItem from './draft-list-item';\n\nconst propTypes = {\n  draftList: PropTypes.array.isRequired,\n  onDeleteHandler: PropTypes.func.isRequired,\n  onPublishHandler: PropTypes.func.isRequired,\n};\n\nclass DraftListView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isItemFreezed: false,\n    };\n  }\n\n  onFreezedItem = () => {\n    this.setState({isItemFreezed: true});\n  }\n\n  onUnfreezedItem = () => {\n    this.setState({isItemFreezed: false});\n  }\n\n  render() {\n    let drafts = this.props.draftList;\n    return (\n      <table>\n        <thead>\n          <tr>\n            <th style={{width: '4%'}}>{/*img*/}</th>\n            <th style={{width: '46%'}}>{gettext('Name')}</th>\n            <th style={{width: '30%'}}>{gettext('Library')}</th>\n            <th style={{width: '10%'}}>{gettext('Last Update')}</th>\n            <th style={{width: '10%'}}></th>\n          </tr>\n        </thead>\n        <tbody>\n          { drafts && drafts.map((draft) => {\n            return (\n              <DraftListItem\n                key={draft.id}\n                draft={draft}\n                isItemFreezed={this.state.isItemFreezed}\n                onFreezedItem={this.onFreezedItem}\n                onUnfreezedItem={this.onUnfreezedItem}\n                onDeleteHandler={this.props.onDeleteHandler}\n                onPublishHandler={this.props.onPublishHandler}\n              />\n            );\n          })}\n        </tbody>\n      </table>\n    );\n  }\n}\n\nDraftListView.propTypes = propTypes;\n\nexport default DraftListView;\n","import React, { Fragment } from 'react';\nimport { gettext } from '../../utils/constants';\nimport editUtilities from '../../utils/editor-utilities';\nimport { Utils } from '../../utils/utils';\nimport PropTypes from 'prop-types';\nimport toaster from '../../components/toast';\nimport EmptyTip from '../../components/empty-tip';\nimport Loading from '../../components/loading';\nimport DraftListView from '../../components/draft-list-view/draft-list-view';\n\nconst propTypes = {\n  isLoadingDraft: PropTypes.bool.isRequired,\n  updateDraftsList: PropTypes.func.isRequired,\n  draftList: PropTypes.array.isRequired,\n  getDrafts: PropTypes.func.isRequired,\n};\n\nclass DraftContent extends React.Component {\n\n  componentDidMount() {\n    this.props.getDrafts();\n  }\n\n  onDeleteHandler = (draft) => {\n    // let draft = this.state.currentDraft;\n    let draft_name = Utils.getFileName(draft.draft_file_path);\n    editUtilities.deleteDraft(draft.id).then(res => {\n      this.props.updateDraftsList(draft.id);\n      let msg_s = gettext('Successfully deleted draft %(draft)s.');\n      msg_s = msg_s.replace('%(draft)s', draft_name);\n      toaster.success(msg_s);\n    }).catch(() => {\n      let msg_s = gettext('Failed to delete draft %(draft)s.');\n      msg_s = msg_s.replace('%(draft)s', draft_name);\n      toaster.danger(msg_s);\n    });\n  }\n\n  onPublishHandler = (draft) => {\n    // let draft = this.state.currentDraft;\n    let draft_name = Utils.getFileName(draft.draft_file_path);\n    editUtilities.publishDraft(draft.id).then(res => {\n      this.props.updateDraftsList(draft.id);\n      let msg_s = gettext('Successfully published draft %(draft)s.');\n      msg_s = msg_s.replace('%(draft)s', draft_name);\n      toaster.success(msg_s);\n    }).catch(() => {\n      let msg_s = gettext('Failed to publish draft %(draft)s.');\n      msg_s = msg_s.replace('%(draft)s', draft_name);\n      toaster.danger(msg_s);\n    });\n  }\n\n  render() {\n    return (\n      <div className=\"cur-view-content\">\n        {this.props.isLoadingDraft && <Loading />}\n        {!this.props.isLoadingDraft && (\n          <Fragment>\n            {this.props.draftList.length === 0 && (\n              <EmptyTip>\n                <h2>{gettext('No draft yet')}</h2>\n                <p>{gettext('Draft is a way to let you collaborate with others on files. You can create a draft from a file, edit the draft and then ask for a review. The original file will be updated only after the draft has been reviewed.')}</p>\n              </EmptyTip>\n            )}\n            {this.props.draftList.length !==0 && (\n              <DraftListView\n                draftList={this.props.draftList}\n                onDeleteHandler={this.onDeleteHandler}\n                onPublishHandler={this.onPublishHandler}\n              />\n            )}\n          </Fragment>\n        )}\n      </div>\n    );\n  }\n}\n\nDraftContent.propTypes = propTypes;\n\nexport default DraftContent;\n","class Acticity {\n  constructor(json) {\n    this.repo_id = json.repo_id;\n    this.repo_name = json.repo_name;\n    this.obj_type = json.obj_type;\n    this.commit_id = json.commit_id;\n    this.path = json.path;\n    this.name = json.name;\n    this.author_email = json.author_email;\n    this.author_name = json.author_name;\n    this.author_contact_email = json.author_contact_email;\n    this.avatar_url = json.avatar_url;\n    this.time = json.time;\n    this.op_type = json.op_type;\n    this.createdFilesCount = 0;\n    this.createdFilesList = [];\n    if (json.op_type === 'clean-up-trash') {\n      this.days = json.days;\n    } else if (json.op_type === 'rename' && json.obj_type === 'repo') {\n      this.old_repo_name = json.old_repo_name;\n    } else if (json.op_type === 'move' && ['dir', 'file'].includes(json.obj_type)) {\n      this.old_path = json.old_path;\n    } else if (json.op_type === 'rename' && ['dir', 'file'].includes(json.obj_type)) {\n      this.old_path = json.old_path;\n      this.old_name = json.old_name;\n    } else if (json.op_type === 'publish') {\n      this.old_path = json.old_path;\n    } else if (json.name.endsWith('(draft).md')) {\n      this.draft_id = json.draft_id;\n    }\n  }\n}\n\nexport default Acticity;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter, Table } from 'reactstrap';\nimport { gettext, siteRoot, serviceURL } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  activity: PropTypes.object.isRequired,\n  toggleCancel: PropTypes.func.isRequired,\n};\n\nclass ListCreatedFileDialog extends React.Component {\n\n  toggle = (activity) => {\n    this.props.toggleCancel(activity);\n  }\n\n  render() {\n    let activity = this.props.activity;\n    return (\n      <Modal isOpen={true}>\n        <ModalHeader toggle={this.toggle}>{gettext('Created Files')}</ModalHeader>\n        <ModalBody>\n          <Table>\n            <thead>\n              <tr>\n                <th width='75%'>{gettext('Name')}</th>\n                <th width='25%'>{gettext('Time')}</th>\n              </tr>\n            </thead>\n            <tbody>\n              {\n                activity.createdFilesList.map((item, index) => {\n                  let fileURL = `${siteRoot}lib/${item.repo_id}/file${Utils.encodePath(item.path)}`;\n                  if (item.name.endsWith('(draft).md')) {\n                    fileURL = serviceURL + '/drafts/' + item.draft_id + '/';\n                  }\n                  let fileLink = <a href={fileURL} target='_blank'>{item.name}</a>;\n                  if (item.name.endsWith('(draft).md') && !item.draft_id) {\n                    fileLink = item.name;\n                  }\n                  return (\n                    <tr key={index}>\n                      <td>{fileLink}</td>\n                      <td>{moment(item.time).fromNow()}</td>\n                    </tr>\n                  );\n                })\n              }\n            </tbody>\n          </Table>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle.bind(this, activity)}>{gettext('Close')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nListCreatedFileDialog.propTypes = propTypes;\n\nexport default ListCreatedFileDialog;\n","import React, { Component, Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { gettext, siteRoot, serviceURL } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport Loading from '../../components/loading';\nimport Activity from '../../models/activity';\nimport ListCreatedFileDialog from '../../components/dialog/list-created-files-dialog';\nimport ModalPortal from '../../components/modal-portal';\n\nimport '../../css/files-activities.css';\n\nmoment.locale(window.app.config.lang);\n\nconst contentPropTypes = {\n  isLoadingMore: PropTypes.bool.isRequired,\n  items: PropTypes.array.isRequired,\n};\n\nclass FileActivitiesContent extends Component {\n\n  render() {\n    const isDesktop = Utils.isDesktop();\n    let { items, isLoadingMore } = this.props;\n\n    const desktopThead = (\n      <thead>\n        <tr>\n          <th width=\"8%\">{/* avatar */}</th>\n          <th width=\"15%\">{gettext('User')}</th>\n          <th width=\"20%\">{gettext('Operation')}</th>\n          <th width=\"37%\">{gettext('File')} / {gettext('Library')}</th>\n          <th width=\"20%\">{gettext('Time')}</th>\n        </tr>\n      </thead>\n    );\n\n    const mobileThead = (\n      <thead>\n        <tr>\n          <th width=\"15%\"></th>\n          <th width=\"53%\"></th>\n          <th width=\"32%\"></th>\n        </tr>\n      </thead>\n    );\n\n    return (\n      <Fragment>\n        <table className=\"table-hover table-thead-hidden\">\n          {isDesktop ? desktopThead : mobileThead}\n          <tbody>\n            {items.map((item, index) => {\n              return (\n                <ActivityItem\n                  key={index}\n                  isDesktop={isDesktop}\n                  item={item}\n                  index={index}\n                  items={items}\n                />\n              );\n            })}\n          </tbody>\n        </table>\n        {isLoadingMore ? <span className=\"loading-icon loading-tip\"></span> : ''}\n      </Fragment>\n    );\n  }\n}\n\nFileActivitiesContent.propTypes = contentPropTypes;\n\nconst activityPropTypes = {\n  item: PropTypes.object.isRequired,\n  index: PropTypes.number.isRequired,\n  items: PropTypes.array.isRequired,\n};\n\nclass ActivityItem extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isListCreatedFiles: false,\n    };\n  }\n\n  onListCreatedFilesToggle = () => {\n    this.setState({\n      isListCreatedFiles: !this.state.isListCreatedFiles,\n    });\n  }\n\n  render() {\n    const isDesktop = this.props.isDesktop;\n    let {item, index, items} = this.props;\n    let op, details, moreDetails = false;\n    let userProfileURL = `${siteRoot}profile/${encodeURIComponent(item.author_email)}/`;\n\n    let libURL = siteRoot + 'library/' + item.repo_id + '/' + encodeURIComponent(item.repo_name) + '/';\n    let libLink = <a href={libURL}>{item.repo_name}</a>;\n    let smallLibLink = <a className=\"small text-secondary\" href={libURL}>{item.repo_name}</a>;\n\n    if (item.obj_type == 'repo') {\n      switch(item.op_type) {\n        case 'create':\n          op = gettext('Created library');\n          details = libLink;\n          break;\n        case 'rename':\n          op = gettext('Renamed library');\n          details = <span>{item.old_repo_name} => {libLink}</span>;\n          break;\n        case 'delete':\n          op = gettext('Deleted library');\n          details = item.repo_name;\n          break;\n        case 'recover':\n          op = gettext('Restored library');\n          details = libLink;\n          break;\n        case 'clean-up-trash':\n          op = gettext('Cleaned trash');\n          if (item.days == 0) {\n            details = gettext('Removed all items from trash.');\n          } else {\n            details = gettext('Removed items older than {n} days from trash.').replace('{n}', item.days);\n          }\n          moreDetails = true;\n          break;\n      }\n    } else if (item.obj_type == 'draft') {\n      let fileURL = `${siteRoot}lib/${item.repo_id}/file${Utils.encodePath(item.path)}`;\n      let fileLink = <a href={fileURL} target=\"_blank\">{item.name}</a>;\n      op = gettext('Publish draft');\n      details = fileLink;\n      moreDetails = true;\n    } else if (item.obj_type == 'files') {\n      let fileURL = `${siteRoot}lib/${item.repo_id}/file${Utils.encodePath(item.path)}`;\n      if (item.name.endsWith('(draft).md')) {\n        fileURL = serviceURL + '/drafts/' + item.draft_id + '/';\n      }\n      let fileLink = `<a href=${fileURL} target=\"_blank\">${item.name}</a>`;\n      if (item.name.endsWith('(draft).md') && !item.draft_id) {\n        fileLink = item.name;\n      }\n      let fileCount = item.createdFilesCount - 1;\n      let firstLine = gettext('{file} and {n} other files')\n        .replace('{file}', fileLink)\n        .replace('{n}', fileCount);\n      op = gettext('Created {n} files').replace('{n}', item.createdFilesCount);\n      details = (\n        <Fragment>\n          <p className=\"m-0 d-inline\" dangerouslySetInnerHTML={{__html: firstLine}}></p>\n          {isDesktop && <span onClick={this.onListCreatedFilesToggle} className=\"activity-details text-secondary ml-2\">{gettext('details')}</span>}\n        </Fragment>\n      );\n      moreDetails = true;\n    } else if (item.obj_type == 'file') {\n      const isDraft = item.name.endsWith('(draft).md');\n      const fileURL = isDraft ? serviceURL + '/drafts/' + item.draft_id + '/' :\n        `${siteRoot}lib/${item.repo_id}/file${Utils.encodePath(item.path)}`;\n      let fileLink = <a href={fileURL} target=\"_blank\">{item.name}</a>;\n      if (isDraft && !item.draft_id) {\n        fileLink = item.name;\n      }\n      switch (item.op_type) {\n        case 'create':\n          op = isDraft ? gettext('Created draft') : gettext('Created file');\n          details = fileLink;\n          moreDetails = true;\n          break;\n        case 'delete':\n          op = isDraft ? gettext('Deleted draft') : gettext('Deleted file');\n          details = item.name;\n          moreDetails = true;\n          break;\n        case 'recover':\n          op = gettext('Restored file');\n          details = fileLink;\n          moreDetails = true;\n          break;\n        case 'rename':\n          op = gettext('Renamed file');\n          details = <span>{item.old_name} => {fileLink}</span>;\n          moreDetails = true;\n          break;\n        case 'move':\n          const filePathLink = <a href={fileURL}>{item.path}</a>;\n          op = gettext('Moved file');\n          details = <span>{item.old_path} => {filePathLink}</span>;\n          moreDetails = true;\n          break;\n        case 'edit': // update\n          op = isDraft ? gettext('Updated draft') : gettext('Updated file');\n          details = fileLink;\n          moreDetails = true;\n          break;\n      }\n    } else { // dir\n      let dirURL = siteRoot + 'library/' + item.repo_id + '/' + encodeURIComponent(item.repo_name) + Utils.encodePath(item.path);\n      let dirLink = <a href={dirURL} target=\"_blank\">{item.name}</a>;\n      switch (item.op_type) {\n        case 'create':\n          op = gettext('Created folder');\n          details = dirLink;\n          moreDetails = true;\n          break;\n        case 'delete':\n          op = gettext('Deleted folder');\n          details = item.name;\n          moreDetails = true;\n          break;\n        case 'recover':\n          op = gettext('Restored folder');\n          details = dirLink;\n          moreDetails = true;\n          break;\n        case 'rename':\n          op = gettext('Renamed folder');\n          details = <span>{item.old_name} => {dirLink}</span>;\n          moreDetails = true;\n          break;\n        case 'move':\n          const dirPathLink = <a href={dirURL}>{item.path}</a>;\n          op = gettext('Moved folder');\n          details = <span>{item.old_path} => {dirPathLink}</span>;\n          moreDetails = true;\n          break;\n      }\n    }\n\n    let isShowDate = true;\n    if (index > 0) {\n      let lastEventTime = items[index - 1].time;\n      isShowDate = moment(item.time).isSame(lastEventTime, 'day') ? false : true;\n    }\n\n    return (\n      <Fragment>\n        {isShowDate &&\n          <tr>\n            <td colSpan={isDesktop ? 5 : 3} className=\"border-top-0\">{moment(item.time).format('YYYY-MM-DD')}</td>\n          </tr>\n        }\n        {isDesktop ? (\n          <tr>\n            <td className=\"text-center\">\n              <img src={item.avatar_url} alt=\"\" width=\"32\" height=\"32\" className=\"avatar\" />\n            </td>\n            <td>\n              <a href={userProfileURL}>{item.author_name}</a>\n            </td>\n            <td>{op}</td>\n            <td>\n              {details}\n              {moreDetails && <br /> }\n              {moreDetails && smallLibLink}\n            </td>\n            <td className=\"text-secondary\">\n              <time datetime={item.time} is=\"relative-time\" title={moment(item.time).format('llll')}>{moment(item.time).fromNow()}</time>\n            </td>\n          </tr>\n        ) : (\n          <tr>\n            <td className=\"text-center align-top\">\n              <img src={item.avatar_url} alt=\"\" width=\"32\" height=\"32\" className=\"avatar\" />\n            </td>\n            <td>\n              <a href={userProfileURL}>{item.author_name}</a>\n              <p className=\"m-0 text-secondary\">{op}</p>\n              {details}\n            </td>\n            <td className=\"text-right align-top\">\n              <span className=\"text-secondary mobile-activity-time\">\n                <time datetime={item.time} is=\"relative-time\" title={moment(item.time).format('llll')}>{moment(item.time).fromNow()}</time>\n              </span>\n              {moreDetails && <br /> }\n              {moreDetails && libLink}\n            </td>\n          </tr>\n        )}\n        {this.state.isListCreatedFiles &&\n          <ModalPortal>\n            <ListCreatedFileDialog\n              activity={item}\n              toggleCancel={this.onListCreatedFilesToggle}\n            />\n          </ModalPortal>\n        }\n      </Fragment>\n    );\n  }\n}\n\nActivityItem.propTypes = activityPropTypes;\n\nclass FilesActivities extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      errorMsg: '',\n      isFirstLoading: true,\n      isLoadingMore: false,\n      currentPage: 1,\n      hasMore: true,\n      items: [],\n    };\n    this.avatarSize = 72;\n    this.curPathList = [];\n    this.oldPathList = [];\n  }\n\n  componentDidMount() {\n    let currentPage = this.state.currentPage;\n    seafileAPI.listActivities(currentPage, this.avatarSize).then(res => {\n      // {\"events\":[...]}\n      let events = this.mergePublishEvents(res.data.events);\n      events = this.mergeFileCreateEvents(events);\n      this.setState({\n        items: events,\n        currentPage: currentPage + 1,\n        isFirstLoading: false,\n        hasMore: true,\n      });\n      if (this.state.items.length < 25) {\n        this.getMore();\n      }\n    }).catch(error => {\n      this.setState({\n        isFirstLoading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  mergePublishEvents = (events) => {\n    events.map((item) => {\n      if (item.op_type === 'publish') {\n        this.curPathList.push(item.path);\n        this.oldPathList.push(item.old_path);\n      }\n    });\n    let actuallyEvents = [];\n    for (var i = 0; i < events.length; i++) {\n      if (events[i].obj_type === 'file') {\n        if (events[i].op_type === 'delete' && this.oldPathList.includes(events[i].path)) {\n          this.oldPathList.splice(this.oldPathList.indexOf(events[i].path), 1);\n        } else if (events[i].op_type === 'edit' && this.curPathList.includes(events[i].path)) {\n          this.curPathList.splice(this.curPathList.indexOf(events[i].path), 1);\n        } else if (events[i].op_type === 'rename' && this.oldPathList.includes(events[i].old_path)) {\n          this.oldPathList.splice(this.oldPathList.indexOf(events[i].old_path), 1);\n        } else {\n          actuallyEvents.push(events[i]);\n        }\n      } else {\n        actuallyEvents.push(events[i]);\n      }\n    }\n    return actuallyEvents;\n  }\n\n  mergeFileCreateEvents = (events) => {\n    let actuallyEvents = [];\n    let multiFilesActivity = null;\n    for (var i = 0; i < events.length; i++) {\n      let isFulfilCondition = events[i].obj_type === 'file' &&\n                              events[i].op_type === 'create' &&\n                              events[i + 1] &&\n                              events[i + 1].obj_type === 'file' &&\n                              events[i + 1].op_type === 'create' &&\n                              events[i + 1].repo_name === events[i].repo_name &&\n                              events[i + 1].author_email === events[i].author_email;\n      if (multiFilesActivity != null) {\n        multiFilesActivity.createdFilesCount++;\n        multiFilesActivity.createdFilesList.push(events[i]);\n        if (isFulfilCondition) {\n          continue;\n        } else {\n          actuallyEvents.push(multiFilesActivity);\n          multiFilesActivity = null;\n        }\n      } else {\n        if (isFulfilCondition) {\n          multiFilesActivity = new Activity(events[i]);\n          multiFilesActivity.obj_type = 'files';\n          multiFilesActivity.createdFilesCount++;\n          multiFilesActivity.createdFilesList.push(events[i]);\n        } else {\n          actuallyEvents.push(events[i]);\n        }\n      }\n    }\n    return actuallyEvents;\n  }\n\n  getMore() {\n    let currentPage = this.state.currentPage;\n    seafileAPI.listActivities(currentPage, this.avatarSize).then(res => {\n      // {\"events\":[...]}\n      let events = this.mergePublishEvents(res.data.events);\n      events = this.mergeFileCreateEvents(events);\n      this.setState({\n        isLoadingMore: false,\n        items: [...this.state.items, ...events],\n        currentPage: currentPage + 1,\n        hasMore: res.data.events.length === 0 ? false : true\n      });\n      if (this.state.items.length < 25 && this.state.hasMore) {\n        this.getMore();\n      }\n    }).catch(error => {\n      this.setState({\n        isLoadingMore: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  handleScroll = (event) => {\n    if (!this.state.isLoadingMore && this.state.hasMore) {\n      const clientHeight = event.target.clientHeight;\n      const scrollHeight = event.target.scrollHeight;\n      const scrollTop    = event.target.scrollTop;\n      const isBottom = (clientHeight + scrollTop + 1 >= scrollHeight);\n      if (isBottom) { // scroll to the bottom\n        this.setState({isLoadingMore: true}, () => {\n          this.getMore();\n        });\n      }\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"main-panel-center\">\n        <div className=\"cur-view-container\" id=\"activities\">\n          <div className=\"cur-view-path\">\n            <h3 className=\"sf-heading\">{gettext('Activities')}</h3>\n          </div>\n          <div className=\"cur-view-content d-block\" onScroll={this.handleScroll}>\n            {this.state.isFirstLoading && <Loading />}\n            {(!this.state.isFirstLoading && this.state.errorMsg) &&\n              <p className=\"error text-center\">{this.state.errorMsg}</p>\n            }\n            {!this.state.isFirstLoading &&\n              <FileActivitiesContent items={this.state.items} isLoadingMore={this.state.isLoadingMore}/>\n            }\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default FilesActivities;\n","import React, { Component } from 'react';\nimport { Dropdown, DropdownToggle, DropdownItem } from 'reactstrap';\nimport { Link, navigate } from '@reach/router';\nimport moment from 'moment';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport { gettext, siteRoot } from '../../utils/constants';\nimport EmptyTip from '../../components/empty-tip';\nimport Loading from '../../components/loading';\nimport toaster from '../../components/toast';\n\nclass Content extends Component {\n\n  render() {\n    const {loading, errorMsg, items} = this.props.data;\n\n    if (loading) {\n      return <Loading />;\n    } else if (errorMsg) {\n      return <p className=\"error text-center\">{errorMsg}</p>;\n    } else {\n      const emptyTip = (\n        <EmptyTip>\n          <h2>{gettext('No favorites')}</h2>\n          <p>{gettext('You have not added any libraries, folders or files to your favorites yet. A favorite gives you quick access to your most frequently used objects. You can add a library, folder or file to your favorites by clicking the star to the left of its name.')}</p>\n        </EmptyTip>\n      );\n\n      const desktopThead = (\n        <thead>\n          <tr>\n            <th width=\"4%\"></th>\n            <th width=\"40%\">{gettext('Name')}</th>\n            <th width=\"32%\">{gettext('Library')}</th>\n            <th width=\"18%\">{gettext('Last Update')}</th>\n            <th width=\"6%\"></th>\n          </tr>\n        </thead>\n      );\n      const mobileThead = (\n        <thead>\n          <tr>\n            <th width=\"12%\"></th>\n            <th width=\"80%\"></th>\n            <th width=\"8%\"></th>\n          </tr>\n        </thead>\n      );\n\n      const isDesktop = Utils.isDesktop();\n      return items.length ? (\n        <table className={`table-hover ${isDesktop ? '': 'table-thead-hidden'}`}>\n          {isDesktop ? desktopThead : mobileThead}\n          <TableBody items={items} />\n        </table>\n      ) : emptyTip;\n    }\n  }\n}\n\nclass TableBody extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      items: this.props.items\n    };\n  }\n\n  componentDidMount() {\n    this.getThumbnails();\n  }\n\n  getThumbnails() {\n    let items = this.state.items.filter((item) => {\n      return Utils.imageCheck(item.obj_name) && !item.repo_encrypted;\n    });\n    if (items.length == 0) {\n      return ;\n    }\n\n    const len = items.length;\n    const thumbnailSize = 48;\n    const _this = this;\n    let getThumbnail = function(i) {\n      const curItem = items[i];\n      seafileAPI.createThumbnail(curItem.repo_id, curItem.path, thumbnailSize).then((res) => {\n        curItem.encoded_thumbnail_src = res.data.encoded_thumbnail_src;\n      }).catch((error) => {\n        // do nothing\n      }).then(() => {\n        if (i < len - 1) {\n          getThumbnail(++i);\n        } else {\n          // when done, `setState()`\n          _this.setState({\n            items: _this.state.items\n          });\n        }\n      });\n    };\n    getThumbnail(0);\n  }\n\n  render() {\n\n    let listItems = this.state.items.map(function(item, index) {\n\n      if (item.path === '/') {\n        item.item_icon_url = Utils.getDefaultLibIconUrl(false);\n      } else {\n        item.item_icon_url = item.is_dir ? Utils.getFolderIconUrl(false) : Utils.getFileIconUrl(item.obj_name);\n      }\n\n      item.encoded_path = Utils.encodePath(item.path);\n\n      item.thumbnail_url = item.encoded_thumbnail_src ? `${siteRoot}${item.encoded_thumbnail_src}` : '';\n      item.dirent_view_url = item.is_dir ? `${siteRoot}library/${item.repo_id}/${item.repo_name}${item.encoded_path}` : `${siteRoot}lib/${item.repo_id}/file${item.encoded_path}`;\n\n      item.mtime_relative = moment(item.mtime).fromNow();\n\n\n      return <Item key={index} data={item} />;\n    }, this);\n\n    return (\n      <tbody>{listItems}</tbody>\n    );\n  }\n}\n\nclass Item extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      showOpIcon: false,\n      unstarred: false,\n      isOpMenuOpen: false // for mobile\n    };\n  }\n\n  toggleOpMenu = () => {\n    this.setState({\n      isOpMenuOpen: !this.state.isOpMenuOpen\n    });\n  }\n\n  handleMouseOver = () => {\n    this.setState({\n      showOpIcon: true\n    });\n  }\n\n  handleMouseOut = () => {\n    this.setState({\n      showOpIcon: false\n    });\n  }\n\n  unstar = (e) => {\n    e.preventDefault();\n\n    const data = this.props.data;\n    seafileAPI.unstarItem(data.repo_id, data.path).then((res) => {\n      this.setState({unstarred: true});\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  visitItem = () => {\n    const data = this.props.data;\n    if (data.is_dir) {\n      navigate(data.dirent_view_url);\n    } else {\n      window.open(data.dirent_view_url);\n    }\n  }\n\n  render() {\n\n    if (this.state.unstarred) {\n      return null;\n    }\n\n    const data = this.props.data;\n\n    let opClasses = 'sf2-icon-x3 unstar action-icon';\n    opClasses += this.state.showOpIcon ? '' : ' invisible';\n\n    const desktopItem = (\n      <tr onMouseOver={this.handleMouseOver} onMouseOut={this.handleMouseOut}>\n        <td className=\"text-center\">\n          {\n            data.thumbnail_url ?\n              <img className=\"thumbnail\" src={data.thumbnail_url} alt=\"\" /> :\n              <img src={data.item_icon_url} alt={gettext('icon')} width=\"24\" />\n          }\n        </td>\n        <td>\n          { data.is_dir ?\n            <Link to={data.dirent_view_url}>{data.obj_name}</Link> :\n            <a className=\"normal\" href={data.dirent_view_url} target=\"_blank\">{data.obj_name}</a>\n          }\n        </td>\n        <td>{data.repo_name}</td>\n        <td dangerouslySetInnerHTML={{__html:data.mtime_relative}}></td>\n        <td>\n          <a href=\"#\" className={opClasses} title={gettext('Unstar')} aria-label={gettext('Unstar')} onClick={this.unstar}></a>\n        </td>\n      </tr>\n    );\n\n    const mobileItem = (\n      <tr>\n        <td className=\"text-center\" onClick={this.visitItem}>\n          {\n            data.thumbnail_url ?\n              <img className=\"thumbnail\" src={data.thumbnail_url} alt=\"\" /> :\n              <img src={data.item_icon_url} alt={gettext('icon')} width=\"24\" />\n          }\n        </td>\n        <td onClick={this.visitItem}>\n          { data.is_dir ?\n            <Link to={data.dirent_view_url}>{data.obj_name}</Link> :\n            <a className=\"normal\" href={data.dirent_view_url} target=\"_blank\">{data.obj_name}</a>\n          }\n          <br />\n          <span className=\"item-meta-info\">{data.repo_name}</span>\n          <span className=\"item-meta-info\" dangerouslySetInnerHTML={{__html:data.mtime_relative}}></span>\n        </td>\n        <td>\n          <Dropdown isOpen={this.state.isOpMenuOpen} toggle={this.toggleOpMenu}>\n            <DropdownToggle\n              tag=\"i\"\n              className=\"sf-dropdown-toggle fa fa-ellipsis-v ml-0\"\n              title={gettext('More Operations')}\n              data-toggle=\"dropdown\"\n              aria-expanded={this.state.isOpMenuOpen}\n            />\n            <div className={this.state.isOpMenuOpen ? '' : 'd-none'} onClick={this.toggleOpMenu}>\n              <div className=\"mobile-operation-menu-bg-layer\"></div>\n              <div className=\"mobile-operation-menu\">\n                <DropdownItem className=\"mobile-menu-item\" onClick={this.unstar}>{gettext('Unstar')}</DropdownItem>\n              </div>\n            </div>\n          </Dropdown>\n        </td>\n      </tr>\n    );\n\n    return Utils.isDesktop() ? desktopItem : mobileItem;\n  }\n}\n\nclass Starred extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      errorMsg: '',\n      items: []\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.listStarredItems().then((res) => {\n      this.setState({\n        loading: false,\n        items: res.data.starred_item_list\n      });\n    }).catch((error) => {\n      this.setState({\n        loading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  render() {\n    return (\n      <div className=\"main-panel-center\">\n        <div className=\"cur-view-container\" id=\"starred\">\n          <div className=\"cur-view-path\">\n            <h3 className=\"sf-heading\">{gettext('Favorites')}</h3>\n          </div>\n          <div className=\"cur-view-content\">\n            <Content data={this.state} />\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default Starred;\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalHeader, ModalBody, ModalFooter, Button, FormGroup, Label, Input } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\n\nconst propTypes = {\n  executeOperation: PropTypes.func.isRequired,\n  toggleDialog: PropTypes.func.isRequired\n};\n\nclass ConfirmUnlinkDevice extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isChecked: false\n    };\n  }\n\n  toggle = () => {\n    this.props.toggleDialog();\n  }\n\n  executeOperation = () => {\n    this.toggle();\n    this.props.executeOperation(this.state.isChecked);\n  }\n\n  onInputChange = (e) => {\n    this.setState({\n      isChecked: e.target.checked\n    });\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true} toggle={this.toggle}>\n        <ModalHeader toggle={this.toggle}>{gettext('Unlink device')}</ModalHeader>\n        <ModalBody>\n          <p>{gettext('Are you sure you want to unlink this device?')}</p>\n          <FormGroup check>\n            <Label check>\n              <Input type=\"checkbox\" checked={this.state.isChecked} onChange={this.onInputChange} />\n              <span>{gettext('Delete files from this device the next time it comes online.')}</span>\n            </Label>\n          </FormGroup>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.executeOperation}>{gettext('Unlink')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nConfirmUnlinkDevice.propTypes = propTypes;\n\nexport default ConfirmUnlinkDevice;\n","import React, { Component } from 'react';\nimport { Dropdown, DropdownToggle, DropdownItem } from 'reactstrap';\nimport moment from 'moment';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { gettext } from '../../utils/constants';\nimport toaster from '../../components/toast';\nimport EmptyTip from '../../components/empty-tip';\nimport ConfirmUnlinkDeviceDialog from '../../components/dialog/confirm-unlink-device';\nimport { Utils } from '../../utils/utils';\n\nclass Content extends Component {\n\n  render() {\n    const {loading, errorMsg, items} = this.props.data;\n\n    if (loading) {\n      return <span className=\"loading-icon loading-tip\"></span>;\n    } else if (errorMsg) {\n      return <p className=\"error text-center\">{errorMsg}</p>;\n    } else {\n      const emptyTip = (\n        <EmptyTip>\n          <h2>{gettext('No linked devices')}</h2>\n          <p>{gettext('You have not accessed your files with any client (desktop or mobile) yet. Configure clients on your devices to access your data more comfortably.')}</p>\n        </EmptyTip>\n      );\n\n      const desktopThead = (\n        <thead>\n          <tr>\n            <th width=\"13%\">{gettext('Platform')}</th>\n            <th width=\"30%\">{gettext('Device Name')}</th>\n            <th width=\"30%\">{gettext('IP')}</th>\n            <th width=\"17%\">{gettext('Last Access')}</th>\n            <th width=\"10%\"></th>\n          </tr>\n        </thead>\n      );\n      const mobileThead = (\n        <thead>\n          <tr>\n            <th width=\"92%\"></th>\n            <th width=\"8%\"></th>\n          </tr>\n        </thead>\n      );\n\n      const isDesktop = Utils.isDesktop();\n      return items.length ? (\n        <table className={`table-hover ${isDesktop ? '': 'table-thead-hidden'}`}>\n          {isDesktop ? desktopThead : mobileThead}\n          <tbody>\n            {items.map((item, index) => {\n              return <Item key={index} data={item} isDesktop={isDesktop} />;\n            })}\n          </tbody>\n        </table>\n      ): emptyTip;\n    }\n  }\n}\n\nclass Item extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOpMenuOpen: false, // for mobile\n      isOpIconShown: false,\n      unlinked: false,\n      isConfirmUnlinkDialogOpen: false\n    };\n  }\n\n  toggleOpMenu = () => {\n    this.setState({\n      isOpMenuOpen: !this.state.isOpMenuOpen\n    });\n  }\n\n  handleMouseOver = () => {\n    this.setState({\n      isOpIconShown: true\n    });\n  }\n\n  handleMouseOut = () => {\n    this.setState({\n      isOpIconShown: false\n    });\n  }\n\n  toggleDialog = () => {\n    this.setState({\n      isConfirmUnlinkDialogOpen: !this.state.isConfirmUnlinkDialogOpen\n    });\n  }\n\n  handleClick = (e) => {\n    e.preventDefault();\n\n    const data = this.props.data;\n    if (data.is_desktop_client) {\n      this.toggleDialog();\n    } else {\n      const wipeDevice = true;\n      this.unlinkDevice(wipeDevice);\n    }\n  }\n\n  unlinkDevice = (wipeDevice) => {\n    const data = this.props.data;\n    seafileAPI.unlinkDevice(data.platform, data.device_id, wipeDevice).then((res) => {\n      this.setState({\n        unlinked: true\n      });\n      let msg = gettext('Successfully unlinked %(name)s.');\n      msg = msg.replace('%(name)s', data.device_name);\n      toaster.success(msg);\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    if (this.state.unlinked) {\n      return null;\n    }\n\n    const data = this.props.data;\n\n    let opClasses = 'sf2-icon-delete unlink-device action-icon';\n    opClasses += this.state.isOpIconShown ? '' : ' invisible';\n\n    const desktopItem = (\n      <tr onMouseOver={this.handleMouseOver} onMouseOut={this.handleMouseOut}>\n        <td>{data.platform}</td>\n        <td>{data.device_name}</td>\n        <td>{data.last_login_ip}</td>\n        <td>{moment(data.last_accessed).fromNow()}</td>\n        <td>\n          <a href=\"#\" className={opClasses} title={gettext('Unlink')} aria-label={gettext('Unlink')} onClick={this.handleClick}></a>\n        </td>\n      </tr>\n    );\n\n    const mobileItem = (\n      <tr>\n        <td>\n          {data.device_name}<br />\n          <span className=\"item-meta-info\">{data.last_login_ip}</span>\n          <span className=\"item-meta-info\">{moment(data.last_accessed).fromNow()}</span>\n          <span className=\"item-meta-info\">{data.platform}</span>\n        </td>\n        <td>\n          <Dropdown isOpen={this.state.isOpMenuOpen} toggle={this.toggleOpMenu}>\n            <DropdownToggle\n              tag=\"i\"\n              className=\"sf-dropdown-toggle fa fa-ellipsis-v ml-0\"\n              title={gettext('More Operations')}\n              data-toggle=\"dropdown\"\n              aria-expanded={this.state.isOpMenuOpen}\n            />\n            <div className={this.state.isOpMenuOpen ? '' : 'd-none'} onClick={this.toggleOpMenu}>\n              <div className=\"mobile-operation-menu-bg-layer\"></div>\n              <div className=\"mobile-operation-menu\">\n                <DropdownItem className=\"mobile-menu-item\" onClick={this.handleClick}>{gettext('Unlink')}</DropdownItem>\n              </div>\n            </div>\n          </Dropdown>\n        </td>\n      </tr>\n    );\n\n    return (\n      <React.Fragment>\n        {this.props.isDesktop ? desktopItem : mobileItem}\n        {this.state.isConfirmUnlinkDialogOpen &&\n        <ConfirmUnlinkDeviceDialog\n          executeOperation={this.unlinkDevice}\n          toggleDialog={this.toggleDialog}\n        />\n        }\n      </React.Fragment>\n    );\n  }\n}\n\nclass LinkedDevices extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      errorMsg: '',\n      items: []\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.listLinkedDevices().then((res) => {\n      this.setState({\n        loading: false,\n        items: res.data\n      });\n    }).catch((error) => {\n      this.setState({\n        loading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  render() {\n    return (\n      <div className=\"main-panel-center\">\n        <div className=\"cur-view-container\" id=\"linked-devices\">\n          <div className=\"cur-view-path\">\n            <h3 className=\"sf-heading\">{gettext('Linked Devices')}</h3>\n          </div>\n          <div className=\"cur-view-content\">\n            <Content data={this.state} />\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default LinkedDevices;\n","class SharedRepoInfo {\n\n  constructor(object) {\n    this.repo_id = object.repo_id;\n    this.repo_name = object.repo_name;\n    this.share_type = object.share_type;\n    this.share_permission = object.share_permission;\n    this.modifier_name = object.modifier_name;\n    this.modifier_email = object.modifier_email;\n    this.modifier_contact_email = object.modifier_contact_email;\n    this.encrypted = object.encrypted;\n    if (this.share_type === 'personal') {\n      this.is_admin = object.is_admin;\n      this.user_name = object.user_name;\n      this.user_email = object.user_email;\n      this.contact_email = object.contact_email;\n    } else if (this.share_type === 'group') {\n      this.is_admin = object.is_admin;\n      this.group_id = object.group_id;\n      this.group_name = object.group_name;\n    }\n  }\n\n}\n\nexport default SharedRepoInfo;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalBody } from 'reactstrap';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  currentPerm: PropTypes.string.isRequired,\n  permissions: PropTypes.array.isRequired,\n  changePerm: PropTypes.func.isRequired,\n  toggleDialog: PropTypes.func.isRequired\n};\n\nclass PermSelect extends React.Component {\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      currentOption: this.props.currentPerm\n    };\n  }\n\n  switchOption = (e) => {\n    if (!e.target.checked) {\n      return;\n    }\n\n    const currentOption = e.target.value;\n    this.setState({\n      currentOption: currentOption\n    });\n\n    this.props.changePerm(currentOption);\n    this.props.toggleDialog();\n  }\n\n  render() {\n    const options = this.props.permissions;\n    const { currentOption } = this.state;\n\n    return (\n      <Modal isOpen={true} toggle={this.props.toggleDialog}>\n        <ModalBody>\n          {options.map((item, index) => {\n            return (\n              <div className=\"d-flex\" key={index}>\n                <input id={`option-${index}`} className=\"mt-1\" type=\"radio\" name=\"permission\" value={item} checked={currentOption == item} onChange={this.switchOption} />\n                <label htmlFor={`option-${index}`} className=\"ml-2\">\n                  {Utils.sharePerms(item)}\n                  <p className=\"text-secondary small m-0\">\n                    {Utils.sharePermsExplanation(item)}\n                  </p>\n                </label>\n              </div>\n            );\n          })}\n        </ModalBody>\n      </Modal>\n    );\n  }\n}\n\nPermSelect.propTypes = propTypes;\n\nexport default PermSelect;\n","import React, { Fragment, Component } from 'react';\nimport { Link } from '@reach/router';\nimport { Dropdown, DropdownToggle, DropdownItem } from 'reactstrap';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { gettext, siteRoot, isPro } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../../components/toast';\nimport EmptyTip from '../../components/empty-tip';\nimport SharePermissionEditor from '../../components/select-editor/share-permission-editor';\nimport SharedRepoInfo from '../../models/shared-repo-info';\nimport PermSelect from '../../components/dialog/perm-select';\n\nclass Content extends Component {\n\n  sortByName = (e) => {\n    e.preventDefault();\n    const sortBy = 'name';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortItems(sortBy, sortOrder);\n  }\n\n  render() {\n    const { loading, errorMsg, items, sortBy, sortOrder } = this.props;\n\n    if (loading) {\n      return <span className=\"loading-icon loading-tip\"></span>;\n    } else if (errorMsg) {\n      return <p className=\"error text-center\">{errorMsg}</p>;\n    } else {\n      const emptyTip = (\n        <EmptyTip>\n          <h2>{gettext('No libraries shared')}</h2>\n          <p>{gettext('You have not shared any libraries with other users yet. You can share a library with other users by clicking the share icon to the right of a library\\'s name in \"My Libraries\".')}</p>\n        </EmptyTip>\n      );\n\n      // sort\n      const sortByName = sortBy == 'name';\n      const sortIcon = sortOrder == 'asc' ? <span className=\"fas fa-caret-up\"></span> : <span className=\"fas fa-caret-down\"></span>;\n\n      const isDesktop = Utils.isDesktop();\n      const table = (\n        <table className={`table-hover ${isDesktop ? '': 'table-thead-hidden'}`}>\n          <thead>\n            {isDesktop ? (\n              <tr>\n                <th width=\"4%\">{/*icon*/}</th>\n                <th width=\"34%\"><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortByName}>{gettext('Name')} {sortByName && sortIcon}</a></th>\n                <th width=\"30%\">{gettext('Share To')}</th>\n                <th width=\"24%\">{gettext('Permission')}</th>\n                <th width=\"8%\"></th>\n              </tr>\n            ) : (\n              <tr>\n                <th width=\"12%\"></th>\n                <th width=\"80%\"></th>\n                <th width=\"8%\"></th>\n              </tr>\n            )}\n          </thead>\n          <tbody>\n            {items.map((item, index) => {\n              return (<Item\n                key={index}\n                isDesktop={isDesktop}\n                item={item}\n              />);\n            })}\n          </tbody>\n        </table>\n      );\n\n      return items.length ? table : emptyTip;\n    }\n  }\n}\n\nclass Item extends Component {\n\n  constructor(props) {\n    super(props);\n\n    let item = this.props.item;\n    this.state = {\n      share_permission: item.share_permission,\n      is_admin: item.is_admin,\n      isOpIconShown: false,\n      isOpMenuOpen: false, // for mobile\n      isPermSelectDialogOpen: false, // for mobile\n      unshared: false\n    };\n    let permissions = ['rw', 'r'];\n    this.permissions = permissions;\n    this.showAdmin = isPro && (item.share_type !== 'public');\n    if (this.showAdmin) {\n      permissions.push('admin');\n    }\n    if (isPro) {\n      permissions.push('cloud-edit', 'preview');\n    }\n  }\n\n  toggleOpMenu = () => {\n    this.setState({\n      isOpMenuOpen: !this.state.isOpMenuOpen\n    });\n  }\n\n  togglePermSelectDialog = () => {\n    this.setState({\n      isPermSelectDialogOpen: !this.state.isPermSelectDialogOpen\n    });\n  }\n\n  onMouseEnter = () => {\n    this.setState({isOpIconShown: true});\n  }\n\n  onMouseLeave = () => {\n    this.setState({isOpIconShown: false});\n  }\n\n  changePerm = (permission) => {\n    const item = this.props.item;\n    const share_type = item.share_type;\n    let options = {\n      'share_type': share_type,\n      'permission': permission\n    };\n    if (share_type == 'personal') {\n      options.user = item.user_email;\n    } else if (share_type == 'group') {\n      options.group_id = item.group_id;\n    }\n\n    seafileAPI.updateRepoSharePerm(item.repo_id, options).then(() => {\n      this.setState({\n        share_permission: permission == 'admin' ? 'rw' : permission,\n        is_admin: permission == 'admin',\n      });\n      toaster.success(gettext('Successfully modified permission.'));\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  unshare = (e) => {\n    e.preventDefault();\n\n    const item = this.props.item;\n    const share_type = item.share_type;\n    let options = {\n      'share_type': share_type\n    };\n    if (share_type == 'personal') {\n      options.user = item.user_email;\n    } else if (share_type == 'group') {\n      options.group_id = item.group_id;\n    }\n\n    seafileAPI.unshareRepo(item.repo_id, options).then((res) => {\n      this.setState({\n        unshared: true\n      });\n      let message = gettext('Successfully unshared {name}').replace('{name}', item.repo_name);\n      toaster.success(message);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster(errMessage);\n    });\n  }\n\n  render() {\n    if (this.state.unshared) {\n      return null;\n    }\n\n    let { share_permission, is_admin, isOpIconShown, isPermSelectDialogOpen } = this.state;\n    let item = this.props.item;\n    Object.assign(item, {\n      share_permission: share_permission,\n      is_admin: is_admin\n    });\n\n    let iconUrl = Utils.getLibIconUrl(item);\n    let iconTitle = Utils.getLibIconTitle(item);\n    let repoUrl = `${siteRoot}library/${item.repo_id}/${encodeURIComponent(item.repo_name)}/`;\n\n\n    let shareTo;\n    const shareType = item.share_type;\n    if (shareType == 'personal') {\n      shareTo = item.user_name;\n    } else if (shareType == 'group') {\n      shareTo = item.group_name;\n    } else if (shareType == 'public') {\n      shareTo = gettext('all members');\n    }\n\n    if (this.showAdmin && is_admin) {\n      share_permission = 'admin';\n    }\n\n    const desktopItem = (\n      <tr onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave}>\n        <td><img src={iconUrl} title={iconTitle} alt={iconTitle} width=\"24\" /></td>\n        <td><Link to={repoUrl}>{item.repo_name}</Link></td>\n        <td>\n          {item.share_type == 'personal' ? <span title={item.contact_email}>{shareTo}</span> : shareTo}\n        </td>\n        <td>\n          <SharePermissionEditor\n            isTextMode={true}\n            isEditIconShow={this.state.isOpIconShown}\n            currentPermission={share_permission}\n            permissions={this.permissions}\n            onPermissionChanged={this.changePerm}\n          />\n        </td>\n        <td><a href=\"#\" className={`action-icon sf2-icon-x3 ${isOpIconShown ? '': 'invisible'}`} title={gettext('Unshare')} onClick={this.unshare}></a></td>\n      </tr>\n    );\n\n    const mobileItem = (\n      <Fragment>\n        <tr>\n          <td><img src={iconUrl} title={iconTitle} alt={iconTitle} width=\"24\" /></td>\n          <td>\n            <Link to={repoUrl}>{item.repo_name}</Link>\n            <span className=\"item-meta-info-highlighted\">{Utils.sharePerms(share_permission)}</span>\n            <br />\n            <span className=\"item-meta-info\">{`${gettext('Share To:')} ${shareTo}`}</span>\n          </td>\n          <td>\n            <Dropdown isOpen={this.state.isOpMenuOpen} toggle={this.toggleOpMenu}>\n              <DropdownToggle\n                tag=\"i\"\n                className=\"sf-dropdown-toggle fa fa-ellipsis-v ml-0\"\n                title={gettext('More Operations')}\n                data-toggle=\"dropdown\"\n                aria-expanded={this.state.isOpMenuOpen}\n              />\n              <div className={this.state.isOpMenuOpen ? '' : 'd-none'} onClick={this.toggleOpMenu}>\n                <div className=\"mobile-operation-menu-bg-layer\"></div>\n                <div className=\"mobile-operation-menu\">\n                  <DropdownItem className=\"mobile-menu-item\" onClick={this.togglePermSelectDialog}>{gettext('Permission')}</DropdownItem>\n                  <DropdownItem className=\"mobile-menu-item\" onClick={this.unshare}>{gettext('Unshare')}</DropdownItem>\n                </div>\n              </div>\n            </Dropdown>\n          </td>\n        </tr>\n        {isPermSelectDialogOpen &&\n        <PermSelect\n          currentPerm={share_permission}\n          permissions={this.permissions}\n          changePerm={this.changePerm}\n          toggleDialog={this.togglePermSelectDialog}\n        />\n        }\n      </Fragment>\n    );\n\n    return this.props.isDesktop ? desktopItem : mobileItem;\n  }\n}\n\nclass ShareAdminLibraries extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      errorMsg: '',\n      items: [],\n      sortBy: 'name', // 'name' or 'time'\n      sortOrder: 'asc' // 'asc' or 'desc'\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.listSharedRepos().then((res) => {\n      // res: {data: Array(2), status: 200, statusText: \"OK\", headers: {…}, config: {…}, …}\n      let items = res.data.map(item => {\n        return new SharedRepoInfo(item);\n      });\n      this.setState({\n        loading: false,\n        items: Utils.sortRepos(items, this.state.sortBy, this.state.sortOrder)\n      });\n    }).catch((error) => {\n      this.setState({\n        loading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  sortItems = (sortBy, sortOrder) => {\n    this.setState({\n      sortBy: sortBy,\n      sortOrder: sortOrder,\n      items: Utils.sortRepos(this.state.items, sortBy, sortOrder)\n    });\n  }\n\n  render() {\n    return (\n      <div className=\"main-panel-center\">\n        <div className=\"cur-view-container\" id=\"share-admin-libs\">\n          <div className=\"cur-view-path\">\n            <h3 className=\"sf-heading\">{gettext('Libraries')}</h3>\n          </div>\n          <div className=\"cur-view-content\">\n            <Content\n              errorMsg={this.state.errorMsg}\n              loading={this.state.loading}\n              items={this.state.items}\n              sortBy={this.state.sortBy}\n              sortOrder={this.state.sortOrder}\n              sortItems={this.sortItems}\n            />\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default ShareAdminLibraries;\n","class SharedFolderInfo {\n\n  constructor(object) {\n    this.path = object.path;\n    this.folder_name = object.folder_name;\n    this.repo_id = object.repo_id;\n    this.repo_name = object.repo_name;\n    this.share_type = object.share_type;\n    this.share_permission = object.share_permission;\n    if (object.share_type === 'group') {\n      this.group_id = object.group_id;\n      this.group_name = object.group_name;\n    } else {\n      this.user_name = object.user_name;\n      this.user_email = object.user_email;\n      this.contact_email = object.contact_email;\n    }\n  }\n\n}\n\nexport default SharedFolderInfo;\n","import React, { Fragment, Component } from 'react';\nimport { Link } from '@reach/router';\nimport { Dropdown, DropdownToggle, DropdownItem } from 'reactstrap';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport { gettext, siteRoot, isPro } from '../../utils/constants';\nimport Loading from '../../components/loading';\nimport EmptyTip from '../../components/empty-tip';\nimport toaster from '../../components/toast';\nimport SharePermissionEditor from '../../components/select-editor/share-permission-editor';\nimport SharedFolderInfo from '../../models/shared-folder-info';\nimport PermSelect from '../../components/dialog/perm-select';\n\nclass Content extends Component {\n\n  sortByName = (e) => {\n    e.preventDefault();\n    const sortBy = 'name';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortItems(sortBy, sortOrder);\n  }\n\n  render() {\n    const { loading, errorMsg, items, sortBy, sortOrder } = this.props;\n\n    if (loading) {\n      return <Loading />;\n    } else if (errorMsg) {\n      return <p className=\"error text-center\">{errorMsg}</p>;\n    } else {\n      const emptyTip = (\n        <EmptyTip>\n          <h2>{gettext('No folders shared')}</h2>\n          <p>{gettext('You have not shared any folders with other users yet. You can share a folder with other users by clicking the share icon to the right of a folder\\'s name.')}</p>\n        </EmptyTip>\n      );\n\n      // sort\n      const sortByName = sortBy == 'name';\n      const sortIcon = sortOrder == 'asc' ? <span className=\"fas fa-caret-up\"></span> : <span className=\"fas fa-caret-down\"></span>;\n\n      const isDesktop = Utils.isDesktop();\n      const table = (\n        <table className={`table-hover ${isDesktop ? '': 'table-thead-hidden'}`}>\n          <thead>\n            {isDesktop ? (\n              <tr>\n                <th width=\"4%\">{/*icon*/}</th>\n                <th width=\"34%\"><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortByName}>{gettext('Name')} {sortByName && sortIcon}</a></th>\n                <th width=\"30%\">{gettext('Share To')}</th>\n                <th width=\"24%\">{gettext('Permission')}</th>\n                <th width=\"8%\"></th>\n              </tr>\n            ) : (\n              <tr>\n                <th width=\"12%\"></th>\n                <th width=\"80%\"></th>\n                <th width=\"8%\"></th>\n              </tr>\n            )}\n          </thead>\n          <tbody>\n            {items.map((item, index) => {\n              return (<Item key={index} isDesktop={isDesktop} item={item} />);\n            })}\n          </tbody>\n        </table>\n      );\n\n      return items.length ? table : emptyTip;\n    }\n  }\n}\n\nclass Item extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      share_permission: this.props.item.share_permission,\n      isOpIconShown: false,\n      isOpMenuOpen: false, // for mobile\n      isPermSelectDialogOpen: false, // for mobile\n      unshared: false\n    };\n\n    this.permissions = ['rw', 'r'];\n    if (isPro) {\n      this.permissions.push('cloud-edit', 'preview');\n    }\n  }\n\n  toggleOpMenu = () => {\n    this.setState({\n      isOpMenuOpen: !this.state.isOpMenuOpen\n    });\n  }\n\n  togglePermSelectDialog = () => {\n    this.setState({\n      isPermSelectDialogOpen: !this.state.isPermSelectDialogOpen\n    });\n  }\n\n  onMouseEnter = () => {\n    this.setState({isOpIconShown: true});\n  }\n\n  onMouseLeave = () => {\n    this.setState({isOpIconShown: false});\n  }\n\n  unshare = (e) => {\n    e.preventDefault();\n\n    const item = this.props.item;\n    let options = {\n      'p': item.path\n    };\n    if (item.share_type == 'personal') {\n      Object.assign(options, {\n        'share_type': 'user',\n        'username': item.user_email\n      });\n    } else {\n      Object.assign(options, {\n        'share_type': item.share_type, // 'group'\n        'group_id': item.group_id\n      });\n    }\n\n    seafileAPI.unshareFolder(item.repo_id, options).then((res) => {\n      this.setState({\n        unshared: true\n      });\n      let message = gettext('Successfully unshared {name}').replace('{name}', item.folder_name);\n      toaster.success(message);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster(errMessage);\n    });\n  }\n\n  changePerm = (permission) => {\n    const item = this.props.item;\n    const postData = {\n      'permission': permission\n    };\n    let options = {\n      'p': item.path\n    };\n    if (item.share_type == 'personal') {\n      Object.assign(options, {\n        'share_type': 'user',\n        'username': item.user_email\n      });\n    } else {\n      Object.assign(options, {\n        'share_type': item.share_type, // 'group'\n        'group_id': item.group_id\n      });\n    }\n\n    seafileAPI.updateFolderSharePerm(item.repo_id, postData, options).then((res) => {\n      this.setState({share_permission: permission});\n      toaster.success(gettext('Successfully modified permission.'));\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    if (this.state.unshared) {\n      return null;\n    }\n\n    const item = this.props.item;\n    let { share_permission, isOpIconShown, isPermSelectDialogOpen } = this.state;\n\n    let is_readonly = false;\n    if (share_permission == 'r' || share_permission == 'preview') {\n      is_readonly = true;\n    }\n    let iconUrl = Utils.getFolderIconUrl(is_readonly);\n    let iconTitle = Utils.getFolderIconTitle({\n      'permission': share_permission\n    });\n    let folderUrl = `${siteRoot}library/${item.repo_id}/${encodeURIComponent(item.repo_name)}${Utils.encodePath(item.path)}`;\n\n    const desktopItem = (\n      <tr onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave}>\n        <td><img src={iconUrl} title={iconTitle} alt={iconTitle} width=\"24\" /></td>\n        <td><Link to={folderUrl}>{item.folder_name}</Link></td>\n        <td>\n          {item.share_type == 'personal' ?\n            <span title={item.contact_email}>{item.user_name}</span> : item.group_name}\n        </td>\n        <td>\n          <SharePermissionEditor\n            isTextMode={true}\n            isEditIconShow={isOpIconShown}\n            currentPermission={share_permission}\n            permissions={this.permissions}\n            onPermissionChanged={this.changePerm}\n          />\n        </td>\n        <td><a href=\"#\" className={`action-icon sf2-icon-x3 ${isOpIconShown ? '': 'invisible'}`} title={gettext('Unshare')} onClick={this.unshare}></a></td>\n      </tr>\n    );\n\n    const mobileItem = (\n      <Fragment>\n        <tr>\n          <td><img src={iconUrl} title={iconTitle} alt={iconTitle} width=\"24\" /></td>\n          <td>\n            <Link to={folderUrl}>{item.folder_name}</Link>\n            <span className=\"item-meta-info-highlighted\">{Utils.sharePerms(share_permission)}</span>\n            <br />\n            <span className=\"item-meta-info\">{`${gettext('Share To:')} ${item.share_type == 'personal' ? item.user_name : item.group_name}`}</span>\n          </td>\n          <td>\n            <Dropdown isOpen={this.state.isOpMenuOpen} toggle={this.toggleOpMenu}>\n              <DropdownToggle\n                tag=\"i\"\n                className=\"sf-dropdown-toggle fa fa-ellipsis-v ml-0\"\n                title={gettext('More Operations')}\n                data-toggle=\"dropdown\"\n                aria-expanded={this.state.isOpMenuOpen}\n              />\n              <div className={this.state.isOpMenuOpen ? '' : 'd-none'} onClick={this.toggleOpMenu}>\n                <div className=\"mobile-operation-menu-bg-layer\"></div>\n                <div className=\"mobile-operation-menu\">\n                  <DropdownItem className=\"mobile-menu-item\" onClick={this.togglePermSelectDialog}>{gettext('Permission')}</DropdownItem>\n                  <DropdownItem className=\"mobile-menu-item\" onClick={this.unshare}>{gettext('Unshare')}</DropdownItem>\n                </div>\n              </div>\n            </Dropdown>\n          </td>\n        </tr>\n        {isPermSelectDialogOpen &&\n        <PermSelect\n          currentPerm={share_permission}\n          permissions={this.permissions}\n          changePerm={this.changePerm}\n          toggleDialog={this.togglePermSelectDialog}\n        />\n        }\n      </Fragment>\n    );\n\n    return this.props.isDesktop ? desktopItem : mobileItem;\n  }\n}\n\nclass ShareAdminFolders extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      errorMsg: '',\n      items: [],\n      sortBy: 'name',\n      sortOrder: 'asc' // 'asc' or 'desc'\n    };\n  }\n\n  _sortItems = (items, sortBy, sortOrder) => {\n    let comparator;\n\n    switch (`${sortBy}-${sortOrder}`) {\n      case 'name-asc':\n        comparator = function(a, b) {\n          var result = Utils.compareTwoWord(a.folder_name, b.folder_name);\n          return result;\n        };\n        break;\n      case 'name-desc':\n        comparator = function(a, b) {\n          var result = Utils.compareTwoWord(a.folder_name, b.folder_name);\n          return -result;\n        };\n        break;\n    }\n\n    items.sort(comparator);\n    return items;\n  }\n\n  sortItems = (sortBy, sortOrder) => {\n    this.setState({\n      sortBy: sortBy,\n      sortOrder: sortOrder,\n      items: this._sortItems(this.state.items, sortBy, sortOrder)\n    });\n  }\n\n  componentDidMount() {\n    seafileAPI.listSharedFolders().then((res) => {\n      let items = res.data.map(item => {\n        return new SharedFolderInfo(item);\n      });\n      this.setState({\n        loading: false,\n        items: this._sortItems(items, this.state.sortBy, this.state.sortOrder)\n      });\n    }).catch((error) => {\n      this.setState({\n        loading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  render() {\n    return (\n      <div className=\"main-panel-center\">\n        <div className=\"cur-view-container\" id=\"share-admin-libs\">\n          <div className=\"cur-view-path\">\n            <h3 className=\"sf-heading\">{gettext('Folders')}</h3>\n          </div>\n          <div className=\"cur-view-content\">\n            <Content\n              errorMsg={this.state.errorMsg}\n              loading={this.state.loading}\n              items={this.state.items}\n              sortBy={this.state.sortBy}\n              sortOrder={this.state.sortOrder}\n              sortItems={this.sortItems}\n            />\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default ShareAdminFolders;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalBody } from 'reactstrap';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  currentPerm: PropTypes.string.isRequired,\n  permissions: PropTypes.array.isRequired,\n  changePerm: PropTypes.func.isRequired,\n  toggleDialog: PropTypes.func.isRequired\n};\n\nclass ShareLinkPermissionSelect extends React.Component {\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      currentOption: this.props.currentPerm\n    };\n  }\n\n  switchOption = (e) => {\n    if (!e.target.checked) {\n      return;\n    }\n\n    const currentOption = e.target.value;\n    this.setState({\n      currentOption: currentOption\n    });\n\n    this.props.changePerm(currentOption);\n    this.props.toggleDialog();\n  }\n\n  render() {\n    const options = this.props.permissions;\n    const { currentOption } = this.state;\n\n    return (\n      <Modal isOpen={true} toggle={this.props.toggleDialog}>\n        <ModalBody>\n          {options.map((item, index) => {\n            return (\n              <div className=\"d-flex\" key={index}>\n                <input id={`option-${index}`} className=\"mt-1\" type=\"radio\" name=\"permission\" value={item} checked={currentOption == item} onChange={this.switchOption} />\n                <label htmlFor={`option-${index}`} className=\"ml-2\">\n                  {Utils.getShareLinkPermissionObject(item).text}\n                </label>\n              </div>\n            );\n          })}\n        </ModalBody>\n      </Modal>\n    );\n  }\n}\n\nShareLinkPermissionSelect.propTypes = propTypes;\n\nexport default ShareLinkPermissionSelect;\n","import React, { Component, Fragment } from 'react';\nimport { Link } from '@reach/router';\nimport moment from 'moment';\nimport { Dropdown, DropdownToggle, DropdownItem } from 'reactstrap';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport { isPro, gettext, siteRoot, canGenerateUploadLink } from '../../utils/constants';\nimport ShareLink from '../../models/share-link';\nimport ShareLinkPermissionEditor from '../../components/select-editor/share-link-permission-editor';\nimport Loading from '../../components/loading';\nimport toaster from '../../components/toast';\nimport EmptyTip from '../../components/empty-tip';\nimport ShareLinkPermissionSelect from '../../components/dialog/share-link-permission-select';\nimport ShareAdminLink from '../../components/dialog/share-admin-link';\n\nclass Content extends Component {\n\n  sortByName = (e) => {\n    e.preventDefault();\n    const sortBy = 'name';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortItems(sortBy, sortOrder);\n  }\n\n  sortByTime = (e) => {\n    e.preventDefault();\n    const sortBy = 'time';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortItems(sortBy, sortOrder);\n  }\n\n  render() {\n    const { loading, errorMsg, items, sortBy, sortOrder } = this.props;\n\n    if (loading) {\n      return <Loading />;\n    } else if (errorMsg) {\n      return <p className=\"error text-center\">{errorMsg}</p>;\n    } else {\n      const emptyTip = (\n        <EmptyTip>\n          <h2>{gettext('No share links')}</h2>\n          <p>{gettext('You have not created any share links yet. A share link can be used to share files and folders with anyone. You can create a share link for a file or folder by clicking the share icon to the right of its name.')}</p>\n        </EmptyTip>\n      );\n\n      // sort\n      const sortByName = sortBy == 'name';\n      const sortByTime = sortBy == 'time';\n      const sortIcon = sortOrder == 'asc' ? <span className=\"fas fa-caret-up\"></span> : <span className=\"fas fa-caret-down\"></span>;\n\n      const isDesktop = Utils.isDesktop();\n      // only for some columns\n      const columnWidths = isPro ? ['14%', '7%', '14%'] : ['21%', '14%', '20%'];\n      const table = (\n        <table className={`table-hover ${isDesktop ? '': 'table-thead-hidden'}`}>\n          <thead>\n            {isDesktop ? (\n              <tr>\n                <th width=\"4%\">{/*icon*/}</th>\n                <th width=\"31%\"><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortByName}>{gettext('Name')} {sortByName && sortIcon}</a></th>\n                <th width={columnWidths[0]}>{gettext('Library')}</th>\n                {isPro && <th width=\"20%\">{gettext('Permission')}</th>}\n                <th width={columnWidths[1]}>{gettext('Visits')}</th>\n                <th width={columnWidths[2]}><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortByTime}>{gettext('Expiration')} {sortByTime && sortIcon}</a></th>\n                <th width=\"10%\">{/*Operations*/}</th>\n              </tr>\n            ) : (\n              <tr>\n                <th width=\"12%\"></th>\n                <th width=\"80%\"></th>\n                <th width=\"8%\"></th>\n              </tr>\n            )}\n          </thead>\n          <tbody>\n            {items.map((item, index) => {\n              return (<Item key={index} isDesktop={isDesktop} item={item} onRemoveLink={this.props.onRemoveLink} />);\n            })}\n          </tbody>\n        </table>\n      );\n\n      return items.length ? table : emptyTip;\n    }\n  }\n}\n\nclass Item extends Component {\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      isOpIconShown: false,\n      isOpMenuOpen: false, // for mobile\n      isPermSelectDialogOpen: false, // for mobile\n      isLinkDialogOpen: false,\n      permissionOptions: [],\n      currentPermission: '',\n    };\n  }\n\n  componentDidMount() {\n    if (isPro) {\n      this.updatePermissionOptions();\n    }\n  }\n\n  updatePermissionOptions = () => {\n    const item = this.props.item;\n    let itemType = item.is_dir ? (item.path === '/' ? 'library' : 'dir') : 'file';\n    let permission = item.repo_folder_permission;\n    let permissionOptions = Utils.getShareLinkPermissionList(itemType, permission, item.path, item.can_edit);\n    let currentPermission = Utils.getShareLinkPermissionStr(this.props.item.permissions);\n    this.setState({\n      permissionOptions: permissionOptions,\n      currentPermission: currentPermission\n    });\n  }\n\n  toggleOpMenu = () => {\n    this.setState({\n      isOpMenuOpen: !this.state.isOpMenuOpen\n    });\n  }\n\n  togglePermSelectDialog = () => {\n    this.setState({\n      isPermSelectDialogOpen: !this.state.isPermSelectDialogOpen\n    });\n  }\n\n  toggleLinkDialog = () => {\n    this.setState({\n      isLinkDialogOpen: !this.state.isLinkDialogOpen\n    });\n  }\n\n  handleMouseOver = () => {\n    this.setState({isOpIconShown: true});\n  }\n\n  handleMouseOut = () => {\n    this.setState({isOpIconShown: false});\n  }\n\n  viewLink = (e) => {\n    e.preventDefault();\n    this.toggleLinkDialog();\n  }\n\n  removeLink = (e) => {\n    e.preventDefault();\n    this.props.onRemoveLink(this.props.item);\n  }\n\n  renderExpiration = () => {\n    const item = this.props.item;\n    if (!item.expire_date) {\n      return '--';\n    }\n    const expire_date = moment(item.expire_date).format('YYYY-MM-DD');\n    const expire_time = moment(item.expire_date).format('YYYY-MM-DD HH:mm:ss');\n    return (<span className={item.is_expired ? 'error' : ''} title={expire_time}>{expire_date}</span>);\n  }\n\n  changePerm = (permission) => {\n    const item = this.props.item;\n    const permissionDetails = Utils.getShareLinkPermissionObject(permission).permissionDetails;\n    seafileAPI.updateShareLink(item.token, JSON.stringify(permissionDetails)).then(() => {\n      this.setState({\n        currentPermission: permission\n      });\n      let message = gettext('Successfully modified permission.');\n      toaster.success(message);\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    const item = this.props.item;\n    const { currentPermission, permissionOptions , isOpIconShown, isPermSelectDialogOpen, isLinkDialogOpen } = this.state;\n\n    let iconUrl, objUrl;\n    if (item.is_dir) {\n      let path = item.path === '/' ? '/' : item.path.slice(0, item.path.length - 1);\n      iconUrl = Utils.getFolderIconUrl(false);\n      objUrl = `${siteRoot}library/${item.repo_id}/${encodeURIComponent(item.repo_name)}${Utils.encodePath(path)}`;\n    } else {\n      iconUrl = Utils.getFileIconUrl(item.obj_name);\n      objUrl = `${siteRoot}lib/${item.repo_id}/file${Utils.encodePath(item.path)}`;\n    }\n\n    const desktopItem = (\n      <tr onMouseEnter={this.handleMouseOver} onMouseLeave={this.handleMouseOut}>\n        <td><img src={iconUrl} width=\"24\" alt=\"\" /></td>\n        <td>\n          {item.is_dir ?\n            <Link to={objUrl}>{item.obj_name}</Link> :\n            <a href={objUrl} target=\"_blank\">{item.obj_name}</a>\n          }\n        </td>\n        <td><Link to={`${siteRoot}library/${item.repo_id}/${encodeURIComponent(item.repo_name)}/`}>{item.repo_name}</Link></td>\n        {isPro &&\n        <td>\n          <ShareLinkPermissionEditor\n            isTextMode={true}\n            isEditIconShow={isOpIconShown && !item.is_expired}\n            currentPermission={currentPermission}\n            permissionOptions={permissionOptions}\n            onPermissionChanged={this.changePerm}\n          />\n        </td>\n        }\n        <td>{item.view_cnt}</td>\n        <td>{this.renderExpiration()}</td>\n        <td>\n          {!item.is_expired && <a href=\"#\" className={`sf2-icon-link action-icon ${isOpIconShown ? '': 'invisible'}`} title={gettext('View')} onClick={this.viewLink}></a>}\n          <a href=\"#\" className={`sf2-icon-delete action-icon ${isOpIconShown ? '': 'invisible'}`} title={gettext('Remove')} onClick={this.removeLink}></a>\n        </td>\n      </tr>\n    );\n\n    const mobileItem = (\n      <Fragment>\n        <tr>\n          <td><img src={iconUrl} alt=\"\" width=\"24\" /></td>\n          <td>\n            {item.is_dir ?\n              <Link to={objUrl}>{item.obj_name}</Link> :\n              <a href={objUrl} target=\"_blank\">{item.obj_name}</a>\n            }\n            {isPro && <span className=\"item-meta-info-highlighted\">{Utils.getShareLinkPermissionObject(currentPermission).text}</span>}\n            <br />\n            <span>{item.repo_name}</span><br />\n            <span className=\"item-meta-info\">{item.view_cnt}<span className=\"small text-secondary\">({gettext('Visits')})</span></span>\n            <span className=\"item-meta-info\">{this.renderExpiration()}<span className=\"small text-secondary\">({gettext('Expiration')})</span></span>\n          </td>\n          <td>\n            <Dropdown isOpen={this.state.isOpMenuOpen} toggle={this.toggleOpMenu}>\n              <DropdownToggle\n                tag=\"i\"\n                className=\"sf-dropdown-toggle fa fa-ellipsis-v ml-0\"\n                title={gettext('More Operations')}\n                data-toggle=\"dropdown\"\n                aria-expanded={this.state.isOpMenuOpen}\n              />\n              <div className={this.state.isOpMenuOpen ? '' : 'd-none'} onClick={this.toggleOpMenu}>\n                <div className=\"mobile-operation-menu-bg-layer\"></div>\n                <div className=\"mobile-operation-menu\">\n                  {(isPro && !item.is_expired) && <DropdownItem className=\"mobile-menu-item\" onClick={this.togglePermSelectDialog}>{gettext('Permission')}</DropdownItem>}\n                  {!item.is_expired && <DropdownItem className=\"mobile-menu-item\" onClick={this.viewLink}>{gettext('View')}</DropdownItem>}\n                  <DropdownItem className=\"mobile-menu-item\" onClick={this.removeLink}>{gettext('Remove')}</DropdownItem>\n                </div>\n              </div>\n            </Dropdown>\n          </td>\n        </tr>\n        {isPermSelectDialogOpen &&\n        <ShareLinkPermissionSelect\n          currentPerm={currentPermission}\n          permissions={permissionOptions}\n          changePerm={this.changePerm}\n          toggleDialog={this.togglePermSelectDialog}\n        />\n        }\n      </Fragment>\n    );\n\n    return (\n      <Fragment>\n        {this.props.isDesktop ? desktopItem : mobileItem}\n        {isLinkDialogOpen &&\n        <ShareAdminLink\n          link={item.link}\n          toggleDialog={this.toggleLinkDialog}\n        />\n        }\n      </Fragment>\n    );\n  }\n}\n\nclass ShareAdminShareLinks extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      errorMsg: '',\n      items: [],\n      sortBy: 'name', // 'name' or 'time'\n      sortOrder: 'asc' // 'asc' or 'desc'\n    };\n  }\n\n  _sortItems = (items, sortBy, sortOrder) => {\n    let comparator;\n\n    switch (`${sortBy}-${sortOrder}`) {\n      case 'name-asc':\n        comparator = function(a, b) {\n          var result = Utils.compareTwoWord(a.obj_name, b.obj_name);\n          return result;\n        };\n        break;\n      case 'name-desc':\n        comparator = function(a, b) {\n          var result = Utils.compareTwoWord(a.obj_name, b.obj_name);\n          return -result;\n        };\n        break;\n      case 'time-asc':\n        comparator = function(a, b) {\n          return a.expire_date < b.expire_date ? -1 : 1;\n        };\n        break;\n      case 'time-desc':\n        comparator = function(a, b) {\n          return a.expire_date < b.expire_date ? 1 : -1;\n        };\n        break;\n    }\n\n    items.sort((a, b) => {\n      if (a.is_dir && !b.is_dir) {\n        return -1;\n      } else if (!a.is_dir && b.is_dir) {\n        return 1;\n      } else {\n        return comparator(a, b);\n      }\n    });\n    return items;\n  }\n\n  sortItems = (sortBy, sortOrder) => {\n    this.setState({\n      sortBy: sortBy,\n      sortOrder: sortOrder,\n      items: this._sortItems(this.state.items, sortBy, sortOrder)\n    });\n  }\n\n  componentDidMount() {\n    seafileAPI.listUserShareLinks().then((res) => {\n      let items = res.data.map(item => {\n        return new ShareLink(item);\n      });\n      this.setState({\n        loading: false,\n        items: this._sortItems(items, this.state.sortBy, this.state.sortOrder)\n      });\n    }).catch((error) => {\n      this.setState({\n        loading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  onRemoveLink = (item) => {\n    seafileAPI.deleteShareLink(item.token).then(() => {\n      let items = this.state.items.filter(uploadItem => {\n        return uploadItem.token !== item.token;\n      });\n      this.setState({items: items});\n      let message = gettext('Successfully deleted 1 item.');\n      toaster.success(message);\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    return (\n      <div className=\"main-panel-center\">\n        <div className=\"cur-view-container\">\n          <div className=\"cur-view-path share-upload-nav\">\n            <ul className=\"nav\">\n              <li className=\"nav-item\">\n                <Link to={`${siteRoot}share-admin-share-links/`} className=\"nav-link active\">{gettext('Share Links')}</Link>\n              </li>\n              {canGenerateUploadLink && (\n                <li className=\"nav-item\"><Link to={`${siteRoot}share-admin-upload-links/`} className=\"nav-link\">{gettext('Upload Links')}</Link></li>\n              )}\n            </ul>\n          </div>\n          <div className=\"cur-view-content\">\n            <Content\n              loading={this.state.loading}\n              errorMsg={this.state.errorMsg}\n              items={this.state.items}\n              sortBy={this.state.sortBy}\n              sortOrder={this.state.sortOrder}\n              sortItems={this.sortItems}\n              onRemoveLink={this.onRemoveLink}\n            />\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default ShareAdminShareLinks;\n","import React, { Component, Fragment } from 'react';\nimport { Link } from '@reach/router';\nimport moment from 'moment';\nimport { Dropdown, DropdownToggle, DropdownItem } from 'reactstrap';\nimport { gettext, siteRoot, canGenerateShareLink } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../../components/toast';\nimport Loading from '../../components/loading';\nimport EmptyTip from '../../components/empty-tip';\nimport UploadLink from '../../models/upload-link';\nimport ShareAdminLink from '../../components/dialog/share-admin-link';\n\nclass Content extends Component {\n\n  render() {\n    const { loading, errorMsg, items } = this.props;\n\n    if (loading) {\n      return <Loading />;\n    }\n    if (errorMsg) {\n      return <p className=\"error text-center\">{errorMsg}</p>;\n    }\n\n    const emptyTip = (\n      <EmptyTip>\n        <h2>{gettext('No upload links')}</h2>\n        <p>{gettext('You have not created any upload links yet. An upload link allows anyone to upload files to a folder or library. You can create an upload link for a folder or library by clicking the share icon to the right of its name.')}</p>\n      </EmptyTip>\n    );\n\n    const isDesktop = Utils.isDesktop();\n    const table = (\n      <table className={`table-hover ${isDesktop ? '': 'table-thead-hidden'}`}>\n        <thead>\n          {isDesktop ? (\n            <tr>\n              <th width=\"4%\">{/*icon*/}</th>\n              <th width=\"30%\">{gettext('Name')}</th>\n              <th width=\"24%\">{gettext('Library')}</th>\n              <th width=\"16%\">{gettext('Visits')}</th>\n              <th width=\"16%\">{gettext('Expiration')}</th>\n              <th width=\"10%\">{/*Operations*/}</th>\n            </tr>\n          ) : (\n            <tr>\n              <th width=\"12%\"></th>\n              <th width=\"80%\"></th>\n              <th width=\"8%\"></th>\n            </tr>\n          )}\n        </thead>\n        <tbody>\n          {items.map((item, index) => {\n            return (<Item key={index} isDesktop={isDesktop} item={item} onRemoveLink={this.props.onRemoveLink}/>);\n          })}\n        </tbody>\n      </table>\n    );\n\n    return items.length ? table : emptyTip;\n  }\n}\n\nclass Item extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOpIconShown: false,\n      isOpMenuOpen: false, // for mobile\n      isLinkDialogOpen: false\n    };\n  }\n\n toggleOpMenu = () => {\n   this.setState({\n     isOpMenuOpen: !this.state.isOpMenuOpen\n   });\n }\n\n  toggleLinkDialog = () => {\n    this.setState({\n      isLinkDialogOpen: !this.state.isLinkDialogOpen\n    });\n  }\n\n  handleMouseOver = () => {\n    this.setState({isOpIconShown: true});\n  }\n\n  handleMouseOut = () => {\n    this.setState({isOpIconShown: false});\n  }\n\n  viewLink = (e) => {\n    e.preventDefault();\n    this.toggleLinkDialog();\n  }\n\n  removeLink = (e) => {\n    e.preventDefault();\n    this.props.onRemoveLink(this.props.item);\n  }\n\n  renderExpiration = () => {\n    const item = this.props.item;\n    if (!item.expire_date) {\n      return '--';\n    }\n    const expire_date = moment(item.expire_date).format('YYYY-MM-DD');\n    const expire_time = moment(item.expire_date).format('YYYY-MM-DD HH:mm:ss');\n    return (<span className={item.is_expired ? 'error' : ''} title={expire_time}>{expire_date}</span>);\n  }\n\n  render() {\n    let item = this.props.item;\n    const { isOpIconShown, isLinkDialogOpen } = this.state;\n\n    const iconUrl = Utils.getFolderIconUrl(false);\n    const repoUrl = `${siteRoot}library/${item.repo_id}/${encodeURIComponent(item.repo_name)}`;\n    const objUrl = `${repoUrl}${Utils.encodePath(item.path)}`;\n\n    const desktopItem = (\n      <tr onMouseOver={this.handleMouseOver} onMouseOut={this.handleMouseOut}>\n        <td><img src={iconUrl} alt=\"\" width=\"24\" /></td>\n        <td><Link to={objUrl}>{item.obj_name}</Link></td>\n        <td><Link to={repoUrl}>{item.repo_name}</Link></td>\n        <td>{item.view_cnt}</td>\n        <td>{this.renderExpiration()}</td>\n        <td>\n          {!item.is_expired && <a href=\"#\" className={`sf2-icon-link action-icon ${isOpIconShown ? '' : 'invisible'}`} title={gettext('View')} onClick={this.viewLink}></a>}\n          <a href=\"#\" className={`sf2-icon-delete action-icon ${isOpIconShown ? '' : 'invisible'}`} title={gettext('Remove')} onClick={this.removeLink}></a>\n        </td>\n      </tr>\n    );\n\n    const mobileItem = (\n      <tr>\n        <td><img src={iconUrl} alt=\"\" width=\"24\" /></td>\n        <td>\n          <Link to={objUrl}>{item.obj_name}</Link>\n          <br />\n          <span>{item.repo_name}</span><br />\n          <span className=\"item-meta-info\">{item.view_cnt}<span className=\"small text-secondary\">({gettext('Visits')})</span></span>\n          <span className=\"item-meta-info\">{this.renderExpiration()}<span className=\"small text-secondary\">({gettext('Expiration')})</span></span>\n        </td>\n        <td>\n          <Dropdown isOpen={this.state.isOpMenuOpen} toggle={this.toggleOpMenu}>\n            <DropdownToggle\n              tag=\"i\"\n              className=\"sf-dropdown-toggle fa fa-ellipsis-v ml-0\"\n              title={gettext('More Operations')}\n              data-toggle=\"dropdown\"\n              aria-expanded={this.state.isOpMenuOpen}\n            />\n            <div className={this.state.isOpMenuOpen ? '' : 'd-none'} onClick={this.toggleOpMenu}>\n              <div className=\"mobile-operation-menu-bg-layer\"></div>\n              <div className=\"mobile-operation-menu\">\n                {!item.is_expired && <DropdownItem className=\"mobile-menu-item\" onClick={this.viewLink}>{gettext('View')}</DropdownItem>}\n                <DropdownItem className=\"mobile-menu-item\" onClick={this.removeLink}>{gettext('Remove')}</DropdownItem>\n              </div>\n            </div>\n          </Dropdown>\n        </td>\n      </tr>\n    );\n    return (\n      <Fragment>\n        {this.props.isDesktop ? desktopItem : mobileItem}\n        {isLinkDialogOpen &&\n        <ShareAdminLink\n          link={item.link}\n          toggleDialog={this.toggleLinkDialog}\n        />\n        }\n      </Fragment>\n    );\n  }\n}\n\nclass ShareAdminUploadLinks extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      errorMsg: '',\n      items: []\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.listUserUploadLinks().then((res) => {\n      let items = res.data.map(item => {\n        return new UploadLink(item);\n      });\n      this.setState({\n        loading: false,\n        items: items\n      });\n    }).catch((error) => {\n      this.setState({\n        loading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  onRemoveLink = (item) => {\n    seafileAPI.deleteUploadLink(item.token).then(() => {\n      let items = this.state.items.filter(uploadItem => {\n        return uploadItem.token !== item.token;\n      });\n      this.setState({items: items});\n      const message = gettext('Successfully deleted 1 item.');\n      toaster.success(message);\n    }).catch((error) => {\n      const errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    return (\n      <div className=\"main-panel-center\">\n        <div className=\"cur-view-container\">\n          <div className=\"cur-view-path share-upload-nav\">\n            <ul className=\"nav\">\n              {canGenerateShareLink && (\n                <li className=\"nav-item\"><Link to={`${siteRoot}share-admin-share-links/`} className=\"nav-link\">{gettext('Share Links')}</Link></li>\n              )}\n              <li className=\"nav-item\"><Link to={`${siteRoot}share-admin-upload-links/`} className=\"nav-link active\">{gettext('Upload Links')}</Link></li>\n            </ul>\n          </div>\n          <div className=\"cur-view-content\">\n            <Content\n              loading={this.state.loading}\n              errorMsg={this.state.errorMsg}\n              items={this.state.items}\n              onRemoveLink={this.onRemoveLink}\n            />\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default ShareAdminUploadLinks;\n","import { Utils } from '../utils/utils';\n\nclass Repo {\n  constructor(object) {\n    this.repo_id = object.repo_id;\n    this.repo_name = object.repo_name;\n    this.permission = object.permission;\n    this.size_original = object.size;\n    this.size = Utils.bytesToSize(object.size);\n    this.owner_name = object.owner_name;\n    this.owner_email = object.owner_email;\n    this.owner_contact_email = object.owner_contact_email;\n    this.encrypted = object.encrypted;\n    this.last_modified = object.last_modified;\n    this.modifier_contact_email = object.modifier_contact_email;\n    this.modifier_email = object.modifier_email;\n    this.modifier_name = object.modifier_name;\n    this.type = object.type;\n    this.starred = object.starred;\n    this.status = object.status;\n    this.storage_name = object.storage_name;\n    if (object.is_admin != undefined) {\n      this.is_admin = object.is_admin;\n    }\n  }\n}\n\nexport default Repo;\n","import React from 'react';\nimport { gettext } from '../utils/constants';\n\nfunction LibsMobileThead() {\n  return (\n    <thead>\n      <tr>\n        <th width=\"12%\"><span className=\"sr-only\">{gettext('Library Type')}</span></th>\n        <th width=\"80%\"></th>\n        <th width=\"8%\"><span className=\"sr-only\">{gettext('Actions')}</span></th>\n      </tr>\n    </thead>\n  );\n}\n\nexport default LibsMobileThead;\n","import arrayWithHoles from \"@babel/runtime/helpers/esm/arrayWithHoles\";\nimport iterableToArrayLimit from \"@babel/runtime/helpers/esm/iterableToArrayLimit\";\nimport unsupportedIterableToArray from \"@babel/runtime/helpers/esm/unsupportedIterableToArray\";\nimport nonIterableRest from \"@babel/runtime/helpers/esm/nonIterableRest\";\nexport default function _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}","export default function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}","export default function _iterableToArrayLimit(arr, i) {\n  if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}","export default function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalBody } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\n\nconst propTypes = {\n  toggleDialog: PropTypes.func.isRequired,\n  sortBy: PropTypes.string.isRequired,\n  sortOrder: PropTypes.string.isRequired,\n  sortItems: PropTypes.func.isRequired\n};\n\nclass SortOptions extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.sortOptions = [\n      {value: 'name-asc', text: gettext('By name ascending')},\n      {value: 'name-desc', text: gettext('By name descending')},\n      {value: 'size-asc', text: gettext('By size ascending')},\n      {value: 'size-desc', text: gettext('By size descending')},\n      {value: 'time-asc', text: gettext('By time ascending')},\n      {value: 'time-desc', text: gettext('By time descending')}\n    ];\n    const { sortBy, sortOrder } = this.props;\n    this.state = {\n      currentOption: `${sortBy}-${sortOrder}`\n    };\n  }\n\n  switchOption = (e) => {\n    if (!e.target.checked) {\n      return;\n    }\n\n    this.setState({\n      currentOption: e.target.value\n    });\n\n    const [sortBy, sortOrder] = e.target.value.split('-');\n    this.props.sortItems(sortBy, sortOrder);\n    this.props.toggleDialog();\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true} toggle={this.props.toggleDialog}>\n        <ModalBody>\n          {this.sortOptions.map((item, index) => {\n            return (\n              <Fragment key={index}>\n                <input id={`option-${index}`} className=\"align-middle\" type=\"radio\" name=\"sort-option\" value={item.value} checked={this.state.currentOption == item.value} onChange={this.switchOption} />\n                <label htmlFor={`option-${index}`} className=\"align-middle m-2\">{item.text}</label><br />\n              </Fragment>\n            );\n          })}\n        </ModalBody>\n      </Modal>\n    );\n  }\n}\n\nSortOptions.propTypes = propTypes;\n\nexport default SortOptions;\n","import React, { Component, Fragment } from 'react';\nimport { Dropdown, DropdownToggle, DropdownItem } from 'reactstrap';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport cookie from 'react-cookies';\nimport { Link, navigate } from '@reach/router';\nimport { gettext, siteRoot, isPro } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../../components/toast';\nimport Repo from '../../models/repo';\nimport Loading from '../../components/loading';\nimport EmptyTip from '../../components/empty-tip';\nimport LibsMobileThead from '../../components/libs-mobile-thead';\nimport ModalPotal from '../../components/modal-portal';\nimport ShareDialog from '../../components/dialog/share-dialog';\nimport SortOptionsDialog from '../../components/dialog/sort-options';\n\nclass Content extends Component {\n\n  sortByName = (e) => {\n    e.preventDefault();\n    const sortBy = 'name';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortItems(sortBy, sortOrder);\n  }\n\n  sortByTime = (e) => {\n    e.preventDefault();\n    const sortBy = 'time';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortItems(sortBy, sortOrder);\n  }\n\n  sortBySize = (e) => {\n    e.preventDefault();\n    const sortBy = 'size';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortItems(sortBy, sortOrder);\n  }\n\n  render() {\n    const { loading, errorMsg, items, sortBy, sortOrder } = this.props;\n\n    const emptyTip = (\n      <EmptyTip>\n        <h2>{gettext('No shared libraries')}</h2>\n        <p>{gettext('No libraries have been shared directly with you. A shared library can be shared with full or restricted permission. If you need access to a library owned by another user, ask the user to share the library with you.')}</p>\n      </EmptyTip>\n    );\n\n    if (loading) {\n      return <Loading />;\n    } else if (errorMsg) {\n      return <p className=\"error text-center\">{errorMsg}</p>;\n    } else {\n      // sort\n      const sortByName = sortBy == 'name';\n      const sortByTime = sortBy == 'time';\n      const sortBySize = sortBy == 'size';\n      const sortIcon = sortOrder == 'asc' ? <span className=\"fas fa-caret-up\"></span> : <span className=\"fas fa-caret-down\"></span>;\n\n      const desktopThead = (\n        <thead>\n          <tr>\n            <th width=\"4%\"></th>\n            <th width=\"4%\"><span className=\"sr-only\">{gettext('Library Type')}</span></th>\n            <th width=\"34%\"><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortByName}>{gettext('Name')} {sortByName && sortIcon}</a></th>\n            <th width=\"10%\"><span className=\"sr-only\">{gettext('Actions')}</span></th>\n            <th width=\"14%\"><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortBySize}>{gettext('Size')} {sortBySize && sortIcon}</a></th>\n            <th width=\"18%\"><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortByTime}>{gettext('Last Update')} {sortByTime && sortIcon}</a></th>\n            <th width=\"16%\">{gettext('Owner')}</th>\n          </tr>\n        </thead>\n      );\n\n      const isDesktop = Utils.isDesktop();\n      const table = (\n        <table className={isDesktop ? '' : 'table-thead-hidden'}>\n          {isDesktop ? desktopThead : <LibsMobileThead />}\n          <tbody>\n            {items.map((item, index) => {\n              return <Item key={index} data={item} isDesktop={isDesktop} />;\n            })}\n          </tbody>\n        </table>\n      );\n\n      return items.length ? table : emptyTip;\n    }\n  }\n}\n\nContent.propTypes = {\n  loading: PropTypes.bool.isRequired,\n  errorMsg: PropTypes.string.isRequired,\n  items: PropTypes.array.isRequired,\n  sortBy: PropTypes.string.isRequired,\n  sortOrder: PropTypes.string.isRequired,\n  sortItems: PropTypes.func.isRequired\n};\n\nclass Item extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      showOpIcon: false,\n      unshared: false,\n      isShowSharedDialog: false,\n      isStarred: this.props.data.starred,\n      isOpMenuOpen: false // for mobile\n    };\n  }\n\n  toggleOpMenu = () => {\n    this.setState({\n      isOpMenuOpen: !this.state.isOpMenuOpen\n    });\n  }\n\n  handleMouseOver = () => {\n    this.setState({\n      showOpIcon: true\n    });\n  }\n\n  handleMouseOut = () => {\n    this.setState({\n      showOpIcon: false\n    });\n  }\n\n  share = (e) => {\n    e.preventDefault();\n    this.setState({isShowSharedDialog: true});\n  }\n\n  leaveShare = (e) => {\n    e.preventDefault();\n\n    const data = this.props.data;\n\n    let request;\n    if (data.owner_email.indexOf('@seafile_group') == -1) {\n      let options = {\n        'share_type': 'personal',\n        'from': data.owner_email\n      };\n      request = seafileAPI.leaveShareRepo(data.repo_id, options);\n    } else {\n      request = seafileAPI.leaveShareGroupOwnedRepo(data.repo_id);\n    }\n\n    request.then((res) => {\n      this.setState({unshared: true});\n      let message = gettext('Successfully unshared {name}').replace('{name}', data.repo_name);\n      toaster.success(message);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      if (errMessage === gettext('Error')) {\n        errMessage = gettext('Failed to unshare {name}').replace('{name}', data.repo_name);\n      }\n      toaster(errMessage);\n    });\n  }\n\n  toggleShareDialog = () => {\n    this.setState({isShowSharedDialog: false});\n  }\n\n  onStarRepo = () => {\n    const repoName = this.props.data.repo_name;\n    if (this.state.isStarred) {\n      seafileAPI.unstarItem(this.props.data.repo_id, '/').then(() => {\n        this.setState({isStarred: !this.state.isStarred});\n        const msg = gettext('Successfully unstarred {library_name_placeholder}.')\n          .replace('{library_name_placeholder}', repoName);\n        toaster.success(msg);\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    } else {\n      seafileAPI.starItem(this.props.data.repo_id, '/').then(() => {\n        this.setState({isStarred: !this.state.isStarred});\n        const msg = gettext('Successfully starred {library_name_placeholder}.')\n          .replace('{library_name_placeholder}', repoName);\n        toaster.success(msg);\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    }\n  }\n\n  visitRepo = () => {\n    navigate(this.repoURL);\n  }\n\n  render() {\n    if (this.state.unshared) {\n      return null;\n    }\n\n    const data = this.props.data;\n\n    data.icon_url = Utils.getLibIconUrl(data);\n    data.icon_title = Utils.getLibIconTitle(data);\n\n    let iconVisibility = this.state.showOpIcon ? '' : ' invisible';\n    let shareIconClassName = 'op-icon sf2-icon-share repo-share-btn' + iconVisibility;\n    let leaveShareIconClassName = 'op-icon sf2-icon-x3' + iconVisibility;\n    let shareRepoUrl = this.repoURL = `${siteRoot}library/${data.repo_id}/${Utils.encodePath(data.repo_name)}/`;\n    const desktopItem = (\n      <Fragment>\n        <tr onMouseOver={this.handleMouseOver} onMouseOut={this.handleMouseOut}>\n          <td className=\"text-center\">\n            {!this.state.isStarred && <i className=\"far fa-star star-empty cursor-pointer\" onClick={this.onStarRepo}></i>}\n            {this.state.isStarred && <i className=\"fas fa-star cursor-pointer\" onClick={this.onStarRepo}></i>}\n          </td>\n          <td><img src={data.icon_url} title={data.icon_title} alt={data.icon_title} width=\"24\" /></td>\n          <td><Link to={shareRepoUrl}>{data.repo_name}</Link></td>\n          <td>\n            {(isPro && data.is_admin) &&\n              <a href=\"#\" className={shareIconClassName} title={gettext('Share')} onClick={this.share}></a>\n            }\n            <a href=\"#\" className={leaveShareIconClassName} title={gettext('Leave Share')} onClick={this.leaveShare}></a>\n          </td>\n          <td>{data.size}</td>\n          <td title={moment(data.last_modified).format('llll')}>{moment(data.last_modified).fromNow()}</td>\n          <td title={data.owner_contact_email}>{data.owner_name}</td>\n        </tr>\n        {this.state.isShowSharedDialog && (\n          <ModalPotal>\n            <ShareDialog\n              itemType={'library'}\n              itemName={data.repo_name}\n              itemPath={'/'}\n              repoID={data.repo_id}\n              repoEncrypted={data.encrypted}\n              enableDirPrivateShare={true}\n              userPerm={data.permission}\n              isAdmin={true}\n              toggleDialog={this.toggleShareDialog}\n            />\n          </ModalPotal>\n        )}\n      </Fragment>\n    );\n\n    const mobileItem = (\n      <Fragment>\n        <tr onMouseOver={this.handleMouseOver} onMouseOut={this.handleMouseOut}>\n          <td onClick={this.visitRepo}><img src={data.icon_url} title={data.icon_title} alt={data.icon_title} width=\"24\" /></td>\n          <td onClick={this.visitRepo}>\n            <Link to={shareRepoUrl}>{data.repo_name}</Link><br />\n            <span className=\"item-meta-info\" title={data.owner_contact_email}>{data.owner_name}</span>\n            <span className=\"item-meta-info\">{data.size}</span>\n            <span className=\"item-meta-info\" title={moment(data.last_modified).format('llll')}>{moment(data.last_modified).fromNow()}</span>\n          </td>\n          <td>\n            <Dropdown isOpen={this.state.isOpMenuOpen} toggle={this.toggleOpMenu}>\n              <DropdownToggle\n                tag=\"i\"\n                className=\"sf-dropdown-toggle fa fa-ellipsis-v ml-0\"\n                title={gettext('More Operations')}\n                data-toggle=\"dropdown\"\n                aria-expanded={this.state.isOpMenuOpen}\n              />\n              <div className={this.state.isOpMenuOpen ? '' : 'd-none'} onClick={this.toggleOpMenu}>\n                <div className=\"mobile-operation-menu-bg-layer\"></div>\n                <div className=\"mobile-operation-menu\">\n                  <DropdownItem className=\"mobile-menu-item\" onClick={this.onStarRepo}>{this.state.isStarred ? gettext('Unstar') : gettext('Star')}</DropdownItem>\n                  {(isPro && data.is_admin) &&\n                  <DropdownItem className=\"mobile-menu-item\" onClick={this.share}>{gettext('Share')}</DropdownItem>\n                  }\n                  <DropdownItem className=\"mobile-menu-item\" onClick={this.leaveShare}>{gettext('Leave Share')}</DropdownItem>\n                </div>\n              </div>\n            </Dropdown>\n          </td>\n        </tr>\n        {this.state.isShowSharedDialog && (\n          <ModalPotal>\n            <ShareDialog\n              itemType={'library'}\n              itemName={data.repo_name}\n              itemPath={'/'}\n              repoID={data.repo_id}\n              repoEncrypted={data.encrypted}\n              enableDirPrivateShare={true}\n              userPerm={data.permission}\n              isAdmin={true}\n              toggleDialog={this.toggleShareDialog}\n            />\n          </ModalPotal>\n        )}\n      </Fragment>\n    );\n\n    return this.props.isDesktop ? desktopItem : mobileItem;\n  }\n}\n\nItem.propTypes = {\n  isDesktop: PropTypes.bool.isRequired,\n  data: PropTypes.object.isRequired\n};\n\nclass SharedLibraries extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      errorMsg: '',\n      items: [],\n      sortBy: cookie.load('seafile-repo-dir-sort-by') || 'name', // 'name' or 'time' or 'size'\n      sortOrder: cookie.load('seafile-repo-dir-sort-order') || 'asc', // 'asc' or 'desc'\n      isSortOptionsDialogOpen: false\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.listRepos({type:'shared'}).then((res) => {\n      let repoList = res.data.repos.map((item) => {\n        return new Repo(item);\n      });\n      this.setState({\n        loading: false,\n        items: Utils.sortRepos(repoList, this.state.sortBy, this.state.sortOrder)\n      });\n    }).catch((error) => {\n      this.setState({\n        loading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  sortItems = (sortBy, sortOrder) => {\n    cookie.save('seafile-repo-dir-sort-by', sortBy);\n    cookie.save('seafile-repo-dir-sort-order', sortOrder);\n    this.setState({\n      sortBy: sortBy,\n      sortOrder: sortOrder,\n      items: Utils.sortRepos(this.state.items, sortBy, sortOrder)\n    });\n  }\n\n  toggleSortOptionsDialog = () => {\n    this.setState({\n      isSortOptionsDialogOpen: !this.state.isSortOptionsDialogOpen\n    });\n  }\n\n  render() {\n    return (\n      <Fragment>\n        <div className=\"main-panel-center\">\n          <div className=\"cur-view-container\">\n            <div className=\"cur-view-path\">\n              <h3 className=\"sf-heading m-0\">{gettext('Shared with me')}</h3>\n              {(!Utils.isDesktop() && this.state.items.length > 0) && <span className=\"sf3-font sf3-font-sort action-icon\" onClick={this.toggleSortOptionsDialog}></span>}\n            </div>\n            <div className=\"cur-view-content\">\n              <Content\n                loading={this.state.loading}\n                errorMsg={this.state.errorMsg}\n                items={this.state.items}\n                sortBy={this.state.sortBy}\n                sortOrder={this.state.sortOrder}\n                sortItems={this.sortItems}\n              />\n            </div>\n          </div>\n        </div>\n        {this.state.isSortOptionsDialogOpen &&\n        <SortOptionsDialog\n          toggleDialog={this.toggleSortOptionsDialog}\n          sortBy={this.state.sortBy}\n          sortOrder={this.state.sortOrder}\n          sortItems={this.sortItems}\n        />\n        }\n      </Fragment>\n    );\n  }\n}\n\nexport default SharedLibraries;\n","import React, { Component, Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport { Link } from '@reach/router';\nimport { gettext, siteRoot } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../../components/toast';\nimport Loading from '../../components/loading';\nimport EmptyTip from '../../components/empty-tip';\n\nclass Content extends Component {\n\n  render() {\n    const { loading, errorMsg, items } = this.props;\n\n    const emptyTip = (\n      <EmptyTip>\n        <h2>{gettext('No libraries have been shared with you')}</h2>\n        <p>{gettext('No libraries have been shared with you from other servers.')}</p>\n      </EmptyTip>\n    );\n\n    if (loading) {\n      return <Loading />;\n    } else if (errorMsg) {\n      return <p className=\"error text-center\">{errorMsg}</p>;\n    } else {\n      const table = (\n        <table>\n          <thead>\n            <tr>\n              <th width=\"4%\"></th>\n              <th width=\"20%\">{gettext('Name')}</th>\n              <th width=\"20%\">{gettext('Shared by')}</th>\n              <th width=\"26%\">{gettext('At server')}</th>\n              <th width=\"20%\">{gettext('Time')}</th>\n              <th width=\"10%\">{/* operations */}</th>\n            </tr>\n          </thead>\n          <tbody>\n            {items.map((item, index) => {\n              return <Item\n                key={index}\n                item={item}\n                leaveShare={this.props.leaveShare}\n              />;\n            })}\n          </tbody>\n        </table>\n      );\n\n      return items.length ? table : emptyTip;\n    }\n  }\n}\n\nContent.propTypes = {\n  loading: PropTypes.bool.isRequired,\n  errorMsg: PropTypes.string.isRequired,\n  items: PropTypes.array.isRequired,\n};\n\nclass Item extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOpIconShown: false\n    };\n  }\n\n  handleMouseOver = () => {\n    this.setState({\n      isOpIconShown: true\n    });\n  }\n\n  handleMouseOut = () => {\n    this.setState({\n      isOpIconShown: false\n    });\n  }\n\n  leaveShare = (e) => {\n    e.preventDefault();\n    this.props.leaveShare(this.props.item);\n  }\n\n  render() {\n    const item = this.props.item;\n    const { isOpIconShown } = this.state;\n\n    item.icon_url = Utils.getLibIconUrl(item);\n    item.icon_title = Utils.getLibIconTitle(item);\n\n    let shareRepoUrl =`${siteRoot}remote-library/${this.props.item.provider_id}/${this.props.item.repo_id}/${Utils.encodePath(this.props.item.repo_name)}/`;\n    return (\n      <tr onMouseOver={this.handleMouseOver} onMouseOut={this.handleMouseOut}>\n        <td><img src={item.icon_url} title={item.icon_title} alt={item.icon_title} width=\"24\" /></td>\n        <td><Link to={shareRepoUrl}>{item.repo_name}</Link></td>\n        <td>{item.from_user}</td>\n        <td>{item.from_server_url}</td>\n        <td title={moment(item.last_modified).format('llll')}>{moment(item.ctime).fromNow()}</td>\n        <td>\n          <a href=\"#\" className={`action-icon sf2-icon-x3 ${isOpIconShown ? '' : 'invisible'}`} title={gettext('Leave Share')} onClick={this.leaveShare}></a>\n        </td>\n      </tr>\n    );\n  }\n}\n\nItem.propTypes = {\n  item: PropTypes.object.isRequired\n};\n\nclass SharedWithOCM extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      errorMsg: '',\n      items: []\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.listOCMSharesReceived().then((res) => {\n      this.setState({\n        loading: false,\n        items: res.data.ocm_share_received_list\n      });\n    }).catch((error) => {\n      this.setState({\n        loading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  leaveShare = (item) => {\n    const { id, repo_name } = item;\n    seafileAPI.deleteOCMShareReceived(id).then((res) => {\n      let items = this.state.items.filter(item => {\n        return item.id != id;\n      });\n      this.setState({items: items});\n      toaster.success(gettext('Successfully unshared {name}').replace('{name}', repo_name));\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    return (\n      <Fragment>\n        <div className=\"main-panel-center\">\n          <div className=\"cur-view-container\">\n            <div className=\"cur-view-path\">\n              <h3 className=\"sf-heading m-0\">{gettext('Shared from other servers')}</h3>\n            </div>\n            <div className=\"cur-view-content\">\n              <Content\n                loading={this.state.loading}\n                errorMsg={this.state.errorMsg}\n                items={this.state.items}\n                leaveShare={this.leaveShare}\n              />\n            </div>\n          </div>\n        </div>\n      </Fragment>\n    );\n  }\n}\n\nexport default SharedWithOCM;\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport Account from '../../components/common/account';\n\nconst propTypes = {\n  children: PropTypes.object\n};\n\nclass MainPanelTopbar extends Component {\n\n  render() {\n    return (\n      <div className={`main-panel-north ${this.props.children ? 'border-left-show' : ''}`}>\n        <div className=\"cur-view-toolbar\">\n          <span className=\"sf2-icon-menu side-nav-toggle hidden-md-up d-md-none\" title=\"Side Nav Menu\"></span>\n          <div className=\"operation\">\n            {this.props.children}\n          </div>\n        </div>\n        <div className=\"common-toolbar\">\n          <Account isAdminPanel={false} />\n        </div>\n      </div>\n    );\n  }\n}\n\nMainPanelTopbar.propTypes = propTypes;\n\nexport default MainPanelTopbar;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Link } from '@reach/router';\nimport { siteRoot, gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  repoName: PropTypes.string.isRequired,\n  currentPath: PropTypes.string.isRequired,\n  onPathClick: PropTypes.func.isRequired,\n  onTabNavClick: PropTypes.func.isRequired,\n  repoID: PropTypes.string.isRequired,\n};\n\nclass DirPath extends React.Component {\n\n  onPathClick = (e) => {\n    let path = Utils.getEventData(e, 'path');\n    this.props.onPathClick(path);\n  }\n\n  turnPathToLink = (path) => {\n    path = path[path.length - 1] === '/' ? path.slice(0, path.length - 1) : path;\n    let pathList = path.split('/');\n    let nodePath = '';\n    let pathElem = pathList.map((item, index) => {\n      if (item === '') {\n        return;\n      }\n      if (index === (pathList.length - 1)) {\n        return (\n          <Fragment key={index}>\n            <span className=\"path-split\">/</span>\n            <span className=\"path-file-name\">{item}</span>\n          </Fragment>\n        );\n      } else {\n        nodePath += '/' + item;\n        return (\n          <Fragment key={index} >\n            <span className=\"path-split\">/</span>\n            <a className=\"path-link\" data-path={nodePath} onClick={this.onPathClick}>{item}</a>\n          </Fragment>\n        );\n      }\n    });\n    return pathElem;\n  }\n\n  render() {\n    let { currentPath, repoName } = this.props;\n    let pathElem = this.turnPathToLink(currentPath);\n\n    return (\n      <div className=\"path-container\">\n        <Link to={siteRoot + 'shared-with-ocm/'} className=\"normal\" onClick={(e) => this.props.onTabNavClick('shared-with-ocm')}>{gettext('All')}</Link>\n        <span className=\"path-split\">/</span>\n        {(currentPath === '/' || currentPath === '') ?\n          <span className=\"path-repo-name\">{repoName}</span>:\n          <a className=\"path-link\" data-path=\"/\" onClick={this.onPathClick}>{repoName}</a>\n        }\n        {pathElem}\n      </div>\n    );\n  }\n}\n\nDirPath.propTypes = propTypes;\n\nexport default DirPath;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Link } from '@reach/router';\nimport moment from 'moment';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport Loading from '../../components/loading';\n\nclass DirentItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOpIconShown: false\n    };\n  }\n\n  handleMouseOver = () => {\n    this.setState({\n      isOpIconShown: true\n    });\n  }\n\n  handleMouseOut = () => {\n    this.setState({\n      isOpIconShown: false\n    });\n  }\n\n  openFolder = () => {\n    this.props.openFolder(this.props.dirent);\n  }\n\n  downloadDirent = (e) => {\n    e.preventDefault();\n    this.props.downloadDirent(this.props.dirent);\n  }\n\n  render () {\n    let { isOpIconShown } = this.state;\n    let { dirent } = this.props;\n    let iconUrl = Utils.getDirentIcon(dirent);\n\n    return (\n      <Fragment>\n        <tr onMouseEnter={this.handleMouseOver} onMouseLeave={this.handleMouseOut}>\n          <td className=\"text-center\"><img src={iconUrl} width=\"24\" alt='' /></td>\n          <td>\n            {dirent.is_file ?\n              dirent.name :\n              <Link to=\"#\" onClick={this.openFolder}>{dirent.name}</Link>\n            }\n          </td>\n          <td>\n            {isOpIconShown && dirent.is_file &&\n            <a href=\"#\" className=\"op-icon sf2-icon-download\" title={gettext('Download')} onClick={this.downloadDirent}></a>\n            }\n          </td>\n          <td>{Utils.bytesToSize(dirent.size)}</td>\n          <td>{moment(dirent.mtime).fromNow()}</td>\n        </tr>\n      </Fragment>\n    );\n  }\n}\n\n\nconst propTypes = {\n  direntList: PropTypes.array.isRequired\n};\n\nclass DirContent extends React.Component {\n\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    let { loading, errorMsg, direntList } = this.props;\n\n    if (loading) {\n      return <Loading />;\n    }\n\n    if (errorMsg) {\n      return <p className=\"error text-center mt-4\">{errorMsg}</p>;\n    }\n\n    return (\n      <Fragment>\n        <table className=\"table-hover\">\n          <thead>\n            <tr>\n              <th width=\"5%\">{/*icon*/}</th>\n              <th width=\"55%\">{gettext('Name')}</th>\n              <th width=\"10%\">{/*operation*/}</th>\n              <th width=\"15%\">{gettext('Size')}</th>\n              <th width=\"15%\">{gettext('Last Update')}</th>\n            </tr>\n          </thead>\n          <tbody>\n            {direntList.map((dirent, index) => {\n              return <DirentItem\n                key={index}\n                dirent={dirent}\n                openFolder={this.props.openFolder}\n                deleteDirent={this.props.deleteDirent}\n                downloadDirent={this.props.downloadDirent}\n                fromSystemRepo={this.props.fromSystemRepo}\n              />;\n            })}\n          </tbody>\n        </table>\n      </Fragment>\n    );\n  }\n}\n\nDirContent.propTypes = propTypes;\n\nexport default DirContent;\n","import React, { Component, Fragment } from 'react';\nimport { Button } from 'reactstrap';\nimport { post } from 'axios';\nimport { Utils } from '../../utils/utils';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { loginUrl, siteRoot, gettext } from '../../utils/constants';\nimport toaster from '../../components/toast';\nimport MainPanelTopbar from './remote-dir-topbar';\nimport DirPathBar from './remote-dir-path';\nimport DirContent from './remote-dir-content';\n\nclass Dirent {\n  constructor(obj) {\n    this.name = obj.name;\n    this.mtime = obj.mtime;\n    this.size = obj.size;\n    this.is_file = obj.type === 'file';\n  }\n\n  isDir() {\n    return !this.is_file;\n  }\n}\n\nclass DirView extends Component {\n\n  constructor(props) {\n    super(props);\n    this.fileInput = React.createRef();\n    this.state = {\n      loading: true,\n      errorMsg: '',\n      repoName: '',\n      path: '',\n      direntList: [],\n      isNewFolderDialogOpen: false,\n      userPerm: '',\n    };\n  }\n\n  componentDidMount () {\n    this.loadDirentList('/');\n  }\n\n  onPathClick = (path) => {\n    this.loadDirentList(path);\n  }\n\n  openFolder = (dirent) => {\n    let direntPath = Utils.joinPath(this.state.path, dirent.name);\n    if (!dirent.is_file) {\n      this.loadDirentList(direntPath);\n    }\n  }\n\n  loadDirentList = (path) => {\n    const { providerID, repoID } = this.props;\n    seafileAPI.listOCMRepoDir(providerID, repoID, path).then(res => {\n      const { repo_name: repoName, dirent_list, user_perm } = res.data;\n      let direntList = [];\n      dirent_list.forEach(item => {\n        let dirent = new Dirent(item);\n        direntList.push(dirent);\n      });\n      this.setState({\n        loading: false,\n        repoName: repoName,\n        direntList: direntList,\n        path: path,\n        userPerm: user_perm,\n      }, () => {\n        let url =`${siteRoot}remote-library/${providerID}/${repoID}/${repoName}${Utils.encodePath(path)}`;\n        window.history.replaceState({url: url, path: path}, path, url);\n      });\n    }).catch((error) => {\n      this.setState({\n        loading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  downloadDirent = (dirent) => {\n    let path = Utils.joinPath(this.state.path, dirent.name);\n    seafileAPI.getOCMRepoDownloadURL(this.props.providerID, this.props.repoID, path).then(res => {\n      location.href = res.data;\n    }).catch((err) => {\n      let errMessage = Utils.getErrorMsg(err);\n      toaster.danger(errMessage);\n    });\n  }\n\n  openFileInput = () => {\n    this.fileInput.current.click();\n  }\n\n  onFileInputChange = () => {\n    if (!this.fileInput.current.files.length) {\n      return;\n    }\n    const file = this.fileInput.current.files[0];\n\n    let { path } = this.state;\n    let { providerID, repoID } = this.props;\n    seafileAPI.getOCMRepoUploadURL(providerID, repoID, path).then(res => {\n      let formData = new FormData();\n      formData.append('parent_dir', path);\n      formData.append('file', file);\n      post(res.data, formData).then(res => {\n        const fileObj = res.data[0];\n        let newDirent = new Dirent({\n          'type': 'file',\n          'name': fileObj.name,\n          'size': fileObj.size,\n          'mtime': (new Date()).getTime()\n        });\n        let direntList = this.state.direntList;\n        const dirs = direntList.filter(item => { return !item.is_file; });\n        direntList.splice(dirs.length, 0, newDirent);\n        this.setState({\n          direntList: direntList\n        });\n      });\n    }).catch((err) => {\n      let errMessage = Utils.getErrorMsg(err);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    const { loading, errorMsg,\n      repoName, direntList, path, userPerm } = this.state;\n    const { repoID } = this.props;\n\n    return (\n      <Fragment>\n        <MainPanelTopbar>\n          <Fragment>\n            <input className=\"d-none\" type=\"file\" onChange={this.onFileInputChange} ref={this.fileInput} />\n            {userPerm === 'rw' &&\n              <Button className=\"operation-item\" onClick={this.openFileInput}>{gettext('Upload')}</Button>\n            }\n          </Fragment>\n        </MainPanelTopbar>\n        <div className=\"main-panel-center flex-row\">\n          <div className=\"cur-view-container\">\n            <div className=\"cur-view-path align-items-center\">\n              <DirPathBar\n                repoID={repoID}\n                repoName={repoName}\n                currentPath={path}\n                onPathClick={this.onPathClick}\n                onTabNavClick={this.props.onTabNavClick}\n              />\n            </div>\n            <div className=\"cur-view-content\">\n              <DirContent\n                loading={loading}\n                errorMsg={errorMsg}\n                direntList={direntList}\n                openFolder={this.openFolder}\n                deleteDirent={this.deleteDirent}\n                downloadDirent={this.downloadDirent}\n              />\n            </div>\n          </div>\n        </div>\n      </Fragment>\n    );\n  }\n}\n\nexport default DirView;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Select from 'react-select';\nimport { Button, Modal, ModalHeader, Input, ModalBody, ModalFooter, Form, FormGroup, Label, Alert } from 'reactstrap';\nimport { gettext, enableEncryptedLibrary, repoPasswordMinLength, storages, libraryTemplates } from '../../utils/constants';\n\nconst propTypes = {\n  libraryType: PropTypes.string.isRequired,\n  onCreateRepo: PropTypes.func.isRequired,\n  onCreateToggle: PropTypes.func.isRequired,\n};\n\nclass CreateRepoDialog extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      repoName: '',\n      disabled: true,\n      encrypt: false,\n      password1: '',\n      password2: '',\n      errMessage: '',\n      permission: 'rw',\n      storage_id: storages.length ? storages[0].id : '',\n      library_template: libraryTemplates.length ? libraryTemplates[0] : '',\n      isSubmitBtnActive: false,\n    };\n    this.newInput = React.createRef();\n  }\n\n  handleRepoNameChange = (e) => {\n    if (!e.target.value.trim()) {\n      this.setState({isSubmitBtnActive: false});\n    } else {\n      this.setState({isSubmitBtnActive: true});\n    }\n\n    this.setState({repoName: e.target.value});\n  }\n\n  handlePassword1Change = (e) => {\n    this.setState({password1: e.target.value});\n  }\n\n  handlePassword2Change = (e) => {\n    this.setState({password2: e.target.value});\n  }\n\n  handleSubmit = () => {\n    let isValid = this.validateInputParams();\n    if (isValid) {\n      let repoData = this.prepareRepoData();\n      if (this.props.libraryType === 'department') {\n        this.props.onCreateRepo(repoData, 'department');\n        return;\n      }\n      this.props.onCreateRepo(repoData);\n    }\n  }\n\n  handleKeyPress = (e) => {\n    if (e.key === 'Enter') {\n      this.handleSubmit();\n      e.preventDefault();\n    }\n  }\n\n  toggle = () => {\n    this.props.onCreateToggle();\n  }\n\n  componentDidMount() {\n    this.newInput.focus();\n  }\n\n  validateInputParams() {\n    let errMessage = '';\n    let repoName = this.state.repoName.trim();\n    if (!repoName.length) {\n      errMessage = gettext('Name is required');\n      this.setState({errMessage: errMessage});\n      return false;\n    }\n    if (repoName.indexOf('/') > -1) {\n      errMessage = gettext('Name should not include \\'/\\'.');\n      this.setState({errMessage: errMessage});\n      return false;\n    }\n    if (this.state.encrypt) {\n      let password1 = this.state.password1.trim();\n      let password2 = this.state.password2.trim();\n      if (!password1.length) {\n        errMessage = gettext('Please enter password');\n        this.setState({errMessage: errMessage});\n        return false;\n      }\n      if (!password2.length) {\n        errMessage = gettext('Please enter the password again');\n        this.setState({errMessage: errMessage});\n        return false;\n      }\n      if (password1.length < repoPasswordMinLength) {\n        errMessage = gettext('Password is too short');\n        this.setState({errMessage: errMessage});\n        return false;\n      }\n      if (password1 !== password2) {\n        errMessage = gettext('Passwords don\\'t match');\n        this.setState({errMessage: errMessage});\n        return false;\n      }\n    }\n    return true;\n  }\n\n  onPermissionChange = (e) => {\n    let permission = e.target.value;\n    this.setState({permission: permission});\n  }\n\n  handleStorageInputChange = (selectedItem) => {\n    this.setState({storage_id: selectedItem.value});\n  }\n\n  handlelibraryTemplatesInputChange = (selectedItem) => {\n    this.setState({library_template: selectedItem.value});\n  }\n\n  onEncrypted = (e) => {\n    let isChecked = e.target.checked;\n    this.setState({\n      encrypt: isChecked,\n      disabled: !isChecked\n    });\n  }\n\n  prepareRepoData = () => {\n    let libraryType = this.props.libraryType;\n\n    let repoName = this.state.repoName.trim();\n    let password = this.state.encrypt ? this.state.password1 : '';\n    let permission = this.state.permission;\n\n    let repo = null;\n    if (libraryType === 'mine' || libraryType === 'public') {\n      repo = {\n        name: repoName,\n        passwd: password\n      };\n    }\n    if (libraryType === 'group') {\n      repo = {\n        repo_name: repoName,\n        password: password,\n        permission: permission,\n      };\n    }\n    if (libraryType === 'department') {\n      repo = {\n        repo_name: repoName,\n        passwd: password,\n      };\n    }\n\n    const storage_id = this.state.storage_id;\n    if (storage_id) {\n      repo.storage_id = storage_id;\n    }\n\n    const library_template = this.state.library_template;\n    if (library_template) {\n      repo.library_template = library_template;\n    }\n\n    return repo;\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true} toggle={this.toggle}>\n        <ModalHeader toggle={this.toggle}>{gettext('New Library')}</ModalHeader>\n        <ModalBody>\n          <Form>\n            <FormGroup>\n              <Label for=\"repoName\">{gettext('Name')}</Label>\n              <Input\n                id=\"repoName\"\n                onKeyPress={this.handleKeyPress}\n                innerRef={input => {this.newInput = input;}}\n                value={this.state.repoName}\n                onChange={this.handleRepoNameChange}\n              />\n            </FormGroup>\n\n            {libraryTemplates.length > 0 && (\n              <FormGroup>\n                <Label for=\"library-template\">{gettext('Template')}</Label>\n                <Select\n                  id=\"library-template\"\n                  defaultValue={{value: libraryTemplates[0], label: libraryTemplates[0]}}\n                  options={libraryTemplates.map((item, index) => { return {value: item, label: item}; })}\n                  onChange={this.handlelibraryTemplatesInputChange}\n                /> \n              </FormGroup>\n            )}\n\n            {storages.length > 0 && (\n              <FormGroup>\n                <Label for=\"storage-backend\">{gettext('Storage Backend')}</Label>\n                <Select\n                  id=\"storage-backend\"\n                  defaultValue={{value: storages[0].id, label: storages[0].name}}\n                  options={storages.map((item, index) => { return {value: item.id, label: item.name}; })}\n                  onChange={this.handleStorageInputChange}\n                />\n              </FormGroup>\n            )}\n\n            {this.props.libraryType === 'group' && (\n              <FormGroup>\n                <Label for=\"exampleSelect\">{gettext('Permission')}</Label>\n                <Input type=\"select\" name=\"select\" id=\"exampleSelect\" onChange={this.onPermissionChange} value={this.state.permission}>\n                  <option value='rw'>{gettext('Read-Write')}</option>\n                  <option value='r'>{gettext('Read-Only')}</option>\n                </Input>\n              </FormGroup>\n            )}\n            {enableEncryptedLibrary &&\n              <div>\n                <FormGroup check>\n                  <Input type=\"checkbox\" id=\"encrypt\" onChange={this.onEncrypted} />\n                  <Label for=\"encrypt\">{gettext('Encrypt')}</Label>\n                </FormGroup>\n                {!this.state.disabled &&\n                  <FormGroup>\n                    {/* todo translate */}\n                    <Label for=\"passwd1\">{gettext('Password')}</Label><span className=\"tip\">{' '}{gettext('(at least {placeholder} characters)').replace('{placeholder}', repoPasswordMinLength)}</span>\n                    <Input\n                      id=\"passwd1\"\n                      type=\"password\"\n                      disabled={this.state.disabled}\n                      value={this.state.password1}\n                      onChange={this.handlePassword1Change}\n                      autoComplete=\"new-password\"\n                    />\n                  </FormGroup>\n                }\n                {!this.state.disabled &&\n                  <FormGroup>\n                    <Label for=\"passwd2\">{gettext('Password again')}</Label>\n                    <Input\n                      id=\"passwd2\"\n                      type=\"password\"\n                      disabled={this.state.disabled}\n                      value={this.state.password2}\n                      onChange={this.handlePassword2Change}\n                      autoComplete=\"new-password\"\n                    />\n                  </FormGroup>\n                }\n              </div>\n            }\n          </Form>\n          {this.state.errMessage && <Alert color=\"danger\">{this.state.errMessage}</Alert>}\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.handleSubmit} disabled={!this.state.isSubmitBtnActive}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nCreateRepoDialog.propTypes = propTypes;\n\nexport default CreateRepoDialog;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Utils } from '../../utils/utils';\nimport { Link } from '@reach/router';\nimport { siteRoot, gettext } from '../../utils/constants';\nimport ModalPortal from '../modal-portal';\nimport CreateRepoDialog from '../dialog/create-repo-dialog';\nimport { DropdownToggle, Dropdown, DropdownMenu, DropdownItem } from 'reactstrap';\n\nconst propTypes = {\n  libraryType: PropTypes.string.isRequired,\n  onCreateRepo: PropTypes.func.isRequired,\n  onShowSidePanel: PropTypes.func.isRequired,\n};\n\nclass RepoViewToolbar extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isCreateRepoDialogShow: false,\n      isOpen: false,\n    };\n  }\n\n  onCreateRepo = (repo) => {\n    this.props.onCreateRepo(repo);\n    this.onCreateToggle();\n  }\n\n  onCreateToggle = () => {\n    this.setState({isCreateRepoDialogShow: !this.state.isCreateRepoDialogShow});\n  }\n\n  toggleMore = () => {\n    this.setState({ isOpen: !this.state.isOpen });\n  }\n\n  render() {\n    return (\n      <Fragment>\n        <div className=\"cur-view-toolbar\">\n          <span className=\"sf2-icon-menu side-nav-toggle hidden-md-up d-md-none\" title=\"Side Nav Menu\" onClick={this.props.onShowSidePanel}></span>\n          {Utils.isDesktop() ? (\n            <div className=\"operation\">\n              <button className=\"btn btn-secondary operation-item\" title={gettext('New Library')} onClick={this.onCreateToggle}>\n                <i className=\"fas fa-plus-square text-secondary mr-1\"></i>{gettext('New Library')}\n              </button>\n              <Dropdown isOpen={this.state.isOpen} toggle={this.toggleMore}>\n                <DropdownToggle className='btn btn-secondary operation-item'>\n                  {gettext('More')}\n                </DropdownToggle>\n                <DropdownMenu>\n                  <DropdownItem className=\"link-dropdown-container\">\n                    <Link className=\"link-dropdown-item\" to={siteRoot + 'my-libs/deleted/'}>{gettext('Deleted Libraries')}</Link>\n                  </DropdownItem>\n                </DropdownMenu>\n              </Dropdown>\n            </div>\n          ) : (\n            <span className=\"sf2-icon-plus mobile-toolbar-icon\" title={gettext('New Library')} onClick={this.onCreateToggle}></span>\n          )}\n        </div>\n        {this.state.isCreateRepoDialogShow && (\n          <ModalPortal>\n            <CreateRepoDialog\n              libraryType={this.props.libraryType}\n              onCreateRepo={this.onCreateRepo}\n              onCreateToggle={this.onCreateToggle}\n            />\n          </ModalPortal>\n        )}\n      </Fragment>\n    );\n  }\n}\n\nRepoViewToolbar.propTypes = propTypes;\n\nexport default RepoViewToolbar;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport { Utils } from '../../utils/utils';\nimport { gettext } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport toaster from '../toast';\nimport '../../css/dirent-detail.css';\n\nconst propTypes = {\n  currentRepo: PropTypes.object.isRequired,\n  closeDetails: PropTypes.func.isRequired,\n};\n\nclass LibDetail extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      fileCount: 0,\n    };\n  }\n\n  componentDidMount() {\n    let repo = this.props.currentRepo;\n    this.getFileCounts(repo);\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (nextProps.currentRepo.repo_id !== this.props.currentRepo.repo_id) {\n      this.getFileCounts(nextProps.currentRepo);\n    }\n  }\n\n  getFileCounts = (repo) => {\n    seafileAPI.getRepoInfo(repo.repo_id).then(res => {\n      this.setState({fileCount: res.data.file_count});\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    let repo = this.props.currentRepo;\n    let smallIconUrl = Utils.getLibIconUrl(repo);\n    let bigIconUrl = Utils.getLibIconUrl(repo, true);\n\n    return (\n      <div className=\"detail-container\">\n        <div className=\"detail-header\">\n          <div className=\"detail-control sf2-icon-x1\" onClick={this.props.closeDetails}></div>\n          <div className=\"detail-title dirent-title\">\n            <img src={smallIconUrl} width=\"24\" height=\"24\" alt=\"\" />{'  '}\n            <span className=\"name ellipsis\" title={repo.repo_name}>{repo.repo_name}</span>\n          </div>\n        </div>\n        <div className=\"detail-body dirent-info\">\n          <div className=\"img\">\n            <img src={bigIconUrl} height=\"96\"  alt=\"\" />\n          </div>\n          <div className=\"dirent-table-container\">\n            <table className=\"table-thead-hidden\">\n              <thead>\n                <tr><th width=\"35%\"></th><th width=\"65%\"></th></tr>\n              </thead>\n              <tbody>\n                <tr><th>{gettext('Files')}</th><td>{this.state.fileCount}</td></tr>\n                <tr><th>{gettext('Size')}</th><td>{repo.size}</td></tr>\n                <tr><th>{gettext('Last Update')}</th><td>{ moment(repo.last_modified).fromNow()}</td></tr>\n              </tbody>\n            </table>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nLibDetail.propTypes = propTypes;\n\nexport default LibDetail;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter, Form, FormGroup, Label, Input, Alert } from 'reactstrap';\nimport { gettext, enableRepoHistorySetting } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api.js';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\n\nconst propTypes = {\n  itemName: PropTypes.string.isRequired,\n  toggleDialog: PropTypes.func.isRequired,\n  repoID: PropTypes.string.isRequired,\n};\n\nclass LibHistorySetting extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      keepDays: -1,\n      expireDays: 30,\n      disabled: true,\n      allHistory: true,\n      noHistory: false,\n      autoHistory: false,\n      errorInfo: ''\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.getRepoHistoryLimit(this.props.repoID).then(res => {\n      this.setState({\n        keepDays: res.data.keep_days,\n        allHistory: res.data.keep_days < 0 ? true : false,\n        noHistory: res.data.keep_days === 0 ? true : false,\n        autoHistory: res.data.keep_days > 0 ? true : false,\n        disabled: res.data.keep_days > 0 ? false : true,\n        expireDays: res.data.keep_days > 0 ? res.data.keep_days : 30,\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  submit = () => {\n    let days = this.state.keepDays;\n    if (this.state.autoHistory) {\n      days = this.state.expireDays;\n    }\n    let repoID = this.props.repoID;\n    let reg = /^-?\\d+$/;\n    let flag = reg.test(days);\n    if (flag) {\n      let message = gettext('Successfully set library history.');\n      seafileAPI.setRepoHistoryLimit(repoID, days).then(res => {\n        toaster.success(message);\n        this.setState({keepDays: res.data.keep_days});\n        this.props.toggleDialog();\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    } else {\n      this.setState({\n        errorInfo: gettext('Please enter a non-negative integer'),\n      });\n    }\n  }\n\n  handleKeyPress = (e) => {\n    if (e.key === 'Enter') {\n      this.submit();\n      e.preventDefault();\n    }\n  }\n\n  onChange = (e) => {\n    let num = e.target.value;\n    this.setState({\n      keepDays: num,\n      expireDays: num,\n    });\n  }\n\n  setLimitDays = (type) => {\n    if (type === 'allHistory') {\n      this.setState({\n        keepDays: -1,\n      });\n    } else if (type === 'noHistory') {\n      this.setState({\n        keepDays: 0,\n      });\n    } else {\n      this.setState({\n        disabled: false\n      });\n    }\n\n    this.setState({\n      allHistory: type === 'allHistory' ? true : false,\n      noHistory: type === 'noHistory' ? true : false,\n      autoHistory: type === 'autoHistory' ? true : false,\n    });\n  }\n\n  render() {\n    const itemName = this.props.itemName;\n    return (\n      <Modal isOpen={true}>\n        <ModalHeader toggle={this.props.toggleDialog}>\n          <span className=\"op-target\" title={itemName}>{itemName}</span>{' '}\n          {gettext('History Setting')}\n        </ModalHeader>\n        <ModalBody>\n          <Form>\n            {!enableRepoHistorySetting &&\n              <FormGroup>\n                <Label className=\"error\">{gettext('Setting library history is disabled by Admin.')}</Label>\n              </FormGroup>\n            }\n            <FormGroup check>\n              <Input type=\"radio\" name=\"radio1\" checked={this.state.allHistory} disabled={!enableRepoHistorySetting} onChange={() => {this.setLimitDays('allHistory');}}/>{' '}\n              <Label>{gettext('Keep full history')}</Label>\n            </FormGroup>\n            <FormGroup check>\n              <Input type=\"radio\" name=\"radio1\" checked={this.state.noHistory} disabled={!enableRepoHistorySetting} onChange={() =>{this.setLimitDays('noHistory');}}/>{' '}\n              <Label>{gettext('Don\\'t keep history')}</Label>\n            </FormGroup>\n            <FormGroup check>\n              <Input type=\"radio\" name=\"radio1\" checked={this.state.autoHistory} disabled={!enableRepoHistorySetting} onChange={() =>{this.setLimitDays('autoHistory');}}/>{' '}\n              <Label>{gettext('Only keep a period of history:')}</Label>\n              <Input\n                type=\"text\"\n                className=\"expire-input\"\n                value={this.state.expireDays}\n                onChange={this.onChange}\n                disabled={this.state.disabled}\n                onKeyDown={this.handleKeyPress}\n              />{' '}\n              <Label><span>{gettext('days')}</span></Label>\n            </FormGroup>\n            {this.state.errorInfo && <Alert color=\"danger\">{this.state.errorInfo}</Alert>}\n          </Form>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.props.toggleDialog}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.submit}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nLibHistorySetting.propTypes = propTypes;\n\nexport default LibHistorySetting;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalHeader, ModalBody, ModalFooter, Alert } from 'reactstrap';\nimport { gettext, repoPasswordMinLength } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport toaster from '../toast';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  repoName: PropTypes.string.isRequired,\n  toggleDialog: PropTypes.func.isRequired\n};\n\nclass ChangeRepoPasswordDialog extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      oldPassword: '',\n      newPassword: '',\n      newPasswordAgain: '',\n      submitBtnDisabled: false,\n      errorMsg: ''\n    };\n  }\n\n  handleOldPasswordInputChange = (e) => {\n    this.setState({\n      oldPassword: e.target.value\n    });\n  }\n\n  handleNewPasswordInputChange = (e) => {\n    this.setState({\n      newPassword: e.target.value\n    });\n  }\n\n  handleNewPasswordAgainInputChange = (e) => {\n    this.setState({\n      newPasswordAgain: e.target.value\n    });\n  }\n\n  formSubmit = (e) => {\n    const { oldPassword, newPassword, newPasswordAgain } = this.state;\n    if (!oldPassword) {\n      this.setState({\n        errorMsg: gettext('Please enter the old password')\n      });\n      return false;\n    }\n    if (!newPassword) {\n      this.setState({\n        errorMsg: gettext('Please enter a new password')\n      });\n      return false;\n    }\n    if (newPassword.length < repoPasswordMinLength) {\n      this.setState({\n        errorMsg: gettext('New password is too short')\n      });\n      return false;\n    }\n    if (!newPasswordAgain) {\n      this.setState({\n        errorMsg: gettext('Please enter the new password again')\n      });\n      return false;\n    }\n    if (newPassword != newPasswordAgain) {\n      this.setState({\n        errorMsg: gettext('New passwords don\\'t match')\n      });\n      return false;\n    }\n\n    this.setState({\n      submitBtnDisabled: true\n    });\n    seafileAPI.changeEncryptedRepoPassword(this.props.repoID, oldPassword, newPassword)\n      .then(() => {\n        this.props.toggleDialog();\n        toaster.success(gettext('Successfully changed library password.'));\n      }).catch((error) => {\n        let errorMsg = Utils.getErrorMsg(error);\n        this.setState({\n          errorMsg: errorMsg,\n          submitBtnDisabled: false\n        });\n      });\n  }\n\n\n  render() {\n    const { repoName, toggleDialog } = this.props;\n\n    return (\n      <Modal isOpen={true} centered={true} style={{height: 'auto'}}>\n        <ModalHeader toggle={toggleDialog}>\n          <span dangerouslySetInnerHTML={{__html: Utils.generateDialogTitle(gettext('Change Password of Library {placeholder}'), repoName)}}></span>\n        </ModalHeader>\n        <ModalBody>\n          <form id=\"repo-change-passwd-form\" action=\"\" method=\"post\">\n            <label htmlFor=\"passwd\">{gettext('Old Password')}</label><br />\n            <input type=\"password\" name=\"old_passwd\" className=\"form-control\" id=\"passwd\" value={this.state.oldPassword} onChange={this.handleOldPasswordInputChange} /><br />\n            <label htmlFor=\"new-passwd\">{gettext('New Password')}</label><span className=\"tip\">{gettext('(at least {placeholder} characters)').replace('{placeholder}', repoPasswordMinLength)}</span><br />\n            <input type=\"password\" name=\"new_passwd\" className=\"form-control\" id=\"new-passwd\" value={this.state.newPassword} onChange={this.handleNewPasswordInputChange} /><br />\n            <label htmlFor=\"new-passwd-again\">{gettext('New Password Again')}</label><br />\n            <input type=\"password\" name=\"new_passwd_again\" className=\"form-control\" id=\"new-passwd-again\" value={this.state.newPasswordAgain} onChange={this.handleNewPasswordAgainInputChange} /><br />\n            {this.state.errorMsg && <Alert color=\"danger\">{this.state.errorMsg}</Alert>}\n          </form>\n        </ModalBody>\n        <ModalFooter>\n          <button className=\"btn btn-primary\" disabled={this.state.submitBtnDisabled} onClick={this.formSubmit}>{gettext('Submit')}</button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nChangeRepoPasswordDialog.propTypes = propTypes;\n\nexport default ChangeRepoPasswordDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport toaster from '../../components/toast';\nimport { Button, Form, FormGroup, Label, Input, Modal, ModalHeader, ModalBody, ModalFooter, Alert } from 'reactstrap';\nimport { gettext, contactEmail } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport { seafileAPI } from '../../utils/seafile-api';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  toggleDialog: PropTypes.func.isRequired,\n};\n\nclass ResetEncryptedRepoPasswordDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      errMessage: '',\n      showLoading: true,\n      showSuccess: false,\n      showError: false,\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.resetAndSendEncryptedRepoPassword(this.props.repoID).then((res) => {\n      this.setState({showLoading: false});\n      this.setState({showSuccess: true});\n    }).catch((error) => {\n      if (error.response) {\n        this.setState({\n          errMessage: error.response.data.error_msg\n        });\n        this.setState({showLoading: false});\n        this.setState({showError: true});\n      }\n    });\n  }\n\n  render() {\n\n    let user_email = '<strong>' + contactEmail + '</strong>';\n    let message = gettext('New password has been sent to your email {mail}. Please check your mailbox. If you don’t receive the password, please check if your email address is properly configured.').replace('{mail}', user_email);\n\n    return (\n      <Modal isOpen={true}  centered={true}>\n        <ModalHeader toggle={this.props.toggleDialog}>\n          {gettext('Reset library password')}\n        </ModalHeader>\n        <ModalBody>\n          {this.state.showLoading && (\n            <span>{gettext('Sending new password...')}</span>\n          )}\n          {this.state.showSuccess && (\n            <div dangerouslySetInnerHTML={{__html:message}} />\n          )}\n          {this.state.showError && (\n            <span className=\"err-message\">{this.state.errMessage}</span>\n          )}\n        </ModalBody>\n      </Modal>\n    );\n  }\n}\n\nResetEncryptedRepoPasswordDialog.propTypes = propTypes;\n\nexport default ResetEncryptedRepoPasswordDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\nimport CreatableSelect from 'react-select/lib/Creatable';\nimport { gettext } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport Loading from '../loading';\nimport toaster from '../toast';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  repoName: PropTypes.string.isRequired,\n  toggleDialog: PropTypes.func.isRequired\n};\n\nclass LabelRepoStateDialog extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isLoading: true,\n      existingLabels: null,\n      errorMsg: '',\n      submitBtnDisabled: false\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.getAllRepoSnapshotLabels().then((res) => {\n      this.setState({\n        isLoading: false,\n        existingLabels: res.data,\n        errorMsg: ''\n      });\n    }).catch((error) => {\n      let errorMsg = Utils.getErrorMsg(error);\n      this.setState({\n        isLoading: false,\n        errorMsg: errorMsg\n      });\n    });\n  }\n\n  handleInputChange = (value) => {\n    this.setState({\n      inputValue: value\n    });\n  }\n\n  formSubmit = () => {\n    const inputValue = this.state.inputValue;\n\n    if (!inputValue || !inputValue.length) { // undefined or []\n      this.setState({\n        formErrorMsg: gettext('It is required.')\n      });\n      return;\n    }\n\n    this.setState({\n      submitBtnDisabled: true\n    });\n\n    const {repoID, repoName} = this.props;\n    const labels = inputValue.map((item, index) => item.value).join(',');\n    seafileAPI.addNewRepoLabels(repoID, labels).then((res) => {\n      const msg = gettext('Successfully added label(s) for library {placeholder}').replace('{placeholder}', repoName);\n      toaster.success(msg);\n      this.props.toggleDialog();\n    }).catch((error) => {\n      let errorMsg = Utils.getErrorMsg(error);\n      this.setState({\n        formErrorMsg: errorMsg,\n        submitBtnDisabled: false\n      });\n    });\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true} toggle={this.props.toggleDialog}>\n        <ModalHeader toggle={this.props.toggleDialog}>{gettext('Label Current State')}</ModalHeader>\n        <ModalBody>\n          <Content data={this.state} handleChange={this.handleInputChange} />\n        </ModalBody>\n        {this.state.existingLabels && (\n          <ModalFooter>\n            <button className=\"btn btn-secondary\" onClick={this.props.toggleDialog}>{gettext('Cancel')}</button>\n            <button className=\"btn btn-primary\" disabled={this.state.submitBtnDisabled} onClick={this.formSubmit}>{gettext('Submit')}</button>\n          </ModalFooter>\n        )}\n      </Modal>\n    );\n  }\n}\n\nclass Content extends React.Component {\n\n  render() {\n    const { isLoading, errorMsg, existingLabels, formErrorMsg } = this.props.data;\n\n    if (isLoading) {\n      return <Loading />;\n    }\n\n    if (errorMsg) {\n      return <p className=\"error mt-4 text-center\">{errorMsg}</p>;\n    }\n\n    return (\n      <React.Fragment>\n        <CreatableSelect\n          isMulti={true}\n          onChange={this.props.handleChange}\n          placeholder=''\n          options={existingLabels.map((item, index) => { return {label: item, value: item}; })}\n        />\n        {formErrorMsg && <p className=\"error m-0 mt-2\">{formErrorMsg}</p>}\n      </React.Fragment>\n    );\n  }\n}\n\nLabelRepoStateDialog.propTypes = propTypes;\n\nexport default LabelRepoStateDialog;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext, isPro, siteRoot } from '../../utils/constants';\nimport { Button, Input, InputGroup, InputGroupAddon } from 'reactstrap';\nimport { seafileAPI } from '../../utils/seafile-api.js';\nimport { Utils } from '../../utils/utils.js';\nimport UserSelect from '../user-select';\nimport SharePermissionEditor from '../select-editor/share-permission-editor';\nimport FileChooser from '../file-chooser/file-chooser';\n\nclass UserItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOperationShow: false\n    };\n  }\n\n  onMouseEnter = () => {\n    this.setState({isOperationShow: true});\n  }\n\n  onMouseLeave = () => {\n    this.setState({isOperationShow: false});\n  }\n\n  deleteUserFolderPermission = () => {\n    let item = this.props.item;\n    this.props.deleteUserFolderPermission(item);\n  }\n\n  onChangeUserFolderPerm = (permission) => {\n    let item = this.props.item;\n    this.props.onChangeUserFolderPerm(item.repo_id, permission, item.folder_path, item.user_email);\n  }\n\n  render() {\n    let item = this.props.item;\n    let currentPermission = item.permission;\n    return (\n      <tr onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave}>\n        <td>\n          <a href={`${siteRoot}profile/${encodeURIComponent(item.user_email)}/`} target=\"_blank\">{item.user_name}</a>\n        </td>\n        {this.props.showPath &&\n          <td>\n            <a href={`${siteRoot}library/${item.repo_id}/${Utils.encodePath(this.props.repoName + item.folder_path)}`}>{item.folder_name}</a>\n          </td>\n        }\n        <td>\n          <SharePermissionEditor\n            isTextMode={true}\n            isEditIconShow={this.state.isOperationShow}\n            currentPermission={currentPermission}\n            permissions={this.props.permissions}\n            onPermissionChanged={this.onChangeUserFolderPerm}\n          />\n        </td>\n        <td>\n          <span\n            className={`sf2-icon-x3 action-icon ${this.state.isOperationShow ? '' : 'hide'}`}\n            onClick={this.deleteUserFolderPermission}\n            title={gettext('Delete')}\n          >\n          </span>\n        </td>\n      </tr>\n    );\n  }\n}\n\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  isDepartmentRepo: PropTypes.bool\n};\n\n\nclass LibSubFolderSetUserPermissionDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      selectedUsers: null,\n      errorMsg: [],\n      permission: 'rw',\n      userFolderPermItems: [],\n      folderPath: '',\n      showFileChooser: false\n    };\n    if (!isPro) {\n      this.permissions = ['r', 'rw'];\n    } else {\n      this.permissions = ['r', 'rw', 'cloud-edit', 'preview'];\n    }\n  }\n\n  handleUserSelectChange = (option) => {\n    this.setState({selectedUsers: option});\n  }\n\n  componentDidMount() {\n    const {repoID, folderPath, isDepartmentRepo} = this.props;\n    const request = isDepartmentRepo ?\n      seafileAPI.listDepartmentRepoUserFolderPerm(repoID, folderPath) :\n      seafileAPI.listUserFolderPerm(repoID, folderPath);\n    request.then((res) => {\n      if (res.data.length !== 0) {\n        this.setState({userFolderPermItems: res.data});\n      }\n    });\n  }\n\n  setPermission = (permission) => {\n    this.setState({permission: permission});\n  }\n\n  addUserFolderPerm = () => {\n    const { selectedUsers } = this.state;\n    const folderPath = this.props.folderPath || this.state.folderPath;\n    if (!selectedUsers || !selectedUsers.length || !folderPath) { // selectedUsers: null or []\n      return false;\n    }\n\n    const users = selectedUsers.map((item, index) => item.email);\n\n    const request = this.props.isDepartmentRepo ?\n      seafileAPI.addDepartmentRepoUserFolderPerm(this.props.repoID, this.state.permission, folderPath, users) :\n      seafileAPI.addUserFolderPerm(this.props.repoID, this.state.permission, folderPath, users);\n    request.then(res => {\n      let errorMsg = [];\n      if (res.data.failed.length > 0) {\n        for (let i = 0; i < res.data.failed.length; i++) {\n          errorMsg[i] = res.data.failed[i];\n        }\n      }\n      this.setState({\n        errorMsg: errorMsg,\n        userFolderPermItems: this.state.userFolderPermItems.concat(res.data.success),\n        selectedUsers: null,\n        permission: 'rw',\n        folderPath: '',\n      });\n      this.refs.userSelect.clearSelect();\n    }).catch((error) => {\n      let errorMsg = '';\n      if (error.response) {\n        if (error.response.data && error.response.data['error_msg']) {\n          errorMsg = error.response.data['error_msg'];\n        } else {\n          errorMsg = gettext('Error');\n        }\n      } else {\n        errorMsg = gettext('Please check the network.');\n      }\n      this.setState({\n        errorMsg: [errorMsg]\n      });\n    });\n  }\n\n  deleteUserFolderPermItem = (item) => {\n    const request = this.props.isDepartmentRepo ?\n      seafileAPI.deleteDepartmentRepoUserFolderPerm(item.repo_id, item.permission, item.folder_path, item.user_email) :\n      seafileAPI.deleteUserFolderPerm(item.repo_id, item.permission, item.folder_path, item.user_email);\n    request.then(res => {\n      this.setState({\n        userFolderPermItems: this.state.userFolderPermItems.filter(deletedItem => {\n          return deletedItem != item;\n        })\n      });\n    });\n  }\n\n  onChangeUserFolderPerm = (repoID, permission, folderPath, userEmail) => {\n    const request = this.props.isDepartmentRepo ?\n      seafileAPI.updateDepartmentRepoUserFolderPerm(repoID, permission, folderPath, userEmail) :\n      seafileAPI.updateUserFolderPerm(repoID, permission, folderPath, userEmail);\n    request.then(res => {\n      let userFolderPermItems = this.state.userFolderPermItems.map(item => {\n        if (item.user_email === userEmail && item.folder_path === folderPath) {\n          item.permission = permission;\n        }\n        return item;\n      });\n      this.setState({userFolderPermItems: userFolderPermItems});\n    });\n  }\n\n  onSetSubFolder = (e) => {\n    this.setState({\n      folderPath: e.target.value\n    });\n  }\n\n  toggleFileChooser = () => {\n    this.setState({\n      showFileChooser: !this.state.showFileChooser,\n      folderPath: ''\n    });\n  }\n\n  toggleSubFolder = (repo, path, item) => {\n    this.setState({\n      folderPath: path,\n    });\n  }\n\n  handleFileChooserSubmit = () => {\n    this.setState({\n      showFileChooser: !this.state.showFileChooser\n    });\n  }\n\n  onRepoItemClick = () => {\n    this.setState({\n      folderPath: '/'\n    });\n  }\n\n  render() {\n    let showPath = this.props.folderPath ? false : true;\n    let { userFolderPermItems } = this.state;\n\n    if (this.state.showFileChooser) {\n      return (\n        <div>\n          <FileChooser repoID={this.props.repoID}\n            mode={'only_current_library'}\n            onDirentItemClick={this.toggleSubFolder}\n            onRepoItemClick={this.onRepoItemClick}\n          />\n          <div className=\"modal-footer\">\n            <Button color=\"secondary\" onClick={this.toggleFileChooser}>{gettext('Cancel')}</Button>\n            <Button color=\"primary\" onClick={this.handleFileChooserSubmit}>{gettext('Submit')}</Button>\n          </div>\n        </div>\n      );\n    }\n\n    const thead = (\n      <thead>\n        <tr>\n          <th width={showPath ? '32%': '55%'}>{gettext('User')}</th>\n          {showPath &&\n          <th width=\"32%\">{gettext('Folder')}</th>\n          }\n          <th width={showPath ? '24%': '30%'}>{gettext('Permission')}</th>\n          <th width={showPath ? '12%' : '15%'}></th>\n        </tr>\n      </thead>\n    );\n    return (\n      <Fragment>\n        <table className=\"w-xs-250\">\n          {thead}\n          <tbody>\n            <tr>\n              <td>\n                <UserSelect\n                  ref=\"userSelect\"\n                  isMulti={true}\n                  className=\"reviewer-select\"\n                  placeholder={gettext('Search users...')}\n                  onSelectChange={this.handleUserSelectChange}\n                  value={this.state.selectedUsers}\n                />\n              </td>\n              {showPath &&\n                <td>\n                  <InputGroup>\n                    <Input value={this.state.folderPath} onChange={this.onSetSubFolder} />\n                    <InputGroupAddon addonType=\"append\"><Button className=\"sf2-icon-plus\" onClick={this.toggleFileChooser}></Button></InputGroupAddon>\n                  </InputGroup>\n                </td>\n              }\n              <td>\n                <SharePermissionEditor\n                  isTextMode={false}\n                  isEditIconShow={false}\n                  currentPermission={this.state.permission}\n                  permissions={this.permissions}\n                  onPermissionChanged={this.setPermission}\n                />\n              </td>\n              <td>\n                <Button onClick={this.addUserFolderPerm}>{gettext('Submit')}</Button>\n              </td>\n            </tr>\n            {this.state.errorMsg.length > 0 &&\n              this.state.errorMsg.map((item, index) => {\n                let errMessage = '';\n                if (item.user_email) {\n                  errMessage = item.user_email + ': ' + item.error_msg;\n                } else {\n                  errMessage = item;\n                }\n                return (\n                  <tr key={index}>\n                    <td colSpan={3}><p className=\"error\">{errMessage}</p></td>\n                  </tr>\n                );\n              })\n            }\n          </tbody>\n        </table>\n        <div className=\"share-list-container\">\n          <table className=\"table-thead-hidden w-xs-250\">\n            {thead}\n            <tbody>\n              {userFolderPermItems.map((item, index) => {\n                return (\n                  <UserItem\n                    key={index}\n                    item={item}\n                    permissions={this.permissions}\n                    deleteUserFolderPermission={this.deleteUserFolderPermItem}\n                    onChangeUserFolderPerm={this.onChangeUserFolderPerm}\n                    showPath={showPath}\n                    repoName={this.props.repoName}\n                  />\n                );\n              })}\n            </tbody>\n          </table>\n        </div>\n      </Fragment>\n    );\n  }\n}\n\nLibSubFolderSetUserPermissionDialog.propTypes = propTypes;\n\nexport default LibSubFolderSetUserPermissionDialog;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Input, InputGroup, InputGroupAddon } from 'reactstrap';\nimport Select from 'react-select';\nimport makeAnimated from 'react-select/lib/animated';\nimport { gettext, isPro, siteRoot } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api.js';\nimport { Utils } from '../../utils/utils.js';\nimport SharePermissionEditor from '../select-editor/share-permission-editor';\nimport FileChooser from '../file-chooser/file-chooser';\n\nclass GroupItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOperationShow: false\n    };\n  }\n\n  onMouseEnter = () => {\n    this.setState({isOperationShow: true});\n  }\n\n  onMouseLeave = () => {\n    this.setState({isOperationShow: false});\n  }\n\n  deleteGroupPermissionItem = () => {\n    let item = this.props.item;\n    this.props.deleteGroupPermissionItem(item);\n  }\n\n  onChangeGroupPermission = (permission) => {\n    let item = this.props.item;\n    this.props.onChangeGroupPermission(item, permission);\n  }\n\n  render() {\n    let item = this.props.item;\n    return (\n      <tr onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave}>\n        <td>\n          <a href={`${siteRoot}group/${item.group_id}/`} target=\"_blank\">{item.group_name}</a>\n        </td>\n        {this.props.showPath &&\n          <td>\n            <a href={`${siteRoot}library/${item.repo_id}/${Utils.encodePath(this.props.repoName + item.folder_path)}`}>{item.folder_name}</a>\n          </td>\n        }\n        <td>\n          <SharePermissionEditor\n            isTextMode={true}\n            isEditIconShow={this.state.isOperationShow}\n            currentPermission={item.permission}\n            permissions={this.props.permissions}\n            onPermissionChanged={this.onChangeGroupPermission}\n          />\n        </td>\n        <td>\n          <span\n            className={`sf2-icon-x3 action-icon ${this.state.isOperationShow ? '' : 'hide'}`}\n            onClick={this.deleteGroupPermissionItem}\n            title={gettext('Delete')}\n          >\n          </span>\n        </td>\n      </tr>\n    );\n  }\n}\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  isDepartmentRepo: PropTypes.bool\n};\n\nconst NoOptionsMessage = (props) => {\n  return (\n    <div {...props.innerProps} style={{margin: '6px 10px', textAlign: 'center', color: 'hsl(0,0%,50%)'}}>{gettext('Group not found')}</div>\n  );\n};\n\nclass LibSubFolderSerGroupPermissionDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      selectedOption: null,\n      errorMsg: [],\n      permission: 'rw',\n      groupPermissionItems: [],\n      folderPath: '',\n      showFileChooser: false\n    };\n    this.options = [];\n    if (!isPro) {\n      this.permissions = ['r', 'rw'];\n    } else {\n      this.permissions = ['r', 'rw', 'cloud-edit', 'preview'];\n    }\n  }\n\n  handleSelectChange = (option) => {\n    this.setState({selectedOption: option});\n  }\n\n  componentDidMount() {\n    this.loadOptions();\n    this.listGroupPermissionItems();\n  }\n\n  loadOptions = () => {\n    seafileAPI.shareableGroups().then((res) => {\n      this.options = res.data.map((item, index) => {\n        return {\n          id: item.id,\n          label: item.name,\n          value: item.name\n        };\n      });\n    });\n  }\n\n  listGroupPermissionItems = () => {\n    const { isDepartmentRepo, repoID, folderPath } = this.props;\n    const request = isDepartmentRepo ?\n      seafileAPI.listDepartmentRepoGroupFolderPerm(repoID, folderPath) :\n      seafileAPI.listGroupFolderPerm(repoID, folderPath);\n    request.then((res) => {\n      if (res.data.length !== 0) {\n        this.setState({\n          groupPermissionItems: res.data\n        });\n      }\n    });\n  }\n\n  setPermission = (permission) => {\n    this.setState({permission: permission});\n  }\n\n  addGroupFolderPerm = () => {\n    const { selectedOption } = this.state;\n    const folderPath = this.props.folderPath || this.state.folderPath;\n    if (!selectedOption || !folderPath) {\n      return false;\n    }\n\n    const request = this.props.isDepartmentRepo ?\n      seafileAPI.addDepartmentRepoGroupFolderPerm(this.props.repoID, this.state.permission, folderPath, selectedOption.id) :\n      seafileAPI.addGroupFolderPerm(this.props.repoID, this.state.permission, folderPath, selectedOption.id);\n    request.then(res => {\n      let errorMsg = [];\n      if (res.data.failed.length > 0) {\n        for (let i = 0; i < res.data.failed.length; i++) {\n          errorMsg[i] = res.data.failed[i];\n        }\n      }\n\n      this.setState({\n        errorMsg: errorMsg,\n        groupPermissionItems: this.state.groupPermissionItems.concat(res.data.success),\n        selectedOption: null,\n        permission: 'rw',\n        folderPath: ''\n      });\n    }).catch((error) => {\n      let errorMsg = '';\n      if (error.response) {\n        if (error.response.data && error.response.data['error_msg']) {\n          errorMsg = error.response.data['error_msg'];\n        } else {\n          errorMsg = gettext('Error');\n        }\n      } else {\n        errorMsg = gettext('Please check the network.');\n      }\n      this.setState({\n        errorMsg: [errorMsg]\n      });\n    });\n  }\n\n  deleteGroupPermissionItem = (item) => {\n    const request = this.props.isDepartmentRepo ?\n      seafileAPI.deleteDepartmentRepoGroupFolderPerm(item.repo_id, item.permission, item.folder_path, item.group_id) :\n      seafileAPI.deleteGroupFolderPerm(item.repo_id, item.permission, item.folder_path, item.group_id);\n    request.then(() => {\n      this.setState({\n        groupPermissionItems: this.state.groupPermissionItems.filter(deletedItem => { return deletedItem != item; })\n      });\n    });\n  }\n\n  onChangeGroupPermission = (item, permission) => {\n    const request = this.props.isDepartmentRepo ?\n      seafileAPI.updateDepartmentRepoGroupFolderPerm(item.repo_id, permission, item.folder_path, item.group_id) :\n      seafileAPI.updateGroupFolderPerm(item.repo_id, permission, item.folder_path, item.group_id);\n    request.then(() => {\n      this.updateGroupPermission(item, permission);\n    });\n  }\n\n  updateGroupPermission = (item, permission) => {\n    let groupID = item.group_id;\n    let groupPermissionItems = this.state.groupPermissionItems.map(sharedItem => {\n      let sharedItemGroupID = sharedItem.group_id;\n      if (groupID === sharedItemGroupID && item.folder_path === sharedItem.folder_path) {\n        sharedItem.permission = permission;\n      }\n      return sharedItem;\n    });\n    this.setState({groupPermissionItems: groupPermissionItems});\n  }\n\n  onSetSubFolder = (e) => {\n    this.setState({\n      folderPath: e.target.value\n    });\n  }\n\n  toggleFileChooser = () => {\n    this.setState({\n      showFileChooser: !this.state.showFileChooser,\n      folderPath: ''\n    });\n  }\n\n  toggleSubFolder = (repo, path, item) => {\n    this.setState({\n      folderPath: path,\n    });\n  }\n\n  handleSubmit = () => {\n    this.setState({\n      showFileChooser: !this.state.showFileChooser\n    });\n  }\n\n  onRepoItemClick = () => {\n    this.setState({\n      folderPath: '/'\n    });\n  }\n\n  render() {\n    let showPath = this.props.folderPath ? false : true;\n\n    if (this.state.showFileChooser) {\n      return (\n        <div>\n          <FileChooser repoID={this.props.repoID}\n            mode={'only_current_library'}\n            onDirentItemClick={this.toggleSubFolder}\n            onRepoItemClick={this.onRepoItemClick}\n          />\n          <div className=\"modal-footer\">\n            <Button color=\"secondary\" onClick={this.toggleFileChooser}>{gettext('Cancel')}</Button>\n            <Button color=\"primary\" onClick={this.handleSubmit}>{gettext('Submit')}</Button>\n          </div>\n        </div>\n      );\n    }\n\n    const thead = (\n      <thead>\n        <tr>\n          <th width={showPath ? '32%' : '55%'}>{gettext('Group')}</th>\n          {showPath &&\n          <th width=\"32%\">{gettext('Folder')}</th>\n          }\n          <th width={showPath ? '24%' : '30%'}>{gettext('Permission')}</th>\n          <th width={showPath ? '12%' : '15%'}></th>\n        </tr>\n      </thead>\n    );\n    return (\n      <Fragment>\n        <table className=\"w-xs-250\">\n          {thead}\n          <tbody>\n            <tr>\n              <td>\n                <Select\n                  onChange={this.handleSelectChange}\n                  options={this.options}\n                  placeholder={gettext('Select a group')}\n                  maxMenuHeight={200}\n                  inputId={'react-select-2-input'}\n                  value={this.state.selectedOption}\n                  components={{ NoOptionsMessage }}\n                />\n              </td>\n              {showPath &&\n                <td>\n                  <InputGroup>\n                    <Input value={this.state.folderPath} onChange={this.onSetSubFolder} />\n                    <InputGroupAddon addonType=\"append\"><Button className=\"sf2-icon-plus\" onClick={this.toggleFileChooser}></Button></InputGroupAddon>\n                  </InputGroup>\n                </td>\n              }\n              <td>\n                <SharePermissionEditor\n                  isTextMode={false}\n                  isEditIconShow={false}\n                  currentPermission={this.state.permission}\n                  permissions={this.permissions}\n                  onPermissionChanged={this.setPermission}\n                />\n              </td>\n              <td>\n                <Button onClick={this.addGroupFolderPerm}>{gettext('Submit')}</Button>\n              </td>\n            </tr>\n            {this.state.errorMsg.length > 0 &&\n              this.state.errorMsg.map((item, index) => {\n                let errMessage = item.group_id + ': ' + item.error_msg;\n                return (\n                  <tr key={index}>\n                    <td colSpan={3}><p className=\"error\">{errMessage}</p></td>\n                  </tr>\n                );\n              })\n            }\n          </tbody>\n        </table>\n        <div className=\"share-list-container\">\n          <table className=\"table-thead-hidden w-xs-250\">\n            {thead}\n            <tbody>\n              {this.state.groupPermissionItems.map((item, index) => {\n                return (\n                  <GroupItem\n                    key={index}\n                    item={item}\n                    permissions={this.permissions}\n                    deleteGroupPermissionItem={this.deleteGroupPermissionItem}\n                    onChangeGroupPermission={this.onChangeGroupPermission}\n                    showPath={showPath}\n                    repoName={this.props.repoName}\n                  />\n                );\n              })}\n            </tbody>\n          </table>\n        </div>\n      </Fragment>\n    );\n  }\n}\n\nLibSubFolderSerGroupPermissionDialog.propTypes = propTypes;\n\nexport default LibSubFolderSerGroupPermissionDialog;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalHeader, ModalBody, TabContent, TabPane, Nav, NavItem, NavLink } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport LibSubFolderSetUserPermissionDialog from './lib-sub-folder-set-user-permission-dialog';\nimport LibSubFolderSetGroupPermissionDialog from './lib-sub-folder-set-group-permission-dialog';\nimport '../../css/share-link-dialog.css';\nimport '../../css/sub-folder-permission.css';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  repoName: PropTypes.string,\n  isDepartmentRepo: PropTypes.bool,\n  folderPath: PropTypes.string,\n  folderName: PropTypes.string,\n  toggleDialog: PropTypes.func.isRequired\n};\n\nclass LibSubFolderPermissionDialog extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      activeTab: 'userPermission'\n    };\n  }\n\n  toggle = (tab) => {\n    if (this.state.activeTab !== tab) {\n      this.setState({activeTab: tab});\n    }\n  }\n\n  renderContent = () => {\n    let activeTab = this.state.activeTab;\n\n    return (\n      <Fragment>\n        <div className=\"share-dialog-side\">\n          <Nav pills>\n            <NavItem>\n              <NavLink className={activeTab === 'userPermission' ? 'active' : ''} onClick={this.toggle.bind(this, 'userPermission')}>\n                {gettext('User Permission')}\n              </NavLink>\n            </NavItem>\n            <NavItem>\n              <NavLink className={activeTab === 'groupPermission' ? 'active' : ''} onClick={this.toggle.bind(this, 'groupPermission')}>\n                {gettext('Group Permission')}\n              </NavLink>\n            </NavItem>\n          </Nav>\n        </div>\n        <div className=\"share-dialog-main\">\n          <TabContent activeTab={this.state.activeTab}>\n            <TabPane tabId=\"userPermission\">\n              <LibSubFolderSetUserPermissionDialog repoID={this.props.repoID} repoName={this.props.repoName} folderPath={this.props.folderPath} isDepartmentRepo={this.props.isDepartmentRepo} />\n            </TabPane>\n            <TabPane tabId=\"groupPermission\">\n              <LibSubFolderSetGroupPermissionDialog repoID={this.props.repoID} repoName={this.props.repoName} folderPath={this.props.folderPath} isDepartmentRepo={this.props.isDepartmentRepo} />\n            </TabPane>\n          </TabContent>\n        </div>\n      </Fragment>\n    );\n  }\n\n  render() {\n    const { repoName, folderName } = this.props;\n\n    return (\n      <div>\n        <Modal isOpen={true} style={{maxWidth: '980px'}} className=\"share-dialog\" toggle={this.props.toggleDialog}>\n          <ModalHeader toggle={this.props.toggleDialog}>\n            <span dangerouslySetInnerHTML={{__html: repoName ? Utils.generateDialogTitle(gettext('{placeholder} Folder Permission'), repoName) : Utils.generateDialogTitle(gettext('Set {placeholder}\\'s permission'), folderName)}}></span>\n          </ModalHeader>\n          <ModalBody className=\"dialog-list-container share-dialog-content\">\n            {this.renderContent()}\n          </ModalBody>\n        </Modal>\n      </div>\n    );\n  }\n}\n\nLibSubFolderPermissionDialog.propTypes = propTypes;\n\nexport default LibSubFolderPermissionDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../utils/constants';\nimport toaster from './toast';\n\nconst propTypes = {\n  hasSuffix: PropTypes.bool,\n  name: PropTypes.string.isRequired,\n  onRenameConfirm: PropTypes.func.isRequired,\n  onRenameCancel: PropTypes.func.isRequired,\n};\n\nclass Rename extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      name: props.name\n    };\n  }\n\n  componentDidMount() {\n    this.refs.renameInput.focus();\n    if (this.props.hasSuffix) {\n      var endIndex = this.props.name.lastIndexOf('.');\n      this.refs.renameInput.setSelectionRange(0, endIndex, 'forward');\n    } else {\n      this.refs.renameInput.setSelectionRange(0, -1);\n    }\n  }\n\n  onChange = (e) => {\n    this.setState({name: e.target.value});\n  }\n\n  onClick = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n  }\n\n  onKeyPress = (e) => {\n    if (e.key === 'Enter') {\n      this.onRenameConfirm(e);\n    }\n  }\n\n  onRenameConfirm = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    let newName = this.state.name.trim();\n    if (newName === this.props.name) {\n      this.props.onRenameCancel();\n      return;\n    }\n\n    let { isValid, errMessage } = this.validateInput();\n    if (!isValid) {\n      toaster.danger(errMessage);\n    } else {\n      this.props.onRenameConfirm(newName);\n    }\n  }\n\n  onRenameCancel = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    this.props.onRenameCancel();\n  }\n\n  validateInput = () => {\n    let newName = this.state.name.trim();\n    let isValid = true;\n    let errMessage = '';\n    if (!newName) {\n      isValid = false;\n      errMessage = gettext('Name is required.');\n      return { isValid, errMessage };\n    }\n\n    if (newName.indexOf('/') > -1) {\n      isValid = false;\n      errMessage = gettext('Name should not include ' + '\\'/\\'' + '.');\n      return { isValid, errMessage };\n    }\n\n    return { isValid, errMessage };\n  }\n\n  render() {\n    return (\n      <div className=\"rename-container\">\n        <input\n          ref=\"renameInput\"\n          value={this.state.name}\n          onChange={this.onChange}\n          onKeyPress={this.onKeyPress}\n          onClick={this.onClick}\n        />\n        <button className=\"btn btn-secondary sf2-icon-confirm confirm\" onClick={this.onRenameConfirm}></button>\n        <button className=\"btn btn-secondary sf2-icon-cancel cancel\" onClick={this.onRenameCancel}></button>\n      </div>\n    );\n  }\n}\n\nRename.propTypes = propTypes;\n\nexport default Rename;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Dropdown, DropdownMenu, DropdownToggle, DropdownItem } from 'reactstrap';\nimport { gettext, isPro, folderPermEnabled, enableRepoSnapshotLabel, enableResetEncryptedRepoPassword, isEmailConfigured } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  isPC: PropTypes.bool,\n  repo: PropTypes.object.isRequired,\n  isStarred: PropTypes.bool,\n  onFreezedItem: PropTypes.func.isRequired,\n  onUnfreezedItem: PropTypes.func.isRequired,\n  onMenuItemClick: PropTypes.func.isRequired,\n};\n\nclass MylibRepoMenu extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isItemMenuShow: false,\n    };\n  }\n\n  onMenuItemClick = (e) => {\n    let operation = Utils.getEventData(e, 'toggle');\n    this.props.onMenuItemClick(operation);\n  }\n\n  onDropdownToggleClick = (e) => {\n    this.toggleOperationMenu(e);\n  }\n\n  toggleOperationMenu = (e) => {\n    let dataset = e.target ? e.target.dataset : null;\n    if (dataset && dataset.toggle && dataset.toggle === 'Rename') {\n      this.setState({isItemMenuShow: !this.state.isItemMenuShow});\n      return;\n    }\n\n    this.setState(\n      {isItemMenuShow: !this.state.isItemMenuShow},\n      () => {\n        if (this.state.isItemMenuShow) {\n          this.props.onFreezedItem();\n        } else {\n          this.props.onUnfreezedItem();\n        }\n      }\n    );\n  }\n\n  generatorOperations = () => {\n    let repo = this.props.repo;\n    let showResetPasswordMenuItem = isPro && repo.encrypted && enableResetEncryptedRepoPassword && isEmailConfigured;\n    let operations = ['Rename', 'Transfer'];\n    if (folderPermEnabled) {\n      operations.push('Folder Permission');\n    }\n    operations.push('Share Links Admin', 'Divider');\n    if (repo.encrypted) {\n      operations.push('Change Password');\n    }\n    if (showResetPasswordMenuItem) {\n      operations.push('Reset Password');\n    }\n    operations.push('History Setting', 'API Token');\n    if (this.props.isPC && enableRepoSnapshotLabel) {\n      operations.push('Label Current State');\n    }\n    if (isPro) {\n      operations.push('Old Files Auto Delete');\n    }\n    return operations;\n  }\n\n  translateOperations = (item) => {\n    let translateResult = '';\n    switch(item) {\n      case 'Star':\n        translateResult = gettext('Star');\n        break;\n      case 'Unstar':\n        translateResult = gettext('Unstar');\n        break;\n      case 'Share':\n        translateResult = gettext('Share');\n        break;\n      case 'Delete':\n        translateResult = gettext('Delete');\n        break;\n      case 'Rename':\n        translateResult = gettext('Rename');\n        break;\n      case 'Transfer':\n        translateResult = gettext('Transfer');\n        break;\n      case 'History Setting':\n        translateResult = gettext('History Setting');\n        break;\n      case 'Change Password':\n        translateResult = gettext('Change Password');\n        break;\n      case 'Reset Password':\n        translateResult = gettext('Reset Password');\n        break;\n      case 'Folder Permission':\n        translateResult = gettext('Folder Permission');\n        break;\n      case 'Label Current State':\n        translateResult = gettext('Label Current State');\n        break;\n      case 'API Token':\n        translateResult = 'API Token'; // translation is not needed here\n        break;\n      case 'Share Links Admin':\n        translateResult = gettext('Share Links Admin');\n        break;\n      case 'Old Files Auto Delete':\n        translateResult = gettext('Auto deletion');\n        break;\n      default:\n        break;\n    }\n\n    return translateResult;\n  }\n\n  render() {\n    let operations = this.generatorOperations();\n\n    // pc menu\n    if (this.props.isPC) {\n      return (\n        <Dropdown isOpen={this.state.isItemMenuShow} toggle={this.toggleOperationMenu}>\n          <DropdownToggle\n            tag=\"i\"\n            className=\"sf-dropdown-toggle sf2-icon-caret-down\"\n            title={gettext('More Operations')}\n            // onClick={this.clickOperationMenuToggle}\n            data-toggle=\"dropdown\"\n            aria-expanded={this.state.isItemMenuShow}\n          />\n          <DropdownMenu>\n            {operations.map((item, index)=> {\n              if (item == 'Divider') {\n                return <DropdownItem key={index} divider />;\n              } else {\n                return (<DropdownItem key={index} data-toggle={item} onClick={this.onMenuItemClick}>{this.translateOperations(item)}</DropdownItem>);\n              }\n            })}\n          </DropdownMenu>\n        </Dropdown>\n      );\n    }\n\n    // mobile menu\n    operations.unshift('Delete');\n    operations.unshift('Share');\n    this.props.isStarred ? operations.unshift('Unstar') : operations.unshift('Star');\n\n    return (\n      <Dropdown isOpen={this.state.isItemMenuShow} toggle={this.toggleOperationMenu}>\n        <DropdownToggle\n          tag=\"i\"\n          className=\"sf-dropdown-toggle fa fa-ellipsis-v ml-0\"\n          title={gettext('More Operations')}\n          // onClick={this.clickOperationMenuToggle}\n          data-toggle=\"dropdown\"\n          aria-expanded={this.state.isItemMenuShow}\n        />\n        <div className={`${this.state.isItemMenuShow ? '' : 'd-none'}`} onClick={this.toggleOperationMenu}>\n          <div className=\"mobile-operation-menu-bg-layer\"></div>\n          <div className=\"mobile-operation-menu\">\n            {operations.map((item, index) => {\n              if (item != 'Divider') {\n                return (<DropdownItem key={index} className=\"mobile-menu-item\" data-toggle={item} onClick={this.onMenuItemClick}>{this.translateOperations(item)}</DropdownItem>);\n              }\n            })}\n          </div>\n        </div>\n      </Dropdown>\n    );\n  }\n}\n\nMylibRepoMenu.propTypes = propTypes;\n\nexport default MylibRepoMenu;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport Select from 'react-select';\nimport { gettext } from '../../utils/constants';\n\nconst propTypes = {\n  isTextMode: PropTypes.bool.isRequired,\n  isEditIconShow: PropTypes.bool.isRequired,\n  currentPermission: PropTypes.string.isRequired,\n  onPermissionChanged: PropTypes.func.isRequired,\n};\n\nclass RepoAPITokenPermissionEditor extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isEditing: false,\n    };\n    this.options = [\n      { value: 'rw', label: <div>{gettext('Read-Write')}</div> },\n      { value: 'r', label: <div>{gettext('Read-Only')}</div> }\n    ];\n  }\n\n  componentDidMount() {\n    document.addEventListener('click', this.onHideSelect);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('click', this.onHideSelect);\n  }\n\n  onHideSelect = () => {\n    this.setState({ isEditing: false });\n  }\n\n  onEditPermission = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    this.setState({ isEditing: true });\n  }\n\n  onPermissionChanged = (e) => {\n    if (e.value !== this.props.currentPermission) {\n      this.props.onPermissionChanged(e.value);\n    }\n    this.setState({ isEditing: false });\n  }\n\n  onSelectHandler = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n  }\n\n  render() {\n    const { currentPermission, isTextMode } = this.props;\n    let optionTranslation = currentPermission === 'rw' ? gettext('Read-Write') : gettext('Read-Only');\n    return (\n      <div onClick={this.onSelectHandler}>\n        {(isTextMode && !this.state.isEditing) ?\n          <Fragment>\n            <span>{optionTranslation}</span>\n            {this.props.isEditIconShow &&\n              <span title={gettext('Edit')} className=\"fa fa-pencil-alt attr-action-icon\" onClick={this.onEditPermission}/>\n            }\n          </Fragment>\n          :\n          <Select\n            options={this.options}\n            placeholder={optionTranslation}\n            onChange={this.onPermissionChanged}\n            captureMenuScroll={false}\n          />\n        }\n      </div>\n    );\n  }\n}\n\nRepoAPITokenPermissionEditor.propTypes = propTypes;\n\nexport default RepoAPITokenPermissionEditor;\n","import React, {Fragment} from 'react';\nimport PropTypes from 'prop-types';\nimport {gettext} from '../../utils/constants';\nimport {Modal, ModalHeader, ModalBody, Button, Input} from 'reactstrap';\nimport RepoAPITokenPermissionEditor from '../select-editor/repo-api-token-permission-editor';\nimport {seafileAPI} from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\nimport copy from 'copy-to-clipboard';\nimport Loading from '../loading';\n\nconst apiTokenItemPropTypes = {\n  item: PropTypes.object.isRequired,\n  deleteAPIToken: PropTypes.func.isRequired,\n  updateAPIToken: PropTypes.func.isRequired,\n};\n\nclass APITokenItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOperationShow: false,\n    };\n  }\n\n  onMouseEnter = () => {\n    this.setState({isOperationShow: true});\n  };\n\n  onMouseLeave = () => {\n    this.setState({isOperationShow: false});\n  };\n\n  onDeleteAPIToken = () => {\n    this.props.deleteAPIToken(this.props.item.app_name);\n  };\n\n  onUpdateAPIToken = (permission) => {\n    this.props.updateAPIToken(this.props.item.app_name, permission);\n  };\n\n  onCopyAPIToken = () => {\n    let api_token = this.props.item.api_token;\n    copy(api_token);\n    toaster.success(gettext('API token is copied to the clipboard.'));\n  };\n\n  render() {\n    let item = this.props.item;\n\n    return (\n      <tr onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave}>\n        <td className=\"name\">{item.app_name}</td>\n        <td>\n          <RepoAPITokenPermissionEditor\n            isTextMode={true}\n            isEditIconShow={this.state.isOperationShow}\n            currentPermission={item.permission}\n            onPermissionChanged={this.onUpdateAPIToken}\n          />\n        </td>\n        <td>\n          <span>{item.api_token}</span>\n          {this.state.isOperationShow &&\n          <span className=\"far fa-copy action-icon\" onClick={this.onCopyAPIToken} />\n          }\n        </td>\n        <td>\n          <span\n            className={`sf2-icon-x3 action-icon ${this.state.isOperationShow ? '' : 'hide'}`}\n            onClick={this.onDeleteAPIToken}\n            title={gettext('Delete')}\n          />\n        </td>\n      </tr>\n    );\n  }\n}\n\nAPITokenItem.propTypes = apiTokenItemPropTypes;\n\nconst propTypes = {\n  repo: PropTypes.object.isRequired,\n  onRepoAPITokenToggle: PropTypes.func.isRequired,\n};\n\nclass RepoAPITokenDialog extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      apiTokenList: [],\n      permission: 'rw',\n      appName: '',\n      errorMsg: '',\n      loading: true,\n      isSubmitBtnActive: true,\n    };\n    this.repo = this.props.repo;\n  }\n\n  listAPITokens = () => {\n    seafileAPI.listRepoAPITokens(this.repo.repo_id).then((res) => {\n      this.setState({\n        apiTokenList: res.data.repo_api_tokens,\n        loading: false,\n      });\n    }).catch(error => {\n      if (error.response.status === 403) {\n        this.setState({\n          errorMsg: gettext('Permission denied'),\n        });\n      } else {\n        this.handleError(error);\n      }\n    });\n  };\n\n  onInputChange = (e) => {\n    let appName = e.target.value;\n    this.setState({\n      appName: appName,\n    });\n  };\n\n  onKeyDown = (e) => {\n    if (e.keyCode === 13) {\n      e.preventDefault();\n      this.addAPIToken();\n    }\n  };\n\n  setPermission = (permission) => {\n    this.setState({permission: permission});\n  };\n\n  addAPIToken = () => {\n    if (!this.state.appName) {\n      return;\n    }\n\n    this.setState({\n      isSubmitBtnActive: false,\n    });\n    const {appName, permission, apiTokenList} = this.state;\n\n    seafileAPI.addRepoAPIToken(this.repo.repo_id, appName, permission).then((res) => {\n      apiTokenList.push(res.data);\n      this.setState({\n        apiTokenList: apiTokenList,\n        isSubmitBtnActive: true,\n      });\n    }).catch(error => {\n      this.handleError(error);\n      this.setState({\n        isSubmitBtnActive: true,\n      });\n    });\n  };\n\n  deleteAPIToken = (appName) => {\n    seafileAPI.deleteRepoAPIToken(this.repo.repo_id, appName).then((res) => {\n      const apiTokenList = this.state.apiTokenList.filter(item => {\n        return item.app_name !== appName;\n      });\n      this.setState({\n        apiTokenList: apiTokenList,\n      });\n    }).catch(error => {\n      this.handleError(error);\n    });\n  };\n\n  updateAPIToken = (appName, permission) => {\n    seafileAPI.updateRepoAPIToken(this.repo.repo_id, appName, permission).then((res) => {\n      let apiTokenList = this.state.apiTokenList.filter(item => {\n        if (item.app_name === appName) {\n          item.permission = permission;\n        }\n        return item;\n      });\n      this.setState({\n        apiTokenList: apiTokenList,\n      });\n    }).catch(error => {\n      this.handleError(error);\n    });\n  };\n\n  handleError = (e) => {\n    if (e.response) {\n      toaster.danger(e.response.data.error_msg || e.response.data.detail || gettext('Error'), {duration: 3});\n    } else {\n      toaster.danger(gettext('Please check the network.'), {duration: 3});\n    }\n  };\n\n  componentDidMount() {\n    this.listAPITokens();\n  }\n\n  renderContent = () => {\n    const renderAPITokenList = this.state.apiTokenList.map((item, index) => {\n      return (\n        <APITokenItem\n          key={index}\n          item={item}\n          deleteAPIToken={this.deleteAPIToken}\n          updateAPIToken={this.updateAPIToken}\n        />\n      );\n    });\n\n    const thead = (\n      <thead>\n        <tr>\n          <th width=\"20%\">{gettext('App Name')}</th>\n          <th width=\"20%\">{gettext('Permission')}</th>\n          <th width=\"48%\">API Token</th>\n          <th width=\"12%\"></th>\n        </tr>\n      </thead>\n    );\n    return (\n      <Fragment>\n        {this.state.errorMsg &&\n          <p className=\"error text-center\">{this.state.errorMsg}</p>\n        }\n        {!this.state.errorMsg &&\n        <Fragment>\n          <table className=\"w-xs-250\">\n            {thead}\n            <tbody>\n              <tr>\n                <td>\n                  <Input\n                    type=\"text\"\n                    id=\"appName\"\n                    value={this.state.appName}\n                    onChange={this.onInputChange}\n                    onKeyDown={this.onKeyDown}\n                  />\n                </td>\n                <td>\n                  <RepoAPITokenPermissionEditor\n                    isTextMode={false}\n                    isEditIconShow={false}\n                    currentPermission={this.state.permission}\n                    onPermissionChanged={this.setPermission}\n                  />\n                </td>\n                <td><span className=\"text-secondary\">--</span></td>\n                <td>\n                  <Button onClick={this.addAPIToken} disabled={!this.state.isSubmitBtnActive}>{gettext('Submit')}</Button>\n                </td>\n              </tr>\n            </tbody>\n          </table>\n          <div style={{minHeight: '10rem', maxHeight: '18rem'}}>\n            {this.state.apiTokenList.length !== 0 &&\n            <table className=\"table-thead-hidden w-xs-250\">\n              {thead}\n              <tbody>\n                {renderAPITokenList}\n              </tbody>\n            </table>\n            }\n          </div>\n          {this.state.loading && <Loading/>}\n        </Fragment>\n        }\n      </Fragment>\n    );\n  };\n\n  render() {\n    let repo = this.repo;\n\n    const itemName = '<span class=\"op-target\">' + Utils.HTMLescape(repo.repo_name) + '</span>';\n    const title = gettext('{placeholder} API Token').replace('{placeholder}', itemName);\n    return (\n      <Modal\n        isOpen={true} style={{maxWidth: '800px'}}\n        toggle={this.props.onRepoAPITokenToggle}\n      >\n        <ModalHeader toggle={this.props.onRepoAPITokenToggle}>\n          <p dangerouslySetInnerHTML={{__html: title}} className=\"m-0\"></p>\n        </ModalHeader>\n        <ModalBody>\n          <div className=\"o-auto\">\n            {this.renderContent()}\n          </div>\n        </ModalBody>\n      </Modal>\n    );\n  }\n}\n\nRepoAPITokenDialog.propTypes = propTypes;\n\nexport default RepoAPITokenDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalHeader, ModalBody, NavLink } from 'reactstrap';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { siteRoot, gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\nimport Loading from '../loading';\nimport EmptyTip from '../empty-tip';\n\nconst repoShareUploadLinkItemPropTypes = {\n  item: PropTypes.object.isRequired,\n  activeTab: PropTypes.string.isRequired,\n  deleteItem: PropTypes.func.isRequired\n};\n\nclass RepoShareUploadLinkItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOperationShow: false\n    };\n  }\n\n  onMouseEnter = () => {\n    this.setState({isOperationShow: true});\n  };\n\n  onMouseLeave = () => {\n    this.setState({isOperationShow: false});\n  };\n\n  onDeleteLink = (e) => {\n    e.preventDefault();\n    this.props.deleteItem(this.props.item.token);\n  };\n\n  render() {\n\n    let objUrl;\n    let item = this.props.item;\n    let path = item.path === '/' ? '/' : item.path.slice(0, item.path.length - 1);\n\n    if (this.props.activeTab === 'shareLinks') {\n      if (item.is_dir) {\n        objUrl = `${siteRoot}library/${item.repo_id}/${encodeURIComponent(item.repo_name)}${Utils.encodePath(path)}`;\n      } else {\n        objUrl = `${siteRoot}lib/${item.repo_id}/file${Utils.encodePath(item.path)}`;\n      }\n    }\n\n    if (this.props.activeTab === 'uploadLinks') {\n      objUrl = `${siteRoot}library/${item.repo_id}/${encodeURIComponent(item.repo_name)}${Utils.encodePath(path)}`;\n    }\n\n    return (\n      <tr onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave}>\n        <td className=\"name\">{item.creator_name}</td>\n        <td>\n          <a href={objUrl} target=\"_blank\" className=\"text-inherit\">{item.obj_name}</a>\n        </td>\n        <td>\n          <a href={item.link} target=\"_blank\" className=\"text-inherit\">{item.link}</a>\n        </td>\n        <td>\n          <span\n            className={`sf2-icon-x3 action-icon ${this.state.isOperationShow ? '' : 'invisible'}`}\n            onClick={this.onDeleteLink}\n            title={gettext('Delete')}\n          />\n        </td>\n      </tr>\n    );\n  }\n}\n\nRepoShareUploadLinkItem.propTypes = repoShareUploadLinkItemPropTypes;\n\nconst RepoShareUploadLinksDialogPropTypes = {\n  repo: PropTypes.object.isRequired,\n  toggleDialog: PropTypes.func.isRequired\n};\n\nclass RepoShareUploadLinksDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      activeTab: 'shareLinks',\n      repoShareUploadLinkList: [],\n      errorMsg: ''\n    };\n  }\n\n  componentDidMount() {\n    this.getItems('share-link');\n  }\n\n  getItems = (itemType) => {\n    const repoID = this.props.repo.repo_id;\n    const request = itemType == 'share-link' ?\n      seafileAPI.listRepoShareLinks(repoID) :\n      seafileAPI.listRepoUploadLinks(repoID);\n    request.then((res) => {\n      this.setState({\n        loading: false,\n        repoShareUploadLinkList: res.data,\n      });\n    }).catch(error => {\n      this.setState({\n        isLoading: false,\n        errorMsg: Utils.getErrorMsg(error, true)\n      });\n    });\n  }\n\n  deleteItem = (token) => {\n    const repoID = this.props.repo.repo_id;\n    const request = this.state.activeTab == 'shareLinks' ?\n      seafileAPI.deleteRepoShareLink(repoID, token) :\n      seafileAPI.deleteRepoUploadLink(repoID, token);\n    request.then((res) => {\n      const repoShareUploadLinkList = this.state.repoShareUploadLinkList.filter(item => {\n        return item.token !== token;\n      });\n      this.setState({\n        repoShareUploadLinkList: repoShareUploadLinkList\n      });\n    }).catch(error => {\n      toaster.danger(Utils.getErrorMsg(error));\n    });\n  };\n\n  toggle = (tab) => {\n    if (this.state.activeTab !== tab) {\n      this.setState({activeTab: tab});\n    }\n    if (tab == 'shareLinks') {\n      this.getItems('share-link');\n    }\n    if (tab == 'uploadLinks') {\n      this.getItems('upload-link');\n    }\n  };\n\n  render() {\n\n    const { loading, errorMsg, activeTab, repoShareUploadLinkList } = this.state;\n\n    const itemName = '<span class=\"op-target\">' + Utils.HTMLescape(this.props.repo.repo_name) + '</span>';\n    const title = gettext('{placeholder} Share/Upload Links').replace('{placeholder}', itemName);\n\n    return (\n      <Modal isOpen={true} style={{maxWidth: '800px'}}>\n        <ModalHeader toggle={this.props.toggleDialog}>\n          <span dangerouslySetInnerHTML={{__html: title}}></span>\n        </ModalHeader>\n        <ModalBody className=\"p-0 pb-4\">\n          <div className=\"main-panel-center\">\n            <div className=\"cur-view-container\">\n              <div className=\"cur-view-path share-upload-nav\">\n                <ul className=\"nav\">\n                  <li className=\"nav-item\">\n                    <NavLink className={activeTab === 'shareLinks' ? 'active' : ''} onClick={this.toggle.bind(this, 'shareLinks')}>{gettext('Share Links')}</NavLink>\n                  </li>\n                  <li className=\"nav-item\">\n                    <NavLink className={activeTab === 'uploadLinks' ? 'active' : ''} onClick={this.toggle.bind(this, 'uploadLinks')}>{gettext('Upload Links')}</NavLink>\n                  </li>\n                </ul>\n              </div>\n              <div className=\"cur-view-content\" style={{minHeight: '20rem', maxHeight: '20rem'}}>\n                {loading && <Loading />}\n                {!loading && errorMsg && <p className=\"error text-center mt-8\">{errorMsg}</p>}\n                {!loading && !errorMsg && !repoShareUploadLinkList.length &&\n                  <EmptyTip forDialog={true}>\n                    <p className=\"text-secondary\">{activeTab == 'shareLinks' ? gettext('No share links') : gettext('No upload links')}</p>\n                  </EmptyTip>\n                }\n                {!loading && !errorMsg && repoShareUploadLinkList.length > 0 &&\n                <table>\n                  <thead>\n                    <tr>\n                      <th width=\"22%\">{gettext('Creator')}</th>\n                      <th width=\"20%\">{gettext('Name')}</th>\n                      <th width=\"48%\">{gettext('Link')}</th>\n                      <th width=\"10%\"></th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {this.state.repoShareUploadLinkList.map((item, index) => {\n                      return (\n                        <RepoShareUploadLinkItem\n                          key={index}\n                          item={item}\n                          activeTab={this.state.activeTab}\n                          deleteItem={this.deleteItem}\n                        />\n                      );\n                    })}\n                  </tbody>\n                </table>\n                }\n              </div>\n            </div>\n          </div>\n        </ModalBody>\n      </Modal>\n    );\n  }\n}\n\nRepoShareUploadLinksDialog.propTypes = RepoShareUploadLinksDialogPropTypes;\n\nexport default RepoShareUploadLinksDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter, Form, FormGroup, Label, Input, Alert } from 'reactstrap';\nimport { gettext, enableRepoHistorySetting } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api.js';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\n\nconst propTypes = {\n  toggleDialog: PropTypes.func.isRequired,\n  repoID: PropTypes.string.isRequired,\n};\n\nclass LibOldFilesAutoDelDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      autoDelDays: 0,\n      isAutoDel: false,\n      errorInfo: '',\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.getRepoOldFilesAutoDelDays(this.props.repoID).then(res => {\n      this.setState({\n        autoDelDays: res.data.auto_delete_days,\n        isAutoDel: res.data.auto_delete_days > 0,\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  submit = () => {\n    let daysNeedTobeSet = this.state.autoDelDays;\n\n    let reg = /^-?\\d+$/;\n    let isvalid_days = reg.test(daysNeedTobeSet);\n    if (!isvalid_days || daysNeedTobeSet <= 0) {\n      this.setState({\n        errorInfo: gettext('Please enter a positive integer'),\n      });\n      return;\n    }\n\n    if (!this.state.isAutoDel) {\n      daysNeedTobeSet = 0;    // if no auto del, give 0 to server\n    }\n\n    let repoID = this.props.repoID;\n\n    seafileAPI.setRepoOldFilesAutoDelDays(repoID, daysNeedTobeSet).then(res => {\n      this.props.toggleDialog();\n      toaster.success(gettext('Successfully set it.'));\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  handleKeyPress = (e) => {\n    if (e.key === 'Enter') {\n      this.submit();\n      e.preventDefault();\n    }\n  }\n\n  onChange = (e) => {\n    let days = e.target.value;\n    this.setState({\n      autoDelDays: days,\n    });\n  }\n\n  updateRadioCheck = (type) => {\n    if (type === 'noAutoDel') {\n      this.setState({\n        isAutoDel: false,\n      });\n    } else if (type === 'autoDel') {\n      this.setState({\n        isAutoDel: true,\n      });\n    }\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true}>\n        <ModalHeader toggle={this.props.toggleDialog}>\n          {gettext('Auto deletion')}\n        </ModalHeader>\n        <ModalBody>\n          <Form>\n            <FormGroup check>\n              <Input type=\"radio\" name=\"radio1\" checked={!this.state.isAutoDel} onChange={() =>{this.updateRadioCheck('noAutoDel');}}/>{' '}\n              <Label>{gettext('Do not automatically delete files')}</Label>\n            </FormGroup>\n            <FormGroup check>\n              <Input type=\"radio\" name=\"radio1\" checked={this.state.isAutoDel} onChange={() =>{this.updateRadioCheck('autoDel');}}/>{' '}\n              <Label>{gettext('Automatically delete files that are not modified within certain days:')}</Label>\n              <Input\n                type=\"text\"\n                className=\"expire-input\"\n                value={this.state.autoDelDays}\n                onChange={this.onChange}\n                onKeyDown={this.handleKeyPress}\n              />{' '}\n              <Label><span>{gettext('days')}</span></Label>\n            </FormGroup>\n            {this.state.errorInfo && <Alert color=\"danger\">{this.state.errorInfo}</Alert>}\n          </Form>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.props.toggleDialog}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.submit}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nLibOldFilesAutoDelDialog.propTypes = propTypes;\n\nexport default LibOldFilesAutoDelDialog;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport MediaQuery from 'react-responsive';\nimport moment from 'moment';\nimport { Link, navigate } from '@reach/router';\nimport { Utils } from '../../utils/utils';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { gettext, siteRoot, storages } from '../../utils/constants';\nimport ModalPortal from '../../components/modal-portal';\nimport ShareDialog from '../../components/dialog/share-dialog';\nimport toaster from '../../components/toast';\nimport DeleteRepoDialog from '../../components/dialog/delete-repo-dialog';\nimport TransferDialog from '../../components/dialog/transfer-dialog';\nimport LibHistorySettingDialog from '../../components/dialog/lib-history-setting-dialog';\nimport ChangeRepoPasswordDialog from '../../components/dialog/change-repo-password-dialog';\nimport ResetEncryptedRepoPasswordDialog from '../../components/dialog/reset-encrypted-repo-password-dialog';\nimport LabelRepoStateDialog from '../../components/dialog/label-repo-state-dialog';\nimport LibSubFolderPermissionDialog from '../../components/dialog/lib-sub-folder-permission-dialog';\nimport Rename from '../../components/rename';\nimport MylibRepoMenu from './mylib-repo-menu';\nimport RepoAPITokenDialog from '../../components/dialog/repo-api-token-dialog';\nimport RepoShareUploadLinksDialog from '../../components/dialog/repo-share-upload-links-dialog';\nimport LibOldFilesAutoDelDialog from '../../components/dialog/lib-old-files-auto-del-dialog';\n\nconst propTypes = {\n  repo: PropTypes.object.isRequired,\n  isItemFreezed: PropTypes.bool.isRequired,\n  onFreezedItem: PropTypes.func.isRequired,\n  onUnfreezedItem: PropTypes.func.isRequired,\n  onRenameRepo: PropTypes.func.isRequired,\n  onDeleteRepo: PropTypes.func.isRequired,\n  onTransferRepo: PropTypes.func.isRequired,\n  onRepoClick: PropTypes.func.isRequired,\n};\n\nclass MylibRepoListItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOpIconShow: false,\n      isStarred: this.props.repo.starred,\n      isRenaming: false,\n      isShareDialogShow: false,\n      isDeleteDialogShow: false,\n      isTransferDialogShow: false,\n      isHistorySettingDialogShow: false,\n      isChangePasswordDialogShow: false,\n      isResetPasswordDialogShow: false,\n      isLabelRepoStateDialogOpen: false,\n      isFolderPermissionDialogShow: false,\n      isAPITokenDialogShow: false,\n      isRepoShareUploadLinksDialogOpen: false,\n      isRepoDeleted: false,\n      isOldFilesAutoDelDialogOpen: false,\n    };\n  }\n\n  onMouseEnter = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        isOpIconShow: true,\n        highlight: true,\n      });\n    }\n  }\n\n  onMouseLeave = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        isOpIconShow: false,\n        highlight: false\n      });\n    }\n  }\n\n  onMenuItemClick = (item) => {\n    switch(item) {\n      case 'Star':\n      case 'Unstar':\n        this.onStarRepo();\n        break;\n      case 'Share':\n        this.onShareToggle();\n        break;\n      case 'Delete':\n        this.onDeleteToggle();\n        break;\n      case 'Rename':\n        this.onRenameToggle();\n        break;\n      case 'Transfer':\n        this.onTransferToggle();\n        break;\n      case 'History Setting':\n        this.onHistorySettingToggle();\n        break;\n      case 'Change Password':\n        this.onChangePasswordToggle();\n        break;\n      case 'Reset Password':\n        this.onResetPasswordToggle();\n        break;\n      case 'Folder Permission':\n        this.onFolderPermissionToggle();\n        break;\n      case 'Label Current State':\n        this.onLabelToggle();\n        break;\n      case 'API Token':\n        this.onAPITokenToggle();\n        break;\n      case 'Share Links Admin':\n        this.toggleRepoShareUploadLinksDialog();\n        break;\n      case 'Old Files Auto Delete':\n        this.toggleOldFilesAutoDelDialog();\n        break;\n      default:\n        break;\n    }\n  }\n\n  visitRepo = () => {\n    if (!this.state.isRenaming && this.props.repo.repo_name) {\n      navigate(this.repoURL);\n    }\n  }\n\n  onRepoClick = () => {\n    this.props.onRepoClick(this.props.repo);\n  }\n\n  onStarRepo = () => {\n    const repoName = this.props.repo.repo_name;\n    if (this.state.isStarred) {\n      seafileAPI.unstarItem(this.props.repo.repo_id, '/').then(() => {\n        this.setState({isStarred: !this.state.isStarred});\n        const msg = gettext('Successfully unstarred {library_name_placeholder}.')\n          .replace('{library_name_placeholder}', repoName);\n        toaster.success(msg);\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    } else {\n      seafileAPI.starItem(this.props.repo.repo_id, '/').then(() => {\n        this.setState({isStarred: !this.state.isStarred});\n        const msg = gettext('Successfully starred {library_name_placeholder}.')\n          .replace('{library_name_placeholder}', repoName);\n        toaster.success(msg);\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    }\n  }\n\n  onShareToggle = () => {\n    this.setState({isShareDialogShow: !this.state.isShareDialogShow});\n  }\n\n  onDeleteToggle = () => {\n    this.setState({isDeleteDialogShow: !this.state.isDeleteDialogShow});\n  }\n\n  onRenameToggle = () => {\n    this.props.onFreezedItem();\n    this.setState({isRenaming: !this.state.isRenaming});\n  }\n\n  onTransferToggle = () => {\n    this.setState({isTransferDialogShow: !this.state.isTransferDialogShow});\n  }\n\n  onHistorySettingToggle = () => {\n    this.setState({isHistorySettingDialogShow: !this.state.isHistorySettingDialogShow});\n  }\n\n  onChangePasswordToggle = () => {\n    this.setState({isChangePasswordDialogShow: !this.state.isChangePasswordDialogShow});\n  }\n\n  onResetPasswordToggle = () => {\n    this.setState({isResetPasswordDialogShow: !this.state.isResetPasswordDialogShow});\n  }\n\n  onLabelToggle = () => {\n    this.setState({isLabelRepoStateDialogOpen: !this.state.isLabelRepoStateDialogOpen});\n  }\n\n  onFolderPermissionToggle = () => {\n    this.setState({isFolderPermissionDialogShow: !this.state.isFolderPermissionDialogShow});\n  }\n\n  onAPITokenToggle = () => {\n    this.setState({isAPITokenDialogShow: !this.state.isAPITokenDialogShow});\n  }\n\n  toggleRepoShareUploadLinksDialog = () => {\n    this.setState({isRepoShareUploadLinksDialogOpen: !this.state.isRepoShareUploadLinksDialogOpen});\n  }\n\n  toggleOldFilesAutoDelDialog = () => {\n    this.setState({isOldFilesAutoDelDialogOpen: !this.state.isOldFilesAutoDelDialogOpen});\n  }\n\n  onUnfreezedItem = () => {\n    this.setState({\n      highlight: false,\n      isOpIconShow: false,\n    });\n    this.props.onUnfreezedItem();\n  }\n\n  onRenameConfirm = (newName) => {\n    let repo = this.props.repo;\n    let repoID = repo.repo_id;\n    seafileAPI.renameRepo(repoID, newName).then(() => {\n      this.props.onRenameRepo(repo, newName);\n      this.onRenameCancel();\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onRenameCancel = () => {\n    this.props.onUnfreezedItem();\n    this.setState({isRenaming: !this.state.isRenaming});\n  }\n\n  onTransferRepo = (user) => {\n    let repoID = this.props.repo.repo_id;\n    seafileAPI.transferRepo(repoID, user.email).then(res => {\n      this.props.onTransferRepo(repoID);\n      let message = gettext('Successfully transferred the library.');\n      toaster.success(message);\n    }).catch(error => {\n      if (error.response){\n        toaster.danger(error.response.data.error_msg || gettext('Error'), {duration: 3});\n      } else {\n        toaster.danger(gettext('Failed. Please check the network.'), {duration: 3});\n      }\n    });\n    this.onTransferToggle();\n  }\n\n  onDeleteRepo = (repo) => {\n    seafileAPI.deleteRepo(repo.repo_id).then((res) => {\n\n      this.setState({\n        isRepoDeleted: true,\n        isDeleteDialogShow: false,\n      });\n\n      this.props.onDeleteRepo(repo);\n      let name = repo.repo_name;\n      var msg = gettext('Successfully deleted {name}.').replace('{name}', name);\n      toaster.success(msg);\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      if (errMessage === gettext('Error')) {\n        let name = repo.repo_name;\n        errMessage = gettext('Failed to delete {name}.').replace('{name}', name);\n      }\n      toaster.danger(errMessage);\n\n      this.setState({isRepoDeleted: false});\n    });\n  }\n\n  renderPCUI = () => {\n    let repo = this.props.repo;\n    let iconUrl = Utils.getLibIconUrl(repo);\n    let iconTitle = Utils.getLibIconTitle(repo);\n    let repoURL = `${siteRoot}library/${repo.repo_id}/${Utils.encodePath(repo.repo_name)}/`;\n    return (\n      <tr className={this.state.highlight ? 'tr-highlight' : ''} onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave} onClick={this.onRepoClick}>\n        <td className=\"text-center\">\n          {!this.state.isStarred && <i className=\"far fa-star star-empty cursor-pointer\" onClick={this.onStarRepo}></i>}\n          {this.state.isStarred && <i className=\"fas fa-star cursor-pointer\" onClick={this.onStarRepo}></i>}\n        </td>\n        <td><img src={iconUrl} title={iconTitle} alt={iconTitle} width=\"24\" /></td>\n        <td>\n          {this.state.isRenaming && (\n            <Rename\n              name={repo.repo_name}\n              onRenameConfirm={this.onRenameConfirm}\n              onRenameCancel={this.onRenameCancel}\n            />\n          )}\n          {!this.state.isRenaming && repo.repo_name && (\n            <Link to={repoURL}>{repo.repo_name}</Link>\n          )}\n          {!this.state.isRenaming && !repo.repo_name &&\n            (gettext('Broken (please contact your administrator to fix this library)'))\n          }\n        </td>\n        <td>\n          {(repo.repo_name && this.state.isOpIconShow) && (\n            <div>\n              <a href=\"#\" className=\"op-icon sf2-icon-share\" title={gettext('Share')} onClick={this.onShareToggle}></a>\n              <a href=\"#\" className=\"op-icon sf2-icon-delete\" title={gettext('Delete')} onClick={this.onDeleteToggle}></a>\n              <MylibRepoMenu\n                isPC={true}\n                repo={this.props.repo}\n                onMenuItemClick={this.onMenuItemClick}\n                onFreezedItem={this.props.onFreezedItem}\n                onUnfreezedItem={this.onUnfreezedItem}\n              />\n            </div>\n          )}\n        </td>\n        <td>{repo.size}</td>\n        {storages.length > 0 && <td>{repo.storage_name}</td>}\n        <td title={moment(repo.last_modified).format('llll')}>{moment(repo.last_modified).fromNow()}</td>\n      </tr>\n    );\n  }\n\n  renderMobileUI = () => {\n    let repo = this.props.repo;\n    let iconUrl = Utils.getLibIconUrl(repo);\n    let iconTitle = Utils.getLibIconTitle(repo);\n    let repoURL = this.repoURL = `${siteRoot}library/${repo.repo_id}/${Utils.encodePath(repo.repo_name)}/`;\n\n    return (\n      <tr className={this.state.highlight ? 'tr-highlight' : ''}  onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave} onClick={this.onRepoClick}>\n        <td onClick={this.visitRepo}><img src={iconUrl} title={iconTitle} alt={iconTitle} width=\"24\" /></td>\n        <td onClick={this.visitRepo}>\n          {this.state.isRenaming && (\n            <Rename\n              name={repo.repo_name}\n              onRenameConfirm={this.onRenameConfirm}\n              onRenameCancel={this.onRenameCancel}\n            />\n          )}\n          {!this.state.isRenaming && repo.repo_name && (\n            <div><Link to={repoURL}>{repo.repo_name}</Link></div>\n          )}\n          {!this.state.isRenaming && !repo.repo_name &&\n            <div>(gettext('Broken (please contact your administrator to fix this library)'))</div>\n          }\n          <span className=\"item-meta-info\">{repo.size}</span>\n          <span className=\"item-meta-info\" title={moment(repo.last_modified).format('llll')}>{moment(repo.last_modified).fromNow()}</span>\n        </td>\n        <td>\n          {repo.repo_name && (\n            <MylibRepoMenu\n              repo={this.props.repo}\n              isStarred={this.state.isStarred}\n              onMenuItemClick={this.onMenuItemClick}\n              onFreezedItem={this.props.onFreezedItem}\n              onUnfreezedItem={this.onUnfreezedItem}\n            />\n          )}\n        </td>\n      </tr>\n    );\n  }\n\n  render() {\n    let repo = this.props.repo;\n    return (\n      <Fragment>\n        <MediaQuery query=\"(min-width: 768px)\">\n          {this.renderPCUI()}\n        </MediaQuery>\n        <MediaQuery query=\"(max-width: 767.8px)\">\n          {this.renderMobileUI()}\n        </MediaQuery>\n        {this.state.isShareDialogShow && (\n          <ModalPortal>\n            <ShareDialog\n              itemType={'library'}\n              itemName={repo.repo_name}\n              itemPath={'/'}\n              repoID={repo.repo_id}\n              repoEncrypted={repo.encrypted}\n              enableDirPrivateShare={true}\n              userPerm={repo.permission}\n              toggleDialog={this.onShareToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isDeleteDialogShow && (\n          <ModalPortal>\n            <DeleteRepoDialog\n              repo={repo}\n              isRepoDeleted={this.state.isRepoDeleted}\n              onDeleteRepo={this.onDeleteRepo}\n              toggle={this.onDeleteToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isTransferDialogShow && (\n          <ModalPortal>\n            <TransferDialog\n              itemName={repo.repo_name}\n              submit={this.onTransferRepo}\n              toggleDialog={this.onTransferToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isHistorySettingDialogShow && (\n          <ModalPortal>\n            <LibHistorySettingDialog\n              repoID={repo.repo_id}\n              itemName={repo.repo_name}\n              toggleDialog={this.onHistorySettingToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isChangePasswordDialogShow && (\n          <ModalPortal>\n            <ChangeRepoPasswordDialog\n              repoID={repo.repo_id}\n              repoName={repo.repo_name}\n              toggleDialog={this.onChangePasswordToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isResetPasswordDialogShow && (\n          <ModalPortal>\n            <ResetEncryptedRepoPasswordDialog\n              repoID={repo.repo_id}\n              toggleDialog={this.onResetPasswordToggle}\n            />\n          </ModalPortal>\n        )}\n\n        {this.state.isLabelRepoStateDialogOpen && (\n          <ModalPortal>\n            <LabelRepoStateDialog\n              repoID={repo.repo_id}\n              repoName={repo.repo_name}\n              toggleDialog={this.onLabelToggle}\n            />\n          </ModalPortal>\n        )}\n\n        {this.state.isFolderPermissionDialogShow && (\n          <ModalPortal>\n            <LibSubFolderPermissionDialog\n              toggleDialog={this.onFolderPermissionToggle}\n              repoID={repo.repo_id}\n              repoName={repo.repo_name}\n            />\n          </ModalPortal>\n        )}\n\n        {this.state.isAPITokenDialogShow && (\n          <ModalPortal>\n            <RepoAPITokenDialog\n              repo={repo}\n              onRepoAPITokenToggle={this.onAPITokenToggle}\n            />\n          </ModalPortal>\n        )}\n\n        {this.state.isRepoShareUploadLinksDialogOpen && (\n          <ModalPortal>\n            <RepoShareUploadLinksDialog\n              repo={repo}\n              toggleDialog={this.toggleRepoShareUploadLinksDialog}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isOldFilesAutoDelDialogOpen && (\n          <ModalPortal>\n            <LibOldFilesAutoDelDialog\n              repoID={repo.repo_id}\n              toggleDialog={this.toggleOldFilesAutoDelDialog}\n            />\n          </ModalPortal>\n        )}\n\n      </Fragment>\n    );\n  }\n}\n\nMylibRepoListItem.propTypes = propTypes;\n\nexport default MylibRepoListItem;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport MediaQuery from 'react-responsive';\nimport { gettext, storages } from '../../utils/constants';\nimport MylibRepoListItem from './mylib-repo-list-item';\nimport LibsMobileThead from '../../components/libs-mobile-thead';\n\nconst propTypes = {\n  sortBy: PropTypes.string.isRequired,\n  sortOrder: PropTypes.string.isRequired,\n  repoList: PropTypes.array.isRequired,\n  sortRepoList: PropTypes.func.isRequired,\n  onRenameRepo: PropTypes.func.isRequired,\n  onDeleteRepo: PropTypes.func.isRequired,\n  onTransferRepo: PropTypes.func.isRequired,\n  onRepoClick: PropTypes.func.isRequired,\n};\n\nclass MylibRepoListView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isItemFreezed: false,\n    };\n  }\n\n  onFreezedItem = () => {\n    this.setState({isItemFreezed: true});\n  }\n\n  onUnfreezedItem = () => {\n    this.setState({isItemFreezed: false});\n  }\n\n  sortByName = (e) => {\n    e.preventDefault();\n    const sortBy = 'name';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortRepoList(sortBy, sortOrder);\n  }\n\n  sortByTime = (e) => {\n    e.preventDefault();\n    const sortBy = 'time';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortRepoList(sortBy, sortOrder);\n  }\n\n  sortBySize = (e) => {\n    e.preventDefault();\n    const sortBy = 'size';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortRepoList(sortBy, sortOrder);\n  }\n\n  renderRepoListView = () => {\n    return (\n      <Fragment>\n        {this.props.repoList.map(item => {\n          return (\n            <MylibRepoListItem\n              key={item.repo_id}\n              repo={item}\n              isItemFreezed={this.state.isItemFreezed}\n              onFreezedItem={this.onFreezedItem}\n              onUnfreezedItem={this.onUnfreezedItem}\n              onRenameRepo={this.props.onRenameRepo}\n              onDeleteRepo={this.props.onDeleteRepo}\n              onTransferRepo={this.props.onTransferRepo}\n              onRepoClick={this.props.onRepoClick}\n            />\n          );\n        })}\n      </Fragment>\n    );\n  }\n\n  renderPCUI = () => {\n    const showStorageBackend = storages.length > 0;\n    const sortIcon = this.props.sortOrder === 'asc' ? <span className=\"fas fa-caret-up\"></span> : <span className=\"fas fa-caret-down\"></span>;\n    return (\n      <table>\n        <thead>\n          <tr>\n            <th width=\"4%\"></th>\n            <th width=\"4%\"><span className=\"sr-only\">{gettext('Library Type')}</span></th>\n            <th width={showStorageBackend ? '33%' : '38%'}><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortByName}>{gettext('Name')} {this.props.sortBy === 'name' && sortIcon}</a></th>\n            <th width=\"14%\"><span className=\"sr-only\">{gettext('Actions')}</span></th>\n            <th width={showStorageBackend ? '15%' : '20%'}><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortBySize}>{gettext('Size')} {this.props.sortBy === 'size' && sortIcon}</a></th>\n            {showStorageBackend ? <th width=\"15%\">{gettext('Storage Backend')}</th> : null}\n            <th width={showStorageBackend ? '15%' : '20%'}><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortByTime}>{gettext('Last Update')} {this.props.sortBy === 'time' && sortIcon}</a></th>\n          </tr>\n        </thead>\n        <tbody>\n          {this.renderRepoListView()}\n        </tbody>\n      </table>\n    );\n  }\n\n  renderMobileUI = () => {\n    return (\n      <table className=\"table-thead-hidden\">\n        <LibsMobileThead />\n        <tbody>\n          {this.renderRepoListView()}\n        </tbody>\n      </table>\n    );\n  }\n\n  render() {\n    return (\n      <Fragment>\n        <MediaQuery query=\"(min-width: 768px)\">\n          {this.renderPCUI()}\n        </MediaQuery>\n        <MediaQuery query=\"(max-width: 767.8px)\">\n          {this.renderMobileUI()}\n        </MediaQuery>\n      </Fragment>\n    );\n  }\n}\n\nMylibRepoListView.propTypes = propTypes;\n\nexport default MylibRepoListView;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalBody } from 'reactstrap';\nimport { gettext, mediaUrl, siteName, canAddRepo } from '../../utils/constants';\n\nconst propTypes = {\n  toggleDialog: PropTypes.func.isRequired\n};\n\nclass GuideForNewDialog extends React.Component {\n\n  toggle = () => {\n    this.props.toggleDialog();\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true} toggle={this.toggle}>\n        <ModalBody>\n          <button type=\"button\" className=\"close text-gray\" onClick={this.toggle}><span aria-hidden=\"true\">×</span></button>\n          <div className=\"p-2 text-center\">\n            <img src={`${mediaUrl}img/welcome.png`} width=\"180\" alt=\"\" />\n            <h3 id=\"dialogTitle\">{gettext('Welcome to {site_name_placeholder}').replace('{site_name_placeholder}', siteName)}</h3>\n            {canAddRepo ?\n              <p>{gettext('{site_name_placeholder} organizes files into libraries. Each library can be synced and shared separately. We have created a personal library for you. You can create more libraries later.').replace('{site_name_placeholder}', siteName)}</p> :\n              <p>{gettext('{site_name_placeholder} organizes files into libraries. Each library can be synced and shared separately. However, since you are a guest user now, you can not create libraries.').replace('{site_name_placeholder}', siteName)}</p>\n            }\n          </div>\n        </ModalBody>\n      </Modal>\n    );\n  }\n}\n\nGuideForNewDialog.propTypes = propTypes;\n\nexport default GuideForNewDialog;\n","import React, { Component, Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport cookie from 'react-cookies';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../../components/toast';\nimport Repo from '../../models/repo';\nimport Loading from '../../components/loading';\nimport EmptyTip from '../../components/empty-tip';\nimport CommonToolbar from '../../components/toolbar/common-toolbar';\nimport RepoViewToolbar from '../../components/toolbar/repo-view-toobar';\nimport LibDetail from '../../components/dirent-detail/lib-details';\nimport MylibRepoListView from './mylib-repo-list-view';\nimport SortOptionsDialog from '../../components/dialog/sort-options';\nimport GuideForNewDialog from '../../components/dialog/guide-for-new-dialog';\n\nconst propTypes = {\n  onShowSidePanel: PropTypes.func.isRequired,\n  onSearchedClick: PropTypes.func.isRequired,\n};\n\nclass MyLibraries extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      errorMsg: '',\n      isLoading: true,\n      repoList: [],\n      isShowDetails: false,\n      isSortOptionsDialogOpen: false,\n      isGuideForNewDialogOpen: window.app.pageOptions.guideEnabled,\n      sortBy: cookie.load('seafile-repo-dir-sort-by') || 'name', // 'name' or 'time' or 'size'\n      sortOrder: cookie.load('seafile-repo-dir-sort-order') || 'asc', // 'asc' or 'desc'\n    };\n\n    this.emptyTip = (\n      <EmptyTip>\n        <h2>{gettext('No libraries')}</h2>\n        <p>{gettext('You have not created any libraries yet. A library is a container to organize your files and folders. A library can also be shared with others and synced to your connected devices. You can create a library by clicking the \"New Library\" button in the menu bar.')}</p>\n      </EmptyTip>\n    );\n  }\n\n  componentDidMount() {\n    seafileAPI.listRepos({type: 'mine'}).then((res) => {\n      let repoList = res.data.repos.map((item) => {\n        return new Repo(item);\n      });\n      this.setState({\n        isLoading: false,\n        repoList: Utils.sortRepos(repoList, this.state.sortBy, this.state.sortOrder)\n      });\n    }).catch((error) => {\n      this.setState({\n        isLoading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  toggleSortOptionsDialog = () => {\n    this.setState({\n      isSortOptionsDialogOpen: !this.state.isSortOptionsDialogOpen\n    });\n  }\n\n  onCreateRepo = (repo) => {\n    seafileAPI.createMineRepo(repo).then((res) => {\n      const newRepo = new Repo({\n        repo_id: res.data.repo_id,\n        repo_name: res.data.repo_name,\n        size: res.data.repo_size,\n        mtime: res.data.mtime,\n        owner_email: res.data.email,\n        encrypted: res.data.encrypted,\n        permission: res.data.permission,\n        storage_name: res.data.storage_name\n      });\n      this.state.repoList.unshift(newRepo);\n      this.setState({repoList: this.state.repoList});\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  sortRepoList = (sortBy, sortOrder) => {\n    cookie.save('seafile-repo-dir-sort-by', sortBy);\n    cookie.save('seafile-repo-dir-sort-order', sortOrder);\n    this.setState({\n      sortBy: sortBy,\n      sortOrder: sortOrder,\n      repoList: Utils.sortRepos(this.state.repoList, sortBy, sortOrder)\n    });\n  }\n\n  onTransferRepo = (repoID) => {\n    let repoList = this.state.repoList.filter(item => {\n      return item.repo_id !== repoID;\n    });\n    this.setState({repoList: repoList});\n  }\n\n  onRenameRepo = (repo, newName) => {\n    let repoList = this.state.repoList.map(item => {\n      if (item.repo_id === repo.repo_id) {\n        item.repo_name = newName;\n      }\n      return item;\n    });\n    this.setState({repoList: repoList});\n  }\n\n  onDeleteRepo = (repo) => {\n    let repoList = this.state.repoList.filter(item => {\n      return item.repo_id !== repo.repo_id;\n    });\n    this.setState({repoList: repoList});\n  }\n\n  onRepoClick = (repo) => {\n    if (this.state.isShowDetails) {\n      this.onRepoDetails(repo);\n    }\n  }\n\n  onRepoDetails = (repo) => {\n    this.setState({\n      currentRepo: repo,\n      isShowDetails: true,\n    });\n  }\n\n  closeDetails = () => {\n    this.setState({isShowDetails: !this.state.isShowDetails});\n  }\n\n  toggleGuideForNewDialog = () => {\n    window.app.pageOptions.guideEnabled = false;\n    this.setState({\n      isGuideForNewDialogOpen: false\n    });\n  }\n\n  render() {\n    return (\n      <Fragment>\n        <div className=\"main-panel-north border-left-show\">\n          <RepoViewToolbar onShowSidePanel={this.props.onShowSidePanel} onCreateRepo={this.onCreateRepo} libraryType={'mine'}/>\n          <CommonToolbar onSearchedClick={this.props.onSearchedClick} />\n        </div>\n        <div className=\"main-panel-center flex-row\">\n          <div className=\"cur-view-container\">\n            <div className=\"cur-view-path\">\n              <h3 className=\"sf-heading m-0\">{gettext('My Libraries')}</h3>\n              {(!Utils.isDesktop() && this.state.repoList.length > 0) && <span className=\"sf3-font sf3-font-sort action-icon\" onClick={this.toggleSortOptionsDialog}></span>}\n            </div>\n            <div className=\"cur-view-content\">\n              {this.state.isLoading && <Loading />}\n              {!this.state.isLoading && this.state.errorMsg && <p className=\"error text-center mt-8\">{this.state.errorMsg}</p>}\n              {!this.state.isLoading && !this.state.errorMsg && this.state.repoList.length === 0 && this.emptyTip}\n              {!this.state.isLoading && !this.state.errorMsg && this.state.repoList.length > 0 &&\n                <MylibRepoListView\n                  sortBy={this.state.sortBy}\n                  sortOrder={this.state.sortOrder}\n                  repoList={this.state.repoList}\n                  onRenameRepo={this.onRenameRepo}\n                  onDeleteRepo={this.onDeleteRepo}\n                  onTransferRepo={this.onTransferRepo}\n                  onRepoClick={this.onRepoClick}\n                  sortRepoList={this.sortRepoList}\n                />\n              }\n            </div>\n          </div>\n          {!this.state.isLoading && !this.state.errorMsg && this.state.isGuideForNewDialogOpen &&\n            <GuideForNewDialog\n              toggleDialog={this.toggleGuideForNewDialog}\n            />\n          }\n          {this.state.isSortOptionsDialogOpen &&\n            <SortOptionsDialog\n              toggleDialog={this.toggleSortOptionsDialog}\n              sortBy={this.state.sortBy}\n              sortOrder={this.state.sortOrder}\n              sortItems={this.sortRepoList}\n            />\n          }\n          {this.state.isShowDetails && (\n            <div className=\"cur-view-detail\">\n              <LibDetail\n                currentRepo={this.state.currentRepo}\n                closeDetails={this.closeDetails}\n              />\n            </div>\n          )}\n        </div>\n      </Fragment>\n    );\n  }\n}\n\nMyLibraries.propTypes = propTypes;\n\nexport default MyLibraries;\n","import React, { Component, Fragment } from 'react';\nimport { Link } from '@reach/router';\nimport moment from 'moment';\nimport { gettext, siteRoot, lang, trashReposExpireDays } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../../components/toast';\nimport Loading from '../../components/loading';\nimport EmptyTip from '../../components/empty-tip';\nimport CommonToolbar from '../../components/toolbar/common-toolbar';\n\nmoment.locale(lang);\n\nclass MyLibsDeleted extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      deletedRepoList: [],\n      isLoading: true,\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.listDeletedRepo().then(res => {\n      this.setState({\n        deletedRepoList: res.data,\n        isLoading: false,\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  refreshDeletedRepoList = (repoID) => {\n    let deletedRepoList = this.state.deletedRepoList.filter(item => {\n      return item.repo_id !== repoID;\n    });\n    this.setState({deletedRepoList: deletedRepoList});\n  }\n\n  render() {\n    return (\n      <Fragment>\n        <div className=\"main-panel-north\">\n          <CommonToolbar onSearchedClick={this.props.onSearchedClick} />\n        </div>\n        <div className=\"main-panel-center\">\n          <div className=\"cur-view-container\">\n            <div className=\"cur-view-path\">\n              <div className=\"path-container\">\n                <Link to={ siteRoot + 'my-libs/' }>{gettext('My Libraries')}</Link>\n                <span className=\"path-split\">/</span>\n                <span>{gettext('Deleted Libraries')}</span>\n              </div>\n            </div>\n            <div className=\"cur-view-content\">\n              {this.state.isLoading && <Loading />}\n              {(!this.state.isLoading && this.state.deletedRepoList.length === 0) &&\n              <EmptyTip>\n                <h2>{gettext('No deleted libraries')}</h2>\n                <p>{gettext('You have not deleted any libraries in the last {placeholder} days. A deleted library will be cleaned automatically after this period.').replace('{placeholder}', trashReposExpireDays)}</p>\n              </EmptyTip>\n              }\n              {this.state.deletedRepoList.length !== 0 &&\n                <div>\n                  <p className=\"tip mt-2\">{gettext('Tip: libraries deleted {placeholder} days ago will be cleaned automatically.').replace('{placeholder}', trashReposExpireDays)}</p>\n                  <DeletedRepoTable\n                    deletedRepoList={this.state.deletedRepoList}\n                    refreshDeletedRepoList={this.refreshDeletedRepoList}\n                  />\n                </div>\n              }\n            </div>\n          </div>\n        </div>\n      </Fragment>\n    );\n  }\n}\n\nclass DeletedRepoTable extends Component {\n\n  render() {\n    let deletedRepos = this.props.deletedRepoList;\n    return (\n      <table>\n        <thead>\n          <tr>\n            <th style={{width: '4%'}}>{/*img*/}</th>\n            <th style={{width: '52%'}}>{gettext('Name')}</th>\n            <th style={{width: '30%'}}>{gettext('Deleted Time')}</th>\n            <th style={{width: '14%'}}></th>\n          </tr>\n        </thead>\n        <tbody>\n          { deletedRepos && deletedRepos.map((item) => {\n            return (\n              <DeletedRepoItem\n                key={item.repo_id}\n                repo={item}\n                refreshDeletedRepoList={this.props.refreshDeletedRepoList}\n              />\n            );\n          })}\n        </tbody>\n      </table>\n    );\n  }\n}\n\nclass DeletedRepoItem extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      hideRestoreMenu: true,\n      highlight: false,\n    };\n  }\n\n  onMouseEnter = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        hideRestoreMenu: false,\n        highlight: true,\n      });\n    }\n  }\n\n  onMouseLeave = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        hideRestoreMenu: true,\n        highlight: false,\n      });\n    }\n  }\n\n  restoreDeletedRepo = () => {\n    let repoID = this.props.repo.repo_id;\n    let repoName = this.props.repo.repo_name;\n    seafileAPI.restoreDeletedRepo(repoID).then(res => {\n      let message = gettext('Successfully restored the library.') + '  ' + repoName;\n      toaster.success(message);\n      this.props.refreshDeletedRepoList(repoID);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      if (errMessage === gettext('Error')) {\n        errMessage = gettext('Failed. Please check the network.');\n      }\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    let localTime = moment.utc(this.props.repo.del_time).toDate();\n    localTime = moment(localTime).fromNow();\n    let iconUrl = Utils.getLibIconUrl(this.props.repo);\n\n    return (\n      <tr className={this.state.highlight ? 'tr-highlight' : ''} onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave}>\n        <td className=\"text-center\"><img src={iconUrl} alt='' width=\"24\" /></td>\n        <td className=\"name\">{this.props.repo.repo_name}</td>\n        <td className=\"update\">{localTime}</td>\n        <td>\n          <span onClick={this.restoreDeletedRepo} title={gettext('Restore')}\n            className={`sf2-icon-reply action-icon ${this.state.highlight ? '' : 'vh'}`}></span>\n        </td>\n      </tr>\n    );\n  }\n}\n\nexport default MyLibsDeleted;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter, Input, Alert } from 'reactstrap';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport Repo from '../../models/repo';\n\nconst shareRepoListItemProps = {\n  repo: PropTypes.object.isRequired,\n  onRepoSelect: PropTypes.func.isRequired,\n  onPermissionChange: PropTypes.func.isRequired,\n};\n\nclass ShareRepoListItem extends React.Component {\n\n  onRepoSelect = (e) => {\n    let isChecked = e.target.checked;\n    this.props.onRepoSelect(this.props.repo, isChecked);\n  }\n\n  onPermissionChange = (e) => {\n    let permission = e.target.value;\n    let repo = this.props.repo;\n    this.props.onPermissionChange(repo, permission);\n  }\n\n  render() {\n    let repo = this.props.repo;\n    let iconUrl = Utils.getLibIconUrl(repo);\n    return (\n      <tr>\n        <td className=\"text-center\"><input type=\"checkbox\" className=\"vam\" name=\"repo\" onChange={this.onRepoSelect} /></td>\n        <td className=\"text-center\"><img src={iconUrl} width=\"24\" alt={gettext('icon')} /></td>\n        <td className=\"name\">{repo.repo_name}</td>\n        <td>{moment(repo.last_modified).fromNow()}</td>\n        <td>\n          <Input style={{height: '1.5rem', padding: 0}} type=\"select\" name=\"select\" onChange={this.onPermissionChange} value={repo.sharePermission}>\n            <option value='rw'>{gettext('Read-Write')}</option>\n            <option value='r'>{gettext('Read-Only')}</option>\n          </Input>\n        </td>\n      </tr>\n    );\n  }\n}\n\nShareRepoListItem.propTypes = shareRepoListItemProps;\n\nconst propTypes = {\n  onRepoSelectedHandler: PropTypes.func.isRequired,\n  onShareRepoDialogClose: PropTypes.func.isRequired,\n};\n\nclass ShareRepoDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      repoList: [],\n      currentRepo: null,\n      permission: 'rw',\n      selectedRepoList: [],\n      errMessage: '',\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.listRepos({type: 'mine'}).then(res => {\n      let repoList = res.data.repos.map(item => {\n        let repo = new Repo(item);\n        repo.sharePermission = 'rw';\n        return repo;\n      });\n      this.setState({repoList: repoList});\n    });\n  }\n\n  onRepoSelect = (repo, isChecked) => {\n    let selectedRepoList = [];\n    if (isChecked) {\n      this.state.selectedRepoList.push(repo);\n      selectedRepoList = this.state.selectedRepoList;\n    } else {\n      selectedRepoList = this.state.selectedRepoList.filter(item => {\n        return item.repo_id !== repo.repo_id;\n      });\n    }\n    this.setState({selectedRepoList: selectedRepoList});\n  }\n\n  onPermissionChange = (repo, permission) => {\n    let repoList = this.state.repoList.map(item => {\n      if (item.repo_id === repo.repo_id) {\n        item.sharePermission = permission;\n      }\n      return item;\n    });\n    this.setState({repoList: repoList});\n  }\n\n  handleSubmit = () => {\n    if (this.state.selectedRepoList.length === 0) {\n      let errMessage = gettext('Please select a library to share.');\n      this.setState({errMessage: errMessage});\n      return;\n    }\n\n    this.props.onRepoSelectedHandler(this.state.selectedRepoList);\n    this.onCloseDialog();\n  }\n\n  onCloseDialog = () => {\n    this.props.onShareRepoDialogClose();\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true}>\n        <ModalHeader toggle={this.toggle}>{gettext('Select libraries to share')}</ModalHeader>\n        <ModalBody className=\"dialog-list-container\">\n          <table>\n            <thead>\n              <tr>\n                <th width='4%'>{/* select */}</th>\n                <th width='6%'>{/* icon */}</th>\n                <th width='35%'>{gettext('Name')}</th>\n                <th width='25%'>{gettext('Last Update')}</th>\n                <th width='30%'>{gettext('Permission')}</th>\n              </tr>\n            </thead>\n            <tbody>\n              {this.state.repoList.map((repo, index) => {\n                return (\n                  <ShareRepoListItem\n                    key={index}\n                    repo={repo}\n                    onRepoSelect={this.onRepoSelect}\n                    onPermissionChange={this.onPermissionChange}\n                  />\n                );\n              })}\n            </tbody>\n          </table>\n        </ModalBody>\n        {this.state.errMessage && <Alert color=\"danger\" className=\"mt-2\">{this.state.errMessage}</Alert>}\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.onCloseDialog}>{gettext('Close')}</Button>\n          <Button color=\"primary\" onClick={this.handleSubmit}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nShareRepoDialog.propTypes = propTypes;\n\nexport default ShareRepoDialog;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport { Dropdown, DropdownMenu, DropdownToggle, DropdownItem } from 'reactstrap';\nimport { Link, navigate } from '@reach/router';\nimport { Utils } from '../../utils/utils';\nimport { gettext, siteRoot, isPro, username, folderPermEnabled, isSystemStaff, enableResetEncryptedRepoPassword, isEmailConfigured } from '../../utils/constants';\nimport ModalPortal from '../../components/modal-portal';\nimport ShareDialog from '../../components/dialog/share-dialog';\nimport LibSubFolderPermissionDialog from '../../components/dialog/lib-sub-folder-permission-dialog';\nimport DeleteRepoDialog from '../../components/dialog/delete-repo-dialog';\nimport ChangeRepoPasswordDialog from '../../components/dialog/change-repo-password-dialog';\nimport ResetEncryptedRepoPasswordDialog from '../../components/dialog/reset-encrypted-repo-password-dialog';\nimport Rename from '../rename';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport LibHistorySettingDialog from '../dialog/lib-history-setting-dialog';\nimport toaster from '../toast';\nimport RepoAPITokenDialog from '../dialog/repo-api-token-dialog';\nimport RepoShareUploadLinksDialog from '../dialog/repo-share-upload-links-dialog';\n\nconst propTypes = {\n  currentGroup: PropTypes.object,\n  libraryType: PropTypes.string,\n  repo: PropTypes.object.isRequired,\n  isItemFreezed: PropTypes.bool.isRequired,\n  onFreezedItem: PropTypes.func.isRequired,\n  onUnfreezedItem: PropTypes.func.isRequired,\n  onItemUnshare: PropTypes.func.isRequired,\n  onItemDetails: PropTypes.func,\n  onItemRename: PropTypes.func,\n  onItemDelete: PropTypes.func,\n};\n\nclass SharedRepoListItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      highlight: false,\n      isOperationShow: false,\n      isItemMenuShow: false,\n      isShowSharedDialog: false,\n      isRenaming: false,\n      isStarred: this.props.repo.starred,\n      isFolderPermissionDialogOpen: false,\n      isHistorySettingDialogShow: false,\n      isDeleteDialogShow: false,\n      isAPITokenDialogShow: false,\n      isRepoShareUploadLinksDialogOpen: false,\n      isRepoDeleted: false,\n      isChangePasswordDialogShow: false,\n      isResetPasswordDialogShow: false\n    };\n    this.isDeparementOnwerGroupMember = false;\n  }\n\n  onMouseEnter = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        highlight: true,\n        isOperationShow: true,\n      });\n    }\n  }\n\n  onMouseOver = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        highlight: true,\n        isOperationShow: true,\n      });\n    }\n  }\n\n  onMouseLeave = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        highlight: false,\n        isOperationShow: false,\n      });\n    }\n  }\n\n  clickOperationMenuToggle = (e) => {\n    this.toggleOperationMenu(e);\n  }\n\n  toggleOperationMenu = (e) => {\n    let dataset = e.target ? e.target.dataset : null;\n    if (dataset && dataset.toggle && dataset.toggle === 'Rename') {\n      this.setState({isItemMenuShow: !this.state.isItemMenuShow});\n      return;\n    }\n\n    this.setState(\n      {isItemMenuShow: !this.state.isItemMenuShow},\n      () => {\n        if (this.state.isItemMenuShow) {\n          this.props.onFreezedItem();\n        } else {\n          this.props.onUnfreezedItem();\n          this.setState({\n            highlight: false,\n            isOperationShow: false,\n          });\n        }\n      }\n    );\n  }\n\n  getRepoComputeParams = () => {\n    let repo = this.props.repo;\n\n    let iconUrl = Utils.getLibIconUrl(repo);\n    let iconTitle = Utils.getLibIconTitle(repo);\n    let libPath = `${siteRoot}library/${repo.repo_id}/${Utils.encodePath(repo.repo_name)}/`;\n\n    return { iconUrl, iconTitle, libPath };\n  }\n\n  onMenuItemClick = (e) => {\n    let operation = e.target.dataset.toggle;\n    switch(operation) {\n      case 'Rename':\n        this.onItemRenameToggle();\n        break;\n      case 'Folder Permission':\n        this.onItemFolderPermissionToggle();\n        break;\n      case 'Details':\n        this.onItemDetails();\n        break;\n      case 'Share':\n        this.onItemShare();\n        break;\n      case 'Unshare':\n        this.onItemUnshare();\n        break;\n      case 'History Setting':\n        this.onHistorySettingToggle();\n        break;\n      case 'API Token':\n        this.onAPITokenToggle();\n        break;\n      case 'Share Links Admin':\n        this.toggleRepoShareUploadLinksDialog();\n        break;\n      case 'Change Password':\n        this.onChangePasswordToggle();\n        break;\n      case 'Reset Password':\n        this.onResetPasswordToggle();\n        break;\n      default:\n        break;\n    }\n  }\n\n  onItemRenameToggle = () => {\n    this.props.onFreezedItem();\n    this.setState({\n      isRenaming: !this.state.isRenaming,\n      isOperationShow: !this.state.isOperationShow\n    });\n  }\n\n  onRenameConfirm = (name) => {\n    this.props.onItemRename(this.props.repo, name);\n    this.onRenameCancel();\n  }\n\n  onRenameCancel = () => {\n    this.props.onUnfreezedItem();\n    this.setState({isRenaming: !this.state.isRenaming});\n  }\n\n  onItemFolderPermissionToggle = () => {\n    this.setState({isFolderPermissionDialogOpen: !this.state.isFolderPermissionDialogOpen});\n  }\n\n  onHistorySettingToggle = () => {\n    this.setState({isHistorySettingDialogShow: !this.state.isHistorySettingDialogShow});\n  }\n\n  onItemDetails = () => {\n    this.props.onItemDetails(this.props.repo);\n  }\n\n  onItemShare = () => {\n    this.setState({isShowSharedDialog: true});\n  }\n\n  onItemUnshare = () => {\n    this.props.onItemUnshare(this.props.repo);\n  }\n\n  onItemDeleteToggle = () => {\n    this.setState({isDeleteDialogShow: !this.state.isDeleteDialogShow});\n  }\n\n  onItemDelete = () => {\n    const { currentGroup, repo } = this.props;\n    if (!currentGroup) {  // repo can not be deleted in share all module\n      return;\n    }\n\n    const groupID = currentGroup.id;\n\n    seafileAPI.deleteGroupOwnedLibrary(groupID, repo.repo_id).then(() => {\n\n      this.setState({\n        isRepoDeleted: true,\n        isDeleteDialogShow: false,\n      });\n\n      this.props.onItemDelete(repo);\n      let name = repo.repo_name;\n      var msg = gettext('Successfully deleted {name}.').replace('{name}', name);\n      toaster.success(msg);\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      if (errMessage === gettext('Error')) {\n        let name = repo.repo_name;\n        errMessage = gettext('Failed to delete {name}.').replace('{name}', name);\n      }\n      toaster.danger(errMessage);\n\n      this.setState({isRepoDeleted: false});\n    });\n  }\n\n  toggleShareDialog = () => {\n    this.setState({isShowSharedDialog: false});\n  }\n\n  toggleRepoShareUploadLinksDialog = () => {\n    this.setState({isRepoShareUploadLinksDialogOpen: !this.state.isRepoShareUploadLinksDialogOpen});\n  }\n\n  onAPITokenToggle = () => {\n    this.setState({isAPITokenDialogShow: !this.state.isAPITokenDialogShow});\n  }\n\n  onChangePasswordToggle = () => {\n    this.setState({isChangePasswordDialogShow: !this.state.isChangePasswordDialogShow});\n  }\n\n  onResetPasswordToggle = () => {\n    this.setState({isResetPasswordDialogShow: !this.state.isResetPasswordDialogShow});\n  }\n\n  translateMenuItem = (menuItem) => {\n    let translateResult = '';\n    switch(menuItem) {\n      case 'Rename':\n        translateResult = gettext('Rename');\n        break;\n      case 'Folder Permission':\n        translateResult = gettext('Folder Permission');\n        break;\n      case 'Details':\n        translateResult = gettext('Details');\n        break;\n      case 'Unshare':\n        translateResult = gettext('Unshare');\n        break;\n      case 'Share':\n        translateResult = gettext('Share');\n        break;\n      case 'History Setting':\n        translateResult = gettext('History Setting');\n        break;\n      case 'Share Links Admin':\n        translateResult = gettext('Share Links Admin');\n        break;\n      case 'Change Password':\n        translateResult = gettext('Change Password');\n        break;\n      case 'Reset Password':\n        translateResult = gettext('Reset Password');\n        break;\n      case 'API Token':\n        translateResult = 'API Token'; // translation is not needed here\n        break;\n      default:\n        break;\n    }\n    return translateResult;\n  }\n\n  generatorOperations = () => {\n    let { repo, currentGroup } = this.props;\n    //todo this have a bug; use current api is not return admins param;\n    let isStaff = currentGroup && currentGroup.admins && currentGroup.admins.indexOf(username) > -1; //for group repolist;\n    let isRepoOwner = repo.owner_email === username;\n    let isAdmin = repo.is_admin;\n    let operations = [];\n    if (isPro) {\n      if (repo.owner_email.indexOf('@seafile_group') != -1) {\n        if (isStaff) {\n          if (repo.owner_email == currentGroup.id + '@seafile_group') {\n            this.isDeparementOnwerGroupMember = true;\n            operations = ['Rename'];\n            if (folderPermEnabled) {\n              operations.push('Folder Permission');\n            }\n            operations.push('Share Links Admin');\n            if (repo.encrypted) {\n              operations.push('Change Password');\n            }\n            if (repo.encrypted && enableResetEncryptedRepoPassword && isEmailConfigured) {\n              operations.push('Reset Password');\n            }\n            operations.push('History Setting', 'API Token', 'Details');\n          } else {\n            operations.push('Unshare');\n          }\n        }\n      } else {\n        if (isRepoOwner || isAdmin) {\n          operations.push('Share');\n        }\n        if (isStaff || isRepoOwner || isAdmin) {\n          operations.push('Unshare');\n        }\n      }\n    } else {\n      if (isRepoOwner) {\n        operations.push('Share');\n      }\n      if (isStaff || isRepoOwner) {\n        operations.push('Unshare');\n      }\n    }\n    return operations;\n  }\n\n  generatorMobileMenu = () => {\n    let operations = [];\n    if (this.props.libraryType && this.props.libraryType === 'public') {\n      let isRepoOwner = this.props.repo.owner_email === username;\n      if (isSystemStaff || isRepoOwner) {\n        operations.push('Unshare');\n      }\n    } else {\n      operations = this.generatorOperations();\n      if (this.isDeparementOnwerGroupMember) {\n        operations.unshift('Unshare');\n        operations.unshift('Share');\n      }\n    }\n\n    if (!operations.length) {\n      return null;\n    }\n    return (\n      <Dropdown isOpen={this.state.isItemMenuShow} toggle={this.toggleOperationMenu}>\n        <DropdownToggle\n          tag=\"i\"\n          className=\"sf-dropdown-toggle fa fa-ellipsis-v ml-0\"\n          title={gettext('More Operations')}\n          data-toggle=\"dropdown\"\n          aria-expanded={this.state.isItemMenuShow}\n          onClick={this.clickOperationMenuToggle}\n        />\n        <div className={`${this.state.isItemMenuShow?'':'d-none'}`} onClick={this.toggleOperationMenu}>\n          <div className=\"mobile-operation-menu-bg-layer\"></div>\n          <div className=\"mobile-operation-menu\">\n            {operations.map((item, index) => {\n              return (\n                <DropdownItem key={index} data-toggle={item} onClick={this.onMenuItemClick}>{this.translateMenuItem(item)}</DropdownItem>\n              );\n            })}\n          </div>\n        </div>\n      </Dropdown>\n    );\n  }\n\n  generatorPCMenu = () => {\n    let operations = [];\n    if (this.props.libraryType && this.props.libraryType === 'public') {\n      let isRepoOwner = this.props.repo.owner_email === username;\n      if (isSystemStaff || isRepoOwner) {\n        operations.push('Unshare');\n      }\n    } else {\n      // scene one: (Share, Delete, itemToggle and other operations);\n      // scene two: (Share, Unshare), (Share), (Unshare)\n      operations = this.generatorOperations();\n    }\n    const shareOperation   = <a href=\"#\" className=\"op-icon sf2-icon-share\" title={gettext('Share')} onClick={this.onItemShare}></a>;\n    const unshareOperation = <a href=\"#\" className=\"op-icon sf2-icon-x3\" title={gettext('Unshare')} onClick={this.onItemUnshare}></a>;\n    const deleteOperation  = <a href=\"#\" className=\"op-icon sf2-icon-delete\" title={gettext('Delete')} onClick={this.onItemDeleteToggle}></a>;\n\n    if (this.isDeparementOnwerGroupMember) {\n      return (\n        <Fragment>\n          {shareOperation}\n          {deleteOperation}\n          <Dropdown isOpen={this.state.isItemMenuShow} toggle={this.toggleOperationMenu}>\n            <DropdownToggle\n              tag=\"i\"\n              className=\"sf-dropdown-toggle sf2-icon-caret-down\"\n              title={gettext('More Operations')}\n              data-toggle=\"dropdown\"\n              aria-expanded={this.state.isItemMenuShow}\n              onClick={this.clickOperationMenuToggle}\n            />\n            <DropdownMenu>\n              {operations.map((item, index) => {\n                return <DropdownItem key={index} data-toggle={item} onClick={this.onMenuItemClick}>{this.translateMenuItem(item)}</DropdownItem>;\n              })}\n            </DropdownMenu>\n          </Dropdown>\n        </Fragment>\n      );\n    } else {\n      if (operations.length == 2) {\n        return (\n          <Fragment>\n            {shareOperation}\n            {unshareOperation}\n          </Fragment>\n        );\n      }\n      if (operations.length == 1 && operations[0] === 'Share') {\n        return shareOperation;\n      }\n\n      if (operations.length == 1 && operations[0] === 'Unshare') {\n        return unshareOperation;\n      }\n    }\n    return null;\n  }\n\n  onStarRepo = () => {\n    if (this.state.isStarred) {\n      seafileAPI.unstarItem(this.props.repo.repo_id, '/').then(() => {\n        this.setState({isStarred: !this.state.isStarred});\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    } else {\n      seafileAPI.starItem(this.props.repo.repo_id, '/').then(() => {\n        this.setState({isStarred: !this.state.isStarred});\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    }\n  }\n\n  renderPCUI = () => {\n    let { iconUrl, iconTitle, libPath } = this.getRepoComputeParams();\n    let { repo } = this.props;\n    return (\n      <Fragment>\n        <tr className={this.state.highlight ? 'tr-highlight' : ''} onMouseEnter={this.onMouseEnter} onMouseOver={this.onMouseOver} onMouseLeave={this.onMouseLeave}>\n          <td className=\"text-center\">\n            {!this.state.isStarred && <i className=\"far fa-star star-empty cursor-pointer\" onClick={this.onStarRepo}></i>}\n            {this.state.isStarred && <i className=\"fas fa-star cursor-pointer\" onClick={this.onStarRepo}></i>}\n          </td>\n          <td><img src={iconUrl} title={iconTitle} alt={iconTitle} width=\"24\" /></td>\n          <td>\n            {this.state.isRenaming ?\n              <Rename  name={repo.repo_name} onRenameConfirm={this.onRenameConfirm} onRenameCancel={this.onRenameCancel}/> :\n              <Link to={libPath}>{repo.repo_name}</Link>\n            }\n          </td>\n          <td>{this.state.isOperationShow && this.generatorPCMenu()}</td>\n          <td>{repo.size}</td>\n          <td title={moment(repo.last_modified).format('llll')}>{moment(repo.last_modified).fromNow()}</td>\n          <td title={repo.owner_contact_email}>{repo.owner_name}</td>\n        </tr>\n      </Fragment>\n    );\n  }\n\n  visitRepo = () => {\n    if (!this.state.isRenaming) {\n      navigate(this.repoURL);\n    }\n  }\n  \n  renderMobileUI = () => {\n    let { iconUrl, iconTitle, libPath } = this.getRepoComputeParams();\n    let { repo } = this.props;\n    this.repoURL = libPath;\n    return (\n      <Fragment>\n        <tr className={this.state.highlight ? 'tr-highlight' : ''}  onMouseEnter={this.onMouseEnter} onMouseOver={this.onMouseOver} onMouseLeave={this.onMouseLeave}>\n          <td onClick={this.visitRepo}><img src={iconUrl} title={iconTitle} width=\"24\" alt={iconTitle}/></td>\n          <td onClick={this.visitRepo}>\n            {this.state.isRenaming ?\n              <Rename name={repo.repo_name} onRenameConfirm={this.onRenameConfirm} onRenameCancel={this.onRenameCancel} /> :\n              <Link to={libPath}>{repo.repo_name}</Link>\n            }\n            <br />\n            <span className=\"item-meta-info\" title={repo.owner_contact_email}>{repo.owner_name}</span>\n            <span className=\"item-meta-info\">{repo.size}</span>\n            <span className=\"item-meta-info\" title={moment(repo.last_modified).format('llll')}>{moment(repo.last_modified).fromNow()}</span>\n          </td>\n          <td>{this.generatorMobileMenu()}</td>\n        </tr>\n      </Fragment>\n    );\n  }\n\n  render() {\n    let { repo } = this.props;\n    let isGroupOwnedRepo = repo.owner_email.indexOf('@seafile_group') > -1;\n    return (\n      <Fragment>\n        {Utils.isDesktop() ? this.renderPCUI() : this.renderMobileUI()}\n        {this.state.isShowSharedDialog && (\n          <ModalPortal>\n            <ShareDialog\n              itemType={'library'}\n              itemName={repo.repo_name}\n              itemPath={'/'}\n              repoID={repo.repo_id}\n              repoEncrypted={repo.encrypted}\n              enableDirPrivateShare={true}\n              userPerm={repo.permission}\n              isAdmin={repo.is_admin}\n              isGroupOwnedRepo={isGroupOwnedRepo}\n              toggleDialog={this.toggleShareDialog}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isFolderPermissionDialogOpen && (\n          <ModalPortal>\n            <LibSubFolderPermissionDialog\n              toggleDialog={this.onItemFolderPermissionToggle}\n              repoID={repo.repo_id}\n              repoName={repo.repo_name}\n              isDepartmentRepo={true}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isDeleteDialogShow &&\n          <ModalPortal>\n            <DeleteRepoDialog\n              repo={this.props.repo}\n              isRepoDeleted={this.state.isRepoDeleted}\n              onDeleteRepo={this.onItemDelete}\n              toggle={this.onItemDeleteToggle}\n            />\n          </ModalPortal>\n        }\n        {this.state.isHistorySettingDialogShow && (\n          <ModalPortal>\n            <LibHistorySettingDialog\n              repoID={repo.repo_id}\n              itemName={repo.repo_name}\n              toggleDialog={this.onHistorySettingToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isAPITokenDialogShow && (\n          <ModalPortal>\n            <RepoAPITokenDialog\n              repo={repo}\n              onRepoAPITokenToggle={this.onAPITokenToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isRepoShareUploadLinksDialogOpen && (\n          <ModalPortal>\n            <RepoShareUploadLinksDialog\n              repo={repo}\n              toggleDialog={this.toggleRepoShareUploadLinksDialog}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isChangePasswordDialogShow && (\n          <ModalPortal>\n            <ChangeRepoPasswordDialog\n              repoID={repo.repo_id}\n              repoName={repo.repo_name}\n              toggleDialog={this.onChangePasswordToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isResetPasswordDialogShow && (\n          <ModalPortal>\n            <ResetEncryptedRepoPasswordDialog\n              repoID={repo.repo_id}\n              toggleDialog={this.onResetPasswordToggle}\n            />\n          </ModalPortal>\n        )}\n      </Fragment>\n    );\n  }\n}\n\nSharedRepoListItem.propTypes = propTypes;\n\nexport default SharedRepoListItem;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport SharedRepoListItem from './shared-repo-list-item';\nimport toaster from '../toast';\nimport LibsMobileThead from '../libs-mobile-thead';\nimport Loading from '../loading';\n\nconst propTypes = {\n  libraryType: PropTypes.string,\n  currentGroup: PropTypes.object,\n  isShowTableThread: PropTypes.bool,\n  sortBy: PropTypes.string,\n  sortOrder: PropTypes.string,\n  sortItems: PropTypes.func,\n  repoList: PropTypes.array.isRequired,\n  onItemUnshare: PropTypes.func.isRequired,\n  onItemDelete: PropTypes.func,\n  onItemDetails: PropTypes.func,\n  onItemRename: PropTypes.func,\n  hasNextPage: PropTypes.bool\n};\n\nclass SharedRepoListView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isItemFreezed: false,\n    };\n  }\n\n  sortByName = (e) => {\n    e.preventDefault();\n    const sortBy = 'name';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortItems(sortBy, sortOrder);\n  }\n\n  sortByTime = (e) => {\n    e.preventDefault();\n    const sortBy = 'time';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortItems(sortBy, sortOrder);\n  }\n\n  sortBySize = (e) => {\n    e.preventDefault();\n    const sortBy = 'size';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortItems(sortBy, sortOrder);\n  }\n\n  getSortMetaData = () => {\n    return {\n      sortByName: this.props.sortBy == 'name',\n      sortByTime: this.props.sortBy == 'time',\n      sortBySize: this.props.sortBy == 'size',\n      sortIcon: this.props.sortOrder == 'asc' ? <span className=\"fas fa-caret-up\"></span> : <span className=\"fas fa-caret-down\"></span>\n    };\n  }\n\n  onFreezedItem = () => {\n    this.setState({isItemFreezed: true});\n  }\n\n  onUnfreezedItem = () => {\n    this.setState({isItemFreezed: false});\n  }\n\n  onItemRename = (repo, newName) => {\n    let isDuplicated = this.props.repoList.some(item => {\n      return item.name === newName;\n    });\n    if (isDuplicated) {\n      let errMessage = gettext('The name \"{name}\" is already taken. Please choose a different name.');\n      errMessage = errMessage.replace('{name}', Utils.HTMLescape(newName));\n      toaster.danger(errMessage);\n      return false;\n    }\n    this.props.onItemRename(repo, newName);\n  }\n\n  renderRepoListView = () => {\n    return (\n      <Fragment>\n        {this.props.repoList.map(repo => {\n          return (\n            <SharedRepoListItem\n              key={repo.repo_id}\n              repo={repo}\n              libraryType={this.props.libraryType}\n              currentGroup={this.props.currentGroup}\n              isItemFreezed={this.state.isItemFreezed}\n              onFreezedItem={this.onFreezedItem}\n              onUnfreezedItem={this.onUnfreezedItem}\n              onItemUnshare={this.props.onItemUnshare}\n              onItemDelete={this.props.onItemDelete}\n              onItemDetails={this.props.onItemDetails}\n              onItemRename={this.props.onItemRename}\n            />\n          );\n        })}\n      </Fragment>\n    );\n  }\n\n  renderPCUI = () => {\n    let isShowTableThread = this.props.isShowTableThread !== undefined ? this.props.isShowTableThread : true;\n\n    const { sortByName, sortByTime, sortBySize, sortIcon } = this.getSortMetaData();\n\n    return (\n      <table className={isShowTableThread ? '' : 'table-thead-hidden'}>\n        <thead>\n          <tr>\n            <th width=\"4%\"></th>\n            <th width=\"4%\"><span className=\"sr-only\">{gettext('Library Type')}</span></th>\n            <th width=\"36%\"><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortByName}>{gettext('Name')} {sortByName && sortIcon}</a></th>\n            <th width=\"12%\"><span className=\"sr-only\">{gettext('Actions')}</span></th>\n            <th width={'14%'}><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortBySize}>{gettext('Size')} {sortBySize && sortIcon}</a></th>\n            <th width={'14%'}><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortByTime}>{gettext('Last Update')} {sortByTime && sortIcon}</a></th>\n            <th width=\"16%\">{gettext('Owner')}</th>\n          </tr>\n        </thead>\n        <tbody>\n          {this.renderRepoListView()}\n        </tbody>\n      </table>\n    );\n  }\n\n  renderMobileUI = () => {\n    return (\n      <table className=\"table-thead-hidden\">\n        <LibsMobileThead />\n        <tbody>\n          {this.renderRepoListView()}\n        </tbody>\n      </table>\n    );\n  }\n\n  render() {\n    const table = Utils.isDesktop() ? this.renderPCUI() : this.renderMobileUI();\n    if (this.props.hasNextPage) {\n      return (\n        <Fragment>\n          {table}\n          <Loading />\n        </Fragment>\n      );\n    } else {\n      return table;\n    }\n  }\n}\n\nSharedRepoListView.propTypes = propTypes;\n\nexport default SharedRepoListView;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport cookie from 'react-cookies';\nimport MediaQuery from 'react-responsive';\nimport { Dropdown, DropdownToggle, DropdownMenu, DropdownItem } from 'reactstrap';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { gettext, canAddPublicRepo } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport Repo from '../../models/repo';\nimport toaster from '../../components/toast';\nimport Loading from '../../components/loading';\nimport EmptyTip from '../../components/empty-tip';\nimport ModalPortal from '../../components/modal-portal';\nimport CommonToolbar from '../../components/toolbar/common-toolbar';\nimport CreateRepoDialog from '../../components/dialog/create-repo-dialog';\nimport ShareRepoDialog from '../../components/dialog/share-repo-dialog';\nimport SharedRepoListView from '../../components/shared-repo-list-view/shared-repo-list-view';\nimport SortOptionsDialog from '../../components/dialog/sort-options';\n\nconst propTypes = {\n  onShowSidePanel: PropTypes.func.isRequired,\n  onSearchedClick: PropTypes.func.isRequired,\n};\n\nclass PublicSharedView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isLoading: true,\n      errMessage: '',\n      emptyTip: '',\n      repoList: [],\n      sortBy: cookie.load('seafile-repo-dir-sort-by') || 'name', // 'name' or 'time' or 'size'\n      sortOrder: cookie.load('seafile-repo-dir-sort-order') || 'asc', // 'asc' or 'desc'\n      isSortOptionsDialogOpen: false,\n      libraryType: 'public',\n      isCreateMenuShow: false,\n      isCreateRepoDialogShow: false,\n      isSelectRepoDialpgShow: false,\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.listRepos({type: 'public'}).then((res) => {\n      let repoList = res.data.repos.map(item => {\n        let repo = new Repo(item);\n        return repo;\n      });\n      this.setState({\n        isLoading: false,\n        repoList: Utils.sortRepos(repoList, this.state.sortBy, this.state.sortOrder)\n      });\n    }).catch((error) => {\n      this.setState({\n        isLoading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  onCreateRepo = (repo) => {\n    seafileAPI.createPublicRepo(repo).then(res => {\n      let object = {  // need modify api return value\n        repo_id: res.data.id,\n        repo_name: res.data.name,\n        permission: res.data.permission,\n        size: res.data.size,\n        owner_name: res.data.owner_name,\n        owner_email: res.data.owner,\n        mtime: res.data.mtime,\n        encrypted: res.data.encrypted,\n      };\n      let repo = new Repo(object);\n      let repoList = this.addRepoItem(repo);\n      this.setState({repoList: repoList});\n      this.onCreateRepoToggle();\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onRepoSelectedHandler = (selectedRepoList) => {\n    selectedRepoList.forEach(repo => {\n      seafileAPI.selectOwnedRepoToPublic(repo.repo_id, {share_type: 'public', permission: repo.sharePermission}).then(() => {\n        let repoList = this.addRepoItem(repo);\n        this.setState({repoList: repoList});\n      }).catch((error) => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    });\n  }\n\n  onItemUnshare = (repo) => {\n    seafileAPI.unshareRepo(repo.repo_id, {share_type: 'public'}).then(() => {\n      let repoList = this.state.repoList.filter(item => {\n        return item.repo_id !== repo.repo_id;\n      });\n      this.setState({repoList: repoList});\n      let message = gettext('Successfully unshared {name}').replace('{name}', repo.repo_name);\n      toaster.success(message);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      if (errMessage === gettext('Error')) {\n        errMessage = gettext('Failed to unshare {name}').replace('{name}', repo.repo_name);\n      }\n      toaster(errMessage);\n    });\n  }\n\n  onItemDelete = () => {\n    // todo need to optimized\n  }\n\n  addRepoItem = (repo) => {\n    let isExist = false;\n    let repoIndex = 0;\n    let repoList = this.state.repoList;\n    for (let i = 0; i < repoList.length; i ++) {\n      if (repo.repo_id === repoList[i].repo_id) {\n        isExist = true;\n        repoIndex = i;\n        break;\n      }\n    }\n    if (isExist) {\n      this.state.repoList.splice(repoIndex, 1);\n    }\n\n    let newRepoList = this.state.repoList.map(item => {return item;});\n    newRepoList.unshift(repo);\n    return newRepoList;\n  }\n\n  onAddRepoToggle = () => {\n    this.setState({isCreateMenuShow: !this.state.isCreateMenuShow});\n  }\n\n  onCreateRepoToggle = () => {\n    this.setState({isCreateRepoDialogShow: !this.state.isCreateRepoDialogShow});\n  }\n\n  onSelectRepoToggle = () => {\n    this.setState({isSelectRepoDialpgShow: !this.state.isSelectRepoDialpgShow});\n  }\n\n  sortItems = (sortBy, sortOrder) => {\n    cookie.save('seafile-repo-dir-sort-by', sortBy);\n    cookie.save('seafile-repo-dir-sort-order', sortOrder);\n    this.setState({\n      sortBy: sortBy,\n      sortOrder: sortOrder,\n      repoList: Utils.sortRepos(this.state.repoList, sortBy, sortOrder)\n    });\n  }\n\n  toggleSortOptionsDialog = () => {\n    this.setState({\n      isSortOptionsDialogOpen: !this.state.isSortOptionsDialogOpen\n    });\n  }\n\n  render() {\n    let errMessage = this.state.errMessage;\n    let emptyTip = (\n      <EmptyTip>\n        <h2>{gettext('No public libraries')}</h2>\n        <p>{gettext('No public libraries have been created yet. A public library is accessible by all users. You can create a public library by clicking the \"Add Library\" button in the menu bar.')}</p>\n      </EmptyTip>\n    );\n    return (\n      <Fragment>\n        <div className=\"main-panel-north border-left-show\">\n          {canAddPublicRepo &&\n            <div className=\"cur-view-toolbar\">\n              <span className=\"sf2-icon-menu side-nav-toggle hidden-md-up d-md-none\" title=\"Side Nav Menu\" onClick={this.props.onShowSidePanel}></span>\n              <div className=\"operation\">\n                <Dropdown isOpen={this.state.isCreateMenuShow} toggle={this.onAddRepoToggle}>\n                  <MediaQuery query=\"(min-width: 768px)\">\n                    <DropdownToggle className='btn btn-secondary operation-item'>\n                      <i className=\"fas fa-plus-square text-secondary mr-1\"></i>{gettext('Add Library')}\n                    </DropdownToggle>\n                  </MediaQuery>\n                  <MediaQuery query=\"(max-width: 767.8px)\">\n                    <DropdownToggle\n                      tag=\"span\"\n                      className=\"sf2-icon-plus mobile-toolbar-icon\"\n                      title={gettext('Add Library')}\n                    />\n                  </MediaQuery>\n                  <DropdownMenu>\n                    <DropdownItem onClick={this.onSelectRepoToggle}>{gettext('Share existing libraries')}</DropdownItem>\n                    <DropdownItem onClick={this.onCreateRepoToggle}>{gettext('New Library')}</DropdownItem>\n                  </DropdownMenu>\n                </Dropdown>\n              </div>\n            </div>\n          }\n          <CommonToolbar onSearchedClick={this.props.onSearchedClick} />\n        </div>\n        <div className=\"main-panel-center\">\n          <div className=\"cur-view-container\">\n            <div className=\"cur-view-path\">\n              <h3 className=\"sf-heading m-0\">{gettext('Shared with all')}</h3>\n              {(!Utils.isDesktop() && this.state.repoList.length > 0) && <span className=\"sf3-font sf3-font-sort action-icon\" onClick={this.toggleSortOptionsDialog}></span>}\n            </div>\n            <div className=\"cur-view-content\">\n              {this.state.isLoading && <Loading />}\n              {(!this.state.isLoading && errMessage) && errMessage}\n              {(!this.state.isLoading && this.state.repoList.length === 0) && emptyTip}\n              {(!this.state.isLoading && this.state.repoList.length > 0) &&\n                <SharedRepoListView\n                  libraryType={this.state.libraryType}\n                  repoList={this.state.repoList}\n                  sortBy={this.state.sortBy}\n                  sortOrder={this.state.sortOrder}\n                  sortItems={this.sortItems}\n                  onItemUnshare={this.onItemUnshare}\n                  onItemDelete={this.onItemDelete}\n                />\n              }\n            </div>\n          </div>\n        </div>\n        {this.state.isSortOptionsDialogOpen &&\n        <SortOptionsDialog\n          toggleDialog={this.toggleSortOptionsDialog}\n          sortBy={this.state.sortBy}\n          sortOrder={this.state.sortOrder}\n          sortItems={this.sortItems}\n        />\n        }\n        {this.state.isCreateRepoDialogShow && (\n          <ModalPortal>\n            <CreateRepoDialog\n              libraryType={this.state.libraryType}\n              onCreateToggle={this.onCreateRepoToggle}\n              onCreateRepo={this.onCreateRepo}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isSelectRepoDialpgShow && (\n          <ModalPortal>\n            <ShareRepoDialog\n              onRepoSelectedHandler={this.onRepoSelectedHandler}\n              onShareRepoDialogClose={this.onSelectRepoToggle}\n            />\n          </ModalPortal>\n        )}\n      </Fragment>\n    );\n  }\n}\n\nPublicSharedView.propTypes = propTypes;\n\nexport default PublicSharedView;\n","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}","import io from 'socket.io-client';\nimport { name, username, contactEmail, seafileCollabServer } from './constants';\n\nconst socket = (seafileCollabServer !== '') ? io(seafileCollabServer) : undefined;\n\nclass CollabServer {\n\n  watchRepo(repoID, fn) {\n    if (!socket) {\n      return;\n    }\n    socket.emit('repo_update', {\n      request: 'watch_update',\n      repo_id: repoID,\n      user: {\n        name: name,\n        username: username,\n        contact_email: contactEmail,\n      },\n    });\n    socket.on('repo_update', fn);\n  }\n\n  unwatchRepo(repoID, fn) {\n    if (!socket) {\n      return;\n    }\n    socket.emit('repo_update', {\n      request: 'unwatch_update',\n      repo_id: repoID,\n      user: {\n        name: name,\n        username: username,\n        contact_email: contactEmail,\n      },\n    });\n    socket.off('repo_update', fn);\n  }\n}\n\nconst collabServer = new CollabServer();\n\nexport default collabServer;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalBody, Form } from 'reactstrap';\nimport { gettext, siteRoot, mediaUrl } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\n\nimport '../../css/lib-decrypt.css';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  onLibDecryptDialog: PropTypes.func.isRequired\n};\n\n\nclass LibDecryptDialog extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      password: '',\n      showError: false,\n    };\n  }\n\n  handleSubmit = (e) => {\n    let repoID = this.props.repoID;\n    let password = this.state.password;\n    seafileAPI.setRepoDecryptPassword(repoID, password).then(res => {\n      this.props.onLibDecryptDialog();\n    }).catch(res => {\n      this.setState({\n        showError: true\n      });\n    });\n\n    e.preventDefault();\n  }\n\n  handleKeyPress = (e) => {\n    if (e.key == 'Enter') {\n      this.handleSubmit(e);\n    }\n  };\n\n  handleChange = (e) => {\n    this.setState({\n      password: e.target.value,\n      showError: false\n    });\n  }\n\n  toggle = () => {\n    window.location.href = siteRoot;\n  };\n\n  render() {\n    return (\n      <Modal isOpen={true}>\n        <ModalBody>\n          <button type=\"button\" className=\"close\" onClick={this.toggle}><span aria-hidden=\"true\">×</span></button>\n          <Form className=\"lib-decrypt-form text-center\">\n            <img src={`${mediaUrl}img/lock.png`} alt=\"\" aria-hidden=\"true\" />\n            <p className=\"intro\">{gettext('This library is password protected')}</p>\n            {this.state.showError &&\n              <p className=\"error\">{gettext('Wrong password')}</p>\n            }\n            <input type=\"password\" name=\"password\" className=\"form-control password-input\" autoComplete=\"off\" onKeyPress={this.handleKeyPress} placeholder={gettext('Password')} onChange={this.handleChange} />\n            <button type=\"submit\" className=\"btn btn-primary submit\" onClick={this.handleSubmit}>{gettext('Submit')}</button>\n            <p className=\"tip\">{'* '}{gettext('The password will be kept in the server for only 1 hour.')}</p>\n          </Form>\n        </ModalBody>\n      </Modal>\n    );\n  }\n}\n\nLibDecryptDialog.propTypes = propTypes;\n\nexport default LibDecryptDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\n\nconst propTypes = {\n  currentMode: PropTypes.string.isRequired,\n  switchViewMode: PropTypes.func.isRequired,\n};\n\nclass ViewModeToolbar extends React.Component {\n\n  switchViewMode = (e) => {\n    e.preventDefault();\n    let id = e.target.id;\n    if (id === this.props.currentMode) {\n      return;\n    }\n    this.props.switchViewMode(id);\n  }\n\n  render() {\n    let baseClass = 'btn btn-secondary btn-icon sf-view-mode-btn ';\n    return (\n      <React.Fragment>\n        <div className=\"view-mode btn-group\">\n          <button className={`${baseClass} sf2-icon-list-view ${this.props.currentMode === 'list' ? 'current-mode' : ''}`} id='list' title={gettext('List')} onClick={this.switchViewMode}></button>\n          <button className={`${baseClass} sf2-icon-grid-view ${this.props.currentMode === 'grid' ? 'current-mode' : ''}`} id='grid' title={gettext('Grid')} onClick={this.switchViewMode}></button>\n          <button className={`${baseClass} sf2-icon-two-columns ${this.props.currentMode === 'column' ? 'current-mode' : ''}`} id='column' title={gettext('Column')} onClick={this.switchViewMode}></button>\n        </div>\n        <div className=\"detail-btn btn-group\">\n          <button className=\"btn btn-secondary btn-icon ml-1 fas fa-info\" id='detail' title={gettext('Detail')} onClick={this.switchViewMode}></button>\n        </div>\n      </React.Fragment>\n    );\n  }\n}\n\nViewModeToolbar.propTypes = propTypes;\n\nexport default ViewModeToolbar;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Modal, ModalHeader, Input, ModalBody, ModalFooter, Form, FormGroup, Label, Alert } from 'reactstrap';\nimport { gettext, isDocs } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  fileType: PropTypes.string,\n  parentPath: PropTypes.string.isRequired,\n  onAddFile: PropTypes.func.isRequired,\n  checkDuplicatedName: PropTypes.func.isRequired,\n  addFileCancel: PropTypes.func.isRequired,\n};\n\nclass CreateFile extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      parentPath: '',\n      childName: props.fileType || '',\n      isDraft: false,\n      errMessage: '',\n      isSubmitBtnActive: false,\n    };\n    this.newInput = React.createRef();\n  }\n\n  componentDidMount() {\n    let parentPath = this.props.parentPath;\n    if (parentPath[parentPath.length - 1] === '/') {  // mainPanel\n      this.setState({parentPath: parentPath});\n    } else {\n      this.setState({parentPath: parentPath + '/'}); // sidePanel\n    }\n    this.newInput.focus();\n    this.newInput.setSelectionRange(0,0);\n  }\n\n  handleChange = (e) => {\n    if (!e.target.value.trim()) {\n      this.setState({isSubmitBtnActive: false});\n    } else {\n      this.setState({isSubmitBtnActive: true});\n    }\n\n    this.setState({\n      childName: e.target.value,\n    }) ;\n  }\n\n  handleSubmit = () => {\n    if (!this.state.isSubmitBtnActive) {\n      return;\n    }\n\n    let isDuplicated = this.checkDuplicatedName();\n    let newName = this.state.childName;\n\n    if (isDuplicated) {\n      let errMessage = gettext('The name \"{name}\" is already taken. Please choose a different name.');\n      errMessage = errMessage.replace('{name}', Utils.HTMLescape(newName));\n      this.setState({errMessage: errMessage});\n    } else {\n      let path = this.state.parentPath + newName;\n      let isDraft = this.state.isDraft;\n      this.props.onAddFile(path, isDraft);\n    }\n  }\n\n  handleKeyPress = (e) => {\n    if (e.key === 'Enter') {\n      this.handleSubmit();\n      e.preventDefault();\n    }\n  }\n\n  handleCheck = () => {\n    let pos = this.state.childName.lastIndexOf('.');\n\n    if (this.state.isDraft) {\n      // from draft to not draft\n      // case 1, normally, the file name is ended with `(draft)`, like `test(draft).md`\n      // case 2, the file name is not ended with `(draft)`, the user has deleted some characters, like `test(dra.md`\n      let p = this.state.childName.substring(pos-7, pos);\n      let fileName = this.state.childName.substring(0, pos-7);\n      let fileType = this.state.childName.substring(pos);\n      if (p === '(draft)') {\n        // remove `(draft)` from file name\n        this.setState({\n          childName: fileName + fileType,\n          isDraft: !this.state.isDraft\n        });\n      } else {\n        // don't change file name\n        this.setState({\n          isDraft: !this.state.isDraft\n        });\n      }\n    }\n\n    if (!this.state.isDraft) {\n      // from not draft to draft\n      // case 1, test.md  ===> test(draft).md\n      // case 2, .md ===> (draft).md\n      // case 3, no '.' in the file name, don't change the file name\n      if (pos > 0) {\n        let fileName = this.state.childName.substring(0, pos);\n        let fileType = this.state.childName.substring(pos);\n        this.setState({\n          childName: fileName + '(draft)' + fileType,\n          isDraft: !this.state.isDraft\n        });\n      } else if (pos === 0 ) {\n        this.setState({\n          childName: '(draft)' + this.state.childName,\n          isDraft: !this.state.isdraft\n        });\n      } else {\n        this.setState({\n          isDraft: !this.state.isdraft\n        });\n      }\n    }\n  }\n\n  toggle = () => {\n    this.props.addFileCancel();\n  }\n\n  checkDuplicatedName = () => {\n    let isDuplicated = this.props.checkDuplicatedName(this.state.childName);\n    return isDuplicated;\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true} toggle={this.toggle}>\n        <ModalHeader toggle={this.toggle}>{gettext('New File')}</ModalHeader>\n        <ModalBody>\n          <Form>\n            <FormGroup>\n              <Label for=\"fileName\">{gettext('Name')}</Label>\n              <Input\n                id=\"fileName\"\n                onKeyPress={this.handleKeyPress}\n                innerRef={input => {this.newInput = input;}}\n                value={this.state.childName}\n                onChange={this.handleChange}\n              />\n            </FormGroup>\n            {this.props.fileType == '.md' && isDocs && (\n              <FormGroup check>\n                <Label check>\n                  <Input type=\"checkbox\" onChange={this.handleCheck}/>{'  '}{gettext('This is a draft')}\n                </Label>\n              </FormGroup>\n            )}\n          </Form>\n          {this.state.errMessage && <Alert color=\"danger\" className=\"mt-2\">{this.state.errMessage}</Alert>}\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.handleSubmit} disabled={!this.state.isSubmitBtnActive}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nCreateFile.propTypes = propTypes;\n\nexport default CreateFile;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Dropdown, DropdownToggle, DropdownMenu, DropdownItem } from 'reactstrap';\nimport { Utils } from '../../utils/utils';\nimport { gettext } from '../../utils/constants';\nimport ModalPortal from '../modal-portal';\nimport CreateFolder from '../../components/dialog/create-folder-dialog';\nimport CreateFile from '../../components/dialog/create-file-dialog';\nimport ShareDialog from '../../components/dialog/share-dialog';\nimport ViewModeToolbar from './view-mode-toolbar';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  repoID: PropTypes.string.isRequired,\n  repoName: PropTypes.string.isRequired,\n  repoEncrypted: PropTypes.bool.isRequired,\n  enableDirPrivateShare: PropTypes.bool.isRequired,\n  userPerm: PropTypes.string.isRequired,\n  isGroupOwnedRepo: PropTypes.bool.isRequired,\n  showShareBtn: PropTypes.bool.isRequired,\n  onAddFile: PropTypes.func.isRequired,\n  onAddFolder: PropTypes.func.isRequired,\n  onUploadFile: PropTypes.func.isRequired,\n  onUploadFolder: PropTypes.func.isRequired,\n  direntList: PropTypes.array.isRequired,\n  currentMode: PropTypes.string.isRequired,\n  switchViewMode: PropTypes.func.isRequired,\n};\n\nclass DirOperationToolbar extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      fileType: '.md',\n      isCreateFileDialogShow: false,\n      isCreateFolderDialogShow: false,\n      isUploadMenuShow: false,\n      isCreateMenuShow: false,\n      isShareDialogShow: false,\n      operationMenuStyle: '',\n      isMobileOpMenuOpen: false\n    };\n  }\n\n  componentDidMount() {\n    document.addEventListener('click', this.hideOperationMenu);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('click', this.hideOperationMenu);\n  }\n\n  toggleMobileOpMenu = () => {\n    this.setState({isMobileOpMenuOpen: !this.state.isMobileOpMenuOpen});\n  }\n\n  hideOperationMenu = () => {\n    this.setState({\n      isUploadMenuShow: false,\n      isCreateMenuShow: false,\n    });\n  }\n\n  toggleOperationMenu = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    let targetRect = e.target.getBoundingClientRect();\n    let left = targetRect.left;\n    let top  = targetRect.bottom;\n    let style = {position: 'fixed', display: 'block', left: left, top: top};\n    this.setState({operationMenuStyle: style});\n  }\n\n  onUploadClick = (e) => {\n    this.toggleOperationMenu(e);\n    this.setState({\n      isUploadMenuShow: true,\n      isCreateMenuShow: false,\n    });\n  }\n\n  onUploadFile = (e) => {\n    this.setState({isUploadMenuShow: false});\n    this.props.onUploadFile(e);\n  }\n\n  onUploadFolder = (e) => {\n    this.setState({isUploadMenuShow: false});\n    this.props.onUploadFolder(e);\n  }\n\n  onCreateClick = (e) => {\n    this.toggleOperationMenu(e);\n    this.setState({\n      isCreateMenuShow: true,\n      isUploadMenuShow: false,\n    });\n  }\n\n  onShareClick = () => {\n    this.setState({\n      isShareDialogShow: !this.state.isShareDialogShow\n    });\n  }\n\n  onCreateFolderToggle = () => {\n    this.setState({isCreateFolderDialogShow: !this.state.isCreateFolderDialogShow});\n  }\n\n  onCreateFileToggle = () => {\n    this.setState({\n      isCreateFileDialogShow: !this.state.isCreateFileDialogShow,\n      fileType: '',\n    });\n  }\n\n  onCreateMarkdownToggle = () => {\n    this.setState({\n      isCreateFileDialogShow: !this.state.isCreateFileDialogShow,\n      fileType: '.md'\n    });\n  }\n\n  onCreateExcelToggle = () => {\n    this.setState({\n      isCreateFileDialogShow: !this.state.isCreateFileDialogShow,\n      fileType: '.xlsx'\n    });\n  }\n\n  onCreatePPTToggle = () => {\n    this.setState({\n      isCreateFileDialogShow: !this.state.isCreateFileDialogShow,\n      fileType: '.pptx'\n    });\n  }\n\n  onCreateWordToggle = () => {\n    this.setState({\n      isCreateFileDialogShow: !this.state.isCreateFileDialogShow,\n      fileType: '.docx'\n    });\n  }\n\n  onAddFile = (filePath, isDraft) => {\n    this.setState({isCreateFileDialogShow: false});\n    this.props.onAddFile(filePath, isDraft);\n  }\n\n  onAddFolder = (dirPath) => {\n    this.setState({isCreateFolderDialogShow: false});\n    this.props.onAddFolder(dirPath);\n  }\n\n  checkDuplicatedName = (newName) => {\n    let direntList = this.props.direntList;\n    let isDuplicated = direntList.some(object => {\n      return object.name === newName;\n    });\n    return isDuplicated;\n  }\n\n  render() {\n    let { path, repoName, userPerm } = this.props;\n\n    let itemType = path === '/' ? 'library' : 'dir';\n    let itemName = path == '/' ? repoName : Utils.getFolderName(path);\n\n    let content = null;\n    if (Utils.isDesktop()) {\n      let { showShareBtn } = this.props;\n      content = (\n        <Fragment>\n          {Utils.isSupportUploadFolder() ?\n            <button className=\"btn btn-secondary operation-item\" title={gettext('Upload')} onClick={this.onUploadClick}>{gettext('Upload')}</button> :\n            <button className=\"btn btn-secondary operation-item\" title={gettext('Upload')} onClick={this.onUploadFile}>{gettext('Upload')}</button>}\n          <button className=\"btn btn-secondary operation-item\" title={gettext('New')} onClick={this.onCreateClick}>{gettext('New')}</button>\n          {showShareBtn && <button className=\"btn btn-secondary operation-item\" title={gettext('Share')} onClick={this.onShareClick}>{gettext('Share')}</button>}\n        </Fragment>\n      );\n    } else {\n      content = (\n        <Dropdown isOpen={this.state.isMobileOpMenuOpen} toggle={this.toggleMobileOpMenu}>\n          <DropdownToggle tag=\"span\" className=\"sf2-icon-plus mobile-toolbar-icon\" />\n          <DropdownMenu>\n            <DropdownItem onClick={this.onUploadFile}>{gettext('Upload')}</DropdownItem>\n            <DropdownItem onClick={this.onCreateFolderToggle}>{gettext('New Folder')}</DropdownItem>\n            <DropdownItem onClick={this.onCreateFileToggle}>{gettext('New File')}</DropdownItem>\n          </DropdownMenu>\n        </Dropdown>\n      );\n    }\n\n    return (\n      <Fragment>\n        {(userPerm === 'rw' || userPerm === 'admin') && (\n          <div className=\"dir-operation\">\n            <div className=\"operation\">\n              {content}\n            </div>\n            {this.state.isUploadMenuShow && (\n              <ul className=\"menu dropdown-menu\" style={this.state.operationMenuStyle}>\n                <li className=\"dropdown-item\" onClick={this.onUploadFile}>{gettext('Upload Files')}</li>\n                <li className=\"dropdown-item\" onClick={this.onUploadFolder}>{gettext('Upload Folder')}</li>\n              </ul>\n            )}\n            {this.state.isCreateMenuShow && (\n              <ul className=\"menu dropdown-menu\" style={this.state.operationMenuStyle}>\n                <li className=\"dropdown-item\" onClick={this.onCreateFolderToggle}>{gettext('New Folder')}</li>\n                <li className=\"dropdown-item\" onClick={this.onCreateFileToggle}>{gettext('New File')}</li>\n                <li className=\"dropdown-divider\"></li>\n                <li className=\"dropdown-item\" onClick={this.onCreateMarkdownToggle}>{gettext('New Markdown File')}</li>\n                <li className=\"dropdown-item\" onClick={this.onCreateExcelToggle}>{gettext('New Excel File')}</li>\n                <li className=\"dropdown-item\" onClick={this.onCreatePPTToggle}>{gettext('New PowerPoint File')}</li>\n                <li className=\"dropdown-item\" onClick={this.onCreateWordToggle}>{gettext('New Word File')}</li>\n              </ul>\n            )}\n          </div>\n        )}\n        {Utils.isDesktop() && <ViewModeToolbar currentMode={this.props.currentMode} switchViewMode={this.props.switchViewMode} />}\n        {this.state.isCreateFileDialogShow && (\n          <ModalPortal>\n            <CreateFile\n              parentPath={this.props.path}\n              fileType={this.state.fileType}\n              onAddFile={this.onAddFile}\n              checkDuplicatedName={this.checkDuplicatedName}\n              addFileCancel={this.onCreateFileToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isCreateFolderDialogShow && (\n          <ModalPortal>\n            <CreateFolder\n              parentPath={this.props.path}\n              onAddFolder={this.onAddFolder}\n              checkDuplicatedName={this.checkDuplicatedName}\n              addFolderCancel={this.onCreateFolderToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isShareDialogShow &&\n          <ModalPortal>\n            <ShareDialog\n              itemType={itemType}\n              itemName={itemName}\n              itemPath={this.props.path}\n              repoID={this.props.repoID}\n              repoEncrypted={this.props.repoEncrypted}\n              enableDirPrivateShare={this.props.enableDirPrivateShare}\n              userPerm={this.props.userPerm}\n              isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n              toggleDialog={this.onShareClick}\n            />\n          </ModalPortal>\n        }\n      </Fragment>\n    );\n  }\n}\n\nDirOperationToolbar.propTypes = propTypes;\n\nexport default DirOperationToolbar;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Modal, ModalHeader, ModalFooter, ModalBody, Alert } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport FileChooser from '../file-chooser/file-chooser';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  repoID: PropTypes.string.isRequired,\n  dirent: PropTypes.object,\n  selectedDirentList: PropTypes.array,\n  isMutipleOperation: PropTypes.bool.isRequired,\n  onItemMove: PropTypes.func,\n  onItemsMove: PropTypes.func,\n  onCancelMove: PropTypes.func.isRequired,\n  repoEncrypted: PropTypes.bool.isRequired,\n};\n\n// need dirent file Path；\nclass MoveDirent extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      repo: null,\n      selectedPath: '',\n      errMessage: '',\n    };\n  }\n\n  shouldComponentUpdate(nextProps, nextState) {\n    if (this.state.errMessage === nextState.errMessage) {\n      return false;\n    }\n    return true;\n  }\n\n  handleSubmit = () => {\n    if (this.props.isMutipleOperation) {\n      this.moveItems();\n    } else {\n      this.moveItem();\n    }\n  }\n\n  moveItems = () => {\n    let { repoID } = this.props;\n    let { repo, selectedPath } = this.state;\n    let message = gettext('Invalid destination path');\n\n    if (!repo || selectedPath === '') {\n      this.setState({errMessage: message});\n      return;\n    }\n\n    let selectedDirentList = this.props.selectedDirentList;\n    let direntPaths = [];\n    selectedDirentList.forEach(dirent => {\n      let path = Utils.joinPath(this.props.path, dirent.name);\n      direntPaths.push(path);\n    });\n\n    // move dirents to one of them. eg: A/B, A/C -> A/B\n    if (direntPaths.some(direntPath => { return direntPath === selectedPath;})) {\n      this.setState({errMessage: message});\n      return;\n    }\n\n    // move dirents to current path\n    if (selectedPath && selectedPath === this.props.path && (repo.repo_id === repoID)) {\n      this.setState({errMessage: message});\n      return;\n    }\n\n    // move dirents to one of their child. eg: A/B, A/D -> A/B/C\n    let moveDirentPath = '';\n    let isChildPath = direntPaths.some(direntPath => {\n      let flag = selectedPath.length > direntPath.length && selectedPath.indexOf(direntPath) > -1;\n      if (flag) {\n        moveDirentPath = direntPath;\n      }\n      return flag;\n    });\n\n    if (isChildPath) {\n      message = gettext('Can not move directory %(src)s to its subdirectory %(des)s');\n      message = message.replace('%(src)s', moveDirentPath);\n      message = message.replace('%(des)s', selectedPath);\n      this.setState({errMessage: message});\n      return;\n    }\n\n    this.props.onItemsMove(repo, selectedPath);\n    this.toggle();\n  }\n\n  moveItem = () => {\n    let { repoID } = this.props;\n    let { repo, selectedPath } = this.state;\n    let direntPath = Utils.joinPath(this.props.path, this.props.dirent.name);\n    let message = gettext('Invalid destination path');\n\n    if (!repo || (repo.repo_id === repoID && selectedPath === '')) {\n      this.setState({errMessage: message});\n      return;\n    }\n\n    // copy the dirent to itself. eg: A/B -> A/B\n    if (selectedPath && direntPath === selectedPath) {\n      this.setState({errMessage: message});\n      return;\n    }\n\n    // copy the dirent to current path\n    if (selectedPath && this.props.path === selectedPath && repo.repo_id === repoID) {\n      this.setState({errMessage: message});\n      return;\n    }\n\n    // copy the dirent to it's child. eg: A/B -> A/B/C\n    if ( selectedPath && selectedPath.length > direntPath.length && selectedPath.indexOf(direntPath) > -1) {\n      message = gettext('Can not move directory %(src)s to its subdirectory %(des)s');\n      message = message.replace('%(src)s', direntPath);\n      message = message.replace('%(des)s', selectedPath);\n      this.setState({errMessage: message});\n      return;\n    }\n\n    this.props.onItemMove(repo, this.props.dirent, selectedPath, this.props.path);\n    this.toggle();\n  }\n\n  toggle = () => {\n    this.props.onCancelMove();\n  }\n\n  onDirentItemClick = (repo, selectedPath) => {\n    this.setState({\n      repo: repo,\n      selectedPath: selectedPath,\n      errMessage: '',\n    });\n  }\n\n  onRepoItemClick = (repo) => {\n    this.setState({\n      repo: repo,\n      selectedPath: '/',\n      errMessage: ''\n    });\n  }\n\n  render() {\n    let title = gettext('Move {placeholder} to');\n    if (!this.props.isMutipleOperation) {\n      title = title.replace('{placeholder}', '<span class=\"op-target\">' + Utils.HTMLescape(this.props.dirent.name) + '</span>');\n    } else {\n      title = gettext('Move selected item(s) to:');\n    }\n    let mode = this.props.repoEncrypted ? 'only_current_library':'current_repo_and_other_repos';\n    return (\n      <Modal isOpen={true} toggle={this.toggle}>\n        <ModalHeader toggle={this.toggle}><div dangerouslySetInnerHTML={{__html: title}}></div></ModalHeader>\n        <ModalBody>\n          <FileChooser\n            repoID={this.props.repoID}\n            onDirentItemClick={this.onDirentItemClick}\n            onRepoItemClick={this.onRepoItemClick}\n            mode={mode}\n          />\n          {this.state.errMessage && <Alert color=\"danger\" style={{margin: '0.5rem'}}>{this.state.errMessage}</Alert>}\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.handleSubmit}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nMoveDirent.propTypes = propTypes;\n\nexport default MoveDirent;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Modal, ModalHeader, ModalFooter, ModalBody, Alert } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport FileChooser from '../file-chooser/file-chooser';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  repoID: PropTypes.string.isRequired,\n  dirent: PropTypes.object,\n  selectedDirentList: PropTypes.array,\n  isMutipleOperation: PropTypes.bool.isRequired,\n  onItemCopy: PropTypes.func,\n  onItemsCopy: PropTypes.func,\n  onCancelCopy: PropTypes.func.isRequired,\n  repoEncrypted: PropTypes.bool.isRequired,\n};\n\n// need dirent file Path；\nclass CopyDirent extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      repo: null,\n      selectedPath: '',\n      errMessage: '',\n    };\n  }\n\n  shouldComponentUpdate(nextProps, nextState) {\n    if (this.state.errMessage === nextState.errMessage) {\n      return false;\n    }\n    return true;\n  }\n\n  handleSubmit = () => {\n    if (this.props.isMutipleOperation) {\n      this.copyItems();\n    } else {\n      this.copyItem();\n    }\n  }\n\n  copyItems = () => {\n    let { repoID } = this.props;\n    let { repo, selectedPath } = this.state;\n    let message = gettext('Invalid destination path');\n\n    if (!repo || selectedPath === '') {\n      this.setState({errMessage: message});\n      return;\n    }\n\n    let selectedDirentList = this.props.selectedDirentList;\n    let direntPaths = [];\n    selectedDirentList.forEach(dirent => {\n      let path = Utils.joinPath(this.props.path, dirent.name);\n      direntPaths.push(path);\n    });\n\n    // copy dirents to one of them. eg: A/B, A/C -> A/B\n    if (direntPaths.some(direntPath => { return direntPath === selectedPath;})) {\n      this.setState({errMessage: message});\n      return;\n    }\n\n    // copy dirents to one of their child. eg: A/B, A/D -> A/B/C\n    let copyDirentPath = '';\n    let isChildPath = direntPaths.some(direntPath => {\n      let flag = selectedPath.length > direntPath.length && selectedPath.indexOf(direntPath) > -1;\n      if (flag) {\n        copyDirentPath = direntPath;\n      }\n      return flag;\n    });\n\n    if (isChildPath) {\n      message = gettext('Can not move directory %(src)s to its subdirectory %(des)s');\n      message = message.replace('%(src)s', copyDirentPath);\n      message = message.replace('%(des)s', selectedPath);\n      this.setState({errMessage: message});\n      return;\n    }\n\n    this.props.onItemsCopy(repo, selectedPath);\n    this.toggle();\n  }\n\n  copyItem = () => {\n    let { repo, repoID, selectedPath } = this.state;\n    let direntPath = Utils.joinPath(this.props.path, this.props.dirent.name);\n    let message = 'Invalid destination path';\n\n    if (!repo || (repo.repo_id === repoID && selectedPath === '')) {\n      this.setState({errMessage: message});\n      return;\n    }\n\n    // copy the dirent to itself. eg: A/B -> A/B\n    if (selectedPath && direntPath === selectedPath) {\n      this.setState({errMessage: message});\n      return;\n    }\n\n    // copy the dirent to current path\n    if (selectedPath && this.props.path === selectedPath && repo.repo_id === repoID) {\n      this.setState({errMessage: message});\n      return;\n    }\n\n    // copy the dirent to it's child. eg: A/B -> A/B/C\n    if ( selectedPath && selectedPath.length > direntPath.length && selectedPath.indexOf(direntPath) > -1) {\n      message = gettext('Can not copy directory %(src)s to its subdirectory %(des)s');\n      message = message.replace('%(src)s', direntPath);\n      message = message.replace('%(des)s', selectedPath);\n      this.setState({errMessage: message});\n      return;\n    }\n\n    this.props.onItemCopy(repo, this.props.dirent, selectedPath, this.props.path);\n    this.toggle();\n  }\n\n  toggle = () => {\n    this.props.onCancelCopy();\n  }\n\n  onDirentItemClick = (repo, selectedPath) => {\n    this.setState({\n      repo: repo,\n      selectedPath: selectedPath,\n      errMessage: '',\n    });\n  }\n\n  onRepoItemClick = (repo) => {\n    this.setState({\n      repo: repo,\n      selectedPath: '/',\n      errMessage: ''\n    });\n  }\n\n  render() {\n    let title = gettext('Copy {placeholder} to');\n    if (!this.props.isMutipleOperation) {\n      title = title.replace('{placeholder}', '<span class=\"op-target\">' + Utils.HTMLescape(this.props.dirent.name) + '</span>');\n    } else {\n      title = gettext('Copy selected item(s) to:');\n    }\n    let mode = this.props.repoEncrypted ? 'only_current_library':'current_repo_and_other_repos';\n    return (\n      <Modal isOpen={true} toggle={this.toggle}>\n        <ModalHeader toggle={this.toggle}><div dangerouslySetInnerHTML={{__html: title}}></div></ModalHeader>\n        <ModalBody>\n          <FileChooser\n            repoID={this.props.repoID}\n            onDirentItemClick={this.onDirentItemClick}\n            onRepoItemClick={this.onRepoItemClick}\n            mode={mode}\n          />\n          {this.state.errMessage && <Alert color=\"danger\" style={{margin: '0.5rem'}}>{this.state.errMessage}</Alert>}\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.handleSubmit}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nCopyDirent.propTypes = propTypes;\n\nexport default CopyDirent;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport { Button, Modal, ModalHeader, Input, ModalBody, ModalFooter, Alert } from 'reactstrap';\n\nconst propTypes = {\n  onRename: PropTypes.func.isRequired,\n  toggleCancel: PropTypes.func.isRequired,\n  checkDuplicatedName: PropTypes.func.isRequired,\n  dirent: PropTypes.object,\n};\n\nclass Rename extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      newName: '',\n      errMessage: '',\n      isSubmitBtnActive: false,\n    };\n    this.newInput = React.createRef();\n  }\n\n  componentWillMount() {\n    this.setState({newName: this.props.dirent.name});\n  }\n\n  componentDidMount() {\n    let {dirent} = this.props;\n    this.changeState(dirent);\n    this.newInput.focus();\n    let type = dirent.type;\n    if (type === 'file') {\n      var endIndex = dirent.name.lastIndexOf('.md');\n      this.newInput.setSelectionRange(0, endIndex, 'forward');\n    } else {\n      this.newInput.setSelectionRange(0, -1);\n    }\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.changeState(nextProps.dirent);\n  }\n\n  handleChange = (e) => {\n    if (!e.target.value.trim()) {\n      this.setState({isSubmitBtnActive: false});\n    } else {\n      this.setState({isSubmitBtnActive: true});\n    }\n\n    this.setState({newName: e.target.value});\n  }\n\n  handleSubmit = () => {\n    let { isValid, errMessage } = this.validateInput();\n    if (!isValid) {\n      this.setState({errMessage : errMessage});\n    } else {\n      let isDuplicated = this.checkDuplicatedName();\n      if (isDuplicated) {\n        let errMessage = gettext('The name \"{name}\" is already taken. Please choose a different name.');\n        errMessage = errMessage.replace('{name}', Utils.HTMLescape(this.state.newName));\n        this.setState({errMessage: errMessage});\n      } else {\n        this.props.onRename(this.state.newName);\n        this.props.toggleCancel();\n      }\n    }\n  }\n\n  handleKeyPress = (e) => {\n    if (e.key === 'Enter') {\n      this.handleSubmit();\n    }\n  }\n\n  toggle = () => {\n    this.props.toggleCancel();\n  }\n\n  changeState = (dirent) => {\n    let name = dirent.name;\n    this.setState({newName: name});\n  }\n\n  validateInput = () => {\n    let newName = this.state.newName.trim();\n    let isValid = true;\n    let errMessage = '';\n    if (!newName) {\n      isValid = false;\n      errMessage = gettext('Name is required.');\n      return { isValid, errMessage };\n    }\n\n    if (newName.indexOf('/') > -1) {\n      isValid = false;\n      errMessage = gettext('Name should not include ' + '\\'/\\'' + '.');\n      return { isValid, errMessage };\n    }\n\n    return { isValid, errMessage };\n  }\n\n  checkDuplicatedName = () => {\n    let isDuplicated = this.props.checkDuplicatedName(this.state.newName);\n    return isDuplicated;\n  }\n\n  render() {\n    let type = this.props.dirent.type;\n    return (\n      <Modal isOpen={true} toggle={this.toggle}>\n        <ModalHeader toggle={this.toggle}>{type === 'file' ? gettext('Rename File') : gettext('Rename Folder') }</ModalHeader>\n        <ModalBody>\n          <p>{type === 'file' ? gettext('New file name'): gettext('New folder name')}</p>\n          <Input onKeyPress={this.handleKeyPress} innerRef={input => {this.newInput = input;}} value={this.state.newName} onChange={this.handleChange} />\n          {this.state.errMessage && <Alert color=\"danger\" className=\"mt-2\">{this.state.errMessage}</Alert>}\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.handleSubmit} disabled={!this.state.isSubmitBtnActive}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nRename.propTypes = propTypes;\n\nexport default Rename;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, ButtonGroup } from 'reactstrap';\nimport { gettext, siteRoot, canGenerateShareLink, isPro, fileAuditEnabled, name } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport URLDecorator from '../../utils/url-decorator';\nimport TextTranslation from '../../utils/text-translation';\nimport MoveDirentDialog from '../dialog/move-dirent-dialog';\nimport CopyDirentDialog from '../dialog/copy-dirent-dialog';\nimport ShareDialog from '../dialog/share-dialog';\nimport RelatedFileDialogs from '../dialog/related-file-dialogs';\nimport EditFileTagDialog from '../dialog/edit-filetag-dialog';\nimport ZipDownloadDialog from '../dialog/zip-download-dialog';\nimport Rename from '../dialog/rename-dirent';\nimport LibSubFolderPermissionDialog from '../dialog/lib-sub-folder-permission-dialog';\nimport ViewModeToolbar from './view-mode-toolbar';\n\nimport ModalPortal from '../modal-portal';\nimport ItemDropdownMenu from '../dropdown-menu/item-dropdown-menu';\nimport toaster from '../toast';\n\nimport '../../css/dirents-menu.css';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  userPerm: PropTypes.string.isRequired,\n  repoID: PropTypes.string.isRequired,\n  repoEncrypted: PropTypes.bool.isRequired,\n  selectedDirentList: PropTypes.array.isRequired,\n  onItemsMove: PropTypes.func.isRequired,\n  onItemsCopy: PropTypes.func.isRequired,\n  onItemsDelete: PropTypes.func.isRequired,\n  isRepoOwner: PropTypes.bool.isRequired,\n  enableDirPrivateShare: PropTypes.bool.isRequired,\n  currentRepoInfo: PropTypes.object.isRequired,\n  onFilesTagChanged: PropTypes.func.isRequired,\n  unSelectDirent: PropTypes.func.isRequired,\n  updateDirent: PropTypes.func.isRequired,\n  currentMode: PropTypes.string.isRequired,\n  switchViewMode: PropTypes.func.isRequired,\n};\n\nclass MultipleDirOperationToolbar extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isZipDialogOpen: false,\n      isMoveDialogShow: false,\n      isCopyDialogShow: false,\n      isMutipleOperation: true,\n      showLibContentViewDialogs: false,\n      showShareDialog: false,\n      showEditFileTagDialog: false,\n      fileTagList: [],\n      multiFileTagList: [],\n      showRelatedFileDialog: false,\n      viewMode: 'list_related_file',\n      isRenameDialogOpen: false,\n      isPermissionDialogOpen: false\n    };\n  }\n\n  onMoveToggle = () => {\n    this.setState({isMoveDialogShow: !this.state.isMoveDialogShow});\n  }\n\n  onCopyToggle = () => {\n    this.setState({isCopyDialogShow: !this.state.isCopyDialogShow});\n  }\n\n  onItemsDelete = () => {\n    this.props.onItemsDelete();\n  }\n\n  onItemsDownload = () => {\n    let { path, repoID, selectedDirentList } = this.props;\n    if (selectedDirentList.length) {\n      if (selectedDirentList.length === 1 && !selectedDirentList[0].isDir()) {\n        let direntPath = Utils.joinPath(path, selectedDirentList[0].name);\n        let url = URLDecorator.getUrl({type: 'download_file_url', repoID: repoID, filePath: direntPath});\n        location.href= url;\n        return;\n      }\n      this.setState({\n        isZipDialogOpen: true\n      });\n    }\n  }\n\n  closeZipDialog = () => {\n    this.setState({\n      isZipDialogOpen: false\n    });\n  }\n\n  checkDuplicatedName = (newName) => {\n    return Utils.checkDuplicatedNameInList(this.props.direntList, newName);\n  }\n\n  onItemRename = (newName) => {\n    const dirent = this.props.selectedDirentList[0];\n    this.props.onItemRename(dirent, newName);\n  }\n\n  onPermissionItem = () => {\n    this.setState({\n      showLibContentViewDialogs: !this.state.showLibContentViewDialogs,\n      isPermissionDialogOpen: !this.state.isPermissionDialogOpen\n    });\n  }\n\n  onCommentItem = () => {\n    this.props.showDirentDetail('comments');\n  }\n\n  getDirentMenuList = (dirent) => {\n    const isRepoOwner = this.props.isRepoOwner;\n    const currentRepoInfo = this.props.currentRepoInfo;\n    const isContextmenu = true;\n    let opList = Utils.getDirentOperationList(isRepoOwner, currentRepoInfo, dirent, isContextmenu);\n    const list = ['Move', 'Copy', 'Delete', 'Download'];\n    if (dirent.type == 'dir') {\n      opList = opList.filter((item, index) => {\n        return list.indexOf(item.key) == -1 && item != 'Divider';\n      });\n    } else {\n      opList = opList.filter((item, index) => {\n        return list.indexOf(item.key) == -1;\n      });\n    }\n    return opList;\n  }\n\n  onMenuItemClick = (operation) => {\n    const dirents = this.props.selectedDirentList;\n    const dirent = dirents[0];\n    switch (operation) {\n      case 'Share':\n        this.setState({\n          showLibContentViewDialogs: true,\n          showShareDialog: true,\n        });\n        break;\n      case 'Rename':\n        this.setState({\n          showLibContentViewDialogs: true,\n          isRenameDialogOpen: true\n        });\n        break;\n      case 'Permission':\n        this.onPermissionItem();\n        break;\n      case 'Tags':\n        this.listFileTags(dirent);\n        break;\n      case 'Lock':\n        this.lockFile(dirent);\n        break;\n      case 'Unlock':\n        this.unlockFile(dirent);\n        break;\n      case 'Comment':\n        this.onCommentItem();\n        break;\n      case 'Related Files':\n        this.openRelatedFilesDialog(dirent);\n        break;\n      case 'History':\n        this.onHistory(dirent);\n        break;\n      case 'Access Log':\n        this.onAccessLog(dirent);\n        break;\n      case 'Open via Client':\n        this.onOpenViaClient(dirent);\n        break;\n      default:\n        break;\n    }\n  }\n\n  lockFile = (dirent) => {\n    const filePath = this.getDirentPath(dirent);\n    seafileAPI.lockfile(this.props.repoID, filePath).then((res) => {\n      if (res.data.is_locked) {\n        this.props.updateDirent(dirent, 'is_locked', true);\n        this.props.updateDirent(dirent, 'locked_by_me', true);\n        this.props.updateDirent(dirent, 'lock_owner_name', name);\n        this.props.unSelectDirent();\n      }\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  unlockFile = (dirent) => {\n    const filePath = this.getDirentPath(dirent);\n    seafileAPI.unlockfile(this.props.repoID, filePath).then((res) => {\n      if (!res.data.is_locked) {\n        this.props.updateDirent(dirent, 'is_locked', false);\n        this.props.updateDirent(dirent, 'locked_by_me', false);\n        this.props.updateDirent(dirent, 'lock_owner_name', '');\n        this.props.unSelectDirent();\n      }\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onOpenViaClient = (dirent) => {\n    const filePath = this.getDirentPath(dirent);\n    let url = URLDecorator.getUrl({\n      type: 'open_via_client',\n      repoID: this.props.repoID,\n      filePath: filePath\n    });\n    location.href = url;\n  }\n\n  onHistory = (dirent) => {\n    let filePath = this.getDirentPath(dirent);\n    let url = URLDecorator.getUrl({\n      type: 'file_revisions',\n      repoID: this.props.repoID,\n      filePath: filePath\n    });\n    location.href = url;\n  }\n\n  onAccessLog = (dirent) => {\n    let filePath = this.getDirentPath(dirent);\n    let path = siteRoot + 'repo/file-access/' + this.props.repoID + '/?p=' + encodeURIComponent(filePath) ;\n    window.open(path);\n  }\n\n  openRelatedFilesDialog = (dirent) => {\n    let filePath = this.getDirentPath(dirent);\n    seafileAPI.listRelatedFiles(this.props.repoID, filePath).then(res => {\n      let relatedFiles = res.data.related_files;\n      if (relatedFiles.length > 0) {\n        this.setState({\n          relatedFiles: relatedFiles,\n          showLibContentViewDialogs: true,\n          showRelatedFileDialog: true,\n          viewMode: 'list_related_file',\n        });\n      } else {\n        this.setState({\n          relatedFiles: relatedFiles,\n          showLibContentViewDialogs: true,\n          showRelatedFileDialog: true,\n          viewMode: 'add_related_file',\n        });\n      }\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  toggleCancel = () => {\n    this.setState({\n      showLibContentViewDialogs: false,\n      showShareDialog: false,\n      showEditFileTagDialog: false,\n      showRelatedFileDialog: false,\n      isRenameDialogOpen: false,\n      isPermissionDialogOpen: false,\n    });\n  }\n\n  listFileTags = (dirent) => {\n    let filePath = this.getDirentPath(dirent);\n    seafileAPI.listFileTags(this.props.repoID, filePath).then(res => {\n      let fileTagList = res.data.file_tags;\n      for (let i = 0, length = fileTagList.length; i < length; i++) {\n        fileTagList[i].id = fileTagList[i].file_tag_id;\n      }\n      this.setState({\n        fileTagList: fileTagList,\n        showLibContentViewDialogs: true,\n        showEditFileTagDialog: true,\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onMenuFileTagChanged = () => {\n    this.listFileTags(this.props.selectedDirentList[0]);\n    let length = this.props.selectedDirentList.length;\n    for (let i = 0; i < length; i++) {\n      const dirent = this.props.selectedDirentList[i];\n      const direntPath = this.getDirentPath(dirent);\n      this.props.onFilesTagChanged(dirent, direntPath);\n    }\n  }\n\n  listRelatedFiles = (dirent) => {\n    let filePath = this.getDirentPath(dirent);\n    seafileAPI.listRelatedFiles(this.props.repoID, filePath).then(res => {\n      this.setState({\n        relatedFiles: res.data.related_files\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onRelatedFileChange = () => {\n    this.listRelatedFiles(this.props.selectedDirentList[0]);\n  }\n\n  getDirentPath = (dirent) => {\n    if (dirent) return Utils.joinPath(this.props.path, dirent.name);\n  }\n\n  render() {\n\n    const { repoID, userPerm } = this.props;\n    const dirent = this.props.selectedDirentList[0];\n\n    let direntPath = this.getDirentPath(dirent);\n\n    return (\n      <Fragment>\n        <div className=\"dir-operation\">\n          <div className=\"d-flex\">\n            <ButtonGroup className=\"flex-row group-operations\">\n              {(userPerm === 'rw' || userPerm === 'admin') && (\n                <Fragment>\n                  <Button className=\"secondary group-op-item action-icon sf2-icon-move\" title={gettext('Move')} onClick={this.onMoveToggle}></Button>\n                  <Button className=\"secondary group-op-item action-icon sf2-icon-copy\" title={gettext('Copy')} onClick={this.onCopyToggle}></Button>\n                  <Button className=\"secondary group-op-item action-icon sf2-icon-delete\" title={gettext('Delete')} onClick={this.onItemsDelete}></Button>\n                </Fragment>\n              )}\n              {userPerm === 'r' && (\n                <Button className=\"secondary group-op-item action-icon sf2-icon-copy\" title={gettext('Copy')} onClick={this.onCopyToggle}></Button>\n              )}\n              {(userPerm === 'rw' || userPerm === 'admin' || userPerm === 'r') && (\n                <Button className=\"secondary group-op-item action-icon sf2-icon-download\" title={gettext('Download')} onClick={this.onItemsDownload}></Button>\n              )}\n              {this.props.selectedDirentList.length === 1 &&\n                <ItemDropdownMenu\n                  tagName={'button'}\n                  item={this.props.selectedDirentList[0]}\n                  toggleClass={'fas fa-ellipsis-v dirents-more-menu'}\n                  onMenuItemClick={this.onMenuItemClick}\n                  getMenuList={this.getDirentMenuList}\n                />\n              }\n            </ButtonGroup>\n          </div>\n        </div>\n        {Utils.isDesktop() && <ViewModeToolbar currentMode={this.props.currentMode} switchViewMode={this.props.switchViewMode} />}\n        {this.state.isMoveDialogShow &&\n          <MoveDirentDialog\n            path={this.props.path}\n            repoID={this.props.repoID}\n            repoEncrypted={this.props.repoEncrypted}\n            isMutipleOperation={this.state.isMutipleOperation}\n            selectedDirentList={this.props.selectedDirentList}\n            onItemsMove={this.props.onItemsMove}\n            onCancelMove={this.onMoveToggle}\n          />\n        }\n        {this.state.isCopyDialogShow &&\n          <CopyDirentDialog\n            path={this.props.path}\n            repoID={this.props.repoID}\n            repoEncrypted={this.props.repoEncrypted}\n            selectedDirentList={this.props.selectedDirentList}\n            isMutipleOperation={this.state.isMutipleOperation}\n            onItemsCopy={this.props.onItemsCopy}\n            onCancelCopy={this.onCopyToggle}\n          />\n        }\n        {this.state.isZipDialogOpen &&\n        <ModalPortal>\n          <ZipDownloadDialog\n            repoID={this.props.repoID}\n            path={this.props.path}\n            target={this.props.selectedDirentList.map(dirent => dirent.name)}\n            toggleDialog={this.closeZipDialog}\n          />\n        </ModalPortal>\n        }\n        {this.state.showLibContentViewDialogs && (\n          <Fragment>\n            {this.state.showShareDialog &&\n              <ModalPortal>\n                <ShareDialog\n                  itemType={dirent.type}\n                  itemName={dirent.name}\n                  itemPath={direntPath}\n                  userPerm={dirent.permission}\n                  repoID={repoID}\n                  repoEncrypted={this.props.repoEncrypted}\n                  enableDirPrivateShare={this.props.enableDirPrivateShare}\n                  isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n                  toggleDialog={this.toggleCancel}\n                />\n              </ModalPortal>\n            }\n            {this.state.isRenameDialogOpen &&\n              <ModalPortal>\n                <Rename\n                  dirent={dirent}\n                  onRename={this.onItemRename}\n                  checkDuplicatedName={this.checkDuplicatedName}\n                  toggleCancel={this.toggleCancel}\n                />\n              </ModalPortal>\n            }\n            {this.state.isPermissionDialogOpen &&\n              <ModalPortal>\n                <LibSubFolderPermissionDialog\n                  toggleDialog={this.toggleCancel}\n                  repoID={repoID}\n                  folderPath={direntPath}\n                  folderName={dirent.name}\n                  isDepartmentRepo={this.props.isGroupOwnedRepo}\n                />\n              </ModalPortal>\n            }\n            {this.state.showEditFileTagDialog &&\n              <ModalPortal>\n                <EditFileTagDialog\n                  repoID={repoID}\n                  filePath={direntPath}\n                  fileTagList={this.state.fileTagList}\n                  toggleCancel={this.toggleCancel}\n                  onFileTagChanged={this.onMenuFileTagChanged}\n                />\n              </ModalPortal>\n            }\n            {this.state.showRelatedFileDialog &&\n              <ModalPortal>\n                <RelatedFileDialogs\n                  repoID={repoID}\n                  filePath={direntPath}\n                  relatedFiles={this.state.relatedFiles}\n                  toggleCancel={this.toggleCancel}\n                  onRelatedFileChange={this.onRelatedFileChange}\n                  dirent={this.props.selectedDirentList[0]}\n                  viewMode={this.state.viewMode}\n                />\n              </ModalPortal>\n            }\n          </Fragment>\n        )}\n      </Fragment>\n    );\n  }\n}\n\nMultipleDirOperationToolbar.propTypes = propTypes;\n\nexport default MultipleDirOperationToolbar;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { DropdownToggle, Dropdown, DropdownMenu, DropdownItem, Tooltip} from 'reactstrap';\nimport { gettext, siteRoot, canGenerateShareLink, isDocs } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\nimport ModalPotal from '../modal-portal';\nimport ShareDialog from '../dialog/share-dialog';\nimport EditFileTagDialog from '../dialog/edit-filetag-dialog';\nimport RelatedFileDialogs from '../dialog/related-file-dialogs';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  repoID: PropTypes.string.isRequired,\n  userPerm: PropTypes.string.isRequired,\n  repoEncrypted: PropTypes.bool.isRequired,\n  enableDirPrivateShare: PropTypes.bool.isRequired,\n  isGroupOwnedRepo: PropTypes.bool.isRequired,\n  filePermission: PropTypes.string,\n  isDraft: PropTypes.bool.isRequired,\n  hasDraft: PropTypes.bool.isRequired,\n  fileTags: PropTypes.array.isRequired,\n  relatedFiles: PropTypes.array.isRequired,\n  onFileTagChanged: PropTypes.func.isRequired,\n  onRelatedFileChange: PropTypes.func.isRequired,\n  showShareBtn: PropTypes.bool.isRequired,\n};\n\nclass ViewFileToolbar extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isDraftMessageShow: false,\n      isMoreMenuShow: false,\n      isShareDialogShow: false,\n      isEditTagDialogShow: false,\n      isRelatedFileDialogShow: false,\n      showRelatedFileDialog: false,\n    };\n  }\n\n  onEditClick = (e) => {\n    e.preventDefault();\n    let { path, repoID } = this.props;\n    let url = siteRoot + 'lib/' + repoID + '/file' + Utils.encodePath(path) + '?mode=edit';\n    window.open(url);\n  }\n\n  onNewDraft = (e) => {\n    e.preventDefault();\n    let { path, repoID } = this.props;\n    seafileAPI.createDraft(repoID, path).then(res => {\n      window.location.href = siteRoot + 'lib/' + res.data.origin_repo_id + '/file' + res.data.draft_file_path + '?mode=edit';\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onDraftHover = () => {\n    this.setState({isDraftMessageShow: !this.state.isDraftMessageShow});\n  }\n\n  toggleMore = () => {\n    this.setState({isMoreMenuShow: !this.state.isMoreMenuShow});\n  }\n\n  onShareToggle = () => {\n    this.setState({isShareDialogShow: !this.state.isShareDialogShow});\n  }\n\n  onEditFileTagToggle = () => {\n    this.setState({isEditTagDialogShow: !this.state.isEditTagDialogShow});\n  }\n\n  onListRelatedFileToggle = () => {\n    this.setState({\n      isRelatedFileDialogShow: true,\n      showRelatedFileDialog: true,\n    });\n  }\n\n  toggleCancel = () => {\n    this.setState({\n      isRelatedFileDialogShow: false,\n      showRelatedFileDialog: false,\n    });\n  }\n\n  onHistoryClick = () => {\n    let historyUrl = siteRoot + 'repo/file_revisions/' + this.props.repoID + '/?p=' + Utils.encodePath(this.props.path);\n    location.href = historyUrl;\n  }\n\n  render() {\n    let { filePermission } = this.props;\n    let name = Utils.getFileName(this.props.path);\n    let dirent = { name: name };\n    return (\n      <Fragment>\n        <div className=\"dir-operation\">\n          {((filePermission === 'rw' || filePermission === 'cloud-edit') && !this.props.hasDraft) && (\n            <Fragment>\n              <button className=\"btn btn-secondary operation-item\" title={gettext('Edit File')} onClick={this.onEditClick}>{gettext('Edit')}</button>\n            </Fragment>\n          )}\n          {(filePermission === 'rw' && !this.props.isDraft && !this.props.hasDraft && isDocs) && (\n            <Fragment>\n              <button id=\"new-draft\" className=\"btn btn-secondary operation-item\" onClick={this.onNewDraft}>{gettext('New Draft')}</button>\n              <Tooltip target=\"new-draft\" placement=\"bottom\" isOpen={this.state.isDraftMessageShow} toggle={this.onDraftHover}>{gettext('Create a draft from this file, instead of editing it directly.')}</Tooltip>\n            </Fragment>\n          )}\n          {filePermission === 'rw' && (\n            <Dropdown isOpen={this.state.isMoreMenuShow} toggle={this.toggleMore}>\n              <DropdownToggle className='btn btn-secondary operation-item'>\n                {gettext('More')}\n              </DropdownToggle>\n              <DropdownMenu>\n                {this.props.showShareBtn &&\n                  <DropdownItem onClick={this.onShareToggle}>{gettext('Share')}</DropdownItem>\n                }\n                <DropdownItem onClick={this.onEditFileTagToggle}>{gettext('Tags')}</DropdownItem>\n                <DropdownItem onClick={this.onListRelatedFileToggle}>{gettext('Related Files')}</DropdownItem>\n                <DropdownItem onClick={this.onHistoryClick}>{gettext('History')}</DropdownItem>\n              </DropdownMenu>\n            </Dropdown>\n          )}\n        </div>\n        {this.state.isShareDialogShow && (\n          <ModalPotal>\n            <ShareDialog\n              itemType={'file'}\n              itemName={Utils.getFileName(this.props.path)}\n              itemPath={this.props.path}\n              repoID={this.props.repoID}\n              repoEncrypted={this.props.repoEncrypted}\n              enableDirPrivateShare={this.props.enableDirPrivateShare}\n              userPerm={this.props.userPerm}\n              isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n              toggleDialog={this.onShareToggle}\n            />\n          </ModalPotal>\n        )}\n        {this.state.isEditTagDialogShow && (\n          <ModalPotal>\n            <EditFileTagDialog\n              filePath={this.props.path}\n              repoID={this.props.repoID}\n              fileTagList={this.props.fileTags}\n              toggleCancel={this.onEditFileTagToggle}\n              onFileTagChanged={this.props.onFileTagChanged}\n            />\n          </ModalPotal>\n        )}\n        {this.state.showRelatedFileDialog &&\n          <ModalPotal>\n            <RelatedFileDialogs\n              repoID={this.props.repoID}\n              filePath={this.props.path}\n              relatedFiles={this.props.relatedFiles}\n              toggleCancel={this.toggleCancel}\n              onRelatedFileChange={this.props.onRelatedFileChange}\n              dirent={dirent}\n              viewMode=\"list_related_file\"\n            />\n          </ModalPotal>\n        }\n      </Fragment>\n    );\n  }\n}\n\nViewFileToolbar.propTypes = propTypes;\n\nexport default ViewFileToolbar;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport CommonToolbar from '../../components/toolbar/common-toolbar';\nimport ViewModeToolbar from '../../components/toolbar/view-mode-toolbar';\nimport DirOperationToolBar from '../../components/toolbar/dir-operation-toolbar';\nimport MultipleDirOperationToolbar from '../../components/toolbar/multiple-dir-operation-toolbar';\nimport ViewFileToolbar from '../../components/toolbar/view-file-toolbar';\n\nconst propTypes = {\n  isViewFile: PropTypes.bool.isRequired,\n  filePermission: PropTypes.string,\n  isDraft: PropTypes.bool.isRequired,\n  hasDraft: PropTypes.bool.isRequired,\n  fileTags: PropTypes.array.isRequired,\n  relatedFiles: PropTypes.array.isRequired,\n  onFileTagChanged: PropTypes.func.isRequired,  // for file-view-toolbar\n  onRelatedFileChange: PropTypes.func.isRequired,\n  // side-panel\n  onSideNavMenuClick: PropTypes.func.isRequired,\n  // mutiple-dir\n  isDirentSelected: PropTypes.bool.isRequired,\n  repoID: PropTypes.string.isRequired,\n  path: PropTypes.string.isRequired,\n  selectedDirentList: PropTypes.array.isRequired,\n  onItemsMove: PropTypes.func.isRequired,\n  onItemsCopy: PropTypes.func.isRequired,\n  onItemsDelete: PropTypes.func.isRequired,\n  // dir\n  direntList: PropTypes.array.isRequired,\n  repoName: PropTypes.string.isRequired,\n  repoEncrypted: PropTypes.bool.isRequired,\n  isGroupOwnedRepo: PropTypes.bool.isRequired,\n  userPerm: PropTypes.string.isRequired,\n  showShareBtn: PropTypes.bool.isRequired,\n  enableDirPrivateShare: PropTypes.bool.isRequired,\n  onAddFile: PropTypes.func.isRequired,\n  onAddFolder: PropTypes.func.isRequired,\n  onUploadFile: PropTypes.func.isRequired,\n  onUploadFolder: PropTypes.func.isRequired,\n  // view-mode\n  currentMode: PropTypes.string.isRequired,\n  switchViewMode: PropTypes.func.isRequired,\n  // search\n  onSearchedClick: PropTypes.func.isRequired,\n  isRepoOwner: PropTypes.bool.isRequired,\n  // selected menu\n  onFilesTagChanged: PropTypes.func.isRequired, // for mutiple select toolbar\n  updateDirent: PropTypes.func.isRequired,\n  unSelectDirent: PropTypes.func,\n  currentRepoInfo: PropTypes.object,\n};\n\nclass LibContentToolbar extends React.Component {\n\n  render() {\n\n    if (this.props.isViewFile) {\n      return (\n        <Fragment>\n          <div className=\"cur-view-toolbar\">\n            <span className=\"sf2-icon-menu hidden-md-up d-md-none side-nav-toggle\" title={gettext('Side Nav Menu')} onClick={this.props.onSideNavMenuClick}></span>\n            <ViewFileToolbar\n              path={this.props.path}\n              repoID={this.props.repoID}\n              userPerm={this.props.userPerm}\n              repoEncrypted={this.props.repoEncrypted}\n              enableDirPrivateShare={this.props.enableDirPrivateShare}\n              isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n              filePermission={this.props.filePermission}\n              isDraft={this.props.isDraft}\n              hasDraft={this.props.hasDraft}\n              fileTags={this.props.fileTags}\n              relatedFiles={this.props.relatedFiles}\n              onFileTagChanged={this.props.onFileTagChanged}\n              onRelatedFileChange={this.props.onRelatedFileChange}\n              showShareBtn={this.props.showShareBtn}\n            />\n            <ViewModeToolbar currentMode={this.props.currentMode} switchViewMode={this.props.switchViewMode}/>\n          </div>\n          <CommonToolbar isLibView={true} repoID={this.props.repoID} repoName={this.props.repoName} onSearchedClick={this.props.onSearchedClick} searchPlaceholder={gettext('Search files in this library')}/>\n        </Fragment>\n      );\n    }\n\n    return (\n      <Fragment>\n        <div className=\"cur-view-toolbar\">\n          <span className=\"sf2-icon-menu hidden-md-up d-md-none side-nav-toggle\" title={gettext('Side Nav Menu')} onClick={this.props.onSideNavMenuClick}></span>\n          {this.props.isDirentSelected ?\n            <MultipleDirOperationToolbar\n              repoID={this.props.repoID}\n              path={this.props.path}\n              userPerm={this.props.userPerm}\n              repoEncrypted={this.props.repoEncrypted}\n              selectedDirentList={this.props.selectedDirentList}\n              direntList={this.props.direntList}\n              onItemsMove={this.props.onItemsMove}\n              onItemsCopy={this.props.onItemsCopy}\n              onItemsDelete={this.props.onItemsDelete}\n              onItemRename={this.props.onItemRename}\n              isRepoOwner={this.props.isRepoOwner}\n              currentRepoInfo={this.props.currentRepoInfo}\n              enableDirPrivateShare={this.props.enableDirPrivateShare}\n              updateDirent={this.props.updateDirent}\n              relatedFiles={this.props.relatedFiles}\n              unSelectDirent={this.props.unSelectDirent}\n              onFilesTagChanged={this.props.onFilesTagChanged}\n              showShareBtn={this.props.showShareBtn}\n              isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n              showDirentDetail={this.props.showDirentDetail}\n              currentMode={this.props.currentMode}\n              switchViewMode={this.props.switchViewMode}\n            /> :\n            <DirOperationToolBar\n              path={this.props.path}\n              repoID={this.props.repoID}\n              repoName={this.props.repoName}\n              repoEncrypted={this.props.repoEncrypted}\n              direntList={this.props.direntList}\n              showShareBtn={this.props.showShareBtn}\n              enableDirPrivateShare={this.props.enableDirPrivateShare}\n              userPerm={this.props.userPerm}\n              isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n              onAddFile={this.props.onAddFile}\n              onAddFolder={this.props.onAddFolder}\n              onUploadFile={this.props.onUploadFile}\n              onUploadFolder={this.props.onUploadFolder}\n              currentMode={this.props.currentMode}\n              switchViewMode={this.props.switchViewMode}\n            />\n          }\n        </div>\n        <CommonToolbar isLibView={true} repoID={this.props.repoID} repoName={this.props.repoName} onSearchedClick={this.props.onSearchedClick} searchPlaceholder={gettext('Search files in this library')}/>\n      </Fragment>\n    );\n  }\n}\n\nLibContentToolbar.propTypes = propTypes;\n\nexport default LibContentToolbar;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Link } from '@reach/router';\nimport { UncontrolledTooltip } from 'reactstrap';\nimport { siteRoot, gettext } from '../../utils/constants';\nimport InternalLinkDialog from '../dialog/internal-link-dialog';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  repoName: PropTypes.string.isRequired,\n  currentPath: PropTypes.string.isRequired,\n  onPathClick: PropTypes.func.isRequired,\n  onTabNavClick: PropTypes.func,\n  pathPrefix: PropTypes.array,\n  repoID: PropTypes.string.isRequired,\n  isViewFile: PropTypes.bool,\n  fileTags: PropTypes.array.isRequired,\n};\n\nclass DirPath extends React.Component {\n\n  onPathClick = (e) => {\n    let path = Utils.getEventData(e, 'path');\n    this.props.onPathClick(path);\n  }\n\n  onTabNavClick = (e, tabName, id) => {\n    if (window.uploader &&\n      window.uploader.isUploadProgressDialogShow &&\n      window.uploader.totalProgress !== 100) {\n      if (!window.confirm(gettext('A file is being uploaded. Are you sure you want to leave this page?'))) {\n        e.preventDefault();\n        return false;\n      }\n      window.uploader.isUploadProgressDialogShow = false;\n    }\n    this.props.onTabNavClick(tabName, id);\n  }\n\n  turnPathToLink = (path) => {\n    path = path[path.length - 1] === '/' ? path.slice(0, path.length - 1) : path;\n    let pathList = path.split('/');\n    let nodePath = '';\n    let pathElem = pathList.map((item, index) => {\n      if (item === '') {\n        return;\n      }\n      if (index === (pathList.length - 1)) {\n        return (\n          <Fragment key={index}>\n            <span className=\"path-split\">/</span>\n            <span className=\"path-file-name\">{item}</span>\n          </Fragment>\n        );\n      } else {\n        nodePath += '/' + item;\n        return (\n          <Fragment key={index} >\n            <span className=\"path-split\">/</span>\n            <a className=\"path-link\" data-path={nodePath} onClick={this.onPathClick}>{item}</a>\n          </Fragment>\n        );\n      }\n    });\n    return pathElem;\n  }\n\n  render() {\n    let { currentPath, repoName, fileTags } = this.props;\n    let pathElem = this.turnPathToLink(currentPath);\n\n    let tagTitle = '';\n    if (fileTags.length > 0) {\n      fileTags.forEach(item => {\n        tagTitle += item.name + ' ';\n      });\n    }\n\n    return (\n      <div className=\"path-container\">\n        {this.props.pathPrefix && this.props.pathPrefix.map((item, index) => {\n          return (\n            <Fragment key={index}>\n              <Link to={item.url} className=\"normal\" onClick={(e) => this.onTabNavClick(e, item.name, item.id)}>{gettext(item.showName)}</Link>\n              <span className=\"path-split\">/</span>\n            </Fragment>\n          );\n        })}\n        {this.props.pathPrefix && this.props.pathPrefix.length === 0 && (\n          <Fragment>\n            <Link to={siteRoot + 'my-libs/'} className=\"normal\" onClick={(e) => this.onTabNavClick(e, 'my-libs')}>{gettext('Libraries')}</Link>\n            <span className=\"path-split\">/</span>\n          </Fragment>\n        )}\n        {!this.props.pathPrefix && (\n          <Fragment>\n            <Link href={siteRoot + 'my-libs/'} className=\"normal\" onClick={(e) => this.onTabNavClick(e, 'my-libs')}>{gettext('Libraries')}</Link>\n            <span className=\"path-split\">/</span>\n          </Fragment>\n        )}\n        {(currentPath === '/' || currentPath === '') ?\n          <span className=\"path-repo-name\">{repoName}</span>:\n          <a className=\"path-link\" data-path=\"/\" onClick={this.onPathClick}>{repoName}</a>\n        }\n        {pathElem}\n        {this.props.isViewFile &&\n          <InternalLinkDialog\n            repoID={this.props.repoID}\n            path={this.props.currentPath}\n          />\n        }\n        {(this.props.isViewFile && fileTags.length !== 0) &&\n          <span id='column-mode-file-tags' className=\"tag-list tag-list-stacked align-middle ml-1\">\n            {fileTags.map((fileTag, index) => {\n              return (<span className=\"file-tag\" key={fileTag.id} style={{zIndex: index, backgroundColor: fileTag.color}}></span>);\n            })}\n            <UncontrolledTooltip target=\"column-mode-file-tags\" placement=\"bottom\">\n              {tagTitle}\n            </UncontrolledTooltip>\n          </span>\n        }\n      </div>\n    );\n  }\n}\n\nDirPath.propTypes = propTypes;\n\nexport default DirPath;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\nimport RepoTag from '../../models/repo-tag';\n\nimport '../../css/repo-tag.css';\n\nconst tagListItemPropTypes = {\n  item: PropTypes.object.isRequired,\n  onTagUpdate: PropTypes.func.isRequired,\n  onListTaggedFiles: PropTypes.func.isRequired,\n};\n\nclass TagListItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      showSelectedTag: false\n    };\n  }\n\n  onMouseOver = () => {\n    this.setState({\n      showSelectedTag: true\n    });\n  }\n\n  onMouseOut = () => {\n    this.setState({\n      showSelectedTag: false\n    });\n  }\n\n  onTagUpdate = () => {\n    this.props.onTagUpdate(this.props.item);\n  }\n\n  onListTaggedFiles = () => {\n    this.props.onListTaggedFiles(this.props.item);\n  }\n\n  render() {\n    let color = this.props.item.color;\n    let drakColor = Utils.getDarkColor(color);\n    const fileCount = this.props.item.fileCount;\n    let fileTranslation = (fileCount === 1 || fileCount === 0) ? gettext('file') : gettext('files');\n    return (\n      <li className=\"tag-list-item\">\n        <div className=\"tag-demo\" style={{backgroundColor:color}} onMouseOver={this.onMouseOver} onMouseOut={this.onMouseOut}>\n          <span className={`${this.state.showSelectedTag ? 'show-tag-selected': ''}`} style={{backgroundColor: drakColor}}></span>\n          <span className=\"tag-name\">{this.props.item.name}</span>\n          <span className=\"tag-files\" onClick={this.onListTaggedFiles}>\n            {fileCount}{' '}{fileTranslation}\n          </span>\n        </div>\n        <i className=\"tag-edit fa fa-pencil-alt\" onClick={this.onTagUpdate}></i>\n      </li>\n    );\n  }\n}\n\nTagListItem.propTypes = tagListItemPropTypes;\n\nconst listTagPropTypes = {\n  repoID: PropTypes.string.isRequired,\n  onListTagCancel: PropTypes.func.isRequired,\n  onCreateRepoTag: PropTypes.func.isRequired,\n  onUpdateRepoTag: PropTypes.func.isRequired,\n  onListTaggedFiles: PropTypes.func.isRequired,\n};\n\nclass ListTagDialog extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      repotagList: [],\n    };\n  }\n\n  componentDidMount() {\n    let repoID = this.props.repoID;\n    seafileAPI.listRepoTags(repoID).then(res => {\n      let repotagList = [];\n      res.data.repo_tags.forEach(item => {\n        let repo_tag = new RepoTag(item);\n        repotagList.push(repo_tag);\n      });\n      this.setState({\n        repotagList: repotagList,\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  toggle = () => {\n    this.props.onListTagCancel();\n  }\n\n  createNewTag = (e) => {\n    e.preventDefault();\n    this.props.onCreateRepoTag();\n  }\n\n  render() {\n    return (\n      <Fragment>\n        <ModalHeader toggle={this.toggle}>{gettext('Tags')}</ModalHeader>\n        <ModalBody>\n          <ul className=\"tag-list tag-list-container\">\n            {this.state.repotagList.map((repoTag, index) => {\n              return (\n                <TagListItem\n                  key={index}\n                  item={repoTag}\n                  onTagUpdate={this.props.onUpdateRepoTag}\n                  onListTaggedFiles={this.props.onListTaggedFiles}\n                />\n              );\n            })}\n          </ul>\n          <a href=\"#\" className=\"add-tag-link\" onClick={this.createNewTag}>{gettext('Create a new tag')}</a>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Close')}</Button>\n        </ModalFooter>\n      </Fragment>\n    );\n  }\n}\n\nListTagDialog.propTypes = listTagPropTypes;\n\nexport default ListTagDialog;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, ModalHeader, ModalBody, ModalFooter, Input } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\n\nconst propTypes = {\n  currentTag: PropTypes.object,\n  repoID: PropTypes.string.isRequired,\n  toggleCancel: PropTypes.func.isRequired,\n  onDeleteRepoTag: PropTypes.func.isRequired,\n  updateUsedRepoTags: PropTypes.func.isRequired,\n  onClose: PropTypes.func.isRequired\n};\n\nclass UpdateTagDialog extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      deleteRepoTag: false,\n      newName: this.props.currentTag.name,\n      newColor: this.props.currentTag.color,\n      colorList: ['#FFA8A8', '#FFA94D', '#FFD43B', '#A0EC50', '#A9E34B', '#63E6BE', '#4FD2C9', '#72C3FC', '#91A7FF', '#E599F7', '#B197FC', '#F783AC', '#CED4DA'],\n    };\n    this.newInput = React.createRef();\n  }\n\n  componentDidMount() {\n    this.newInput.focus();\n    this.newInput.setSelectionRange(0, -1);\n  }\n\n  inputNewName = (e) => {\n    this.setState({\n      newName: e.target.value,\n    });\n  }\n\n  selectNewcolor = (e) => {\n    this.setState({\n      newColor: e.target.value,\n    });\n  }\n\n  updateTag = () => {\n    let tag_id = this.props.currentTag.id;\n    let name = this.state.newName;\n    let color = this.state.newColor;\n    let repoID = this.props.repoID;\n    seafileAPI.updateRepoTag(repoID, tag_id, name, color).then(() => {\n      this.props.toggleCancel();\n      this.props.updateUsedRepoTags();\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  handleKeyPress = (e) => {\n    if (e.key === 'Enter') {\n      this.updateTag();\n    }\n  }\n\n  deleteTagClick = (item) => {\n    this.setState({\n      deleteRepoTag: !this.state.deleteRepoTag,\n    });\n  }\n\n  onDeleteTag = () => {\n    let tag = this.props.currentTag;\n    let repoID = this.props.repoID;\n    seafileAPI.deleteRepoTag(repoID, tag.id).then((res) => {\n      this.props.toggleCancel();\n      if (res.data.success === 'true') {\n        this.props.onDeleteRepoTag(tag.id);\n      }\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    let colorList = this.state.colorList;\n    if (colorList.indexOf(this.props.currentTag.color)===-1) {\n      colorList.push(this.props.currentTag.color);\n    }\n    return (\n      <Fragment>\n        <ModalHeader toggle={this.props.onClose}>\n          <span className=\"tag-dialog-back fas fa-sm fa-arrow-left\" onClick={this.props.toggleCancel} aria-label={gettext('Back')}></span>\n          {gettext('Edit Tag')}\n        </ModalHeader>\n        <ModalBody>\n          <div className=\"tag-edit\">\n            <div className=\"form-group\">\n              <label className=\"form-label\">{gettext('Name')}</label>\n              <Input onKeyPress={this.handleKeyPress} innerRef={input => {this.newInput = input;}} value={this.state.newName} onChange={this.inputNewName}/>\n            </div>\n            <div className=\"form-group\">\n              <label className=\"form-label\">{gettext('Select a color')}</label>\n              <div className=\"row gutters-xs\">\n                {colorList.map((item, index)=>{\n                  return (\n                    <div key={index} className=\"col-auto\" onChange={this.selectNewcolor}>\n                      <label className=\"colorinput\">\n                        {item===this.props.currentTag.color ?\n                          <input name=\"color\" type=\"radio\" value={item} className=\"colorinput-input\" defaultChecked onChange={this.selectNewcolor}></input> :\n                          <input name=\"color\" type=\"radio\" value={item} className=\"colorinput-input\" onChange={this.selectNewcolor}></input>}\n                        <span className=\"colorinput-color\" style={{backgroundColor:item}}></span>\n                      </label>\n                    </div>\n                  );\n                })}\n              </div>\n            </div>\n          </div>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"danger\" onClick={this.onDeleteTag}>{gettext('Delete')}</Button>\n          <Button color=\"primary\" onClick={this.updateTag}>{gettext('Save')}</Button>\n        </ModalFooter>\n      </Fragment>\n    );\n  }\n}\n\nUpdateTagDialog.propTypes = propTypes;\n\nexport default UpdateTagDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\nimport moment from 'moment';\nimport { gettext, siteRoot } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  currentTag: PropTypes.object.isRequired,\n  toggleCancel: PropTypes.func.isRequired,\n  onClose: PropTypes.func.isRequired,\n  updateUsedRepoTags: PropTypes.func.isRequired,\n  onFileTagChanged: PropTypes.func,\n};\n\nclass ListTaggedFilesDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      taggedFileList: [],\n    };\n  }\n\n  onFileTagChanged = (TaggedFile) => {\n    const path = TaggedFile.parent_path;\n    const dirent = {name: TaggedFile.filename};\n    let direntPath = path === '/' ? path + TaggedFile.filename : path + '/' + TaggedFile.filename;\n    this.props.onFileTagChanged(dirent, direntPath);\n  }\n\n  onDeleteTaggedFile = (taggedFile) => {\n    let repoID = this.props.repoID;\n    let fileTagID = taggedFile.file_tag_id;\n    seafileAPI.deleteFileTag(repoID, fileTagID).then(res => {\n      this.getTaggedFiles();\n      this.props.updateUsedRepoTags();\n      if ((this.props.onFileTagChanged) && !taggedFile.file_deleted) this.onFileTagChanged(taggedFile);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  componentDidMount() {\n    this.getTaggedFiles();\n  }\n\n  getTaggedFiles = () => {\n    let { repoID, currentTag } = this.props;\n    seafileAPI.listTaggedFiles(repoID, currentTag.id).then(res => {\n      let taggedFileList = [];\n      res.data.tagged_files !== undefined &&\n      res.data.tagged_files.forEach(file => {\n        let taggedFile = file;\n        taggedFileList.push(taggedFile);\n      });\n      this.setState({\n        taggedFileList: taggedFileList,\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    let taggedFileList = this.state.taggedFileList;\n    return (\n      <Modal isOpen={true}>\n        <ModalHeader toggle={this.props.onClose}>{gettext('Tagged Files')}</ModalHeader>\n        <ModalBody className=\"dialog-list-container\">\n          <table>\n            <thead>\n              <tr>\n                <th width='45%' className=\"ellipsis\">{gettext('Name')}</th>\n                <th width='27%'>{gettext('Size')}</th>\n                <th width='18%'>{gettext('Last Update')}</th>\n                <th width='10%'></th>\n              </tr>\n            </thead>\n            <tbody>\n              {taggedFileList.map((taggedFile, index) => {\n                return (\n                  <TaggedFile\n                    key={index}\n                    repoID={this.props.repoID}\n                    taggedFile={taggedFile}\n                    onDeleteTaggedFile={this.onDeleteTaggedFile}\n                  />\n                );\n              })}\n            </tbody>\n          </table>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.props.toggleCancel}>{gettext('Close')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nListTaggedFilesDialog.propTypes = propTypes;\n\nexport default ListTaggedFilesDialog;\n\nconst TaggedFilePropTypes = {\n  repoID: PropTypes.string.isRequired,\n  taggedFile: PropTypes.object,\n  onDeleteTaggedFile: PropTypes.func.isRequired,\n};\n\nclass TaggedFile extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = ({\n      active: false,\n    });\n  }\n\n  onMouseEnter = () => {\n    this.setState({\n      active: true\n    });\n  }\n\n  onMouseLeave = () => {\n    this.setState({\n      active: false\n    });\n  }\n\n  render() {\n    const taggedFile = this.props.taggedFile;\n    let className = this.state.active ? 'action-icon sf2-icon-x3' : 'action-icon vh sf2-icon-x3';\n    let path = taggedFile.parent_path ? Utils.joinPath(taggedFile.parent_path, taggedFile.filename) : '';\n    let href = siteRoot + 'lib/' + this.props.repoID + '/file' + Utils.encodePath(path);\n    return ( taggedFile.file_deleted ?\n      <tr onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave}>\n        <td colSpan='3' className=\"name\">{taggedFile.filename}{' '}\n          <span style={{color:'red'}}>{gettext('deleted')}</span>\n        </td>\n        <td><i className={className} onClick={this.props.onDeleteTaggedFile.bind(this, taggedFile)}></i></td>\n      </tr>\n      :\n      <tr onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave}>\n        <td className=\"name\"><a href={href} target='_blank'>{taggedFile.filename}</a></td>\n        <td>{Utils.bytesToSize(taggedFile.size)}</td>\n        <td>{moment.unix(taggedFile.mtime).fromNow()}</td>\n        <td><i className={className} onClick={this.props.onDeleteTaggedFile.bind(this, taggedFile)}></i></td>\n      </tr>\n    );\n  }\n}\n\nTaggedFile.propTypes = TaggedFilePropTypes;\n","import React, { Fragment } from 'react';\nimport { gettext, siteRoot } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport PropTypes from 'prop-types';\nimport ModalPortal from '../modal-portal';\nimport { Modal } from 'reactstrap';\nimport ListTagDialog from '../dialog/list-tag-dialog';\nimport CreateTagDialog from '../dialog/create-tag-dialog';\nimport UpdateTagDialog from '../dialog/update-tag-dialog';\nimport ListTaggedFilesDialog from '../dialog/list-taggedfiles-dialog';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  repoName: PropTypes.string.isRequired,\n  permission: PropTypes.bool.isRequired,\n  currentPath: PropTypes.string.isRequired,\n  updateUsedRepoTags: PropTypes.func.isRequired,\n  onDeleteRepoTag: PropTypes.func.isRequired,\n};\n\nclass DirTool extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isRepoTagDialogShow: false,\n      currentTag: null,\n      isListRepoTagShow: false,\n      isUpdateRepoTagShow: false,\n      isCreateRepoTagShow: false,\n      isListTaggedFileShow: false,\n    };\n  }\n\n  onShowListRepoTag = () => {\n    this.setState({\n      isRepoTagDialogShow: true,\n      isListRepoTagShow: true,\n      isUpdateRepoTagShow: false,\n      isCreateRepoTagShow: false,\n      isListTaggedFileShow: false\n    });\n  }\n\n  onCloseRepoTagDialog = () => {\n    this.setState({\n      isRepoTagDialogShow: false,\n      isListRepoTagShow: false,\n      isUpdateRepoTagShow: false,\n      isCreateRepoTagShow: false,\n      isListTaggedFileShow: false\n    });\n  }\n\n  onCreateRepoTagToggle = () => {\n    this.setState({\n      isCreateRepoTagShow: !this.state.isCreateRepoTagShow,\n      isListRepoTagShow: !this.state.isListRepoTagShow,\n    });\n  }\n\n  onUpdateRepoTagToggle = (currentTag) => {\n    this.setState({\n      currentTag: currentTag,\n      isListRepoTagShow: !this.state.isListRepoTagShow,\n      isUpdateRepoTagShow: !this.state.isUpdateRepoTagShow,\n    });\n  }\n\n  onListTaggedFileToggle = (currentTag) => {\n    this.setState({\n      currentTag: currentTag,\n      isListRepoTagShow: !this.state.isListRepoTagShow,\n      isListTaggedFileShow: !this.state.isListTaggedFileShow,\n    });\n  }\n\n  isMarkdownFile(filePath) {\n    let name = Utils.getFileName(filePath);\n    return name.indexOf('.md') > -1 ? true : false;\n  }\n\n  render() {\n    let { repoID, repoName, permission, currentPath } = this.props;\n    let isFile = this.isMarkdownFile(currentPath);\n    let name = Utils.getFileName(currentPath);\n    let trashUrl = siteRoot + 'repo/' + repoID + '/trash/';\n    let historyUrl = siteRoot + 'repo/history/' + repoID + '/';\n    if (permission) {\n      if (!isFile) {\n        if (name) { // name not '' is not root path\n          trashUrl = siteRoot + 'repo/' + repoID + '/trash/?path=' + encodeURIComponent(currentPath);\n          return (\n            <ul className=\"path-toolbar\">\n              <li className=\"toolbar-item\"><a className=\"op-link sf2-icon-recycle\" href={trashUrl} title={gettext('Trash')} aria-label={gettext('Trash')}></a></li>\n            </ul>\n          );\n        } else { // currentPath === '/' is root path\n          return (\n            <Fragment>\n              <ul className=\"path-toolbar\">\n                <li className=\"toolbar-item\"><a className=\"op-link sf2-icon-tag\" onClick={this.onShowListRepoTag} title={gettext('Tags')} aria-label={gettext('Tags')}></a></li>\n                <li className=\"toolbar-item\"><a className=\"op-link sf2-icon-recycle\" href={trashUrl} title={gettext('Trash')} aria-label={gettext('Trash')}></a></li>\n                <li className=\"toolbar-item\"><a className=\"op-link sf2-icon-history\" href={historyUrl} title={gettext('History')} aria-label={gettext('History')}></a></li>\n              </ul>\n\n              {this.state.isRepoTagDialogShow && (\n                <ModalPortal>\n                  <Modal isOpen={true}>\n                    {this.state.isListRepoTagShow && (\n                      <ListTagDialog\n                        repoID={repoID}\n                        onListTagCancel={this.onCloseRepoTagDialog}\n                        onCreateRepoTag={this.onCreateRepoTagToggle}\n                        onUpdateRepoTag={this.onUpdateRepoTagToggle}\n                        onListTaggedFiles={this.onListTaggedFileToggle}\n                      />\n                    )}\n                    {this.state.isCreateRepoTagShow && (\n                      <CreateTagDialog\n                        repoID={repoID}\n                        onClose={this.onCloseRepoTagDialog}\n                        toggleCancel={this.onCreateRepoTagToggle}\n                      />\n                    )}\n                    {this.state.isUpdateRepoTagShow && (\n                      <UpdateTagDialog\n                        repoID={repoID}\n                        currentTag={this.state.currentTag}\n                        onClose={this.onCloseRepoTagDialog}\n                        toggleCancel={this.onUpdateRepoTagToggle}\n                        onDeleteRepoTag={this.props.onDeleteRepoTag}\n                        updateUsedRepoTags={this.props.updateUsedRepoTags}\n                      />\n                    )}\n                    {this.state.isListTaggedFileShow && (\n                      <ListTaggedFilesDialog\n                        repoID={this.props.repoID}\n                        currentTag={this.state.currentTag}\n                        onClose={this.onCloseRepoTagDialog}\n                        toggleCancel={this.onListTaggedFileToggle}\n                        updateUsedRepoTags={this.props.updateUsedRepoTags}\n                      />\n                    )}\n                  </Modal>\n                </ModalPortal>\n              )}\n            </Fragment>\n          );\n        }\n      }\n    }\n    return '';\n  }\n}\n\nDirTool.propTypes = propTypes;\n\nexport default DirTool;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Utils } from '../../utils/utils';\nimport SortOptionsDialog from '../../components/dialog/sort-options';\nimport DirPath from './dir-path';\nimport DirTool from './dir-tool';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  repoName: PropTypes.string.isRequired,\n  permission: PropTypes.bool.isRequired,\n  currentPath: PropTypes.string.isRequired,\n  onPathClick: PropTypes.func.isRequired,\n  onTabNavClick: PropTypes.func,\n  pathPrefix: PropTypes.array,\n  isViewFile: PropTypes.bool,\n  updateUsedRepoTags: PropTypes.func.isRequired,\n  fileTags: PropTypes.array.isRequired,\n  onDeleteRepoTag: PropTypes.func.isRequired,\n};\n\nclass CurDirPath extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isSortOptionsDialogOpen: false\n    };\n  }\n\n  toggleSortOptionsDialog = () => {\n    this.setState({\n      isSortOptionsDialogOpen: !this.state.isSortOptionsDialogOpen\n    });\n  }\n\n  render() {\n    const isDesktop = Utils.isDesktop();\n    return (\n      <Fragment>\n        <DirPath\n          repoName={this.props.repoName}\n          pathPrefix={this.props.pathPrefix}\n          currentPath={this.props.currentPath}\n          onPathClick={this.props.onPathClick}\n          onTabNavClick={this.props.onTabNavClick}\n          repoID={this.props.repoID}\n          isViewFile={this.props.isViewFile}\n          fileTags={this.props.fileTags}\n        />\n        {isDesktop &&\n        <DirTool\n          repoID={this.props.repoID}\n          repoName={this.props.repoName}\n          permission={this.props.permission}\n          currentPath={this.props.currentPath}\n          updateUsedRepoTags={this.props.updateUsedRepoTags}\n          onDeleteRepoTag={this.props.onDeleteRepoTag}\n        />}\n        {!isDesktop && this.props.direntList.length > 0 &&\n        <span className=\"sf3-font sf3-font-sort action-icon\" onClick={this.toggleSortOptionsDialog}></span>}\n        {this.state.isSortOptionsDialogOpen &&\n        <SortOptionsDialog\n          toggleDialog={this.toggleSortOptionsDialog}\n          sortBy={this.props.sortBy}\n          sortOrder={this.props.sortOrder}\n          sortItems={this.props.sortItems}\n        />\n        }\n      </Fragment>\n    );\n  }\n}\n\nCurDirPath.propTypes = propTypes;\n\nexport default CurDirPath;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport { processor } from '@seafile/seafile-editor/dist/utils/seafile-markdown2html';\nimport { Button, Dropdown, DropdownToggle, DropdownMenu, DropdownItem } from 'reactstrap';\nimport { gettext, username, siteRoot } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\nimport ParticipantsList from '../file-view/participants-list';\nimport { MentionsInput, Mention } from 'react-mentions';\nimport { defaultStyle, defaultMentionStyle } from '../../css/react-mentions-default-style';\nimport '../../css/comments-list.css';\n\nconst DetailCommentListPropTypes = {\n  repoID: PropTypes.string.isRequired,\n  filePath: PropTypes.string.isRequired,\n  onParticipantsChange: PropTypes.func.isRequired,\n  fileParticipantList: PropTypes.array.isRequired,\n};\n\nclass DetailCommentList extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      commentsList: [],\n      relatedUsers: null,\n      comment: '',\n    };\n    this.toBeAddedParticipant = [];\n  }\n\n  componentDidMount() {\n    this.listComments();\n    this.checkParticipant();\n    this.listRepoRelatedUsers();\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (nextProps.filePath !== this.props.filePath) {\n      this.listComments(nextProps.filePath);\n    }\n  }\n\n  handleCommentChange = (event) => {\n    this.setState({ comment: event.target.value });\n  }\n\n  listComments = (filePath) => {\n    seafileAPI.listComments(this.props.repoID, (filePath || this.props.filePath)).then((res) => {\n      this.setState({ commentsList: res.data.comments });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  addComment = () => {\n    const { repoID, filePath } = this.props;\n    if (!this.state.comment.trim()) return;\n    seafileAPI.postComment(repoID, filePath, this.state.comment.trim()).then(() => {\n      this.listComments();\n    }).catch(err => {\n      toaster.danger(Utils.getErrorMsg(err));\n    });\n    this.setState({ comment: '' });\n  }\n\n  onSubmit = () => {\n    this.addParticipant(username);\n    if (this.toBeAddedParticipant.length === 0) {\n      this.addComment();\n    } else {\n      const { repoID, filePath } = this.props;\n      seafileAPI.addFileParticipants(repoID, filePath, this.toBeAddedParticipant).then((res) => {\n        this.props.onParticipantsChange(repoID, filePath);\n        this.toBeAddedParticipant = [];\n        this.addComment();\n      }).catch((err) => {\n        toaster.danger(Utils.getErrorMsg(err));\n      });\n    }\n  }\n\n  resolveComment = (event) => {\n    const { repoID } = this.props;\n    seafileAPI.updateComment(repoID, event.target.id, 'true').then(() => {\n      this.listComments();\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  deleteComment = (event) => {\n    const { repoID } = this.props;\n    seafileAPI.deleteComment(repoID, event.target.id).then(() => {\n      this.listComments();\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  editComment = (commentID, newComment) => {\n    const { repoID } = this.props;\n    seafileAPI.updateComment(repoID, commentID, null, null, newComment).then(() => {\n      this.listComments();\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  listRepoRelatedUsers = () => {\n    const { repoID } = this.props;\n    seafileAPI.listRepoRelatedUsers(repoID).then((res) => {\n      let users = res.data.user_list.map((item) => {\n        return { id: item.email, display: item.name};\n      });\n      this.setState({ relatedUsers: users });\n    });\n  }\n\n  checkParticipant = (email) => {\n    return this.props.fileParticipantList.map((participant) => {return participant.email;}).includes(email);\n  }\n\n  addParticipant = (email) => {\n    if (this.checkParticipant(email)) return;\n    this.toBeAddedParticipant.push(email);\n  }\n\n  renderUserSuggestion = (entry, search, highlightedDisplay, index, focused) => {\n    return <div className={`user ${focused ? 'focused' : ''}`}>{highlightedDisplay}</div>;\n  }\n\n  render() {\n    const { repoID, filePath, fileParticipantList } = this.props;\n    return (\n      <div className=\"seafile-comment detail-comments h-100 w-100\">\n        <ul className=\"seafile-comment-list\">\n          {this.state.commentsList.length > 0 &&\n            this.state.commentsList.map((item, index = 0, arr) => {\n              let oldTime = (new Date(item.created_at)).getTime();\n              let time = moment(oldTime).format('YYYY-MM-DD HH:mm');\n              return (\n                <React.Fragment key={item.id}>\n                  <CommentItem\n                    item={item} time={time} deleteComment={this.deleteComment}\n                    resolveComment={this.resolveComment} editComment={this.editComment}\n                  />\n                </React.Fragment>\n              );\n            })\n          }\n          {(this.state.commentsList.length == 0 ) &&\n            <li className=\"comment-vacant\">{gettext('No comment yet.')}</li>}\n        </ul>\n        <div className=\"seafile-comment-footer\">\n          {fileParticipantList &&\n            <ParticipantsList\n              onParticipantsChange={this.props.onParticipantsChange}\n              participants={fileParticipantList}\n              repoID={repoID}\n              filePath={filePath}\n              showIconTip={true}\n            />\n          }\n          <MentionsInput\n            value={this.state.comment}\n            onChange={this.handleCommentChange}\n            placeholder={gettext('Add a comment.')}\n            style={defaultStyle}\n          >\n            <Mention\n              trigger=\"@\"\n              displayTransform={(username, display) => `@${display}`}\n              data={this.state.relatedUsers}\n              renderSuggestion={this.renderUserSuggestion}\n              style={defaultMentionStyle}\n              onAdd={(id, display) => {this.addParticipant(id);}}\n              appendSpaceOnAdd={true}\n            />\n          </MentionsInput>\n          <Button className=\"submit-comment\" color=\"primary\" size=\"sm\" onClick={this.onSubmit}>{gettext('Submit')}</Button>\n        </div>\n      </div>\n    );\n  }\n}\n\nDetailCommentList.propTypes = DetailCommentListPropTypes;\n\nconst commentItemPropTypes = {\n  time: PropTypes.string.isRequired,\n  item: PropTypes.object.isRequired,\n  deleteComment: PropTypes.func.isRequired,\n  resolveComment: PropTypes.func.isRequired,\n  editComment: PropTypes.func.isRequired,\n};\n\nclass CommentItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      dropdownOpen: false,\n      html: '',\n      newComment: this.props.item.comment,\n      editable: false,\n    };\n  }\n\n  componentWillMount() {\n    this.convertComment(this.props.item.comment);\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.convertComment(nextProps.item.comment);\n  }\n\n  convertComment = (mdFile) => {\n    processor.process(mdFile).then((result) => {\n      let html = String(result);\n      this.setState({ html: html });\n    });\n  }\n\n  toggleDropDownMenu = () => {\n    this.setState({ dropdownOpen: !this.state.dropdownOpen });\n  }\n\n  toggleEditComment = () => {\n    this.setState({ editable: !this.state.editable });\n  }\n\n  updateComment = (event) => {\n    const newComment = this.state.newComment;\n    if (this.props.item.comment !== newComment) {\n      this.props.editComment(event.target.id, newComment);\n    }\n    this.toggleEditComment();\n  }\n\n  handleCommentChange = (event) => {\n    this.setState({ newComment: event.target.value });\n  }\n\n  onCommentClick = (e) => {\n    // click participant link, page shouldn't jump\n    if (e.target.nodeName !== 'A') return;\n    const preNode = e.target.previousSibling;\n    if (preNode && preNode.nodeType === 3 && preNode.nodeValue.slice(-1) === '@') {\n      e.preventDefault();\n    }\n  }\n\n  renderInfo = (item) => {\n    return (\n      <Fragment>\n        <img className=\"avatar\" src={item.avatar_url} alt=\"\"/>\n        <div className=\"reviewer-info\">\n          <div className=\"reviewer-name ellipsis\">{item.user_name}</div>\n          <div className=\"review-time\">{this.props.time}</div>\n        </div>\n      </Fragment>\n    );\n  }\n\n  render() {\n    const item = this.props.item;\n    if (this.state.editable) {\n      return(\n        <li className=\"seafile-comment-item\" id={item.id}>\n          <div className=\"seafile-comment-info\">\n            {this.renderInfo(item)}\n          </div>\n          <div className=\"seafile-edit-comment\">\n            <textarea className=\"edit-comment-input\" value={this.state.newComment}\n              onChange={this.handleCommentChange} clos=\"100\" rows=\"3\" warp=\"virtual\"\n            ></textarea>\n            <Button className=\"comment-btn\" color=\"primary\" size=\"sm\" onClick={this.updateComment} id={item.id}>{gettext('Update')}</Button>{' '}\n            <Button className=\"comment-btn\" color=\"secondary\" size=\"sm\" onClick={this.toggleEditComment}> {gettext('Cancel')}</Button>\n          </div>\n        </li>\n      );\n    }\n    return (\n      <li className={item.resolved ? 'seafile-comment-item seafile-comment-item-resolved' : 'seafile-comment-item'} id={item.id}>\n        <div className=\"seafile-comment-info\">\n          {this.renderInfo(item)}\n          <Dropdown isOpen={this.state.dropdownOpen} size=\"sm\" className=\"seafile-comment-dropdown\" toggle={this.toggleDropDownMenu}>\n            <DropdownToggle className=\"seafile-comment-dropdown-btn\"><i className=\"fas fa-ellipsis-v\"></i></DropdownToggle>\n            <DropdownMenu>\n              {item.user_email === username &&\n                <DropdownItem onClick={this.props.deleteComment} className=\"delete-comment\" id={item.id}>{gettext('Delete')}</DropdownItem>\n              }\n              {item.user_email === username &&\n                <DropdownItem onClick={this.toggleEditComment} className=\"edit-comment\" id={item.id}>{gettext('Edit')}</DropdownItem>\n              }\n              {!item.resolved &&\n                <DropdownItem onClick={this.props.resolveComment} className=\"seafile-comment-resolved\"\n                  id={item.id}>{gettext('Mark as resolved')}</DropdownItem>\n              }\n            </DropdownMenu>\n          </Dropdown>\n        </div>\n        <div\n          className=\"seafile-comment-content\"\n          dangerouslySetInnerHTML={{ __html: this.state.html }}\n          onClick={e => this.onCommentClick(e)}\n        ></div>\n      </li>\n    );\n  }\n}\n\nCommentItem.propTypes = commentItemPropTypes;\n\nexport default DetailCommentList;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport { gettext, siteRoot } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport EditFileTagDialog from '../dialog/edit-filetag-dialog';\nimport ModalPortal from '../modal-portal';\nimport RelatedFileDialogs from '../dialog/related-file-dialogs';\nimport ParticipantsList from '../file-view/participants-list';\n\nconst propTypes = {\n  repoInfo: PropTypes.object.isRequired,\n  repoID: PropTypes.string.isRequired,\n  dirent: PropTypes.object.isRequired,\n  direntType: PropTypes.string.isRequired,\n  direntDetail: PropTypes.object.isRequired,\n  path: PropTypes.string.isRequired,\n  fileTagList: PropTypes.array.isRequired,\n  relatedFiles: PropTypes.array.isRequired,\n  onFileTagChanged: PropTypes.func.isRequired,\n  onRelatedFileChange: PropTypes.func.isRequired,\n  onParticipantsChange: PropTypes.func.isRequired,\n  fileParticipantList: PropTypes.array.isRequired,\n};\n\nclass DetailListView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isEditFileTagShow: false,\n      showRelatedFileDialog: false,\n    };\n  }\n\n  getDirentPostion = () => {\n    let { repoInfo } = this.props;\n    let direntPath = this.getDirentPath();\n    let position = repoInfo.repo_name;\n    if (direntPath !== '/') {\n      let index = direntPath.lastIndexOf('/');\n      let path = direntPath.slice(0, index);\n      position = position + path;\n    }\n    return position;\n  }\n\n  onEditFileTagToggle = () => {\n    this.setState({\n      isEditFileTagShow: !this.state.isEditFileTagShow\n    });\n  }\n\n  onFileTagChanged = () => {\n    let direntPath = this.getDirentPath();\n    this.props.onFileTagChanged(this.props.dirent, direntPath);\n  }\n\n  getDirentPath = () => {\n    if (Utils.isMarkdownFile(this.props.path)) {\n      return this.props.path; // column mode: view file\n    }\n    let { dirent, path } = this.props;\n    return Utils.joinPath(path, dirent.name);\n  }\n\n  onRelatedFileChange = () => {\n    let direntPath = this.getDirentPath();\n    this.props.onRelatedFileChange(this.props.dirent, direntPath);\n  }\n\n  onListRelatedFileToggle = () => {\n    this.setState({\n      showRelatedFileDialog: true,\n    });\n  }\n\n  toggleCancel = () => {\n    this.setState({\n      showRelatedFileDialog: false,\n    });\n  }\n\n  render() {\n    let { direntType, direntDetail, fileTagList, relatedFiles, fileParticipantList } = this.props;\n    let position = this.getDirentPostion();\n    let direntPath = this.getDirentPath();\n    if (direntType === 'dir') {\n      return (\n        <table className=\"table-thead-hidden\">\n          <thead>\n            <tr><th width=\"35%\"></th><th width=\"65%\"></th></tr>\n          </thead>\n          <tbody>\n            <tr><th>{gettext('Location')}</th><td>{position}</td></tr>\n            <tr><th>{gettext('Last Update')}</th><td>{moment(direntDetail.mtime).format('YYYY-MM-DD')}</td></tr>\n          </tbody>\n        </table>\n      );\n    } else {\n      return (\n        <Fragment>\n          <table className=\"table-thead-hidden\">\n            <thead>\n              <tr><th width=\"35%\"></th><th width=\"65%\"></th></tr>\n            </thead>\n            <tbody>\n              <tr><th>{gettext('Size')}</th><td>{Utils.bytesToSize(direntDetail.size)}</td></tr>\n              <tr><th>{gettext('Location')}</th><td>{position}</td></tr>\n              <tr><th>{gettext('Last Update')}</th><td>{moment(direntDetail.last_modified).fromNow()}</td></tr>\n              <tr className=\"file-tag-container\">\n                <th>{gettext('Tags')}</th>\n                <td>\n                  <ul className=\"file-tag-list\">\n                    {fileTagList.map((fileTag) => {\n                      return (\n                        <li key={fileTag.id} className=\"file-tag-item\">\n                          <span className=\"file-tag\" style={{backgroundColor:fileTag.color}}></span>\n                          <span className=\"tag-name\" title={fileTag.name}>{fileTag.name}</span>\n                        </li>\n                      );\n                    })}\n                  </ul>\n                  <i className='fa fa-pencil-alt attr-action-icon' onClick={this.onEditFileTagToggle}></i>\n                </td>\n              </tr>\n              <tr className=\"file-related-files\">\n                <th>{gettext('Related Files')}</th>\n                <td>\n                  <ul>\n                    {relatedFiles.map((relatedFile, index) => {\n                      let href = siteRoot + 'lib/' + relatedFile.repo_id + '/file' + Utils.encodePath(relatedFile.path);\n                      return (\n                        <li key={index}>\n                          <a href={href} target='_blank'>{relatedFile.name}</a>\n                        </li>\n                      );\n                    })}\n                  </ul>\n                  <i className='fa fa-pencil-alt attr-action-icon' onClick={this.onListRelatedFileToggle}></i>\n                </td>\n              </tr>\n              <tr className=\"file-participants\">\n                <th>{gettext('Participants')}</th>\n                <td>\n                  {fileParticipantList &&\n                    <ParticipantsList\n                      onParticipantsChange={this.props.onParticipantsChange}\n                      participants={fileParticipantList}\n                      repoID={this.props.repoID}\n                      filePath={direntPath}\n                      showIconTip={false}\n                    />\n                  }\n                </td>\n              </tr>\n            </tbody>\n          </table>\n          {this.state.showRelatedFileDialog &&\n            <ModalPortal>\n              <RelatedFileDialogs\n                repoID={this.props.repoID}\n                filePath={direntPath}\n                relatedFiles={relatedFiles}\n                toggleCancel={this.toggleCancel}\n                onRelatedFileChange={this.onRelatedFileChange}\n                dirent={this.props.dirent}\n                viewMode=\"list_related_file\"\n              />\n            </ModalPortal>\n          }\n          {this.state.isEditFileTagShow &&\n            <ModalPortal>\n              <EditFileTagDialog\n                repoID={this.props.repoID}\n                fileTagList={fileTagList}\n                filePath={direntPath}\n                toggleCancel={this.onEditFileTagToggle}\n                onFileTagChanged={this.onFileTagChanged}\n              />\n            </ModalPortal>\n          }\n        </Fragment>\n      );\n    }\n  }\n}\n\nDetailListView.propTypes = propTypes;\n\nexport default DetailListView;","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport classnames from 'classnames';\nimport { Nav, NavItem, NavLink, TabContent, TabPane } from 'reactstrap';\nimport DetailCommentList from './detail-comments-list';\nimport { siteRoot } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\nimport Dirent from '../../models/dirent';\nimport DetailListView from './detail-list-view';\nimport FileTag from '../../models/file-tag';\nimport '../../css/dirent-detail.css';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  dirent: PropTypes.object,\n  path: PropTypes.string.isRequired,\n  currentRepoInfo: PropTypes.object.isRequired,\n  onItemDetailsClose: PropTypes.func.isRequired,\n  onFileTagChanged: PropTypes.func.isRequired,\n  direntDetailPanelTab: PropTypes.string,\n};\n\nclass DirentDetail extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      direntType: '',\n      direntDetail: '',\n      fileTagList: [],\n      relatedFiles: [],\n      folderDirent: null,\n      activeTab: 'info',\n      fileParticipantList: [],\n    };\n  }\n\n  componentWillMount() {\n    if (this.props.direntDetailPanelTab) {\n      this.tabItemClick(this.props.direntDetailPanelTab);\n    }\n  }\n\n  componentDidMount() {\n    let { dirent, path, repoID } = this.props;\n    this.loadDirentInfo(dirent, path, repoID);\n  }\n\n  componentWillReceiveProps(nextProps) {\n    let { dirent, path, repoID } = nextProps;\n    if (this.props.dirent !== nextProps.dirent) {\n      this.loadDirentInfo(dirent, path, repoID);\n    }\n    if (this.props.direntDetailPanelTab) {\n      this.tabItemClick(this.props.direntDetailPanelTab);\n    }\n  }\n\n  loadDirentInfo = (dirent, path, repoID) => {\n    if (dirent) {\n      let direntPath = Utils.joinPath(path, dirent.name);\n      this.updateDetailView(dirent, direntPath);\n    } else {\n      let dirPath = Utils.getDirName(path);\n      seafileAPI.listDir(repoID, dirPath).then(res => {\n        let direntList = res.data.dirent_list;\n        let folderDirent = null;\n        for (let i = 0; i < direntList.length; i++) {\n          let dirent = direntList[i];\n          if (dirent.parent_dir + dirent.name === path) {\n            folderDirent = new Dirent(dirent);\n            break;\n          }\n        }\n        this.setState({folderDirent: folderDirent});\n        this.updateDetailView(folderDirent, path);\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    }\n  }\n\n  updateDetailView = (dirent, direntPath) => {\n    let repoID = this.props.repoID;\n    if (dirent.type === 'file') {\n      seafileAPI.getFileInfo(repoID, direntPath).then(res => {\n        this.setState({\n          direntType: 'file',\n          direntDetail: res.data,\n        });\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n      seafileAPI.listFileTags(repoID, direntPath).then(res => {\n        let fileTagList = [];\n        res.data.file_tags.forEach(item => {\n          let file_tag = new FileTag(item);\n          fileTagList.push(file_tag);\n        });\n        this.setState({fileTagList: fileTagList});\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n      seafileAPI.listRelatedFiles(repoID, direntPath).then(res => {\n        let relatedFiles = [];\n        res.data.related_files.map((relatedFile) => {\n          relatedFiles.push(relatedFile);\n        });\n        this.setState({\n          relatedFiles: relatedFiles,\n        });\n      }).catch((error) => {\n        if (error.response.status === 500) {\n          this.setState({\n            relatedFiles: []\n          });\n        }\n      });\n      this.listParticipants(repoID, direntPath);\n    } else {\n      seafileAPI.getDirInfo(repoID, direntPath).then(res => {\n        this.setState({\n          direntType: 'dir',\n          direntDetail: res.data\n        });\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    }\n  }\n\n  listParticipants = (repoID, filePath) => {\n    seafileAPI.listFileParticipants(repoID, filePath).then((res) => {\n      this.setState({ fileParticipantList: res.data.participant_list });\n    });\n  }\n\n  onParticipantsChange = (repoID, filePath) => {\n    this.listParticipants(repoID, filePath);\n  }\n\n  onRelatedFileChange = (dirent, direntPath) => {\n    this.updateDetailView(dirent, direntPath);\n  }\n\n  tabItemClick = (tab) => {\n    if (this.state.activeTab !== tab) {\n      this.setState({ activeTab: tab });\n    }\n  }\n\n  renderNavItem = (showTab) => {\n    switch(showTab) {\n      case 'info':\n        return (\n          <NavItem className=\"nav-item w-50\">\n            <NavLink className={classnames({ active: this.state.activeTab === 'info' })} onClick={() => { this.tabItemClick('info');}}>\n              <i className=\"fas fa-info-circle\"></i>\n            </NavLink>\n          </NavItem>\n        );\n      case 'comments':\n        return (\n          <NavItem className=\"nav-item w-50\">\n            <NavLink className={classnames({ active: this.state.activeTab === 'comments' })} onClick={() => {this.tabItemClick('comments');}}>\n              <i className=\"fa fa-comments\"></i>\n            </NavLink>\n          </NavItem>\n        );\n    }\n  }\n\n  renderHeader = (smallIconUrl, direntName) => {\n    return (\n      <div className=\"detail-header\">\n        <div className=\"detail-control sf2-icon-x1\" onClick={this.props.onItemDetailsClose}></div>\n        <div className=\"detail-title dirent-title\">\n          <img src={smallIconUrl} width=\"24\" height=\"24\" alt=\"\" />{' '}\n          <span className=\"name ellipsis\" title={direntName}>{direntName}</span>\n        </div>\n      </div>\n    );\n  }\n\n  renderDetailBody = (bigIconUrl, folderDirent) => {\n    return (\n      <Fragment>\n        <div className=\"detail-body dirent-info\">\n          <div className=\"img\"><img src={bigIconUrl} className=\"thumbnail\" alt=\"\" /></div>\n          {this.state.direntDetail &&\n            <div className=\"dirent-table-container\">\n              <DetailListView\n                repoInfo={this.props.currentRepoInfo}\n                path={this.props.path}\n                repoID={this.props.repoID}\n                dirent={this.props.dirent || folderDirent}\n                direntType={this.state.direntType}\n                direntDetail={this.state.direntDetail}\n                fileTagList={this.state.fileTagList}\n                relatedFiles={this.state.relatedFiles}\n                onFileTagChanged={this.props.onFileTagChanged}\n                onRelatedFileChange={this.onRelatedFileChange}\n                fileParticipantList={this.state.fileParticipantList}\n                onParticipantsChange={this.onParticipantsChange}\n              />\n            </div>\n          }\n        </div>\n      </Fragment>\n    );\n  }\n\n  render() {\n    let { dirent, repoID, path } = this.props;\n    let { folderDirent } = this.state;\n    if (!dirent && !folderDirent) {\n      return '';\n    }\n    let smallIconUrl = dirent ? Utils.getDirentIcon(dirent) : Utils.getDirentIcon(folderDirent);\n    let bigIconUrl = dirent ? Utils.getDirentIcon(dirent, true) : Utils.getDirentIcon(folderDirent, true);\n    const isImg = dirent ? Utils.imageCheck(dirent.name) : Utils.imageCheck(folderDirent.name);\n    if (isImg) {\n      bigIconUrl = `${siteRoot}thumbnail/${repoID}/1024` + Utils.encodePath(`${path === '/' ? '' : path}/${dirent.name}`);\n    }\n    let direntName = dirent ? dirent.name : folderDirent.name;\n\n    if ((dirent && dirent.type === 'file') || path.lastIndexOf('.') > -1) {\n      return (\n        <div className=\"detail-container\">\n          {this.renderHeader(smallIconUrl, direntName)}\n          <Nav tabs className=\"mx-0\">{this.renderNavItem('info')}{this.renderNavItem('comments')}</Nav>\n          <TabContent activeTab={this.state.activeTab}>\n            <TabPane tabId=\"info\">{this.renderDetailBody(bigIconUrl, folderDirent)}</TabPane>\n            <TabPane tabId=\"comments\" className=\"comments h-100\">\n              <DetailCommentList\n                repoID={this.props.repoID}\n                filePath={(dirent && dirent.type === 'file') ? Utils.joinPath(path, dirent.name) : path}\n                fileParticipantList={this.state.fileParticipantList}\n                onParticipantsChange={this.onParticipantsChange}\n              />\n            </TabPane>\n          </TabContent>\n        </div>\n      );\n    } else {\n      return (\n        <div className=\"detail-container\">\n          {this.renderHeader(smallIconUrl, direntName)}\n          {this.renderDetailBody(bigIconUrl, folderDirent)}\n        </div>\n      );\n    }\n  }\n}\n\nDirentDetail.propTypes = propTypes;\n\nexport default DirentDetail;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport Loading from '../loading';\nimport ModalPortal from '../modal-portal';\nimport CreateFile from '../../components/dialog/create-file-dialog';\n\nimport '../../css/tip-for-new-file.css';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  isDirentListLoading: PropTypes.bool.isRequired,\n  onAddFile: PropTypes.func.isRequired,\n};\n\nclass DirentNodeView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      fileType: '',\n      isCreateFileDialogShow: false,\n    };\n  }\n\n  onCreateNewFile = (type) => {\n    this.setState({\n      fileType: type,\n      isCreateFileDialogShow: !this.state.isCreateFileDialogShow,\n    });\n  }\n\n  onCreateFileToggle = () => {\n    this.setState({\n      fileType: '',\n      isCreateFileDialogShow: !this.state.isCreateFileDialogShow,\n    });\n  }\n\n  checkDuplicatedName = () => {\n    return false; // current repo is null, and unnecessary to check duplicated name\n  }\n\n  onAddFile = (filePath, isDraft) => {\n    this.setState({isCreateFileDialogShow: false});\n    this.props.onAddFile(filePath, isDraft);\n  }\n\n  render() {\n    if (this.props.isDirentListLoading) {\n      return (<Loading />);\n    }\n\n    return (\n      <Fragment>\n        <div className=\"tip-for-new-file text-center\">\n          <p className=\"text-secondary\">{gettext('This folder has no content at this time.')}</p>\n          <p className=\"text-secondary\">{gettext('You can create files quickly')}{' +'}</p>\n          <button className=\"big-new-file-button\" onClick={this.onCreateNewFile.bind(this, '.md')}>\n            {'+ Markdown'}</button>\n          <button className=\"big-new-file-button\" onClick={this.onCreateNewFile.bind(this, '.pptx')}>\n            {'+ PPT'}</button>\n          <br />\n          <button className=\"big-new-file-button\" onClick={this.onCreateNewFile.bind(this, '.docx')}>\n            {'+ Word'}</button>\n          <button className=\"big-new-file-button\" onClick={this.onCreateNewFile.bind(this, '.xlsx')}>\n            {'+ Excel'}</button>\n        </div>\n        {this.state.isCreateFileDialogShow && (\n          <ModalPortal>\n            <CreateFile\n              parentPath={this.props.path}\n              fileType={this.state.fileType}\n              onAddFile={this.onAddFile}\n              addFileCancel={this.onCreateFileToggle}\n              checkDuplicatedName={this.checkDuplicatedName}\n            />\n          </ModalPortal>\n        )}\n      </Fragment>\n    );\n  }\n}\n\nDirentNodeView.propTypes = propTypes;\n\nexport default DirentNodeView;\n","import moment from 'moment';\n\nclass Draft {\n\n  constructor(item) {\n    this.created = item.created_at;\n    this.createdStr = moment((new Date(item.created_at)).getTime()).format('YYYY-MM-DD HH:mm');\n    this.id = item.id;\n    this.ownerNickname = item.owner_nickname;\n    this.originRepoID = item.origin_repo_id;\n    this.draftFilePath = item.draft_file_path;\n  }\n}\n\nexport default Draft;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\nimport { gettext, siteRoot } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport moment from 'moment';\nimport editorUtilities from '../../utils/editor-utilities';\nimport toaster from '../../components/toast';\nimport { Utils } from '../../utils/utils';\nimport Draft from '../../models/draft';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  toggle: PropTypes.func.isRequired,\n};\n\nclass ListRepoDraftsDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      drafts: [],\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.listRepoDrafts(this.props.repoID).then(res => {\n      let drafts = res.data.drafts.map(item => {\n        let draft = new Draft(item);\n        return draft;\n      });\n      this.setState({\n        drafts: drafts\n      });\n    });\n  }\n\n  onDeleteDraftItem = (draft) => {\n    editorUtilities.deleteDraft(draft.id).then(() => {\n      let drafts = this.state.drafts.filter(item => {\n        return item.id !== draft.id;\n      });\n      this.setState({drafts: drafts});\n      let msg = gettext('Successfully deleted draft %(draft)s.');\n      msg = msg.replace('%(draft)s', draft.draftFilePath);\n      toaster.success(msg);\n    }).catch(() => {\n      let msg = gettext('Failed to delete draft %(draft)s.');\n      msg = msg.replace('%(draft)s', draft.draftFilePath);\n      toaster.danger(msg);\n    });\n  }\n\n  toggle = () => {\n    this.props.toggle();\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true}>\n        <ModalHeader toggle={this.toggle}>{gettext('Drafts')}</ModalHeader>\n        <ModalBody className=\"dialog-list-container\">\n          <table>\n            <thead>\n              <tr>\n                <th width='50%' className=\"ellipsis\">{gettext('Name')}</th>\n                <th width='20%'>{gettext('Owner')}</th>\n                <th width='20%'>{gettext('Last Update')}</th>\n                <th width='10%'></th>\n              </tr>\n            </thead>\n            <tbody>\n              {this.state.drafts.map((item, index) => {\n                return (\n                  <DraftItem\n                    key={index}\n                    draftItem={item}\n                    onDeleteDraftItem={this.onDeleteDraftItem}\n                  />\n                );\n              })}\n            </tbody>\n          </table>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Close')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nListRepoDraftsDialog.propTypes = propTypes;\n\nexport default ListRepoDraftsDialog;\n\nconst DraftItemPropTypes = {\n  draftItem: PropTypes.object,\n  onDeleteDraftItem: PropTypes.func.isRequired,\n};\n\nclass DraftItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = ({\n      active: false,\n    });\n  }\n\n  onMouseEnter = () => {\n    this.setState({\n      active: true\n    });\n  }\n\n  onMouseLeave = () => {\n    this.setState({\n      active: false\n    });\n  }\n\n  render() {\n    const draftItem = this.props.draftItem;\n    let href = siteRoot + 'drafts/' + draftItem.id + '/';\n    let className = this.state.active ? 'action-icon sf2-icon-x3' : 'action-icon vh sf2-icon-x3';\n    return (\n      <tr onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave}>\n        <td className=\"name\">\n          <a href={href} target='_blank'>{Utils.getFileName(draftItem.draftFilePath)}</a>\n        </td>\n        <td>{draftItem.ownerNickname}</td>\n        <td>{moment(draftItem.createdStr).fromNow()}</td>\n        <td>\n          <i className={className} onClick={this.props.onDeleteDraftItem.bind(this, draftItem)}></i>\n        </td>\n      </tr>\n    );\n  }\n}\n\nDraftItem.propTypes = DraftItemPropTypes;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\nimport MarkdownViewer from '@seafile/seafile-editor/dist/viewer/markdown-viewer';\nimport Loading from '../../components/loading';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { gettext, mediaUrl } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  filePath: PropTypes.string.isRequired,\n  fileName: PropTypes.string.isRequired,\n  href: PropTypes.string,\n  toggleCancel: PropTypes.func.isRequired,\n};\n\nclass ReadmeDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      readmeContent: null,\n      isLoading: true,\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.getFileDownloadLink(this.props.repoID, this.props.filePath).then(res => {\n      seafileAPI.getFileContent(res.data).then(res => {\n        this.setState({\n          readmeContent: res.data,\n          isLoading: false,\n        });\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true} toggle={this.props.toggleCancel} className=\"readme-dialog\" size=\"lg\">\n        <ModalHeader>{this.props.fileName}\n          <a className=\"readme-dialog-edit\" href={this.props.href} target='_blank'><i className=\"fa fa-pencil-alt\"></i></a>\n        </ModalHeader>\n        <ModalBody>\n          {this.state.isLoading ?\n            <Loading />:\n            <MarkdownViewer\n              markdownContent={this.state.readmeContent}\n              showTOC={false}\n              scriptSource={mediaUrl + 'js/mathjax/tex-svg.js'}\n            />\n          }\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.props.toggleCancel}>{gettext('Close')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nReadmeDialog.propTypes = propTypes;\n\nexport default ReadmeDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport ModalPortal from './modal-portal';\nimport ListTaggedFilesDialog from './dialog/list-taggedfiles-dialog';\nimport ListRepoDraftsDialog from './dialog/list-repo-drafts-dialog';\nimport ReadmeDialog from './dialog/readme-dialog';\nimport { siteRoot, gettext } from '../utils/constants';\nimport { Utils } from '../utils/utils';\n\nimport '../css/repo-info-bar.css';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  currentPath: PropTypes.string.isRequired,\n  usedRepoTags: PropTypes.array.isRequired,\n  readmeMarkdown: PropTypes.object,\n  draftCounts: PropTypes.number,\n  updateUsedRepoTags: PropTypes.func.isRequired,\n  onFileTagChanged: PropTypes.func.isRequired,\n};\n\nclass RepoInfoBar extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      currentTag: null,\n      isListTaggedFileShow: false,\n      showRepoDrafts: false,\n      showReadmeDialog: false,\n    };\n  }\n\n  onListTaggedFiles = (currentTag) => {\n    this.setState({\n      currentTag: currentTag,\n      isListTaggedFileShow: !this.state.isListTaggedFileShow,\n    });\n  }\n\n  onCloseDialog = () => {\n    this.setState({\n      isListTaggedFileShow: false\n    });\n  }\n\n  toggleDrafts = () => {\n    this.setState({\n      showRepoDrafts: !this.state.showRepoDrafts\n    });\n  }\n\n  toggleReadme = () => {\n    this.setState({\n      showReadmeDialog: !this.state.showReadmeDialog\n    });\n  }\n\n  render() {\n    let {repoID, currentPath, usedRepoTags, readmeMarkdown} = this.props;\n    let href = readmeMarkdown !== null ? siteRoot + 'lib/' + repoID + '/file' + Utils.joinPath(currentPath, readmeMarkdown.name) +  '?mode=edit' : '';\n    let filePath = readmeMarkdown !== null ? currentPath + readmeMarkdown.name : '';\n    return (\n      <div className=\"repo-info-bar\">\n        {usedRepoTags.length > 0 && (\n          <ul className=\"used-tag-list\">\n            {usedRepoTags.map((usedRepoTag) => {\n              return (\n                <li key={usedRepoTag.id} className=\"used-tag-item\">\n                  <span className=\"used-tag\" style={{backgroundColor:usedRepoTag.color}}></span>\n                  <span className=\"used-tag-name\" title={usedRepoTag.name}>{usedRepoTag.name}</span>\n                  <span className=\"used-tag-files\" onClick={this.onListTaggedFiles.bind(this, usedRepoTag)}>\n                    {usedRepoTag.fileCount > 1 ? usedRepoTag.fileCount + ' files' : usedRepoTag.fileCount + ' file'}\n                  </span>\n                </li>\n              );\n            })}\n          </ul>\n        )}\n        <div className={(usedRepoTags.length > 0 && readmeMarkdown) ? 'file-info-list mt-1' : 'file-info-list'}>\n          {(readmeMarkdown !== null && parseInt(readmeMarkdown.size) > 1) &&\n            <span className=\"file-info\" onClick={this.toggleReadme}>\n              <span className=\"info-icon sf2-icon-readme\"></span>\n              <span className=\"used-tag-name\">{readmeMarkdown.name}</span>\n            </span>\n          }\n          {(readmeMarkdown !== null && parseInt(readmeMarkdown.size) < 2) &&\n            <span className=\"file-info\">\n              <span className=\"info-icon sf2-icon-readme\"></span>\n              <a className=\"used-tag-name\" href={href} target='_blank'>{readmeMarkdown.name}</a>\n            </span>\n          }\n          {this.props.draftCounts > 0 &&\n            <span className=\"file-info\">\n              <span className=\"info-icon sf2-icon-drafts\"></span>\n              <span className=\"used-tag-name\">{gettext('draft')}</span>\n              <span className=\"used-tag-files\" onClick={this.toggleDrafts}>\n                {this.props.draftCounts > 1 ? this.props.draftCounts + ' files' : this.props.draftCounts + ' file'}\n              </span>\n            </span>\n          }\n        </div>\n        {this.state.isListTaggedFileShow && (\n          <ModalPortal>\n            <ListTaggedFilesDialog\n              repoID={repoID}\n              currentTag={this.state.currentTag}\n              onClose={this.onCloseDialog}\n              toggleCancel={this.onListTaggedFiles}\n              updateUsedRepoTags={this.props.updateUsedRepoTags}\n              onFileTagChanged={this.props.onFileTagChanged}\n            />\n          </ModalPortal>\n        )}\n\n        {this.state.showRepoDrafts && (\n          <ModalPortal>\n            <ListRepoDraftsDialog\n              toggle={this.toggleDrafts}\n              repoID={this.props.repoID}\n            />\n          </ModalPortal>\n        )}\n\n        {this.state.showReadmeDialog && (\n          <ModalPortal>\n            <ReadmeDialog\n              toggleCancel={this.toggleReadme}\n              repoID={repoID}\n              filePath={filePath}\n              href={href}\n              fileName={readmeMarkdown.name}\n            />\n          </ModalPortal>\n        )}\n      </div>\n    );\n  }\n}\n\nRepoInfoBar.propTypes = propTypes;\n\nexport default RepoInfoBar;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport MD5 from 'MD5';\nimport { UncontrolledTooltip } from 'reactstrap';\nimport { Dropdown, DropdownToggle, DropdownItem } from 'reactstrap';\nimport { gettext, siteRoot, mediaUrl, username } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport URLDecorator from '../../utils/url-decorator';\nimport ItemDropdownMenu from '../dropdown-menu/item-dropdown-menu';\nimport Rename from '../rename';\nimport ModalPortal from '../modal-portal';\nimport MoveDirentDialog from '../dialog/move-dirent-dialog';\nimport CopyDirentDialog from '../dialog/copy-dirent-dialog';\nimport ShareDialog from '../dialog/share-dialog';\nimport ZipDownloadDialog from '../dialog/zip-download-dialog';\nimport EditFileTagDialog from '../dialog/edit-filetag-dialog';\nimport LibSubFolderPermissionDialog from '../dialog/lib-sub-folder-permission-dialog';\n\nimport '../../css/dirent-list-item.css';\nimport toaster from '../toast';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  repoID: PropTypes.string.isRequired,\n  isItemFreezed: PropTypes.bool.isRequired,\n  dirent: PropTypes.object.isRequired,\n  onItemClick: PropTypes.func.isRequired,\n  freezeItem: PropTypes.func.isRequired,\n  unfreezeItem: PropTypes.func.isRequired,\n  onItemRenameToggle: PropTypes.func.isRequired,\n  onItemSelected: PropTypes.func.isRequired,\n  onItemDelete: PropTypes.func.isRequired,\n  onItemRename: PropTypes.func.isRequired,\n  onItemMove: PropTypes.func.isRequired,\n  onItemCopy: PropTypes.func.isRequired,\n  onDirentClick: PropTypes.func.isRequired,\n  updateDirent: PropTypes.func.isRequired,\n  showImagePopup: PropTypes.func.isRequired,\n  currentRepoInfo: PropTypes.object,\n  isRepoOwner: PropTypes.bool,\n  isAdmin: PropTypes.bool.isRequired,\n  repoEncrypted: PropTypes.bool.isRequired,\n  isGroupOwnedRepo: PropTypes.bool.isRequired,\n  onItemMouseDown: PropTypes.func.isRequired,\n  onItemContextMenu: PropTypes.func.isRequired,\n  selectedDirentList: PropTypes.array.isRequired,\n  activeDirent: PropTypes.object,\n  getDirentItemMenuList: PropTypes.func.isRequired,\n  onFileTagChanged: PropTypes.func,\n  enableDirPrivateShare: PropTypes.bool.isRequired,\n  showDirentDetail: PropTypes.func.isRequired,\n  onItemsMove: PropTypes.func.isRequired,\n  onShowDirentsDraggablePreview: PropTypes.func,\n};\n\nclass DirentListItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOperationShow: false,\n      highlight: false,\n      isZipDialogOpen: false,\n      isMoveDialogShow: false,\n      isCopyDialogShow: false,\n      isShareDialogShow: false,\n      isMutipleOperation: false,\n      isShowTagTooltip: false,\n      isDragTipShow: false,\n      isDropTipshow: false,\n      isEditFileTagShow: false,\n      isPermissionDialogOpen: false,\n      isOpMenuOpen: false // for mobile\n    };\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (nextProps.isItemFreezed !== this.props.isItemFreezed && !nextProps.isItemFreezed) {\n      this.setState({\n        highlight: false,\n        isOperationShow: false,\n      }, () => {\n        if (nextProps.activeDirent && nextProps.activeDirent.name === nextProps.dirent.name) {\n          this.setState({isOperationShow: true});\n        }\n      });\n    }\n  }\n\n  toggleOpMenu = () => {\n    this.setState({\n      isOpMenuOpen: !this.state.isOpMenuOpen\n    });\n  }\n\n  //UI Interactive\n  onMouseEnter = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        highlight: true,\n        isOperationShow: true,\n      });\n    }\n    this.setState({isDragTipShow: true});\n  }\n\n  onMouseOver = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        highlight: true,\n        isOperationShow: true,\n      });\n    }\n    this.setState({isDragTipShow: true});\n  }\n\n  onMouseLeave = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        highlight: false,\n        isOperationShow: false,\n      });\n    }\n    this.setState({isDragTipShow: false});\n  }\n\n  unfreezeItem = () => {\n    this.setState({\n      highlight: false,\n      isOperationShow: false,\n    });\n    this.props.unfreezeItem();\n  }\n\n  //buiness handler\n  onItemSelected = () => {\n    this.props.onItemSelected(this.props.dirent);\n  }\n\n  onItemStarred = () => {\n    let dirent = this.props.dirent;\n    let repoID = this.props.repoID;\n    let filePath = this.getDirentPath(dirent);\n\n    if (dirent.starred) {\n      seafileAPI.unstarItem(repoID, filePath).then(() => {\n        this.props.updateDirent(this.props.dirent, 'starred', false);\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    } else {\n      seafileAPI.starItem(repoID, filePath).then(() => {\n        this.props.updateDirent(this.props.dirent, 'starred', true);\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    }\n  }\n\n  // on '<tr>'\n  onDirentClick = (e) => {\n    // '<td>' is clicked\n    e.stopPropagation();\n    if (e.target.tagName == 'TD') {\n      this.props.onDirentClick(this.props.dirent);\n    }\n  }\n\n  onItemClick = (e) => {\n    e.preventDefault();\n    const dirent = this.props.dirent;\n    if (this.state.isRenameing) {\n      return;\n    }\n    if (Utils.imageCheck(dirent.name)) {\n      this.props.showImagePopup(dirent);\n    } else {\n      this.props.onItemClick(dirent);\n    }\n  }\n\n  onItemDelete = (e) => {\n    e.nativeEvent.stopImmediatePropagation(); //for document event\n    this.props.onItemDelete(this.props.dirent);\n  }\n\n  onItemShare = (e) => {\n    e.nativeEvent.stopImmediatePropagation(); //for document event\n    this.setState({isShareDialogShow: !this.state.isShareDialogShow});\n  }\n\n  closeSharedDialog = () => {\n    this.setState({isShareDialogShow: !this.state.isShareDialogShow});\n  }\n\n  onMobileMenuItemClick = (e) => {\n    const operation = e.target.getAttribute('data-op');\n    this.onMenuItemClick(operation, e);\n  }\n\n  onMenuItemClick = (operation, event) => {\n    switch(operation) {\n      case 'Download':\n        this.onItemDownload(event);\n        break;\n      case 'Share':\n        this.onItemShare(event);\n        break;\n      case 'Delete':\n        this.onItemDelete(event);\n        break;\n      case 'Rename':\n        this.onItemRenameToggle();\n        break;\n      case 'Move':\n        this.onItemMoveToggle();\n        break;\n      case 'Copy':\n        this.onItemCopyToggle();\n        break;\n      case 'Tags':\n        this.onEditFileTagToggle();\n        break;\n      case 'Permission':\n        this.onPermissionItem();\n        break;\n      case 'Unlock':\n        this.onUnlockItem();\n        break;\n      case 'Lock':\n        this.onLockItem();\n        break;\n      case 'Comment':\n        this.props.onDirentClick(this.props.dirent);\n        this.props.showDirentDetail('comments');\n        break;\n      case 'History':\n        this.onHistory();\n        break;\n      case 'Access Log':\n        this.onAccessLog();\n        break;\n      case 'Open via Client':\n        this.onOpenViaClient();\n        break;\n      default:\n        break;\n    }\n  }\n\n  onEditFileTagToggle = () => {\n    this.setState({\n      isEditFileTagShow: !this.state.isEditFileTagShow\n    });\n  }\n\n  onFileTagChanged = () => {\n    let direntPath = this.getDirentPath(this.props.dirent);\n    this.props.onFileTagChanged(this.props.dirent, direntPath);\n  }\n\n  onItemRenameToggle = () => {\n    this.props.onItemRenameToggle(this.props.dirent);\n    this.setState({\n      isOperationShow: false,\n      isRenameing: true,\n    });\n  }\n\n  onRenameConfirm = (newName) => {\n    this.props.onItemRename(this.props.dirent, newName);\n    this.onRenameCancel();\n  }\n\n  onRenameCancel = () => {\n    this.setState({isRenameing: false});\n    this.unfreezeItem();\n  }\n\n  onItemMoveToggle = () => {\n    this.setState({isMoveDialogShow: !this.state.isMoveDialogShow});\n  }\n\n  onItemCopyToggle = () => {\n    this.setState({isCopyDialogShow: !this.state.isCopyDialogShow});\n  }\n\n  onPermissionItem = () => {\n    this.setState({isPermissionDialogOpen: !this.state.isPermissionDialogOpen});\n  }\n\n  onLockItem = () => {\n    let repoID = this.props.repoID;\n    let filePath = this.getDirentPath(this.props.dirent);\n    seafileAPI.lockfile(repoID, filePath).then(() => {\n      this.props.updateDirent(this.props.dirent, 'is_locked', true);\n      this.props.updateDirent(this.props.dirent, 'locked_by_me', true);\n      let lockName = username.split('@');\n      this.props.updateDirent(this.props.dirent, 'lock_owner_name', lockName[0]);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onUnlockItem = () => {\n    let repoID = this.props.repoID;\n    let filePath = this.getDirentPath(this.props.dirent);\n    seafileAPI.unlockfile(repoID, filePath).then(() => {\n      this.props.updateDirent(this.props.dirent, 'is_locked', false);\n      this.props.updateDirent(this.props.dirent, 'locked_by_me', false);\n      this.props.updateDirent(this.props.dirent, 'lock_owner_name', '');\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onHistory = () => {\n    let repoID = this.props.repoID;\n    let filePath = this.getDirentPath(this.props.dirent);\n    let url = URLDecorator.getUrl({type: 'file_revisions', repoID: repoID, filePath: filePath});\n    location.href = url;\n  }\n\n  onAccessLog = () => {\n    let filePath = this.getDirentPath(this.props.dirent);\n    let path = siteRoot + 'repo/file-access/' + this.props.repoID + '/?p=' + encodeURIComponent(filePath) ;\n    window.open(path);\n  }\n\n  onOpenViaClient = () => {\n    let repoID = this.props.repoID;\n    let filePath = this.getDirentPath(this.props.dirent);\n    let url = URLDecorator.getUrl({type: 'open_via_client', repoID: repoID, filePath: filePath});\n    location.href = url;\n  }\n\n  onItemDownload = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    let dirent = this.props.dirent;\n    let repoID = this.props.repoID;\n    let direntPath = this.getDirentPath(dirent);\n    if (dirent.type === 'dir') {\n      this.setState({\n        isZipDialogOpen: true\n      });\n    } else {\n      let url = URLDecorator.getUrl({type: 'download_file_url', repoID: repoID, filePath: direntPath});\n      location.href = url;\n    }\n  }\n\n  closeZipDialog = () => {\n    this.setState({\n      isZipDialogOpen: false\n    });\n  }\n\n  getDirentPath = (dirent) => {\n    let path = this.props.path;\n    return path === '/' ? path + dirent.name : path + '/' + dirent.name;\n  }\n\n  onTagTooltipToggle = (e) => {\n    e.stopPropagation();\n    this.setState({isShowTagTooltip: !this.state.isShowTagTooltip});\n  }\n\n  onItemMove = (destRepo, dirent, selectedPath, currentPath) => {\n    this.props.onItemMove(destRepo, dirent, selectedPath, currentPath);\n  }\n\n  onItemDragStart = (e) => {\n    if (Utils.isIEBrower()) {\n      return false;\n    }\n    e.dataTransfer.effectAllowed = 'move';\n    let { selectedDirentList } = this.props;\n    if (selectedDirentList.length > 0 && selectedDirentList.includes(this.props.dirent)) { // drag items and selectedDirentList include item\n      this.props.onShowDirentsDraggablePreview();\n      e.dataTransfer.setDragImage(this.refs.empty_content, 0, 0); // Show an empty content\n      let selectedList =  selectedDirentList.map(item => {\n        let nodeRootPath = this.getDirentPath(item);\n        let dragStartItemData = {nodeDirent: item, nodeParentPath: this.props.path, nodeRootPath: nodeRootPath};\n        return dragStartItemData;\n      });\n      selectedList = JSON.stringify(selectedList);\n      e.dataTransfer.setData('applicaiton/drag-item-info', selectedList);\n      return ;\n    }\n\n    if (e.dataTransfer && e.dataTransfer.setDragImage) {\n      e.dataTransfer.setDragImage(this.refs.drag_icon, 15, 15);\n    }\n\n    let nodeRootPath = this.getDirentPath(this.props.dirent);\n    let dragStartItemData = {nodeDirent: this.props.dirent, nodeParentPath: this.props.path, nodeRootPath: nodeRootPath};\n    dragStartItemData = JSON.stringify(dragStartItemData);\n\n    e.dataTransfer.setData('applicaiton/drag-item-info', dragStartItemData);\n  }\n\n  onItemDragEnter = (e) => {\n    if (Utils.isIEBrower()) {\n      return false;\n    }\n    if (this.props.dirent.type === 'dir') {\n      e.stopPropagation();\n      this.setState({isDropTipshow: true});\n    }\n  }\n\n  onItemDragOver = (e) => {\n    if (Utils.isIEBrower()) {\n      return false;\n    }\n    if (e.dataTransfer.dropEffect === 'copy') {\n      return;\n    }\n    e.preventDefault();\n    e.dataTransfer.dropEffect = 'move';\n  }\n\n  onItemDragLeave = (e) => {\n    if (Utils.isIEBrower()) {\n      return false;\n    }\n\n    if (this.props.dirent.type === 'dir') {\n      e.stopPropagation();\n    }\n    this.setState({isDropTipshow: false});\n  }\n\n  onItemDragDrop = (e) => {\n    if (Utils.isIEBrower()) {\n      return false;\n    }\n    this.setState({isDropTipshow: false});\n    if (e.dataTransfer.files.length) { // uploaded files\n      return;\n    }\n    if (this.props.dirent.type === 'dir') {\n      e.stopPropagation();\n    } else {\n      return;\n    }\n    let dragStartItemData = e.dataTransfer.getData('applicaiton/drag-item-info');\n    dragStartItemData = JSON.parse(dragStartItemData);\n    if (Array.isArray(dragStartItemData)) { //move items\n      let direntPaths =  dragStartItemData.map(draggedItem => {\n        return draggedItem.nodeRootPath;\n      });\n\n      let selectedPath = Utils.joinPath(this.props.path, this.props.dirent.name);\n\n      if (direntPaths.some(direntPath => { return direntPath === selectedPath;})) { //eg; A/B, A/C --> A/B\n        return;\n      }\n\n      this.props.onItemsMove(this.props.currentRepoInfo, selectedPath);\n      return ;\n    }\n\n    let { nodeDirent, nodeParentPath, nodeRootPath } = dragStartItemData;\n    let dropItemData = this.props.dirent;\n\n    if (nodeDirent.name === dropItemData.name) {\n      return;\n    }\n\n    //  copy the dirent to it's child. eg: A/B -> A/B/C\n    if (dropItemData.type === 'dir' && nodeDirent.type === 'dir') {\n      if (nodeParentPath !== this.props.path) {\n        if (this.props.path.indexOf(nodeRootPath) !== -1) {\n          return;\n        }\n      }\n    }\n\n    let selectedPath = Utils.joinPath(this.props.path, this.props.dirent.name);\n    this.onItemMove(this.props.currentRepoInfo, nodeDirent, selectedPath, nodeParentPath);\n  }\n\n  onItemMouseDown = (event) => {\n    this.props.onItemMouseDown(event);\n  }\n\n  onItemContextMenu = (event) => {\n    let dirent = this.props.dirent;\n    this.props.onItemContextMenu(event, dirent);\n  }\n\n  renderItemOperation = () => {\n    let { dirent, currentRepoInfo, selectedDirentList } = this.props;\n\n    // https://dev.seafile.com/seahub/lib/d6f300e7-bb2b-4722-b83e-cf45e370bfbc/file/seaf-server%20%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1/%E6%9D%83%E9%99%90%E7%9B%B8%E5%85%B3/%E8%B5%84%E6%96%99%E5%BA%93%E6%9D%83%E9%99%90%E8%A7%84%E8%8C%83.md\n    let showShareBtn = Utils.isHasPermissionToShare(currentRepoInfo, dirent.permission, dirent);\n\n    return (\n      <Fragment>\n        {selectedDirentList.length > 1 ?\n          <Fragment>\n            {this.state.isOperationShow && !dirent.isSelected &&\n              <div className=\"operations\">\n                <ul className=\"operation-group\">\n                  {(dirent.permission === 'rw' || dirent.permission === 'r') && (\n                    <li className=\"operation-group-item\">\n                      <i className=\"op-icon sf2-icon-download\" title={gettext('Download')} onClick={this.onItemDownload}></i>\n                    </li>\n                  )}\n                  {showShareBtn && (\n                    <li className=\"operation-group-item\">\n                      <i className=\"op-icon sf2-icon-share\" title={gettext('Share')} onClick={this.onItemShare}></i>\n                    </li>\n                  )}\n                  {dirent.permission === 'rw' && (\n                    <li className=\"operation-group-item\">\n                      <i className=\"op-icon sf2-icon-delete\" title={gettext('Delete')} onClick={this.onItemDelete}></i>\n                    </li>\n                  )}\n                  <li className=\"operation-group-item\">\n                    <ItemDropdownMenu\n                      item={this.props.dirent}\n                      toggleClass={'sf2-icon-caret-down'}\n                      isHandleContextMenuEvent={true}\n                      getMenuList={this.props.getDirentItemMenuList}\n                      onMenuItemClick={this.onMenuItemClick}\n                      unfreezeItem={this.unfreezeItem}\n                      freezeItem={this.props.freezeItem}\n                    />\n                  </li>\n                </ul>\n              </div>\n            }\n          </Fragment> :\n          <Fragment>\n            {this.state.isOperationShow &&\n              <div className=\"operations\">\n                <ul className=\"operation-group\">\n                  {(dirent.permission === 'rw' || dirent.permission === 'r') && (\n                    <li className=\"operation-group-item\">\n                      <i className=\"op-icon sf2-icon-download\" title={gettext('Download')} onClick={this.onItemDownload}></i>\n                    </li>\n                  )}\n                  {showShareBtn && (\n                    <li className=\"operation-group-item\">\n                      <i className=\"op-icon sf2-icon-share\" title={gettext('Share')} onClick={this.onItemShare}></i>\n                    </li>\n                  )}\n                  {dirent.permission === 'rw' && (\n                    <li className=\"operation-group-item\">\n                      <i className=\"op-icon sf2-icon-delete\" title={gettext('Delete')} onClick={this.onItemDelete}></i>\n                    </li>\n                  )}\n                  <li className=\"operation-group-item\">\n                    <ItemDropdownMenu\n                      item={this.props.dirent}\n                      toggleClass={'sf2-icon-caret-down'}\n                      isHandleContextMenuEvent={true}\n                      getMenuList={this.props.getDirentItemMenuList}\n                      onMenuItemClick={this.onMenuItemClick}\n                      unfreezeItem={this.unfreezeItem}\n                      freezeItem={this.props.freezeItem}\n                    />\n                  </li>\n                </ul>\n              </div>\n            }\n          </Fragment>\n        }\n      </Fragment>\n    );\n  }\n\n  render() {\n    let { path, dirent, activeDirent } = this.props;\n    let direntPath = Utils.joinPath(path, dirent.name);\n    let dirHref = '';\n    if (this.props.currentRepoInfo) {\n      dirHref = siteRoot + 'library/' + this.props.repoID + '/' + this.props.currentRepoInfo.repo_name + Utils.encodePath(direntPath);\n    }\n    let fileHref = siteRoot + 'lib/' + this.props.repoID + '/file' + Utils.encodePath(direntPath);\n\n    let toolTipID = '';\n    let tagTitle = '';\n    if (dirent.file_tags && dirent.file_tags.length > 0) {\n      toolTipID = MD5(dirent.name).slice(0, 7);\n      tagTitle = dirent.file_tags.map(item => item.name).join(' ');\n    }\n\n    let iconUrl = Utils.getDirentIcon(dirent);\n\n    let trClass = this.state.highlight ? 'tr-highlight ' : '';\n    trClass += this.state.isDropTipshow ? 'tr-drop-effect' : '';\n    trClass += (activeDirent && activeDirent.name === dirent.name)  ? 'tr-active' : '';\n    trClass += dirent.isSelected? 'tr-active' : '';\n\n    let lockedInfo = gettext('locked by {name}').replace('{name}', dirent.lock_owner_name);\n\n    const isDesktop = Utils.isDesktop();\n    const desktopItem = (\n      <tr\n        className={trClass}\n        draggable=\"true\"\n        onMouseEnter={this.onMouseEnter}\n        onMouseOver={this.onMouseOver}\n        onMouseLeave={this.onMouseLeave}\n        onClick={this.onDirentClick}\n        onDragStart={this.onItemDragStart}\n        onDragEnter={this.onItemDragEnter}\n        onDragOver={this.onItemDragOver}\n        onDragLeave={this.onItemDragLeave}\n        onDrop={this.onItemDragDrop}\n        onMouseDown={this.onItemMouseDown}\n        onContextMenu={this.onItemContextMenu}\n      >\n        <td className={`pl10 ${this.state.isDragTipShow ? 'tr-drag-effect' : ''}`}>\n          <input type=\"checkbox\" className=\"vam\" onChange={this.onItemSelected} checked={dirent.isSelected}/>\n        </td>\n        <td className=\"pl10\">\n          {dirent.starred !== undefined && !dirent.starred && <i className=\"far fa-star star-empty cursor-pointer\" onClick={this.onItemStarred}></i>}\n          {dirent.starred !== undefined && dirent.starred && <i className=\"fas fa-star cursor-pointer\" onClick={this.onItemStarred}></i>}\n        </td>\n        <td className=\"pl10\">\n          <div className=\"dir-icon\">\n            {dirent.encoded_thumbnail_src ?\n              <img ref='drag_icon' src={`${siteRoot}${dirent.encoded_thumbnail_src}`} className=\"thumbnail cursor-pointer\" onClick={this.onItemClick} alt=\"\" /> :\n              <img ref='drag_icon' src={iconUrl} width=\"24\" alt='' />\n            }\n            {dirent.is_locked && <img className=\"locked\" src={mediaUrl + 'img/file-locked-32.png'} alt={gettext('locked')} title={lockedInfo}/>}\n            <div ref=\"empty_content\" style={{position: 'absolute', width: '1px', height: '1px'}}></div>\n          </div>\n        </td>\n        <td className=\"name\">\n          {this.state.isRenameing ?\n            <Rename hasSuffix={dirent.type !== 'dir'} name={dirent.name} onRenameConfirm={this.onRenameConfirm} onRenameCancel={this.onRenameCancel} /> :\n            <a href={dirent.type === 'dir' ? dirHref : fileHref} onClick={this.onItemClick}>{dirent.name}</a>\n          }\n        </td>\n        <td className=\"tag-list-title\">\n          {(dirent.type !== 'dir' && dirent.file_tags && dirent.file_tags.length > 0) && (\n            <Fragment>\n              <div id={`tag-list-title-${toolTipID}`} className=\"dirent-item tag-list tag-list-stacked\">\n                {dirent.file_tags.map((fileTag, index) => {\n                  let length = dirent.file_tags.length;\n                  return (\n                    <span className=\"file-tag\" key={fileTag.id} style={{zIndex:length - index, backgroundColor:fileTag.color}}></span>\n                  );\n                })}\n              </div>\n              <UncontrolledTooltip target={`tag-list-title-${toolTipID}`} placement=\"bottom\">\n                {tagTitle}\n              </UncontrolledTooltip>\n            </Fragment>\n          )}\n        </td>\n        <td className=\"operation\">{this.renderItemOperation()}</td>\n        <td className=\"file-size\">{dirent.size && dirent.size}</td>\n        <td className=\"last-update\">{dirent.mtime_relative}</td>\n      </tr>\n    );\n    const mobileItem = (\n      <tr>\n        <td onClick={this.onItemClick}>\n          <div className=\"dir-icon\">\n            {dirent.encoded_thumbnail_src ?\n              <img src={`${siteRoot}${dirent.encoded_thumbnail_src}`} className=\"thumbnail cursor-pointer\" alt=\"\" /> :\n              <img src={iconUrl} width=\"24\" alt=\"\" />\n            }\n            {dirent.is_locked && <img className=\"locked\" src={mediaUrl + 'img/file-locked-32.png'} alt={gettext('locked')} title={lockedInfo}/>}\n          </div>\n        </td>\n        <td onClick={this.onItemClick}>\n          {this.state.isRenameing ?\n            <Rename hasSuffix={dirent.type !== 'dir'} name={dirent.name} onRenameConfirm={this.onRenameConfirm} onRenameCancel={this.onRenameCancel} /> :\n            <a href={dirent.type === 'dir' ? dirHref : fileHref}>{dirent.name}</a>\n          }\n          <br />\n          {dirent.size && <span className=\"item-meta-info\">{dirent.size}</span>}\n          <span className=\"item-meta-info\">{dirent.mtime_relative}</span>\n        </td>\n        <td>\n          <Dropdown isOpen={this.state.isOpMenuOpen} toggle={this.toggleOpMenu}>\n            <DropdownToggle\n              tag=\"i\"\n              className=\"sf-dropdown-toggle fa fa-ellipsis-v ml-0\"\n              title={gettext('More Operations')}\n              data-toggle=\"dropdown\"\n              aria-expanded={this.state.isOpMenuOpen}\n            />\n            <div className={this.state.isOpMenuOpen ? '' : 'd-none'} onClick={this.toggleOpMenu}>\n              <div className=\"mobile-operation-menu-bg-layer\"></div>\n              <div className=\"mobile-operation-menu\">\n                {dirent.starred !== undefined &&\n                <DropdownItem className=\"mobile-menu-item\" onClick={this.onItemStarred}>{dirent.starred ? gettext('Unstar') : gettext('Star')}</DropdownItem>}\n                {this.props.getDirentItemMenuList(dirent, true).map((item, index) => {\n                  if (item != 'Divider' && item.key != 'Open via Client') {\n                    return (\n                      <DropdownItem className=\"mobile-menu-item\" key={index} data-op={item.key} onClick={this.onMobileMenuItemClick}>{item.value}</DropdownItem>\n                    );\n                  }\n                })}\n              </div>\n            </div>\n          </Dropdown>\n        </td>\n      </tr>\n    );\n\n    return (\n      <Fragment>\n        {isDesktop ? desktopItem : mobileItem}\n        {this.state.isMoveDialogShow &&\n          <ModalPortal>\n            <MoveDirentDialog\n              path={this.props.path}\n              repoID={this.props.repoID}\n              dirent={this.props.dirent}\n              isMutipleOperation={this.state.isMutipleOperation}\n              onItemMove={this.props.onItemMove}\n              onCancelMove={this.onItemMoveToggle}\n              repoEncrypted={this.props.repoEncrypted}\n            />\n          </ModalPortal>\n        }\n        {this.state.isCopyDialogShow &&\n          <ModalPortal>\n            <CopyDirentDialog\n              path={this.props.path}\n              repoID={this.props.repoID}\n              dirent={this.props.dirent}\n              isMutipleOperation={this.state.isMutipleOperation}\n              onItemCopy={this.props.onItemCopy}\n              onCancelCopy={this.onItemCopyToggle}\n              repoEncrypted={this.props.repoEncrypted}\n            />\n          </ModalPortal>\n        }\n        {this.state.isEditFileTagShow &&\n          <EditFileTagDialog\n            repoID={this.props.repoID}\n            fileTagList={dirent.file_tags}\n            filePath={direntPath}\n            toggleCancel={this.onEditFileTagToggle}\n            onFileTagChanged={this.onFileTagChanged}\n          />\n        }\n        {this.state.isZipDialogOpen &&\n          <ModalPortal>\n            <ZipDownloadDialog\n              repoID={this.props.repoID}\n              path={this.props.path}\n              target={this.props.dirent.name}\n              toggleDialog={this.closeZipDialog}\n            />\n          </ModalPortal>\n        }\n        {this.state.isShareDialogShow &&\n          <ModalPortal>\n            <ShareDialog\n              itemType={dirent.type}\n              itemName={dirent.name}\n              itemPath={direntPath}\n              userPerm={dirent.permission}\n              repoID={this.props.repoID}\n              repoEncrypted={this.props.repoEncrypted}\n              enableDirPrivateShare={this.props.enableDirPrivateShare}\n              isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n              toggleDialog={this.closeSharedDialog}\n            />\n          </ModalPortal>\n        }\n        {this.state.isPermissionDialogOpen &&\n          <ModalPortal>\n            <LibSubFolderPermissionDialog\n              toggleDialog={this.onPermissionItem}\n              repoID={this.props.repoID}\n              folderPath={direntPath}\n              folderName={dirent.name}\n              isDepartmentRepo={this.props.isGroupOwnedRepo}\n            />\n          </ModalPortal>\n        }\n      </Fragment>\n    );\n  }\n}\n\nDirentListItem.propTypes = propTypes;\n\nexport default DirentListItem;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { siteRoot } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  selectedDirentList: PropTypes.array,\n  onHideDirentsDraggablePreview: PropTypes.func\n};\n\nclass DirentsDraggedPreview extends React.Component {\n\n  componentDidMount() {\n    document.addEventListener('dragover', this.handleDragOver);\n    document.addEventListener('drop', this.handleDrop);\n    document.addEventListener('dragend', this.handleDragEnd);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('dragover', this.handleDragOver);\n    document.removeEventListener('drop', this.handleDrop);\n    document.removeEventListener('dragend', this.handleDragEnd);\n  }\n\n  handleDragEnd = () => {\n    this.element.style.opacity = 0;\n    this.props.onHideDirentsDraggablePreview();\n  }\n\n  handleDragOver = (event) => {\n    if (Utils.isIEBrower()) {\n      return false;\n    }\n    event.preventDefault();\n    event.dataTransfer.dropEffect = 'move';\n\n    this.element.style.top = event.clientY + 'px';\n    this.element.style.left = event.clientX + 'px';\n  }\n\n  handleDrop = (event) => {\n    this.element.style.opacity = 0;\n    this.props.onHideDirentsDraggablePreview();\n  }\n\n  render() {\n    let{ selectedDirentList } = this.props;\n    const inlineStyle = {\n      position: 'absolute',\n      opacity: 1,\n      pointerEvents: 'none',\n      display: 'block',\n      left: '-9999px',\n      top: '-9999px',\n      zIndex: 101,\n      maxHeight: document.documentElement.clientHeight,\n      overflow: 'hidden'\n    };\n    return (\n      <div style={inlineStyle} ref={element => this.element = element}>\n        {selectedDirentList.map((dirent, index) => {\n          let iconUrl = Utils.getDirentIcon(dirent);\n          return (\n            <div key={index}>\n              {dirent.encoded_thumbnail_src ?\n                <img src={`${siteRoot}${dirent.encoded_thumbnail_src}`} className=\"thumbnail cursor-pointer\" alt=\"\" /> :\n                <img src={iconUrl} width=\"24\" alt='' />\n              }\n            </div>\n          );\n        })}\n      </div>\n    );\n  }\n}\n\nDirentsDraggedPreview.propTypes = propTypes;\n\nexport default DirentsDraggedPreview;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { siteRoot, gettext, thumbnailSizeForOriginal, username, isPro, enableFileComment, fileAuditEnabled, folderPermEnabled, canGenerateShareLink } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport TextTranslation from '../../utils/text-translation';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport URLDecorator from '../../utils/url-decorator';\nimport Loading from '../loading';\nimport toaster from '../toast';\nimport ModalPortal from '../modal-portal';\nimport CreateFile from '../dialog/create-file-dialog';\nimport CreateFolder from '../dialog/create-folder-dialog';\nimport ImageDialog from '../dialog/image-dialog';\nimport ZipDownloadDialog from '../dialog/zip-download-dialog';\nimport MoveDirentDialog from '../dialog/move-dirent-dialog';\nimport CopyDirentDialog from '../dialog/copy-dirent-dialog';\nimport DirentListItem from './dirent-list-item';\nimport ContextMenu from '../context-menu/context-menu';\nimport { hideMenu, showMenu } from '../context-menu/actions';\nimport DirentsDraggedPreview from '../draggable/dirents-dragged-preview';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  repoID: PropTypes.string.isRequired,\n  currentRepoInfo: PropTypes.object,\n  isAllItemSelected: PropTypes.bool.isRequired,\n  isDirentListLoading: PropTypes.bool.isRequired,\n  direntList: PropTypes.array.isRequired,\n  sortBy: PropTypes.string.isRequired,\n  sortOrder: PropTypes.string.isRequired,\n  sortItems: PropTypes.func.isRequired,\n  onAddFile: PropTypes.func.isRequired,\n  onAddFolder: PropTypes.func.isRequired,\n  onItemDelete: PropTypes.func.isRequired,\n  onAllItemSelected: PropTypes.func.isRequired,\n  onItemSelected: PropTypes.func.isRequired,\n  onItemRename: PropTypes.func.isRequired,\n  onItemClick: PropTypes.func.isRequired,\n  onItemMove: PropTypes.func.isRequired,\n  onItemCopy: PropTypes.func.isRequired,\n  onDirentClick: PropTypes.func.isRequired,\n  updateDirent: PropTypes.func.isRequired,\n  selectedDirentList: PropTypes.array.isRequired,\n  onItemsMove: PropTypes.func.isRequired,\n  onItemsCopy: PropTypes.func.isRequired,\n  onItemsDelete: PropTypes.func.isRequired,\n  onFileTagChanged: PropTypes.func,\n  enableDirPrivateShare: PropTypes.bool.isRequired,\n  isGroupOwnedRepo: PropTypes.bool.isRequired,\n  userPerm: PropTypes.string,\n  showDirentDetail: PropTypes.func.isRequired,\n};\n\nclass DirentListView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isItemFreezed: false,\n      isImagePopupOpen: false,\n      imageItems: [],\n      imageIndex: 0,\n      fileType: '',\n      isCreateFileDialogShow: false,\n      isCreateFolderDialogShow: false,\n      isMoveDialogShow: false,\n      isCopyDialogShow: false,\n      isProgressDialogShow: false,\n      downloadItems: [],\n      isMutipleOperation: true,\n      activeDirent: null,\n      isListDropTipShow: false,\n      isShowDirentsDraggablePreview: false,\n    };\n\n    this.enteredCounter = 0; // Determine whether to enter the child element to avoid dragging bubbling bugs。\n    this.isRepoOwner = props.currentRepoInfo.owner_email === username;\n    this.isAdmin = props.currentRepoInfo.is_admin;\n    this.repoEncrypted = props.currentRepoInfo.encrypted;\n\n    this.clickedDirent = null;\n    this.direntItems = [];\n    this.currentItemRef = null;\n\n    this.zipToken = null;\n  }\n\n  freezeItem = () => {\n    this.setState({isItemFreezed: true});\n  }\n\n  unfreezeItem = () => {\n    this.setState({isItemFreezed: false});\n  }\n\n  onItemRename = (dirent, newName) => {\n    let isDuplicated = this.props.direntList.some(item => {\n      return item.name === newName;\n    });\n    if (isDuplicated) {\n      let errMessage = gettext('The name \"{name}\" is already taken. Please choose a different name.');\n      errMessage = errMessage.replace('{name}', Utils.HTMLescape(newName));\n      toaster.danger(errMessage);\n      return false;\n    }\n    this.props.onItemRename(dirent, newName);\n  }\n\n  onItemRenameToggle = () => {\n    this.freezeItem();\n  }\n\n  onItemSelected = (dirent) => {\n    this.setState({activeDirent: null});\n    this.props.onItemSelected(dirent);\n  }\n\n  onDirentClick = (dirent) => {\n    if (this.props.selectedDirentList.length > 0 && !this.state.activeDirent ) {\n      return;\n    }\n    this.setState({activeDirent: dirent});\n    this.props.onDirentClick(dirent);\n  }\n\n  sortByName = (e) => {\n    e.preventDefault();\n    const sortBy = 'name';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortItems(sortBy, sortOrder);\n  }\n\n  sortByTime = (e) => {\n    e.preventDefault();\n    const sortBy = 'time';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortItems(sortBy, sortOrder);\n  }\n\n  sortBySize = (e) => {\n    e.preventDefault();\n    const sortBy = 'size';\n    const sortOrder = this.props.sortOrder == 'asc' ? 'desc' : 'asc';\n    this.props.sortItems(sortBy, sortOrder);\n  }\n\n  // for image popup\n  prepareImageItem = (item) => {\n    const useThumbnail = !this.repoEncrypted;\n    const name = item.name;\n\n    const fileExt = name.substr(name.lastIndexOf('.') + 1).toLowerCase();\n    const isGIF = fileExt == 'gif';\n\n    const path = Utils.encodePath(Utils.joinPath(this.props.path, name));\n    const repoID = this.props.repoID;\n    let src;\n    if (useThumbnail && !isGIF) {\n      src = `${siteRoot}thumbnail/${repoID}/${thumbnailSizeForOriginal}${path}`;\n    } else {\n      src = `${siteRoot}repo/${repoID}/raw${path}`;\n    }\n\n    return {\n      'name': name,\n      'url': `${siteRoot}lib/${repoID}/file${path}`,\n      'src': src\n    };\n  }\n\n  showImagePopup = (curItem) => {\n    let items = this.props.direntList.filter((item) => {\n      return Utils.imageCheck(item.name);\n    });\n\n    const imageItems = items.map((item) => {\n      return this.prepareImageItem(item);\n    });\n\n    this.setState({\n      isImagePopupOpen: true,\n      imageItems: imageItems,\n      imageIndex: items.indexOf(curItem)\n    });\n  }\n\n  moveToPrevImage = () => {\n    const imageItemsLength = this.state.imageItems.length;\n    this.setState((prevState) => ({\n      imageIndex: (prevState.imageIndex + imageItemsLength - 1) % imageItemsLength\n    }));\n  }\n\n  moveToNextImage = () => {\n    const imageItemsLength = this.state.imageItems.length;\n    this.setState((prevState) => ({\n      imageIndex: (prevState.imageIndex + 1) % imageItemsLength\n    }));\n  }\n\n  closeImagePopup = () => {\n    this.setState({isImagePopupOpen: false});\n  }\n\n  onCreateFileToggle = () => {\n    this.setState({isCreateFileDialogShow: !this.state.isCreateFileDialogShow});\n  }\n\n  onCreateFolderToggle = () => {\n    this.setState({isCreateFolderDialogShow: !this.state.isCreateFolderDialogShow});\n  }\n\n  onAddFile = (filePath, isDraft) => {\n    this.setState({isCreateFileDialogShow: false});\n    this.props.onAddFile(filePath, isDraft);\n  }\n\n  onAddFolder = (dirPath) => {\n    this.setState({isCreateFolderDialogShow: false});\n    this.props.onAddFolder(dirPath);\n  }\n\n  checkDuplicatedName = (newName) => {\n    let direntList = this.props.direntList;\n    let isDuplicated = direntList.some(object => {\n      return object.name === newName;\n    });\n    return isDuplicated;\n  }\n\n  onMoveToggle = () => {\n    this.setState({isMoveDialogShow: !this.state.isMoveDialogShow});\n  }\n\n  onCopyToggle = () => {\n    this.setState({isCopyDialogShow: !this.state.isCopyDialogShow});\n  }\n\n  onItemsDownload = () => {\n    let { path, repoID, selectedDirentList } = this.props;\n    if (selectedDirentList.length) {\n      if (selectedDirentList.length === 1 && !selectedDirentList[0].isDir()) {\n        let direntPath = Utils.joinPath(path, selectedDirentList[0].name);\n        let url = URLDecorator.getUrl({type: 'download_file_url', repoID: repoID, filePath: direntPath});\n        location.href= url;\n        return;\n      }\n\n      let selectedDirentNames = selectedDirentList.map(dirent => {\n        return dirent.name;\n      });\n\n      this.setState({\n        isProgressDialogShow: true,\n        downloadItems: selectedDirentNames\n      });\n    }\n  }\n\n  onCloseZipDownloadDialog = () => {\n    this.setState({isProgressDialogShow: false});\n  }\n\n  // common contextmenu handle\n  onMouseDown = (event) => {\n    event.stopPropagation();\n    if (event.button === 2) {\n      return;\n    }\n  }\n\n  handleContextClick = (event, id, menuList, currentObject = null) => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    let x = event.clientX || (event.touches && event.touches[0].pageX);\n    let y = event.clientY || (event.touches && event.touches[0].pageY);\n\n    if (this.props.posX) {\n      x -= this.props.posX;\n    }\n    if (this.props.posY) {\n      y -= this.props.posY;\n    }\n\n    hideMenu();\n\n    let showMenuConfig = {\n      id: id,\n      position: { x, y },\n      target: event.target,\n      currentObject: currentObject,\n      menuList: menuList,\n    };\n\n    if (menuList.length === 0) {\n      return;\n    }\n\n    showMenu(showMenuConfig);\n  }\n\n  // table-container contextmenu handle\n  onContainerClick = () => {\n    if (this.state.activeDirent) {\n      this.onDirentClick(null);\n    }\n  }\n\n  onContainerMouseDown = (event) => {\n    this.onMouseDown(event);\n  }\n\n  onContainerContextMenu = (event) => {\n    event.preventDefault();\n    // Display menu items based on the permissions of the current path\n    let permission = this.props.userPerm;\n    if (permission !== 'admin' && permission !== 'rw') {\n      return;\n    }\n\n    if (this.props.selectedDirentList.length === 0) {\n      let id = 'dirent-container-menu';\n      let menuList = [TextTranslation.NEW_FOLDER, TextTranslation.NEW_FILE];\n      this.handleContextClick(event, id, menuList);\n    } else {\n      if (this.props.selectedDirentList.length === 1) {\n        if (!this.state.activeDirent) {\n          let id = 'dirent-item-menu';\n          let dirent = this.props.selectedDirentList[0];\n          let menuList = this.getDirentItemMenuList(dirent, true);\n          this.handleContextClick(event, id, menuList, dirent);\n        } else {\n          this.onDirentClick(null);\n          event.preventDefault();\n          event.persist();\n          setTimeout(() => {\n            let id = 'dirent-container-menu';\n            let menuList = [TextTranslation.NEW_FOLDER, TextTranslation.NEW_FILE];\n            this.handleContextClick(event, id, menuList);\n          }, 0);\n        }\n      } else {\n        let id = 'dirents-menu';\n        let menuList = [TextTranslation.MOVE, TextTranslation.COPY, TextTranslation.DOWNLOAD, TextTranslation.DELETE];\n        this.handleContextClick(event, id, menuList);\n      }\n    }\n  }\n\n  onContainerMenuItemClick = (operation) => {\n    switch(operation) {\n      case 'New Folder':\n        this.onCreateFolderToggle();\n        break;\n      case 'New File':\n        this.onCreateFileToggle();\n        break;\n      default:\n        break;\n    }\n\n    hideMenu();\n  }\n\n  onDirentsMenuItemClick = (operation) => {\n    switch(operation) {\n      case 'Move':\n        this.onMoveToggle();\n        break;\n      case 'Copy':\n        this.onCopyToggle();\n        break;\n      case 'Download':\n        this.onItemsDownload();\n        break;\n      case 'Delete':\n        this.props.onItemsDelete();\n        break;\n      default:\n        break;\n    }\n\n    hideMenu();\n  }\n\n  // table-thread contextmenu handle -- Shield event\n  onThreadMouseDown = (event) => {\n    this.onMouseDown(event);\n  }\n\n  onThreadContextMenu = (event) => {\n    event.stopPropagation();\n  }\n\n  // table-dirent-item contextmenu handle\n  onItemMouseDown = (event) => {\n    this.onMouseDown(event);\n  }\n\n  onItemContextMenu = (event, dirent) => {\n    // Display menu items according to the current dirent permission\n    if (this.props.selectedDirentList.length > 1) {\n      return;\n    }\n    this.onDirentClick(dirent);\n    let id = 'dirent-item-menu';\n    let menuList = this.getDirentItemMenuList(dirent, true);\n    this.handleContextClick(event, id, menuList, dirent);\n  }\n\n  setDirentItemRef = (index) => item => {\n    this.direntItems[index] = item;\n  }\n\n  onMenuItemClick = (operation, currentObject, event) => {\n    let index = this.getDirentIndex(currentObject);\n    this.direntItems[index].onMenuItemClick(operation, event);\n\n    hideMenu();\n  }\n\n  onShowMenu = (e) => {\n    this.freezeItem();\n  }\n\n  onHideMenu = (e) => {\n    this.unfreezeItem();\n  }\n\n  // contextmenu utils\n  getDirentIndex = (dirent) => {\n    let direntList = this.props.direntList;\n    let index = 0;\n    for (let i = 0; i < direntList.length; i++) {\n      if (direntList[i].name === dirent.name) {\n        index = i;\n        break;\n      }\n    }\n    return index;\n  }\n\n  getDirentItemMenuList = (dirent, isContextmenu) => {\n    const isRepoOwner = this.isRepoOwner;\n    const currentRepoInfo = this.props.currentRepoInfo;\n    return Utils.getDirentOperationList(isRepoOwner, currentRepoInfo, dirent, isContextmenu);\n  }\n\n  onTableDragEnter = (e) => {\n    if (Utils.isIEBrower()) {\n      return false;\n    }\n    this.enteredCounter++;\n    if (this.enteredCounter !== 0) {\n      if (this.state.isListDropTipShow) {\n        return ;\n      }\n      this.setState({isListDropTipShow: true});\n    }\n  }\n\n  onTableDragOver = (e) => {\n    if (Utils.isIEBrower()) {\n      return false;\n    }\n    if (e.dataTransfer.dropEffect === 'copy') {\n      return;\n    }\n    e.preventDefault();\n    e.dataTransfer.dropEffect = 'move';\n  }\n\n  onTableDragLeave = (e) => {\n    if (Utils.isIEBrower()) {\n      return false;\n    }\n    this.enteredCounter--;\n    if (this.enteredCounter === 0) {\n      this.setState({isListDropTipShow: false});\n    }\n  }\n\n  tableDrop = (e) => {\n    if (Utils.isIEBrower()) {\n      return false;\n    }\n    e.persist();\n    this.enteredCounter = 0;\n    this.setState({isListDropTipShow: false});\n    if (e.dataTransfer.files.length) { // uploaded files\n      return;\n    }\n    let dragStartItemData = e.dataTransfer.getData('applicaiton/drag-item-info');\n    dragStartItemData = JSON.parse(dragStartItemData);\n\n    let {nodeDirent, nodeParentPath, nodeRootPath} = dragStartItemData;\n\n    if (Array.isArray(dragStartItemData)) { //selected items\n      return;\n    }\n\n    if (nodeRootPath === this.props.path || nodeParentPath === this.props.path) {\n      return;\n    }\n\n    if (this.props.path.indexOf(nodeRootPath) !== -1) {\n      return;\n    }\n\n    this.props.onItemMove(this.props.currentRepoInfo, nodeDirent, this.props.path, nodeParentPath);\n  }\n\n  onShowDirentsDraggablePreview = () => {\n    this.setState({\n      isShowDirentsDraggablePreview: true,\n    });\n  }\n\n  onHideDirentsDraggablePreview = () => {\n    this.setState({\n      isShowDirentsDraggablePreview: false\n    });\n  }\n\n  render() {\n    const { direntList, sortBy, sortOrder } = this.props;\n\n    if (this.props.isDirentListLoading) {\n      return (<Loading />);\n    }\n\n    // sort\n    const sortByName = sortBy == 'name';\n    const sortByTime = sortBy == 'time';\n    const sortBySize = sortBy == 'size';\n    const sortIcon = sortOrder == 'asc' ? <span className=\"fas fa-caret-up\"></span> : <span className=\"fas fa-caret-down\"></span>;\n\n    const isDesktop = Utils.isDesktop();\n\n    return (\n      <div\n        className={`table-container ${this.state.isListDropTipShow ? 'table-drop-active' : ''}`}\n        onMouseDown={this.onContainerMouseDown}\n        onContextMenu={this.onContainerContextMenu}\n        onClick={this.onContainerClick}\n        onDragEnter={this.onTableDragEnter}\n        onDragOver={this.onTableDragOver}\n        onDragLeave={this.onTableDragLeave}\n        onDrop={this.tableDrop}\n      >\n        <table className={`table-hover ${isDesktop ? '': 'table-thead-hidden'}`}>\n          {isDesktop ? (\n            <thead onMouseDown={this.onThreadMouseDown} onContextMenu={this.onThreadContextMenu}>\n              <tr>\n                <th width=\"3%\" className=\"pl10\">\n                  <input type=\"checkbox\" className=\"vam\" onChange={this.props.onAllItemSelected} checked={this.props.isAllItemSelected}/>\n                </th>\n                <th width=\"3%\" className=\"pl10\">{/*icon */}</th>\n                <th width=\"5%\" className=\"pl10\">{/*star */}</th>\n                <th width=\"39%\"><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortByName}>{gettext('Name')} {sortByName && sortIcon}</a></th>\n                <th width=\"6%\">{/*tag */}</th>\n                <th width=\"18%\">{/*operation */}</th>\n                <th width=\"11%\"><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortBySize}>{gettext('Size')} {sortBySize && sortIcon}</a></th>\n                <th width=\"15%\"><a className=\"d-block table-sort-op\" href=\"#\" onClick={this.sortByTime}>{gettext('Last Update')} {sortByTime && sortIcon}</a></th>\n              </tr>\n            </thead>\n          ) : (\n            <thead>\n              <tr>\n                <th width=\"12%\"></th>\n                <th width=\"80%\"></th>\n                <th width=\"8%\"></th>\n              </tr>\n            </thead>\n          )}\n          <tbody>\n            {direntList.map((dirent, index) => {\n              return (\n                <DirentListItem\n                  ref={this.setDirentItemRef(index)}\n                  key={index}\n                  dirent={dirent}\n                  path={this.props.path}\n                  repoID={this.props.repoID}\n                  currentRepoInfo={this.props.currentRepoInfo}\n                  isAdmin={this.isAdmin}\n                  isRepoOwner={this.isRepoOwner}\n                  repoEncrypted={this.repoEncrypted}\n                  enableDirPrivateShare={this.props.enableDirPrivateShare}\n                  isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n                  onItemClick={this.props.onItemClick}\n                  onItemRenameToggle={this.onItemRenameToggle}\n                  onItemSelected={this.onItemSelected}\n                  onItemDelete={this.props.onItemDelete}\n                  onItemRename={this.onItemRename}\n                  onItemMove={this.props.onItemMove}\n                  onItemCopy={this.props.onItemCopy}\n                  updateDirent={this.props.updateDirent}\n                  isItemFreezed={this.state.isItemFreezed}\n                  freezeItem={this.freezeItem}\n                  unfreezeItem={this.unfreezeItem}\n                  onDirentClick={this.onDirentClick}\n                  showImagePopup={this.showImagePopup}\n                  onItemMouseDown={this.onItemMouseDown}\n                  onItemContextMenu={this.onItemContextMenu}\n                  selectedDirentList={this.props.selectedDirentList}\n                  activeDirent={this.state.activeDirent}\n                  onFileTagChanged={this.props.onFileTagChanged}\n                  getDirentItemMenuList={this.getDirentItemMenuList}\n                  showDirentDetail={this.props.showDirentDetail}\n                  onItemsMove={this.props.onItemsMove}\n                  onShowDirentsDraggablePreview={this.onShowDirentsDraggablePreview}\n                />\n              );\n            })}\n          </tbody>\n        </table>\n        <Fragment>\n          <ContextMenu\n            id={'dirent-container-menu'}\n            onMenuItemClick={this.onContainerMenuItemClick}\n          />\n          <ContextMenu\n            id={'dirent-item-menu'}\n            onMenuItemClick={this.onMenuItemClick}\n            onShowMenu={this.onShowMenu}\n            onHideMenu={this.onHideMenu}\n          />\n          <ContextMenu\n            id={'dirents-menu'}\n            onMenuItemClick={this.onDirentsMenuItemClick}\n          />\n          {this.state.isShowDirentsDraggablePreview &&\n            <ModalPortal>\n              <DirentsDraggedPreview\n                selectedDirentList={this.props.selectedDirentList}\n                onHideDirentsDraggablePreview={this.onHideDirentsDraggablePreview}\n                dragStartPosition={this.state.dragStartPosition}\n              />\n            </ModalPortal>\n          }\n          {this.state.isImagePopupOpen && (\n            <ModalPortal>\n              <ImageDialog\n                imageItems={this.state.imageItems}\n                imageIndex={this.state.imageIndex}\n                closeImagePopup={this.closeImagePopup}\n                moveToPrevImage={this.moveToPrevImage}\n                moveToNextImage={this.moveToNextImage}\n              />\n            </ModalPortal>\n          )}\n          {this.state.isCreateFolderDialogShow && (\n            <ModalPortal>\n              <CreateFolder\n                parentPath={this.props.path}\n                onAddFolder={this.onAddFolder}\n                checkDuplicatedName={this.checkDuplicatedName}\n                addFolderCancel={this.onCreateFolderToggle}\n              />\n            </ModalPortal>\n          )}\n          {this.state.isCreateFileDialogShow && (\n            <ModalPortal>\n              <CreateFile\n                parentPath={this.props.path}\n                fileType={this.state.fileType}\n                onAddFile={this.onAddFile}\n                checkDuplicatedName={this.checkDuplicatedName}\n                addFileCancel={this.onCreateFileToggle}\n              />\n            </ModalPortal>\n          )}\n          {this.state.isMoveDialogShow &&\n            <MoveDirentDialog\n              path={this.props.path}\n              repoID={this.props.repoID}\n              repoEncrypted={this.props.currentRepoInfo.encrypted}\n              isMutipleOperation={this.state.isMutipleOperation}\n              selectedDirentList={this.props.selectedDirentList}\n              onItemsMove={this.props.onItemsMove}\n              onCancelMove={this.onMoveToggle}\n            />\n          }\n          {this.state.isCopyDialogShow &&\n            <CopyDirentDialog\n              path={this.props.path}\n              repoID={this.props.repoID}\n              repoEncrypted={this.props.currentRepoInfo.encrypted}\n              selectedDirentList={this.props.selectedDirentList}\n              isMutipleOperation={this.state.isMutipleOperation}\n              onItemsCopy={this.props.onItemsCopy}\n              onCancelCopy={this.onCopyToggle}\n            />\n          }\n          {this.state.isProgressDialogShow &&\n            <ZipDownloadDialog\n              repoID={this.props.repoID}\n              path={this.props.path}\n              target={this.state.downloadItems}\n              toggleDialog={this.onCloseZipDownloadDialog}\n            />\n          }\n        </Fragment>\n      </div>\n    );\n  }\n}\n\nDirentListView.propTypes = propTypes;\n\nexport default DirentListView;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport DirentNoneView from '../../components/dirent-list-view/dirent-none-view';\nimport RepoInfoBar from '../../components/repo-info-bar';\nimport DirentListView from '../../components/dirent-list-view/dirent-list-view';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  repoID: PropTypes.string.isRequired,\n  currentRepoInfo: PropTypes.object.isRequired,\n  isGroupOwnedRepo: PropTypes.bool.isRequired,\n  userPerm: PropTypes.string,\n  enableDirPrivateShare: PropTypes.bool.isRequired,\n  isRepoInfoBarShow: PropTypes.bool.isRequired,\n  usedRepoTags: PropTypes.array.isRequired,\n  readmeMarkdown: PropTypes.object,\n  draftCounts: PropTypes.number,\n  updateUsedRepoTags: PropTypes.func.isRequired,\n  isDirentListLoading: PropTypes.bool.isRequired,\n  direntList: PropTypes.array.isRequired,\n  sortBy: PropTypes.string.isRequired,\n  sortOrder: PropTypes.string.isRequired,\n  sortItems: PropTypes.func.isRequired,\n  onAddFolder: PropTypes.func.isRequired,\n  onAddFile: PropTypes.func.isRequired,\n  onItemClick: PropTypes.func.isRequired,\n  onItemSelected: PropTypes.func.isRequired,\n  onItemDelete: PropTypes.func.isRequired,\n  onItemRename: PropTypes.func.isRequired,\n  onItemMove: PropTypes.func.isRequired,\n  onItemCopy: PropTypes.func.isRequired,\n  onDirentClick: PropTypes.func.isRequired,\n  updateDirent: PropTypes.func.isRequired,\n  isAllItemSelected: PropTypes.bool.isRequired,\n  onAllItemSelected: PropTypes.func.isRequired,\n  selectedDirentList: PropTypes.array.isRequired,\n  onItemsMove: PropTypes.func.isRequired,\n  onItemsCopy: PropTypes.func.isRequired,\n  onItemsDelete: PropTypes.func.isRequired,\n  onFileTagChanged: PropTypes.func,\n  showDirentDetail: PropTypes.func.isRequired,\n};\n\nclass DirListView extends React.Component {\n\n  render() {\n\n    if (this.props.path === '/' && this.props.direntList.length === 0) {\n      return (\n        <DirentNoneView\n          path={this.props.path}\n          isDirentListLoading={this.props.isDirentListLoading}\n          onAddFile={this.props.onAddFile}\n        />\n      );\n    }\n\n    return (\n      <Fragment>\n        {this.props.isRepoInfoBarShow && (\n          <RepoInfoBar\n            repoID={this.props.repoID}\n            currentPath={this.props.path}\n            readmeMarkdown={this.props.readmeMarkdown}\n            draftCounts={this.props.draftCounts}\n            usedRepoTags={this.props.usedRepoTags}\n            updateUsedRepoTags={this.props.updateUsedRepoTags}\n            onFileTagChanged={this.props.onFileTagChanged}\n          />\n        )}\n        <DirentListView\n          path={this.props.path}\n          currentRepoInfo={this.props.currentRepoInfo}\n          repoID={this.props.repoID}\n          isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n          userPerm={this.props.userPerm}\n          enableDirPrivateShare={this.props.enableDirPrivateShare}\n          direntList={this.props.direntList}\n          sortBy={this.props.sortBy}\n          sortOrder={this.props.sortOrder}\n          sortItems={this.props.sortItems}\n          onItemClick={this.props.onItemClick}\n          onItemSelected={this.props.onItemSelected}\n          onItemDelete={this.props.onItemDelete}\n          onItemRename={this.props.onItemRename}\n          onItemMove={this.props.onItemMove}\n          onItemCopy={this.props.onItemCopy}\n          onDirentClick={this.props.onDirentClick}\n          isDirentListLoading={this.props.isDirentListLoading}\n          updateDirent={this.props.updateDirent}\n          isAllItemSelected={this.props.isAllItemSelected}\n          onAllItemSelected={this.props.onAllItemSelected}\n          selectedDirentList={this.props.selectedDirentList}\n          onItemsMove={this.props.onItemsMove}\n          onItemsCopy={this.props.onItemsCopy}\n          onItemsDelete={this.props.onItemsDelete}\n          onAddFile={this.props.onAddFile}\n          onAddFolder={this.props.onAddFolder}\n          onFileTagChanged={this.props.onFileTagChanged}\n          showDirentDetail={this.props.showDirentDetail}\n        />\n      </Fragment>\n    );\n  }\n}\n\nDirListView.propTypes = propTypes;\n\nexport default DirListView;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport MD5 from 'MD5';\nimport { UncontrolledTooltip } from 'reactstrap';\nimport { gettext, siteRoot, mediaUrl } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  repoID: PropTypes.string.isRequired,\n  dirent: PropTypes.object.isRequired,\n  onItemClick: PropTypes.func.isRequired,\n  showImagePopup: PropTypes.func.isRequired,\n  onGridItemContextMenu: PropTypes.func.isRequired,\n  onGridItemClick: PropTypes.func.isRequired,\n  activeDirent: PropTypes.object,\n  onGridItemMouseDown: PropTypes.func,\n  currentRepoInfo: PropTypes.object,\n  onItemMove: PropTypes.func.isRequired,\n};\n\nclass DirentGridItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isGridSelected: false,\n      isGridDropTipShow: false,\n    };\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.setState({isGridSelected: false}, () => {\n      if (nextProps.activeDirent && nextProps.activeDirent.name === nextProps.dirent.name) {\n        this.setState({isGridSelected: true});\n      }\n    });\n  }\n\n  onItemMove = (destRepo, dirent, selectedPath, currentPath) => {\n    this.props.onItemMove(destRepo, dirent, selectedPath, currentPath);\n  }\n\n  onItemClick = (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n\n    const dirent = this.props.dirent;\n    if (this.props.dirent === this.props.activeDirent) {\n      this.setState({isGridSelected: false});\n      if (Utils.imageCheck(dirent.name)) {\n        this.props.showImagePopup(dirent);\n      } else {\n        this.props.onItemClick(dirent);\n      }\n    } else {\n      this.setState({isGridSelected: false});\n      this.props.onGridItemClick(this.props.dirent);\n    }\n  }\n\n  onItemLinkClick = (e) => {\n    e.preventDefault();\n    const dirent = this.props.dirent;\n    if (Utils.imageCheck(dirent.name)) {\n      this.props.showImagePopup(dirent);\n    } else {\n      this.props.onItemClick(dirent);\n    }\n  }\n\n  onGridItemDragStart = (e) => {\n    let dragStartItemData = {nodeDirent: this.props.dirent, nodeParentPath: this.props.path};\n    dragStartItemData = JSON.stringify(dragStartItemData);\n\n    e.dataTransfer.effectAllowed = 'move';\n    e.dataTransfer.setData('applicaiton/drag-item-info', dragStartItemData);\n  }\n\n  onGridItemDragEnter = (e) => {\n    if (this.props.dirent.type === 'dir') {\n      this.setState({isGridDropTipShow: true});\n    }\n  }\n\n  onGridItemDragOver = (e) => {\n    e.preventDefault();\n    e.dataTransfer.dropEffect = 'move';\n  }\n\n  onGridItemDragLeave = (e) => {\n    this.setState({isGridDropTipShow: false});\n  }\n\n  onGridItemDragDrop = (e) => {\n    this.setState({isGridDropTipShow: false});\n    if (e.dataTransfer.files.length) { // uploaded files\n      return;\n    }\n    let dragStartItemData = e.dataTransfer.getData('applicaiton/drag-item-info');\n    dragStartItemData = JSON.parse(dragStartItemData);\n    let {nodeDirent, nodeParentPath} = dragStartItemData;\n    let dropItemData = this.props.dirent;\n\n    if (nodeDirent.name === dropItemData.name) {\n      return;\n    }\n\n    if (dropItemData.type !== 'dir') {\n      return;\n    }\n\n    let selectedPath = Utils.joinPath(this.props.path, this.props.dirent.name);\n    this.onItemMove(this.props.currentRepoInfo, nodeDirent, selectedPath, nodeParentPath);\n  }\n\n  onGridItemMouseDown = (event) =>{\n    this.props.onGridItemMouseDown(event);\n  }\n\n  getFileUrl = (url) => {\n    let fileUrlArr = url.split('/');\n    if (fileUrlArr.indexOf('48') !== -1) {\n      fileUrlArr.splice(fileUrlArr.indexOf('48'), 1, '192');\n    }\n    let fileUrl = fileUrlArr.join('/');\n    return fileUrl;\n  }\n\n  onGridItemContextMenu = (event) => {\n    let dirent = this.props.dirent;\n    this.props.onGridItemContextMenu(event, dirent);\n  }\n\n  render() {\n    let { dirent, path } = this.props;\n    let direntPath = Utils.joinPath(path, dirent.name);\n    let iconUrl = Utils.getDirentIcon(dirent, true);\n    let fileUrl = dirent.encoded_thumbnail_src ? this.getFileUrl(dirent.encoded_thumbnail_src) : '';\n\n    let toolTipID = '';\n    let tagTitle = '';\n    if (dirent.file_tags && dirent.file_tags.length > 0) {\n      toolTipID = MD5(dirent.name).slice(0, 7);\n      tagTitle = dirent.file_tags.map(item => item.name).join(' ');\n    }\n\n    let dirHref = '';\n    if (this.props.currentRepoInfo) {\n      dirHref = siteRoot + 'library/' + this.props.repoID + '/' + this.props.currentRepoInfo.repo_name + Utils.encodePath(direntPath);\n    }\n    let fileHref = siteRoot + 'lib/' + this.props.repoID + '/file' + Utils.encodePath(direntPath);\n\n    let gridClass = 'grid-file-img-link cursor-pointer';\n    gridClass += this.state.isGridSelected ? ' grid-selected-active' : ' ';\n    gridClass += this.state.isGridDropTipShow ? ' grid-drop-show' : ' ';\n\n    let lockedInfo = gettext('locked by {name}');\n    lockedInfo = lockedInfo.replace('{name}', dirent.lock_owner_name);\n\n    return(\n      <Fragment>\n        <li className=\"grid-item\" onContextMenu={this.onGridItemContextMenu} onMouseDown={this.onGridItemMouseDown}>\n          <div\n            className={gridClass}\n            draggable=\"true\"\n            onClick={this.onItemClick}\n            onDragStart={this.onGridItemDragStart}\n            onDragEnter={this.onGridItemDragEnter}\n            onDragOver={this.onGridItemDragOver}\n            onDragLeave={this.onGridItemDragLeave}\n            onDrop={this.onGridItemDragDrop}\n          >\n            {dirent.encoded_thumbnail_src ?\n              <img src={`${siteRoot}${fileUrl}`} ref={this.gridIcon} className=\"thumbnail\" onClick={this.onItemClick} alt=\"\"/> :\n              <img src={iconUrl} ref={this.gridIcon} width=\"96\" alt='' />\n            }\n            {dirent.is_locked && <img className=\"grid-file-locked-icon\" src={mediaUrl + 'img/file-locked-32.png'} alt={gettext('locked')} title={lockedInfo}/>}\n          </div>\n          <div className=\"grid-file-name\" onDragStart={this.onGridItemDragStart} draggable=\"true\" >\n            {(dirent.type !== 'dir' && dirent.file_tags && dirent.file_tags.length > 0) && (\n              <Fragment>\n                <div id={`tag-list-title-${toolTipID}`} className=\"dirent-item tag-list tag-list-stacked d-inline-block align-middle\">\n                  {dirent.file_tags.map((fileTag, index) => {\n                    let length = dirent.file_tags.length;\n                    return (\n                      <span className=\"file-tag\" key={fileTag.id} style={{zIndex:length - index, backgroundColor:fileTag.color}}></span>\n                    );\n                  })}\n                </div>\n                <UncontrolledTooltip target={`tag-list-title-${toolTipID}`} placement=\"bottom\">\n                  {tagTitle}\n                </UncontrolledTooltip>\n              </Fragment>\n            )}\n            <a className={`grid-file-name-link ${this.state.isGridSelected ? 'grid-link-selected-active' : ''}`} href={dirent.type === 'dir' ? dirHref : fileHref} onClick={this.onItemLinkClick}>{dirent.name}</a>\n          </div>\n        </li>\n      </Fragment>\n    );\n  }\n}\n\nDirentGridItem.propTypes = propTypes;\nexport default DirentGridItem;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { siteRoot, thumbnailSizeForOriginal, username, isPro, enableFileComment, fileAuditEnabled, folderPermEnabled, canGenerateShareLink } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport URLDecorator from '../../utils/url-decorator';\nimport Loading from '../loading';\nimport ModalPortal from '../modal-portal';\nimport ImageDialog from '../../components/dialog/image-dialog';\nimport DirentGridItem from '../../components/dirent-grid-view/dirent-grid-item';\nimport ContextMenu from '../context-menu/context-menu';\nimport { hideMenu, showMenu } from '../context-menu/actions';\nimport TextTranslation from '../../utils/text-translation';\nimport MoveDirentDialog from '../dialog/move-dirent-dialog';\nimport CopyDirentDialog from '../dialog/copy-dirent-dialog';\nimport ShareDialog from '../dialog/share-dialog';\nimport ZipDownloadDialog from '../dialog/zip-download-dialog';\nimport EditFileTagDialog from '../dialog/edit-filetag-dialog';\nimport Rename from '../../components/dialog/rename-dirent';\nimport CreateFile from '../dialog/create-file-dialog';\nimport CreateFolder from '../dialog/create-folder-dialog';\nimport LibSubFolderPermissionDialog from '../dialog/lib-sub-folder-permission-dialog';\nimport toaster from '../toast';\n\nimport '../../css/grid-view.css';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  repoID: PropTypes.string.isRequired,\n  currentRepoInfo: PropTypes.object,\n  direntList: PropTypes.array.isRequired,\n  onAddFile: PropTypes.func,\n  onItemDelete: PropTypes.func,\n  onItemCopy: PropTypes.func.isRequired,\n  onItemMove: PropTypes.func.isRequired,\n  onRenameNode: PropTypes.func.isRequired,\n  onItemClick: PropTypes.func.isRequired,\n  isDirentListLoading: PropTypes.bool.isRequired,\n  isGroupOwnedRepo: PropTypes.bool.isRequired,\n  userPerm: PropTypes.string, // current path's user permission\n  enableDirPrivateShare: PropTypes.bool.isRequired,\n  updateDirent: PropTypes.func.isRequired,\n  isDirentDetailShow: PropTypes.bool.isRequired,\n  onGridItemClick: PropTypes.func,\n  onFileTagChanged: PropTypes.func,\n  onAddFolder: PropTypes.func.isRequired,\n  showDirentDetail: PropTypes.func.isRequired,\n  onItemRename: PropTypes.func.isRequired,\n};\n\nclass DirentGridView extends React.Component{\n  constructor(props) {\n    super(props);\n    this.state = {\n      isImagePopupOpen: false,\n      imageItems: [],\n      imageIndex: 0,\n      // onmenuClick\n      isShareDialogShow: false,\n      isMoveDialogShow: false,\n      isCopyDialogShow: false,\n      isEditFileTagShow: false,\n      isZipDialogOpen: false,\n      isRenameDialogShow: false,\n      isCreateFolderDialogShow: false,\n      isCreateFileDialogShow: false,\n      isPermissionDialogOpen: false,\n\n      isMutipleOperation: false,\n      isGridItemFreezed: false,\n      activeDirent: null,\n    };\n    this.isRepoOwner = props.currentRepoInfo.owner_email === username;\n  }\n\n  onCreateFileToggle = () => {\n    this.setState({\n      isCreateFileDialogShow: !this.state.isCreateFileDialogShow,\n    });\n  }\n\n  onGridItemClick = (dirent) => {\n    this.setState({activeDirent: dirent});\n    this.props.onGridItemClick(dirent);\n  }\n\n  onMoveToggle = () => {\n    this.setState({isMoveDialogShow: !this.state.isMoveDialogShow});\n  }\n\n  onCopyToggle = () => {\n    this.setState({isCopyDialogShow: !this.state.isCopyDialogShow});\n  }\n\n  onAddFile = (filePath, isDraft) => {\n    this.setState({isCreateFileDialogShow: false});\n    this.props.onAddFile(filePath, isDraft);\n  }\n\n  onAddFolder = (dirPath) => {\n    this.setState({isCreateFolderDialogShow: false});\n    this.props.onAddFolder(dirPath);\n  }\n\n  onItemShare = (e) => {\n    e.nativeEvent.stopImmediatePropagation(); //for document event\n    this.setState({isShareDialogShow: !this.state.isShareDialogShow});\n  }\n\n  closeSharedDialog = () => {\n    this.setState({isShareDialogShow: !this.state.isShareDialogShow});\n  }\n\n  onItemDelete = (currentObject, e) => {\n    e.nativeEvent.stopImmediatePropagation(); //for document event\n    this.props.onItemDelete(currentObject);\n  }\n\n  onMenuItemClick = (operation, currentObject, event) => {\n    hideMenu();\n    switch(operation) {\n      case 'Download':\n        this.onItemDownload(currentObject, event);\n        break;\n      case 'Share':\n        this.onItemShare(event);\n        break;\n      case 'Delete':\n        this.onItemDelete(currentObject, event);\n        break;\n      case 'Rename':\n        this.onItemRenameToggle();\n        break;\n      case 'Move':\n        this.onItemMoveToggle();\n        break;\n      case 'Copy':\n        this.onItemCopyToggle();\n        break;\n      case 'Tags':\n        this.onEditFileTagToggle();\n        break;\n      case 'Permission':\n        this.onPermissionItem();\n        break;\n      case 'Unlock':\n        this.onUnlockItem(currentObject);\n        break;\n      case 'Lock':\n        this.onLockItem(currentObject);\n        break;\n      case 'Comment':\n        this.onCommentItem();\n        break;\n      case 'History':\n        this.onHistory(currentObject);\n        break;\n      case 'New Folder':\n        this.onCreateFolderToggle(currentObject);\n        break;\n      case 'New File':\n        this.onCreateFileToggle(currentObject);\n        break;\n      case 'Access Log':\n        this.onAccessLog(currentObject);\n        break;\n      case 'Open via Client':\n        this.onOpenViaClient(currentObject);\n        break;\n      default:\n        break;\n    }\n  }\n\n  onEditFileTagToggle = () => {\n    this.setState({\n      isEditFileTagShow: !this.state.isEditFileTagShow\n    });\n  }\n\n  onFileTagChanged = () => {\n    let dirent = this.state.activeDirent ? this.state.activeDirent : '';\n    let direntPath = Utils.joinPath(this.props.path, dirent.name);\n    this.props.onFileTagChanged(dirent, direntPath);\n  }\n\n  getDirentPath = (dirent) => {\n    let path = this.props.path;\n    return path === '/' ? path + dirent.name : path + '/' + dirent.name;\n  }\n\n  closeZipDialog = () => {\n    this.setState({\n      isZipDialogOpen: false\n    });\n  }\n\n  onItemDownload = (currentObject, e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    let dirent = currentObject;\n    let repoID = this.props.repoID;\n    let direntPath = this.getDirentPath(dirent);\n    if (dirent.type === 'dir') {\n      this.setState({\n        isZipDialogOpen: true\n      });\n    } else {\n      let url = URLDecorator.getUrl({type: 'download_file_url', repoID: repoID, filePath: direntPath});\n      location.href = url;\n    }\n  }\n\n  onCreateFolderToggle = () => {\n    this.setState({\n      isCreateFolderDialogShow: !this.state.isCreateFolderDialogShow,\n    });\n  }\n\n  onItemRenameToggle = () => {\n    this.setState({\n      isRenameDialogShow: !this.state.isRenameDialogShow,\n    });\n  }\n\n  onItemMoveToggle = () => {\n    this.setState({isMoveDialogShow: !this.state.isMoveDialogShow});\n  }\n\n  onItemCopyToggle = () => {\n    this.setState({isCopyDialogShow: !this.state.isCopyDialogShow});\n  }\n\n  onPermissionItem = () => {\n    this.setState({isPermissionDialogOpen: !this.state.isPermissionDialogOpen});\n  }\n\n  onLockItem = (currentObject) => {\n    let repoID = this.props.repoID;\n    let filePath = this.getDirentPath(currentObject);\n    seafileAPI.lockfile(repoID, filePath).then(() => {\n      this.props.updateDirent(currentObject, 'is_locked', true);\n      this.props.updateDirent(currentObject, 'locked_by_me', true);\n      let lockName = username.split('@');\n      this.props.updateDirent(currentObject, 'lock_owner_name', lockName[0]);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onUnlockItem = (currentObject) => {\n    let repoID = this.props.repoID;\n    let filePath = this.getDirentPath(currentObject);\n    seafileAPI.unlockfile(repoID, filePath).then(() => {\n      this.props.updateDirent(currentObject, 'is_locked', false);\n      this.props.updateDirent(currentObject, 'locked_by_me', false);\n      this.props.updateDirent(currentObject, 'lock_owner_name', '');\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onCommentItem = () => {\n    this.props.showDirentDetail('comments');\n  }\n\n  onHistory = (currentObject) => {\n    let repoID = this.props.repoID;\n    let filePath = this.getDirentPath(currentObject);\n    let url = URLDecorator.getUrl({type: 'file_revisions', repoID: repoID, filePath: filePath});\n    location.href = url;\n  }\n\n  onAccessLog = (currentObject) => {\n    let filePath = this.getDirentPath(currentObject);\n    let path = siteRoot + 'repo/file-access/' + this.props.repoID + '/?p=' + encodeURIComponent(filePath) ;\n    window.open(path);\n  }\n\n  onOpenViaClient = (currentObject) => {\n    let repoID = this.props.repoID;\n    let filePath = this.getDirentPath(currentObject);\n    let url = URLDecorator.getUrl({type: 'open_via_client', repoID: repoID, filePath: filePath});\n    location.href = url;\n  }\n\n  onItemRename = (newName) => {\n    this.props.onItemRename(this.state.activeDirent, newName);\n  }\n\n  prepareImageItem = (item) => {\n    const useThumbnail = !this.repoEncrypted;\n    const name = item.name;\n\n    const fileExt = name.substr(name.lastIndexOf('.') + 1).toLowerCase();\n    const isGIF = fileExt == 'gif';\n\n    const path = Utils.encodePath(Utils.joinPath(this.props.path, name));\n    const repoID = this.props.repoID;\n    let src;\n    if (useThumbnail && !isGIF) {\n      src = `${siteRoot}thumbnail/${repoID}/${thumbnailSizeForOriginal}${path}`;\n    } else {\n      src = `${siteRoot}repo/${repoID}/raw${path}`;\n    }\n\n    return {\n      'name': name,\n      'url': `${siteRoot}lib/${repoID}/file${path}`,\n      'src': src\n    };\n  }\n\n  showImagePopup = (curItem) => {\n    let items = this.props.direntList.filter((item) => {\n      return Utils.imageCheck(item.name);\n    });\n\n    const imageItems = items.map((item) => {\n      return this.prepareImageItem(item);\n    });\n\n    this.setState({\n      isImagePopupOpen: true,\n      imageItems: imageItems,\n      imageIndex: items.indexOf(curItem)\n    });\n  }\n\n  closeImagePopup = () => {\n    this.setState({isImagePopupOpen: false});\n  }\n\n  moveToPrevImage = () => {\n    const imageItemsLength = this.state.imageItems.length;\n    this.setState((prevState) => ({\n      imageIndex: (prevState.imageIndex + imageItemsLength - 1) % imageItemsLength\n    }));\n  }\n\n  moveToNextImage = () => {\n    const imageItemsLength = this.state.imageItems.length;\n    this.setState((prevState) => ({\n      imageIndex: (prevState.imageIndex + 1) % imageItemsLength\n    }));\n  }\n\n  checkDuplicatedName = (newName) => {\n    return Utils.checkDuplicatedNameInList(this.props.direntList, newName);\n  }\n\n  // common contextmenu handle\n  onMouseDown = (event) => {\n    event.stopPropagation();\n    if (event.button === 2) {\n      return;\n    }\n  }\n\n  onGridContainerMouseDown = (event) => {\n    this.onMouseDown(event);\n  }\n\n  onGridItemMouseDown = (event) => {\n    this.onMouseDown(event);\n  }\n\n  gridContainerClick = () => {\n    if (!this.props.isDirentDetailShow) {\n      this.onGridItemClick(null);\n    }\n  }\n\n  onGridContainerContextMenu = (event) => {\n    event.preventDefault();\n    // Display menu items based on the permissions of the current path\n    let permission = this.props.userPerm;\n    if (permission !== 'admin' && permission !== 'rw') {\n      return;\n    }\n    let id = 'dirent-grid-container-menu';\n    let menuList = [TextTranslation.NEW_FOLDER, TextTranslation.NEW_FILE];\n    this.handleContextClick(event, id, menuList);\n  }\n\n  onGridItemContextMenu = (event, dirent) => {\n    // Display menu items according to the current dirent permission\n    let id = 'grid-item-contextmenu';\n    let menuList = this.getDirentItemMenuList(dirent, true);\n    this.handleContextClick(event, id, menuList, dirent);\n    this.props.onGridItemClick && this.props.onGridItemClick(dirent);\n  }\n\n  handleContextClick = (event, id, menuList, currentObject = null) => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    let x = event.clientX || (event.touches && event.touches[0].pageX);\n    let y = event.clientY || (event.touches && event.touches[0].pageY);\n\n    if (this.props.posX) {\n      x -= this.props.posX;\n    }\n    if (this.props.posY) {\n      y -= this.props.posY;\n    }\n\n    hideMenu();\n\n    this.setState({activeDirent: currentObject});\n\n    let showMenuConfig = {\n      id: id,\n      position: { x, y },\n      target: event.target,\n      currentObject: currentObject,\n      menuList: menuList,\n    };\n\n    if (menuList.length === 0) {\n      return;\n    }\n\n    showMenu(showMenuConfig);\n  }\n\n  getDirentItemMenuList = (dirent, isContextmenu) => {\n    const isRepoOwner = this.isRepoOwner;\n    const currentRepoInfo = this.props.currentRepoInfo;\n    return Utils.getDirentOperationList(isRepoOwner, currentRepoInfo, dirent, isContextmenu);\n  }\n\n  render() {\n    let {direntList, path} = this.props;\n    let dirent = this.state.activeDirent ? this.state.activeDirent : '';\n    let direntPath = Utils.joinPath(path, dirent.name);\n\n    if (this.props.isDirentListLoading) {\n      return (<Loading />);\n    }\n\n    return (\n      <Fragment>\n        <ul className=\"grid-view\" onClick={this.gridContainerClick} onContextMenu={this.onGridContainerContextMenu} onMouseDown={this.onGridContainerMouseDown}>\n          {\n            direntList.length !== 0 && direntList.map((dirent, index) => {\n              return (\n                <DirentGridItem\n                  key={index}\n                  dirent={dirent}\n                  repoID={this.props.repoID}\n                  path={this.props.path}\n                  onItemClick={this.props.onItemClick}\n                  currentRepoInfo={this.props.currentRepoInfo}\n                  showImagePopup={this.showImagePopup}\n                  onGridItemContextMenu={this.onGridItemContextMenu}\n                  onItemMove={this.props.onItemMove}\n                  onGridItemMouseDown={this.onGridItemMouseDown}\n                  onGridItemClick={this.onGridItemClick}\n                  activeDirent={this.state.activeDirent}\n                />\n              );\n            })\n          }\n        </ul>\n        <ContextMenu\n          id={'grid-item-contextmenu'}\n          onMenuItemClick={this.onMenuItemClick}\n        />\n        <ContextMenu\n          id={'dirent-grid-container-menu'}\n          onMenuItemClick={this.onMenuItemClick}\n        />\n        {this.state.isCreateFolderDialogShow && (\n          <ModalPortal>\n            <CreateFolder\n              parentPath={this.props.path}\n              onAddFolder={this.onAddFolder}\n              checkDuplicatedName={this.checkDuplicatedName}\n              addFolderCancel={this.onCreateFolderToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isCreateFileDialogShow && (\n          <ModalPortal>\n            <CreateFile\n              parentPath={this.props.path}\n              onAddFile={this.onAddFile}\n              checkDuplicatedName={this.checkDuplicatedName}\n              addFileCancel={this.onCreateFileToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isMoveDialogShow &&\n          <MoveDirentDialog\n            path={this.props.path}\n            repoID={this.props.repoID}\n            repoEncrypted={this.props.currentRepoInfo.encrypted}\n            isMutipleOperation={this.state.isMutipleOperation}\n            onItemMove={this.props.onItemMove}\n            onCancelMove={this.onMoveToggle}\n            dirent={this.state.activeDirent}\n          />\n        }\n        {this.state.isZipDialogOpen &&\n          <ModalPortal>\n            <ZipDownloadDialog\n              repoID={this.props.repoID}\n              path={this.props.path}\n              target={dirent.name}\n              toggleDialog={this.closeZipDialog}\n            />\n          </ModalPortal>\n        }\n        {this.state.isCopyDialogShow &&\n          <CopyDirentDialog\n            path={this.props.path}\n            repoID={this.props.repoID}\n            repoEncrypted={this.props.currentRepoInfo.encrypted}\n            isMutipleOperation={this.state.isMutipleOperation}\n            onItemCopy={this.props.onItemCopy}\n            onCancelCopy={this.onCopyToggle}\n            dirent={this.state.activeDirent}\n          />\n        }\n        {this.state.isEditFileTagShow &&\n          <EditFileTagDialog\n            repoID={this.props.repoID}\n            fileTagList={dirent.file_tags}\n            filePath={direntPath}\n            toggleCancel={this.onEditFileTagToggle}\n            onFileTagChanged={this.onFileTagChanged}\n          />\n        }\n        {this.state.isShareDialogShow &&\n          <ModalPortal>\n            <ShareDialog\n              itemType={dirent.type}\n              itemName={dirent.name}\n              itemPath={direntPath}\n              userPerm={dirent.permission}\n              repoID={this.props.repoID}\n              repoEncrypted={false}\n              enableDirPrivateShare={this.props.enableDirPrivateShare}\n              isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n              toggleDialog={this.closeSharedDialog}\n            />\n          </ModalPortal>\n        }\n        {this.state.isRenameDialogShow && (\n          <ModalPortal>\n            <Rename\n              dirent={this.state.activeDirent}\n              onRename={this.onItemRename}\n              checkDuplicatedName={this.checkDuplicatedName}\n              toggleCancel={this.onItemRenameToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isPermissionDialogOpen &&\n          <ModalPortal>\n            <LibSubFolderPermissionDialog\n              toggleDialog={this.onPermissionItem}\n              repoID={this.props.repoID}\n              folderPath={direntPath}\n              folderName={dirent.name}\n              isDepartmentRepo={this.props.isGroupOwnedRepo}\n            />\n          </ModalPortal>\n        }\n        {this.state.isImagePopupOpen && (\n          <ModalPortal>\n            <ImageDialog\n              imageItems={this.state.imageItems}\n              imageIndex={this.state.imageIndex}\n              closeImagePopup={this.closeImagePopup}\n              moveToPrevImage={this.moveToPrevImage}\n              moveToNextImage={this.moveToNextImage}\n            />\n          </ModalPortal>\n        )}\n      </Fragment>\n    );\n  }\n}\n\nDirentGridView.propTypes = propTypes;\n\nexport default DirentGridView;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport RepoInfoBar from '../../components/repo-info-bar';\nimport DirentGridView from '../../components/dirent-grid-view/dirent-grid-view';\nimport DirentNoneView from '../../components/dirent-list-view/dirent-none-view';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  repoID: PropTypes.string.isRequired,\n  currentRepoInfo: PropTypes.object.isRequired,\n  readmeMarkdown: PropTypes.object,\n  draftCounts: PropTypes.number,\n  usedRepoTags: PropTypes.array.isRequired,\n  updateUsedRepoTags: PropTypes.func.isRequired,\n  direntList: PropTypes.array.isRequired,\n  onItemClick: PropTypes.func.isRequired,\n  onGridItemClick: PropTypes.func,\n  onAddFile: PropTypes.func.isRequired,\n  onItemDelete: PropTypes.func.isRequired,\n  onItemMove: PropTypes.func.isRequired,\n  onItemCopy: PropTypes.func.isRequired,\n  onRenameNode: PropTypes.func.isRequired,\n  isGroupOwnedRepo: PropTypes.bool.isRequired,\n  userPerm: PropTypes.string,\n  isRepoInfoBarShow: PropTypes.bool.isRequired,\n  isDirentListLoading: PropTypes.bool.isRequired,\n  isDirentDetailShow: PropTypes.bool.isRequired,\n  enableDirPrivateShare: PropTypes.bool.isRequired,\n  updateDirent: PropTypes.func.isRequired,\n  showDirentDetail: PropTypes.func.isRequired,\n  onAddFolder: PropTypes.func.isRequired,\n  onFileTagChanged: PropTypes.func,\n  onItemRename: PropTypes.func.isRequired,\n};\n\nclass DirGridView extends React.Component {\n\n  render() {\n    if (this.props.path === '/' && this.props.direntList.length === 0) {\n      return (\n        <DirentNoneView\n          path={this.props.path}\n          isDirentListLoading={this.props.isDirentListLoading}\n          onAddFile={this.props.onAddFile}\n        />\n      );\n    }\n    return (\n      <Fragment>\n        {this.props.isRepoInfoBarShow && (\n          <RepoInfoBar\n            repoID={this.props.repoID}\n            currentPath={this.props.path}\n            readmeMarkdown={this.props.readmeMarkdown}\n            draftCounts={this.props.draftCounts}\n            usedRepoTags={this.props.usedRepoTags}\n            updateUsedRepoTags={this.props.updateUsedRepoTags}\n            onFileTagChanged={this.props.onFileTagChanged}\n          />\n        )}\n        <DirentGridView\n          path={this.props.path}\n          repoID={this.props.repoID}\n          currentRepoInfo={this.props.currentRepoInfo}\n          isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n          userPerm={this.props.userPerm}\n          enableDirPrivateShare={this.props.enableDirPrivateShare}\n          direntList={this.props.direntList}\n          onAddFile={this.props.onAddFile}\n          onItemClick={this.props.onItemClick}\n          onItemDelete={this.props.onItemDelete}\n          onItemMove={this.props.onItemMove}\n          onItemCopy={this.props.onItemCopy}\n          isDirentListLoading={this.props.isDirentListLoading}\n          updateDirent={this.props.updateDirent}\n          onRenameNode={this.props.onRenameNode}\n          showDirentDetail={this.props.showDirentDetail}\n          onGridItemClick={this.props.onGridItemClick}\n          isDirentDetailShow={this.props.isDirentDetailShow}\n          onItemRename={this.props.onItemRename}\n          onAddFolder={this.props.onAddFolder}\n          onFileTagChanged={this.props.onFileTagChanged}\n        />\n      </Fragment>\n    );\n  }\n}\n\nDirGridView.propTypes = propTypes;\n\nexport default DirGridView;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport { Button, Modal, ModalHeader, Input, ModalBody, ModalFooter, Alert } from 'reactstrap';\n\nconst propTypes = {\n  currentNode: PropTypes.object,\n  onRename: PropTypes.func.isRequired,\n  toggleCancel: PropTypes.func.isRequired,\n  checkDuplicatedName: PropTypes.func.isRequired,\n};\n\nclass Rename extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      newName: '',\n      errMessage: '',\n      isSubmitBtnActive: false,\n    };\n    this.newInput = React.createRef();\n  }\n\n  componentWillMount() {\n    this.setState({newName: this.props.currentNode.object.name});\n  }\n\n  componentDidMount() {\n    let currentNode = this.props.currentNode;\n    this.changeState(currentNode);\n    this.newInput.focus();\n    let type = currentNode.object.type;\n    if (type === 'file') {\n      var endIndex = currentNode.object.name.lastIndexOf('.md');\n      this.newInput.setSelectionRange(0, endIndex, 'forward');\n    } else {\n      this.newInput.setSelectionRange(0, -1);\n    }\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.changeState(nextProps.currentNode);\n  }\n\n  handleChange = (e) => {\n    if (!e.target.value.trim()) {\n      this.setState({isSubmitBtnActive: false});\n    } else {\n      this.setState({isSubmitBtnActive: true});\n    }\n\n    this.setState({newName: e.target.value});\n  }\n\n  handleSubmit = () => {\n    let { isValid, errMessage } = this.validateInput();\n    if (!isValid) {\n      this.setState({errMessage : errMessage});\n    } else {\n      let isDuplicated = this.checkDuplicatedName();\n      if (isDuplicated) {\n        let errMessage = gettext('The name \"{name}\" is already taken. Please choose a different name.');\n        errMessage = errMessage.replace('{name}', Utils.HTMLescape(this.state.newName));\n        this.setState({errMessage: errMessage});\n      } else {\n        this.props.onRename(this.state.newName);\n      }\n    }\n  }\n\n  handleKeyPress = (e) => {\n    if (e.key === 'Enter') {\n      this.handleSubmit();\n    }\n  }\n\n  toggle = () => {\n    this.props.toggleCancel();\n  }\n\n  changeState = (currentNode) => {\n    let name = currentNode.object.name;\n    this.setState({newName: name});\n  }\n\n  validateInput = () => {\n    let newName = this.state.newName.trim();\n    let isValid = true;\n    let errMessage = '';\n    if (!newName) {\n      isValid = false;\n      errMessage = gettext('Name is required.');\n      return { isValid, errMessage };\n    }\n\n    if (newName.indexOf('/') > -1) {\n      isValid = false;\n      errMessage = gettext('Name should not include ' + '\\'/\\'' + '.');\n      return { isValid, errMessage };\n    }\n\n    return { isValid, errMessage };\n  }\n\n  checkDuplicatedName = () => {\n    let isDuplicated = this.props.checkDuplicatedName(this.state.newName);\n    return isDuplicated;\n  }\n\n  render() {\n    let type = this.props.currentNode.object.type;\n    return (\n      <Modal isOpen={true} toggle={this.toggle}>\n        <ModalHeader toggle={this.toggle}>{type === 'file' ? gettext('Rename File') : gettext('Rename Folder') }</ModalHeader>\n        <ModalBody>\n          <p>{type === 'file' ? gettext('New file name'): gettext('New folder name')}</p>\n          <Input onKeyPress={this.handleKeyPress} innerRef={input => {this.newInput = input;}} placeholder=\"newName\" value={this.state.newName} onChange={this.handleChange} />\n          {this.state.errMessage && <Alert color=\"danger\" className=\"mt-2\">{this.state.errMessage}</Alert>}\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.handleSubmit} disabled={!this.state.isSubmitBtnActive}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nRename.propTypes = propTypes;\n\nexport default Rename;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport TreeView from '../../components/tree-view/tree-view';\nimport Loading from '../../components/loading';\nimport ModalPortal from '../../components/modal-portal';\nimport Rename from '../../components/dialog/rename-dialog';\nimport Copy from '../../components/dialog/copy-dirent-dialog';\nimport Move from '../../components/dialog/move-dirent-dialog';\nimport CreateFolder from '../../components/dialog/create-folder-dialog';\nimport CreateFile from '../../components/dialog/create-file-dialog';\nimport ImageDialog from '../../components/dialog/image-dialog';\nimport { siteRoot, thumbnailSizeForOriginal } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  currentPath: PropTypes.string.isRequired,\n  repoPermission: PropTypes.bool.isRequired,\n  isTreeDataLoading: PropTypes.bool.isRequired,\n  treeData: PropTypes.object.isRequired,\n  currentNode: PropTypes.object,\n  onNodeClick: PropTypes.func.isRequired,\n  onNodeCollapse: PropTypes.func.isRequired,\n  onNodeExpanded: PropTypes.func.isRequired,\n  onRenameNode: PropTypes.func.isRequired,\n  onDeleteNode: PropTypes.func.isRequired,\n  onAddFileNode: PropTypes.func.isRequired,\n  onAddFolderNode: PropTypes.func.isRequired,\n  repoID: PropTypes.string.isRequired,\n  navRate: PropTypes.number,\n  inResizing: PropTypes.bool.isRequired,\n  currentRepoInfo: PropTypes.object.isRequired,\n  onItemMove: PropTypes.func.isRequired,\n  onItemCopy: PropTypes.func.isRequired,\n  selectedDirentList: PropTypes.array.isRequired,\n  onItemsMove: PropTypes.func.isRequired,\n};\n\nclass DirColumnNav extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      opNode: null,\n      isAddFileDialogShow: false,\n      isAddFolderDialogShow: false,\n      isRenameDialogShow: false,\n      isNodeImagePopupOpen: false,\n      imageNodeItems: [],\n      imageIndex: 0,\n      isCopyDialogShow: false,\n      isMoveDialogShow: false,\n      isMutipleOperation: false,\n    };\n    this.isNodeMenuShow = true;\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.setState({opNode: nextProps.currentNode});\n  }\n\n  onNodeClick = (node) => {\n    this.setState({opNode: node});\n    if (Utils.imageCheck(node.object.name)) {\n      this.showNodeImagePopup(node);\n      return;\n    }\n    this.props.onNodeClick(node);\n  }\n\n  onMenuItemClick = (operation, node) => {\n    this.setState({opNode: node});\n    switch (operation) {\n      case 'New Folder':\n        if (!node) {\n          this.onAddFolderToggle('root');\n        } else {\n          this.onAddFolderToggle();\n        }\n        break;\n      case 'New File':\n        if (!node) {\n          this.onAddFileToggle('root');\n        } else {\n          this.onAddFileToggle();\n        }\n        break;\n      case 'Rename':\n        this.onRenameToggle();\n        break;\n      case 'Delete':\n        this.onDeleteNode(node);\n        break;\n      case 'Copy':\n        this.onCopyToggle();\n        break;\n      case 'Move':\n        this.onMoveToggle();\n        break;\n      case 'Open in New Tab':\n        this.onOpenFile(node);\n        break;\n    }\n  }\n\n  onAddFileToggle = (type) => {\n    if (type === 'root') {\n      let root = this.props.treeData.root;\n      this.setState({\n        isAddFileDialogShow: !this.state.isAddFileDialogShow,\n        opNode: root,\n      });\n    } else {\n      this.setState({isAddFileDialogShow: !this.state.isAddFileDialogShow});\n    }\n  }\n\n  onAddFolderToggle = (type) => {\n    if (type === 'root') {\n      let root = this.props.treeData.root;\n      this.setState({\n        isAddFolderDialogShow: !this.state.isAddFolderDialogShow,\n        opNode: root,\n      });\n    } else {\n      this.setState({isAddFolderDialogShow: !this.state.isAddFolderDialogShow});\n    }\n  }\n\n  onRenameToggle = () => {\n    this.setState({isRenameDialogShow: !this.state.isRenameDialogShow});\n  }\n\n  onCopyToggle = () => {\n    this.setState({isCopyDialogShow: !this.state.isCopyDialogShow});\n  }\n\n  onMoveToggle = () => {\n    this.setState({isMoveDialogShow: !this.state.isMoveDialogShow});\n  }\n\n  onAddFolderNode = (dirPath) => {\n    this.setState({isAddFolderDialogShow: !this.state.isAddFolderDialogShow});\n    this.props.onAddFolderNode(dirPath);\n  }\n\n  onAddFileNode = (filePath, isDraft) => {\n    this.setState({isAddFileDialogShow: !this.state.isAddFileDialogShow});\n    this.props.onAddFileNode(filePath, isDraft);\n  }\n\n  onRenameNode = (newName) => {\n    this.setState({isRenameDialogShow: !this.state.isRenameDialogShow});\n    let node = this.state.opNode;\n    this.props.onRenameNode(node, newName);\n  }\n\n  onDeleteNode = (node) => {\n    this.props.onDeleteNode(node);\n  }\n\n  onOpenFile = (node) => {\n    let newUrl = siteRoot + 'lib/' + this.props.repoID + '/file' + Utils.encodePath(node.path);\n    window.open(newUrl, '_blank');\n  }\n\n  checkDuplicatedName = (newName) => {\n    let node = this.state.opNode;\n    // root node to new node conditions: parentNode is null,\n    let parentNode = node.parentNode ? node.parentNode : node;\n    let childrenObject = parentNode.children.map(item => {\n      return item.object;\n    });\n    let isDuplicated = childrenObject.some(object => {\n      return object.name === newName;\n    });\n    return isDuplicated;\n  }\n\n  showNodeImagePopup = (node) => {\n    let childrenNode = node.parentNode.children;\n    let items = childrenNode.filter((item) => {\n      return Utils.imageCheck(item.object.name);\n    });\n    let imageNames = items.map((item) => {\n      return item.object.name;\n    });\n    this.setState({\n      isNodeImagePopupOpen: true,\n      imageNodeItems: this.prepareImageItems(node),\n      imageIndex: imageNames.indexOf(node.object.name)\n    });\n  }\n\n  prepareImageItems = (node) => {\n    let childrenNode = node.parentNode.children;\n    let items = childrenNode.filter((item) => {\n      return Utils.imageCheck(item.object.name);\n    });\n\n    const useThumbnail = !this.props.currentRepoInfo.encrypted;\n    let prepareItem = (item) => {\n      const name = item.object.name;\n\n      const path = Utils.encodePath(Utils.joinPath(node.parentNode.path, name));\n      const fileExt = name.substr(name.lastIndexOf('.') + 1).toLowerCase();\n      const isGIF = fileExt === 'gif';\n\n      const repoID = this.props.repoID;\n      let src = '';\n      if (useThumbnail && !isGIF) {\n        src = `${siteRoot}thumbnail/${repoID}/${thumbnailSizeForOriginal}${path}`;\n      } else {\n        src = `${siteRoot}repo/${repoID}/raw${path}`;\n      }\n\n      return {\n        'name': name,\n        'url': `${siteRoot}lib/${repoID}/file${path}`,\n        'src': src\n      };\n    };\n\n    return items.map((item) => { return prepareItem(item); });\n  }\n\n  closeNodeImagePopup = () => {\n    this.setState({\n      isNodeImagePopupOpen: false\n    });\n  }\n\n  moveToPrevImage = () => {\n    const imageItemsLength = this.state.imageNodeItems.length;\n    this.setState((prevState) => ({\n      imageIndex: (prevState.imageIndex + imageItemsLength - 1) % imageItemsLength\n    }));\n  }\n\n  moveToNextImage = () => {\n    const imageItemsLength = this.state.imageNodeItems.length;\n    this.setState((prevState) => ({\n      imageIndex: (prevState.imageIndex + 1) % imageItemsLength\n    }));\n  }\n\n  stopTreeScrollPropagation = (e) => {\n    e.stopPropagation();\n  }\n\n  render() {\n    let flex = this.props.navRate ? '0 0 ' + this.props.navRate * 100 + '%' : '0 0 25%';\n    const select = this.props.inResizing ? 'none' : '';\n    return (\n      <Fragment>\n        <div className=\"dir-content-nav\" role=\"navigation\" style={{flex: (flex), userSelect: select}} onScroll={this.stopTreeScrollPropagation}>\n          {this.props.isTreeDataLoading ?\n            (<Loading/>) :\n            (<TreeView\n              repoPermission={this.props.repoPermission}\n              isNodeMenuShow={this.isNodeMenuShow}\n              treeData={this.props.treeData}\n              currentPath={this.props.currentPath}\n              onNodeClick={this.onNodeClick}\n              onNodeExpanded={this.props.onNodeExpanded}\n              onNodeCollapse={this.props.onNodeCollapse}\n              onMenuItemClick={this.onMenuItemClick}\n              onFreezedItem={this.onFreezedItem}\n              onUnFreezedItem={this.onUnFreezedItem}\n              onItemMove={this.props.onItemMove}\n              currentRepoInfo={this.props.currentRepoInfo}\n              selectedDirentList={this.props.selectedDirentList}\n              onItemsMove={this.props.onItemsMove}\n            />)\n          }\n        </div>\n        {this.state.isAddFolderDialogShow && (\n          <ModalPortal>\n            <CreateFolder\n              parentPath={this.state.opNode.path}\n              onAddFolder={this.onAddFolderNode}\n              checkDuplicatedName={this.checkDuplicatedName}\n              addFolderCancel={this.onAddFolderToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isAddFileDialogShow && (\n          <ModalPortal>\n            <CreateFile\n              parentPath={this.state.opNode.path}\n              onAddFile={this.onAddFileNode}\n              checkDuplicatedName={this.checkDuplicatedName}\n              addFileCancel={this.onAddFileToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isRenameDialogShow && (\n          <ModalPortal>\n            <Rename\n              currentNode={this.state.opNode}\n              onRename={this.onRenameNode}\n              checkDuplicatedName={this.checkDuplicatedName}\n              toggleCancel={this.onRenameToggle}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isCopyDialogShow && (\n          <ModalPortal>\n            <Copy\n              path={this.state.opNode.parentNode.path}\n              repoID={this.props.repoID}\n              dirent={this.state.opNode.object}\n              onItemCopy={this.props.onItemCopy}\n              repoEncrypted={this.props.currentRepoInfo.encrypted}\n              onCancelCopy={this.onCopyToggle}\n              isMutipleOperation={this.state.isMutipleOperation}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isMoveDialogShow && (\n          <ModalPortal>\n            <Move\n              path={this.state.opNode.parentNode.path}\n              repoID={this.props.repoID}\n              dirent={this.state.opNode.object}\n              onItemMove={this.props.onItemMove}\n              repoEncrypted={this.props.currentRepoInfo.encrypted}\n              onCancelMove={this.onMoveToggle}\n              isMutipleOperation={this.state.isMutipleOperation}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isNodeImagePopupOpen && (\n          <ModalPortal>\n            <ImageDialog\n              imageItems={this.state.imageNodeItems}\n              imageIndex={this.state.imageIndex}\n              closeImagePopup={this.closeNodeImagePopup}\n              moveToPrevImage={this.moveToPrevImage}\n              moveToNextImage={this.moveToNextImage}\n            />\n          </ModalPortal>\n        )}\n      </Fragment>\n    );\n  }\n}\n\nDirColumnNav.defaultProps={\n  navRate: 0.25\n};\n\nDirColumnNav.propTypes = propTypes;\n\nexport default DirColumnNav;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Utils } from '../../utils/utils';\nimport { gettext, siteRoot } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport toaster from '../toast';\nimport WikiMarkdownViewer from '../wiki-markdown-viewer';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  repoID: PropTypes.string.isRequired,\n  hash: PropTypes.string,\n  isDraft: PropTypes.bool,\n  hasDraft: PropTypes.bool,\n  goDraftPage: PropTypes.func.isRequired,\n  isFileLoading: PropTypes.bool.isRequired,\n  isFileLoadedErr: PropTypes.bool.isRequired,\n  filePermission: PropTypes.string,\n  content: PropTypes.string,\n  lastModified: PropTypes.string,\n  latestContributor: PropTypes.string,\n  onLinkClick: PropTypes.func.isRequired,\n};\n\nclass DirColumnFile extends React.Component {\n\n  componentDidMount() {\n    if (this.props.hash) {\n      let hash = this.props.hash;\n      setTimeout(function() {\n        window.location.hash = hash;\n      }, 500);\n    }\n  }\n\n  onEditClick = (e) => {\n    e.preventDefault();\n    let { path, repoID } = this.props;\n    let url = siteRoot + 'lib/' + repoID + '/file' + Utils.encodePath(path) + '?mode=edit';\n    window.open(url);\n  }\n\n  onNewDraft = (e) => {\n    e.preventDefault();\n    let { path, repoID } = this.props;\n    seafileAPI.createDraft(repoID, path).then(res => {\n      window.location.href = siteRoot + 'lib/' + res.data.origin_repo_id + '/file' + res.data.draft_file_path + '?mode=edit';\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onOpenFile = (e) => {\n    e.preventDefault();\n    let { path, repoID } = this.props;\n    let newUrl = siteRoot + 'lib/' + repoID + '/file' + Utils.encodePath(path);\n    window.open(newUrl, '_blank');\n  }\n\n  goDraftPage = (e) => {\n    e.preventDefault();\n    this.props.goDraftPage();\n  }\n\n  render() {\n    if (this.props.isFileLoadedErr) {\n      return (\n        <div className=\"message err-tip\">{gettext('File does not exist.')}</div>\n      );\n    }\n    return (\n      <WikiMarkdownViewer\n        isTOCShow={false}\n        isFileLoading={this.props.isFileLoading}\n        markdownContent={this.props.content}\n        lastModified = {this.props.lastModified}\n        latestContributor={this.props.latestContributor}\n        onLinkClick={this.props.onLinkClick}\n        repoID={this.props.repoID}\n        path={this.props.path}\n      >\n        <Fragment>\n          <span className='wiki-open-file position-fixed' onClick={this.onOpenFile}>\n            <i className=\"fas fa-expand-arrows-alt\"></i>\n          </span>\n          {(!this.props.isDraft && this.props.hasDraft) &&\n            <div className='seafile-btn-view-review text-center mt-2'>\n              <div className='tag tag-green'>\n                {gettext('This file is in draft stage.')}\n                <span className=\"ml-2\" onClick={this.goDraftPage}>{gettext('View Draft')}</span>\n              </div>\n            </div>\n          }\n        </Fragment>\n      </WikiMarkdownViewer>\n    );\n  }\n}\n\nDirColumnFile.propTypes = propTypes;\n\nexport default DirColumnFile;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport DirColumnNav from './dir-column-nav';\nimport DirColumnFile from './dir-column-file';\nimport DirListView from './dir-list-view';\n\nconst propTypes = {\n  path: PropTypes.string.isRequired,\n  repoID: PropTypes.string.isRequired,\n  // repoinfo\n  currentRepoInfo: PropTypes.object.isRequired,\n  repoPermission: PropTypes.bool.isRequired,\n  enableDirPrivateShare: PropTypes.bool.isRequired,\n  userPerm: PropTypes.string,\n  isGroupOwnedRepo: PropTypes.bool.isRequired,\n  // tree\n  isTreeDataLoading: PropTypes.bool.isRequired,\n  treeData: PropTypes.object.isRequired,\n  currentNode: PropTypes.object,\n  onNodeClick: PropTypes.func.isRequired,\n  onNodeCollapse: PropTypes.func.isRequired,\n  onNodeExpanded: PropTypes.func.isRequired,\n  onRenameNode: PropTypes.func.isRequired,\n  onDeleteNode: PropTypes.func.isRequired,\n  onAddFileNode: PropTypes.func.isRequired,\n  onAddFolderNode: PropTypes.func.isRequired,\n  // file\n  isViewFile: PropTypes.bool.isRequired,\n  isFileLoading: PropTypes.bool.isRequired,\n  isFileLoadedErr: PropTypes.bool.isRequired,\n  hash: PropTypes.string,\n  isDraft: PropTypes.bool.isRequired,\n  hasDraft: PropTypes.bool.isRequired,\n  goDraftPage: PropTypes.func.isRequired,\n  filePermission: PropTypes.string,\n  content: PropTypes.string,\n  lastModified: PropTypes.string,\n  latestContributor: PropTypes.string,\n  onLinkClick: PropTypes.func.isRequired,\n  // repo content\n  isRepoInfoBarShow: PropTypes.bool.isRequired,\n  draftCounts: PropTypes.number.isRequired,\n  usedRepoTags: PropTypes.array.isRequired,\n  readmeMarkdown: PropTypes.object,\n  updateUsedRepoTags: PropTypes.func.isRequired,\n  // list\n  isDirentListLoading: PropTypes.bool.isRequired,\n  direntList: PropTypes.array.isRequired,\n  sortBy: PropTypes.string.isRequired,\n  sortOrder: PropTypes.string.isRequired,\n  sortItems: PropTypes.func.isRequired,\n  onAddFolder: PropTypes.func.isRequired,\n  onAddFile: PropTypes.func.isRequired,\n  updateDirent: PropTypes.func.isRequired,\n  onItemClick: PropTypes.func.isRequired,\n  onItemSelected: PropTypes.func.isRequired,\n  onItemDelete: PropTypes.func.isRequired,\n  onItemRename: PropTypes.func.isRequired,\n  onItemMove: PropTypes.func.isRequired,\n  onItemCopy: PropTypes.func.isRequired,\n  onDirentClick: PropTypes.func.isRequired,\n  isAllItemSelected: PropTypes.bool.isRequired,\n  onAllItemSelected: PropTypes.func.isRequired,\n  selectedDirentList: PropTypes.array.isRequired,\n  onItemsMove: PropTypes.func.isRequired,\n  onItemsCopy: PropTypes.func.isRequired,\n  onItemsDelete: PropTypes.func.isRequired,\n  onFileTagChanged: PropTypes.func,\n  showDirentDetail: PropTypes.func.isRequired,\n};\n\nclass DirColumnView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      inResizing: false,\n      navRate: 0.25,\n    };\n    this.containerWidth = null;\n  }\n\n  onResizeMouseUp = () => {\n    if (this.state.inResizing) {\n      this.setState({\n        inResizing: false\n      });\n    }\n    this.setCookie('navRate', this.state.navRate);\n  }\n\n  onResizeMouseDown = () => {\n    this.containerWidth = this.refs.viewModeContainer.clientWidth;\n    this.setState({\n      inResizing: true\n    });\n  };\n\n  onResizeMouseMove = (e) => {\n    let sizeNavWidth = this.containerWidth / 0.78 * 0.22 + 3;\n    let rate = (e.nativeEvent.clientX - sizeNavWidth) / this.containerWidth;\n    if (rate < 0.1) {\n      this.setState({\n        inResizing: false,\n        navRate: 0.12,\n      });\n    }\n    else if (rate > 0.4) {\n      this.setState({\n        inResizing: false,\n        navRate: 0.38,\n      });\n    }\n    else {\n      this.setState({\n        navRate: rate\n      });\n    }\n  };\n\n  setCookie = (name, value) => {\n    let cookie = name + '=' + value + ';';\n    document.cookie = cookie;\n  }\n\n  getCookie = (cookiename) => {\n    let name = cookiename + '=';\n    let cookie = document.cookie.split(';');\n    for (let i = 0, len = cookie.length; i < len; i++) {\n      let c = cookie[i].trim();\n      if (c.indexOf(name) == 0) {\n        return c.substring(name.length, c.length) * 1;\n      }\n    }\n    return '';\n  }\n\n  componentWillMount() {\n    let rate = this.getCookie('navRate');\n    if (rate) {\n      this.setState({\n        navRate: rate,\n      });\n    }\n  }\n\n  render() {\n    const onResizeMove = this.state.inResizing ? this.onResizeMouseMove : null;\n    const select = this.state.inResizing ? 'none' : '';\n    const mainFlex = '1 0 ' + (1 - this.state.navRate - 0.05) * 100 + '%';\n    return (\n      <div className=\"dir-colunm-view\" onMouseMove={onResizeMove} onMouseUp={this.onResizeMouseUp} ref=\"viewModeContainer\">\n        <DirColumnNav\n          currentPath={this.props.path}\n          repoPermission={this.props.repoPermission}\n          isTreeDataLoading={this.props.isTreeDataLoading}\n          treeData={this.props.treeData}\n          currentNode={this.props.currentNode}\n          onNodeClick={this.props.onNodeClick}\n          onNodeCollapse={this.props.onNodeCollapse}\n          onNodeExpanded={this.props.onNodeExpanded}\n          onAddFolderNode={this.props.onAddFolderNode}\n          onAddFileNode={this.props.onAddFileNode}\n          onRenameNode={this.props.onRenameNode}\n          onDeleteNode={this.props.onDeleteNode}\n          repoID={this.props.repoID}\n          navRate={this.state.navRate}\n          inResizing={this.state.inResizing}\n          currentRepoInfo={this.props.currentRepoInfo}\n          onItemMove={this.props.onItemMove}\n          onItemCopy={this.props.onItemCopy}\n          selectedDirentList={this.props.selectedDirentList}\n          onItemsMove={this.props.onItemsMove}\n        />\n        <div className=\"dir-content-resize\" onMouseDown={this.onResizeMouseDown}></div>\n        <div className=\"dir-content-main\" style={{userSelect: select, flex: mainFlex}}>\n          {this.props.isViewFile ? (\n            <DirColumnFile\n              path={this.props.path}\n              repoID={this.props.repoID}\n              hash={this.props.hash}\n              isDraft={this.props.isDraft}\n              hasDraft={this.props.hasDraft}\n              goDraftPage={this.props.goDraftPage}\n              isFileLoading={this.props.isFileLoading}\n              isFileLoadedErr={this.props.isFileLoadedErr}\n              filePermission={this.props.filePermission}\n              content={this.props.content}\n              lastModified={this.props.lastModified}\n              latestContributor={this.props.latestContributor}\n              onLinkClick={this.props.onLinkClick}\n            />\n          ) : (\n            <DirListView\n              path={this.props.path}\n              repoID={this.props.repoID}\n              currentRepoInfo={this.props.currentRepoInfo}\n              isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n              userPerm={this.props.userPerm}\n              enableDirPrivateShare={this.props.enableDirPrivateShare}\n              isRepoInfoBarShow={this.props.isRepoInfoBarShow}\n              usedRepoTags={this.props.usedRepoTags}\n              readmeMarkdown={this.props.readmeMarkdown}\n              draftCounts={this.props.draftCounts}\n              updateUsedRepoTags={this.props.updateUsedRepoTags}\n              isDirentListLoading={this.props.isDirentListLoading}\n              direntList={this.props.direntList}\n              sortBy={this.props.sortBy}\n              sortOrder={this.props.sortOrder}\n              sortItems={this.props.sortItems}\n              onAddFolder={this.props.onAddFolder}\n              onAddFile={this.props.onAddFile}\n              onItemClick={this.props.onItemClick}\n              onItemSelected={this.props.onItemSelected}\n              onItemDelete={this.props.onItemDelete}\n              onItemRename={this.props.onItemRename}\n              onItemMove={this.props.onItemMove}\n              onItemCopy={this.props.onItemCopy}\n              onDirentClick={this.props.onDirentClick}\n              updateDirent={this.props.updateDirent}\n              isAllItemSelected={this.props.isAllItemSelected}\n              onAllItemSelected={this.props.onAllItemSelected}\n              selectedDirentList={this.props.selectedDirentList}\n              onItemsMove={this.props.onItemsMove}\n              onItemsCopy={this.props.onItemsCopy}\n              onItemsDelete={this.props.onItemsDelete}\n              onFileTagChanged={this.props.onFileTagChanged}\n              showDirentDetail={this.props.showDirentDetail}\n            />\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n\nDirColumnView.propTypes = propTypes;\n\nexport default DirColumnView;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport CurDirPath from '../../components/cur-dir-path';\nimport DirentDetail from '../../components/dirent-detail/dirent-details';\nimport LibDetail from '../../components/dirent-detail/lib-details';\nimport DirListView from '../../components/dir-view-mode/dir-list-view';\nimport DirGridView from '../../components/dir-view-mode/dir-grid-view';\nimport DirColumnView from '../../components/dir-view-mode/dir-column-view';\n\nimport '../../css/lib-content-view.css';\n\nconst propTypes = {\n  pathPrefix: PropTypes.array.isRequired,\n  currentMode: PropTypes.string.isRequired,\n  path: PropTypes.string.isRequired,\n  pathExist: PropTypes.bool.isRequired,\n  // repoinfo\n  currentRepoInfo: PropTypes.object.isRequired,\n  repoID: PropTypes.string.isRequired,\n  repoPermission: PropTypes.bool.isRequired,\n  enableDirPrivateShare: PropTypes.bool.isRequired,\n  isGroupOwnedRepo: PropTypes.bool.isRequired,\n  userPerm: PropTypes.string,\n  // path func\n  onTabNavClick: PropTypes.func.isRequired,\n  onMainNavBarClick: PropTypes.func.isRequired,\n  // file\n  isViewFile: PropTypes.bool.isRequired,\n  isFileLoadedErr: PropTypes.bool.isRequired,\n  hash: PropTypes.string,\n  isDraft: PropTypes.bool.isRequired,\n  hasDraft: PropTypes.bool.isRequired,\n  fileTags: PropTypes.array.isRequired,\n  goDraftPage: PropTypes.func.isRequired,\n  isFileLoading: PropTypes.bool.isRequired,\n  filePermission: PropTypes.string,\n  content: PropTypes.string,\n  lastModified: PropTypes.string,\n  latestContributor: PropTypes.string,\n  onLinkClick: PropTypes.func.isRequired,\n  // tree\n  isTreeDataLoading: PropTypes.bool.isRequired,\n  treeData: PropTypes.object.isRequired,\n  currentNode: PropTypes.object,\n  onNodeClick: PropTypes.func.isRequired,\n  onNodeCollapse: PropTypes.func.isRequired,\n  onNodeExpanded: PropTypes.func.isRequired,\n  onRenameNode: PropTypes.func.isRequired,\n  onDeleteNode: PropTypes.func.isRequired,\n  onAddFileNode: PropTypes.func.isRequired,\n  onAddFolderNode: PropTypes.func.isRequired,\n  // repo content\n  draftCounts: PropTypes.number,\n  usedRepoTags: PropTypes.array.isRequired,\n  readmeMarkdown: PropTypes.object,\n  updateUsedRepoTags: PropTypes.func.isRequired,\n  // list\n  isDirentListLoading: PropTypes.bool.isRequired,\n  direntList: PropTypes.array.isRequired,\n  sortBy: PropTypes.string.isRequired,\n  sortOrder: PropTypes.string.isRequired,\n  sortItems: PropTypes.func.isRequired,\n  updateDirent: PropTypes.func.isRequired,\n  onItemClick: PropTypes.func.isRequired,\n  onItemSelected: PropTypes.func.isRequired,\n  onItemDelete: PropTypes.func.isRequired,\n  onItemRename: PropTypes.func.isRequired,\n  onItemMove: PropTypes.func.isRequired,\n  onItemCopy: PropTypes.func.isRequired,\n  onAddFolder: PropTypes.func.isRequired,\n  onAddFile: PropTypes.func.isRequired,\n  onFileTagChanged: PropTypes.func.isRequired,\n  isDirentSelected: PropTypes.bool.isRequired,\n  isAllDirentSelected: PropTypes.bool.isRequired,\n  onAllDirentSelected: PropTypes.func.isRequired,\n  isDirentDetailShow: PropTypes.bool.isRequired,\n  selectedDirent: PropTypes.object,\n  selectedDirentList: PropTypes.array.isRequired,\n  onItemsMove: PropTypes.func.isRequired,\n  onItemsCopy: PropTypes.func.isRequired,\n  onItemsDelete: PropTypes.func.isRequired,\n  closeDirentDetail: PropTypes.func.isRequired,\n  showDirentDetail: PropTypes.func.isRequired,\n  onDeleteRepoTag: PropTypes.func.isRequired,\n  updateDetail: PropTypes.bool.isRequired,\n  onListContainerScroll: PropTypes.func.isRequired,\n  onDirentClick: PropTypes.func.isRequired,\n  direntDetailPanelTab: PropTypes.string,\n};\n\nclass LibContentContainer extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      currentDirent: null,\n    };\n\n    this.errMessage = (<div className=\"message err-tip\">{gettext('Folder does not exist.')}</div>);\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (nextProps.path !== this.props.path || nextProps.updateDetail !== this.props.updateDetail) {\n      this.setState({currentDirent: null});\n    }\n  }\n\n  onPathClick = (path) => {\n    this.props.onMainNavBarClick(path);\n    this.props.closeDirentDetail();\n  }\n\n  onItemClick = (dirent) => {\n    this.props.onItemClick(dirent);\n    this.props.closeDirentDetail();\n  }\n\n  onGridItemClick = (dirent) => {\n    this.setState({currentDirent: dirent});\n    this.props.onDirentClick(dirent);\n  }\n\n  // on '<tr>'\n  onDirentClick = (dirent) => {\n    this.setState({currentDirent: dirent});\n    this.props.onDirentClick(dirent);\n  }\n\n  onItemSelected = (dirent) => {\n    this.setState({currentDirent: dirent});\n    this.props.onItemSelected(dirent);\n  }\n\n  onItemDelete = (dirent) => {\n    this.checkCurrentDirent(dirent);\n    this.props.onItemDelete(dirent);\n  }\n\n  onItemMove = (destRepo, dirent, selectedPath, currentPath) => {\n    this.checkCurrentDirent(dirent);\n    this.props.onItemMove(destRepo, dirent, selectedPath, currentPath);\n  }\n\n  checkCurrentDirent = (deletedDirent) => {\n    let { currentDirent } = this.state;\n    if (currentDirent && deletedDirent.name === currentDirent.name) {\n      this.setState({currentDirent: null});\n    }\n  }\n\n  onItemsScroll = (e) => {\n    let target = e.target;\n\n    if (target.scrollTop === 0) {\n      return;\n    }\n\n    if (target.scrollTop + target.clientHeight + 1 >= target.scrollHeight) {\n      this.props.onListContainerScroll();\n    }\n  }\n\n  render() {\n    let { path, repoID, usedRepoTags, readmeMarkdown, draftCounts } = this.props;\n    let isRepoInfoBarShow = false;\n    if (path === '/') {\n      if (usedRepoTags.length !== 0 || readmeMarkdown !== null || draftCounts !== 0) {\n        isRepoInfoBarShow = true;\n      }\n    }\n\n    return (\n      <Fragment>\n        <div className=\"cur-view-container\">\n          {this.props.currentRepoInfo.status === 'read-only' &&\n            <div className=\"readonly-tip-message\">\n              {gettext('This library has been set to read-only by admin and cannot be updated.')}\n            </div>\n          }\n          <div className=\"cur-view-path\">\n            <CurDirPath\n              repoID={repoID}\n              repoName={this.props.currentRepoInfo.repo_name}\n              pathPrefix={this.props.pathPrefix}\n              currentPath={this.props.path}\n              permission={this.props.repoPermission}\n              isViewFile={this.props.isViewFile}\n              onTabNavClick={this.props.onTabNavClick}\n              onPathClick={this.onPathClick}\n              updateUsedRepoTags={this.props.updateUsedRepoTags}\n              fileTags={this.props.fileTags}\n              onDeleteRepoTag={this.props.onDeleteRepoTag}\n              direntList={this.props.direntList}\n              sortBy={this.props.sortBy}\n              sortOrder={this.props.sortOrder}\n              sortItems={this.props.sortItems}\n            />\n          </div>\n          <div className={`cur-view-content lib-content-container ${this.props.currentMode === 'column' ? 'view-mode-container' : ''}`} onScroll={this.onItemsScroll}>\n            {!this.props.pathExist && this.errMessage}\n            {this.props.pathExist && (\n              <Fragment>\n                {this.props.currentMode === 'list' && (\n                  <DirListView\n                    path={this.props.path}\n                    repoID={repoID}\n                    currentRepoInfo={this.props.currentRepoInfo}\n                    isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n                    userPerm={this.props.userPerm}\n                    enableDirPrivateShare={this.props.enableDirPrivateShare}\n                    isRepoInfoBarShow={isRepoInfoBarShow}\n                    usedRepoTags={this.props.usedRepoTags}\n                    readmeMarkdown={this.props.readmeMarkdown}\n                    draftCounts={this.props.draftCounts}\n                    updateUsedRepoTags={this.props.updateUsedRepoTags}\n                    isDirentListLoading={this.props.isDirentListLoading}\n                    direntList={this.props.direntList}\n                    sortBy={this.props.sortBy}\n                    sortOrder={this.props.sortOrder}\n                    sortItems={this.props.sortItems}\n                    onAddFolder={this.props.onAddFolder}\n                    onAddFile={this.props.onAddFile}\n                    onItemClick={this.onItemClick}\n                    onItemSelected={this.onItemSelected}\n                    onItemDelete={this.onItemDelete}\n                    onItemRename={this.props.onItemRename}\n                    onItemMove={this.onItemMove}\n                    onItemCopy={this.props.onItemCopy}\n                    onDirentClick={this.onDirentClick}\n                    updateDirent={this.props.updateDirent}\n                    isAllItemSelected={this.props.isAllDirentSelected}\n                    onAllItemSelected={this.props.onAllDirentSelected}\n                    selectedDirentList={this.props.selectedDirentList}\n                    onItemsMove={this.props.onItemsMove}\n                    onItemsCopy={this.props.onItemsCopy}\n                    onItemsDelete={this.props.onItemsDelete}\n                    onFileTagChanged={this.props.onFileTagChanged}\n                    showDirentDetail={this.props.showDirentDetail}\n                  />\n                )}\n                {this.props.currentMode === 'grid' && (\n                  <DirGridView\n                    path={this.props.path}\n                    repoID={repoID}\n                    currentRepoInfo={this.props.currentRepoInfo}\n                    repoPermission={this.props.repoPermission}\n                    isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n                    userPerm={this.props.userPerm}\n                    enableDirPrivateShare={this.props.enableDirPrivateShare}\n                    onRenameNode={this.props.onRenameNode}\n                    isRepoInfoBarShow={isRepoInfoBarShow}\n                    usedRepoTags={this.props.usedRepoTags}\n                    readmeMarkdown={this.props.readmeMarkdown}\n                    draftCounts={this.props.draftCounts}\n                    updateUsedRepoTags={this.props.updateUsedRepoTags}\n                    isDirentListLoading={this.props.isDirentListLoading}\n                    direntList={this.props.direntList}\n                    onAddFile={this.props.onAddFile}\n                    onItemClick={this.onItemClick}\n                    onItemDelete={this.props.onItemDelete}\n                    onItemMove={this.onItemMove}\n                    onItemCopy={this.props.onItemCopy}\n                    updateDirent={this.props.updateDirent}\n                    onAddFolder={this.props.onAddFolder}\n                    showDirentDetail={this.props.showDirentDetail}\n                    onGridItemClick={this.onGridItemClick}\n                    isDirentDetailShow={this.props.isDirentDetailShow}\n                    onItemRename={this.props.onItemRename}\n                    onFileTagChanged={this.props.onFileTagChanged}\n                  />\n                )}\n                {this.props.currentMode === 'column' && (\n                  <DirColumnView\n                    path={this.props.path}\n                    repoID={repoID}\n                    currentRepoInfo={this.props.currentRepoInfo}\n                    repoPermission={this.props.repoPermission}\n                    isGroupOwnedRepo={this.props.isGroupOwnedRepo}\n                    userPerm={this.props.userPerm}\n                    enableDirPrivateShare={this.props.enableDirPrivateShare}\n                    isTreeDataLoading={this.props.isTreeDataLoading}\n                    treeData={this.props.treeData}\n                    currentNode={this.props.currentNode}\n                    onNodeClick={this.props.onNodeClick}\n                    onNodeCollapse={this.props.onNodeCollapse}\n                    onNodeExpanded={this.props.onNodeExpanded}\n                    onAddFolderNode={this.props.onAddFolder}\n                    onAddFileNode={this.props.onAddFile}\n                    onRenameNode={this.props.onRenameNode}\n                    onDeleteNode={this.props.onDeleteNode}\n                    isViewFile={this.props.isViewFile}\n                    isFileLoading={this.props.isFileLoading}\n                    isFileLoadedErr={this.props.isFileLoadedErr}\n                    hash={this.props.hash}\n                    isDraft={this.props.isDraft}\n                    hasDraft={this.props.hasDraft}\n                    goDraftPage={this.props.goDraftPage}\n                    filePermission={this.props.filePermission}\n                    content={this.props.content}\n                    lastModified={this.props.lastModified}\n                    latestContributor={this.props.latestContributor}\n                    onLinkClick={this.props.onLinkClick}\n                    isRepoInfoBarShow={isRepoInfoBarShow}\n                    usedRepoTags={this.props.usedRepoTags}\n                    readmeMarkdown={this.props.readmeMarkdown}\n                    draftCounts={this.props.draftCounts}\n                    updateUsedRepoTags={this.props.updateUsedRepoTags}\n                    isDirentListLoading={this.props.isDirentListLoading}\n                    direntList={this.props.direntList}\n                    sortBy={this.props.sortBy}\n                    sortOrder={this.props.sortOrder}\n                    sortItems={this.props.sortItems}\n                    onAddFolder={this.props.onAddFolder}\n                    onAddFile={this.props.onAddFile}\n                    onItemClick={this.onItemClick}\n                    onItemSelected={this.onItemSelected}\n                    onItemDelete={this.onItemDelete}\n                    onItemRename={this.props.onItemRename}\n                    onItemMove={this.onItemMove}\n                    onItemCopy={this.props.onItemCopy}\n                    onDirentClick={this.onDirentClick}\n                    updateDirent={this.props.updateDirent}\n                    isAllItemSelected={this.props.isAllDirentSelected}\n                    onAllItemSelected={this.props.onAllDirentSelected}\n                    selectedDirentList={this.props.selectedDirentList}\n                    onItemsMove={this.props.onItemsMove}\n                    onItemsCopy={this.props.onItemsCopy}\n                    onItemsDelete={this.props.onItemsDelete}\n                    onFileTagChanged={this.props.onFileTagChanged}\n                    showDirentDetail={this.props.showDirentDetail}\n                  />\n                )}\n              </Fragment>\n            )}\n          </div>\n        </div>\n        {this.props.isDirentDetailShow &&\n          <Fragment>\n            <div className=\"cur-view-detail\">\n              {(this.props.path === '/' && !this.state.currentDirent) ?\n                <LibDetail\n                  currentRepo={this.props.currentRepoInfo}\n                  closeDetails={this.props.closeDirentDetail}\n                /> :\n                <DirentDetail\n                  repoID={repoID}\n                  path={this.props.path}\n                  dirent={this.state.currentDirent}\n                  currentRepoInfo={this.props.currentRepoInfo}\n                  onFileTagChanged={this.props.onFileTagChanged}\n                  onItemDetailsClose={this.props.closeDirentDetail}\n                  direntDetailPanelTab={this.props.direntDetailPanelTab}\n                />\n              }\n            </div>\n          </Fragment>\n        }\n      </Fragment>\n    );\n  }\n}\n\nLibContentContainer.propTypes = propTypes;\n\nexport default LibContentContainer;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  resumableFile: PropTypes.object.isRequired,\n  onUploadCancel: PropTypes.func.isRequired,\n  onUploadRetry: PropTypes.func.isRequired,\n};\n\nconst UPLOAD_UPLOADING = 'uploading';\nconst UPLOAD_ERROR = 'error';\nconst UPLOAD_ISSAVING = 'isSaving';\nconst UPLOAD_UPLOADED = 'uploaded';\n\nclass UploadListItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      uploadState: UPLOAD_UPLOADING\n    };\n  }\n\n  componentWillReceiveProps(nextProps) {\n    let { resumableFile } = nextProps;\n    let uploadState = UPLOAD_UPLOADING;\n\n    if (resumableFile.error) {\n      uploadState = UPLOAD_ERROR;\n    } else {\n      if (resumableFile.remainingTime === 0 && !resumableFile.isSaved) {\n        uploadState = UPLOAD_ISSAVING;\n      }\n\n      if (resumableFile.isSaved) {\n        uploadState = UPLOAD_UPLOADED;\n      }\n    }\n\n    this.setState({uploadState: uploadState});\n  }\n\n  onUploadCancel = (e) => {\n    e.preventDefault();\n    this.props.onUploadCancel(this.props.resumableFile);\n  }\n\n  onUploadRetry = (e) => {\n    e.preventDefault();\n    this.props.onUploadRetry(this.props.resumableFile);\n  }\n\n  formatFileSize = (size) => {\n    if (typeof size !== 'number') {\n      return '';\n    }\n    if (size >= 1000 * 1000 * 1000) {\n      return (size / (1000 * 1000 * 1000)).toFixed(1) + ' G';\n    }\n    if (size >= 1000 * 1000) {\n      return (size / (1000 * 1000)).toFixed(1) + ' M';\n    }\n    if (size >= 1000) {\n      return (size / 1000).toFixed(1) + ' K';\n    }\n    return size.toFixed(1) + ' B';\n  }\n\n  render() {\n    let { resumableFile } = this.props;\n    let progress = Math.round(resumableFile.progress() * 100);\n    let error = resumableFile.error;\n\n    return (\n      <tr className=\"file-upload-item\">\n        <td className=\"upload-name\">\n          <div className=\"ellipsis\">{resumableFile.newFileName}</div>\n        </td>\n        <td>\n          <span className=\"file-size\">{this.formatFileSize(resumableFile.size)}</span>\n        </td>\n        <td className=\"upload-progress\">\n          {(this.state.uploadState === UPLOAD_UPLOADING || this.state.uploadState === UPLOAD_ISSAVING) &&\n            <Fragment>\n              {resumableFile.size >= (100 * 1000 * 1000) &&\n                <Fragment>\n                  {resumableFile.isUploading() && (\n                    <div className=\"progress-container\">\n                      <div className=\"progress\">\n                        <div className=\"progress-bar\" role=\"progressbar\" style={{width: `${progress}%`}} aria-valuenow={progress} aria-valuemin=\"0\" aria-valuemax=\"100\"></div>\n                      </div>\n                      {(resumableFile.remainingTime === -1) && <div className=\"progress-text\">{gettext('Preparing to upload...')}</div>}\n                      {(resumableFile.remainingTime > 0) && <div className=\"progress-text\">{gettext('Remaining')}{' '}{Utils.formatTime(resumableFile.remainingTime)}</div>}\n                      {(resumableFile.remainingTime === 0) && <div className=\"progress-text\">{gettext('Indexing...')}</div>}\n                    </div>\n                  )}\n                  {!resumableFile.isUploading() && (\n                    <div className=\"progress-container d-flex align-items-center\">\n                      <div className=\"progress\">\n                        <div className=\"progress-bar\" role=\"progressbar\" style={{width: `${progress}%`}} aria-valuenow={progress} aria-valuemin=\"0\" aria-valuemax=\"100\"></div>\n                      </div>\n                    </div>\n                  )}\n                </Fragment>\n              }\n              {(resumableFile.size < (100 * 1000 * 1000)) &&\n                <div className=\"progress-container d-flex align-items-center\">\n                  <div className=\"progress\">\n                    <div className=\"progress-bar\" role=\"progressbar\" style={{width: `${progress}%`}} aria-valuenow={progress} aria-valuemin=\"0\" aria-valuemax=\"100\"></div>\n                  </div>\n                </div>\n              }\n            </Fragment>\n          }\n          {this.state.uploadState === UPLOAD_ERROR && (\n            <div className=\"message err-message ml-0\" dangerouslySetInnerHTML={{__html: error}}></div>\n          )}\n        </td>\n        <td className=\"upload-operation\">\n          <Fragment>\n            {this.state.uploadState === UPLOAD_UPLOADING && (\n              <a href=\"#\" onClick={this.onUploadCancel}>{gettext('Cancel')}</a>\n            )}\n            {this.state.uploadState === UPLOAD_ERROR && (\n              <a href=\"#\" onClick={this.onUploadRetry}>{gettext('Retry')}</a>\n            )}\n            {this.state.uploadState === UPLOAD_ISSAVING && (\n              <span className=\"saving\">{gettext('Saving...')}</span>\n            )}\n            {this.state.uploadState === UPLOAD_UPLOADED && (\n              <span className=\"uploaded\">{gettext('Uploaded')}</span>\n            )}\n          </Fragment>\n        </td>\n      </tr>\n    );\n  }\n}\n\nUploadListItem.propTypes = propTypes;\n\nexport default UploadListItem;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext, maxUploadFileSize } from '../../utils/constants';\n\nconst propTypes = {\n  file: PropTypes.object,\n};\n\nclass ForbidUploadListItem extends React.Component {\n\n  render() {\n    let { file } = this.props;\n    let msg = gettext('Please upload files less than {placeholder}M').replace('{placeholder}', maxUploadFileSize);\n    return (\n      <tr className=\"file-upload-item\">\n        <td className=\"upload-name\">\n          <div className=\"ellipsis\">{file.name}</div>\n        </td>\n\n        <td colSpan={3} className=\"error\">{msg}</td>\n      </tr>\n    );\n  }\n}\n\nForbidUploadListItem.propTypes = propTypes;\n\nexport default ForbidUploadListItem;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport UploadListItem from './upload-list-item';\nimport ForbidUploadListItem from './forbid-upload-list-item';\n\nconst propTypes = {\n  uploadBitrate: PropTypes.number.isRequired,\n  totalProgress: PropTypes.number.isRequired,\n  retryFileList: PropTypes.array.isRequired,\n  uploadFileList: PropTypes.array.isRequired,\n  forbidUploadFileList: PropTypes.array.isRequired,\n  onCloseUploadDialog: PropTypes.func.isRequired,\n  onCancelAllUploading: PropTypes.func.isRequired,\n  onUploadCancel: PropTypes.func.isRequired,\n  onUploadRetry: PropTypes.func.isRequired,\n  onUploadRetryAll: PropTypes.func.isRequired,\n  allFilesUploaded: PropTypes.bool.isRequired,\n};\n\nclass UploadProgressDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isMinimized: false\n    };\n  }\n\n  onCancelAllUploading = () => {\n    this.props.onCancelAllUploading();\n  }\n\n  onMinimizeUpload = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    this.setState({isMinimized: !this.state.isMinimized});\n  }\n\n  onCloseUpload = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    this.props.onCloseUploadDialog();\n  }\n\n  render() {\n\n    let uploadBitrate = Utils.formatBitRate(this.props.uploadBitrate);\n    let uploadedMessage = gettext('File Upload');\n    let uploadingMessage = gettext('File Uploading...') + ' ' + this.props.totalProgress + '%' + ' (' + uploadBitrate + ')';\n\n    let uploadingOptions = (<span className=\"sf2-icon-minus\" onClick={this.onMinimizeUpload}></span>);\n\n    let uploadedOptions = (\n      <Fragment>\n        <span className=\"sf2-icon-minus\" onClick={this.onMinimizeUpload}></span>\n        <span className=\"sf2-icon-x1\" onClick={this.onCloseUpload}></span>\n      </Fragment>\n    );\n\n    let { totalProgress, allFilesUploaded, retryFileList } = this.props;\n\n    return (\n      <div className=\"uploader-list-view\" style={{height: this.state.isMinimized ? '2.25rem' : '20rem'}}>\n        <div className=\"uploader-list-header\">\n          <div className=\"title\">\n            {totalProgress === 100 ? uploadedMessage : uploadingMessage}\n          </div>\n          <div className=\"uploader-options\">\n            {totalProgress === 100 ||  allFilesUploaded ? uploadedOptions : uploadingOptions}\n          </div>\n        </div>\n        <div className=\"uploader-list-content\">\n          <table className=\"table-thead-hidden\">\n            <thead>\n              <tr>\n                <th width=\"35%\">{gettext('name')}</th>\n                <th width=\"15%\">{gettext('size')}</th>\n                <th width=\"35%\">{gettext('progress')}</th>\n                <th width=\"15%\">{gettext('state')}</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr>\n                <td className=\"text-right\" colSpan={3}>\n                  {retryFileList.length > 0 ?\n                    <span className=\"cursor-pointer\" onClick={this.props.onUploadRetryAll}>{gettext('Retry All')}</span>\n                    :\n                    <span className=\"cursor-pointer disabled-link\">{gettext('Retry All')}</span>\n                  }\n                </td>\n                <td className=\"text-right\" colSpan={1}>\n                  {!allFilesUploaded ?\n                    <span className=\"cursor-pointer\" onClick={this.onCancelAllUploading}>{gettext('Cancel All')}</span>\n                    :\n                    <span className=\"cursor-pointer disabled-link\" >{gettext('Cancel All')}</span>\n                  }\n                </td>\n              </tr>\n              {\n                this.props.forbidUploadFileList.map((file, index) => {\n                  return (<ForbidUploadListItem key={index} file={file} />);\n                })\n              }\n              {\n                this.props.uploadFileList.map((resumableFile, index) => {\n                  return (\n                    <UploadListItem\n                      key={index}\n                      resumableFile={resumableFile}\n                      onUploadCancel={this.props.onUploadCancel}\n                      onUploadRetry={this.props.onUploadRetry}\n                    />\n                  );\n                })\n              }\n            </tbody>\n          </table>\n        </div>\n      </div>\n    );\n  }\n}\n\nUploadProgressDialog.propTypes = propTypes;\n\nexport default UploadProgressDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { Modal, ModalHeader, ModalBody, ModalFooter, Button } from 'reactstrap';\n\nconst propTypes = {\n  currentResumableFile: PropTypes.object.isRequired,\n  replaceRepetitionFile: PropTypes.func.isRequired,\n  uploadFile: PropTypes.func.isRequired,\n  cancelFileUpload: PropTypes.func.isRequired,\n};\n\nclass UploadRemindDialog extends React.Component {\n\n  toggle = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    this.props.cancelFileUpload();\n  }\n\n  replaceRepetitionFile = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    this.props.replaceRepetitionFile();\n  }\n\n  uploadFile = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    this.props.uploadFile();\n  }\n\n  render() {\n\n    let title = gettext('Replace file {filename}?');\n    title = title.replace('{filename}', '<span class=\"a-simaulte\">' + this.props.currentResumableFile.fileName + '</span>');\n    return (\n      <Modal isOpen={true} toggle={this.toggle}>\n        <ModalHeader toggle={this.toggle} ><div dangerouslySetInnerHTML={{__html: title}}></div></ModalHeader>\n        <ModalBody>\n          <p>{gettext('A file with the same name already exists in this folder.')}</p>\n          <p>{gettext('Replacing it will overwrite its content.')}</p>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"primary\" onClick={this.replaceRepetitionFile}>{gettext('Replace')}</Button>\n          <Button color=\"primary\" onClick={this.uploadFile}>{gettext('Don\\'t replace')}</Button>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Cancel')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nUploadRemindDialog.propTypes = propTypes;\n\nexport default UploadRemindDialog;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport Resumablejs from '@seafile/resumablejs';\nimport MD5 from 'MD5';\nimport { resumableUploadFileBlockSize, maxUploadFileSize, maxNumberOfFilesForFileupload } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport { gettext } from '../../utils/constants';\nimport UploadProgressDialog from './upload-progress-dialog';\nimport UploadRemindDialog from '../dialog/upload-remind-dialog';\nimport toaster from '../toast';\nimport '../../css/file-uploader.css';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  direntList: PropTypes.array.isRequired,\n  filetypes: PropTypes.array,\n  chunkSize: PropTypes.number,\n  withCredentials: PropTypes.bool,\n  testMethod: PropTypes.string,\n  testChunks: PropTypes.number,\n  simultaneousUploads: PropTypes.number,\n  fileParameterName: PropTypes.string,\n  minFileSizeErrorCallback: PropTypes.func,\n  fileTypeErrorCallback: PropTypes.func,\n  dragAndDrop: PropTypes.bool.isRequired,\n  path: PropTypes.string.isRequired,\n  onFileUploadSuccess: PropTypes.func.isRequired,\n};\n\nclass FileUploader extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      retryFileList: [],\n      uploadFileList: [],\n      forbidUploadFileList: [],\n      totalProgress: 0,\n      isUploadProgressDialogShow: false,\n      isUploadRemindDialogShow: false,\n      currentResumableFile: null,\n      uploadBitrate: 0,\n      allFilesUploaded: false,\n    };\n\n    this.uploadInput = React.createRef();\n\n    this.notifiedFolders = [];\n\n    this.timestamp = null;\n    this.loaded = 0;\n    this.bitrateInterval = 500; // Interval in milliseconds to calculate the bitrate\n    window.onbeforeunload = this.onbeforeunload;\n    this.isUploadLinkLoaded = false;\n  }\n\n  componentDidMount() {\n    this.resumable = new Resumablejs({\n      target: '',\n      query: this.setQuery || {},\n      fileType: this.props.filetypes,\n      maxFiles: maxNumberOfFilesForFileupload || undefined,\n      maxFileSize: maxUploadFileSize * 1000 * 1000 || undefined,\n      testMethod: this.props.testMethod || 'post',\n      testChunks: this.props.testChunks || false,\n      headers: this.setHeaders || {},\n      withCredentials: this.props.withCredentials || false,\n      chunkSize: parseInt(resumableUploadFileBlockSize) * 1024 * 1024 || 1 * 1024 * 1024,\n      simultaneousUploads: this.props.simultaneousUploads || 1,\n      fileParameterName: this.props.fileParameterName,\n      generateUniqueIdentifier: this.generateUniqueIdentifier,\n      forceChunkSize: true,\n      maxChunkRetries: 3,\n      minFileSize: 0,\n    });\n\n    this.resumable.assignBrowse(this.uploadInput.current, true);\n\n    //Enable or Disable DragAnd Drop\n    if (this.props.dragAndDrop === true) {\n      this.resumable.enableDropOnDocument();\n    }\n\n    this.bindCallbackHandler();\n    this.bindEventHandler();\n  }\n\n  componentWillUnmount = () => {\n    window.onbeforeunload = null;\n    if (this.props.dragAndDrop === true) {\n      this.resumable.disableDropOnDocument();\n    }\n  }\n\n  onbeforeunload = () => {\n    if (window.uploader &&\n        window.uploader.isUploadProgressDialogShow &&\n        window.uploader.totalProgress !== 100) {\n      return '';\n    }\n  }\n\n  bindCallbackHandler = () => {\n    let { minFileSizeErrorCallback, fileTypeErrorCallback } = this.props;\n\n    if (this.maxFilesErrorCallback) {\n      this.resumable.opts.maxFilesErrorCallback = this.maxFilesErrorCallback;\n    }\n\n    if (minFileSizeErrorCallback) {\n      this.resumable.opts.minFileSizeErrorCallback = this.props.minFileSizeErrorCallback;\n    }\n\n    if (this.maxFileSizeErrorCallback) {\n      this.resumable.opts.maxFileSizeErrorCallback = this.maxFileSizeErrorCallback;\n    }\n\n    if (fileTypeErrorCallback) {\n      this.resumable.opts.fileTypeErrorCallback = this.props.fileTypeErrorCallback;\n    }\n\n  }\n\n  bindEventHandler = () => {\n    this.resumable.on('chunkingComplete', this.onChunkingComplete.bind(this));\n    this.resumable.on('fileAdded', this.onFileAdded.bind(this));\n    this.resumable.on('filesAddedComplete', this.filesAddedComplete.bind(this));\n    this.resumable.on('fileProgress', this.onFileProgress.bind(this));\n    this.resumable.on('fileSuccess', this.onFileUploadSuccess.bind(this));\n    this.resumable.on('progress', this.onProgress.bind(this));\n    this.resumable.on('complete', this.onComplete.bind(this));\n    this.resumable.on('pause', this.onPause.bind(this));\n    this.resumable.on('fileRetry', this.onFileRetry.bind(this));\n    this.resumable.on('fileError', this.onFileError.bind(this));\n    this.resumable.on('error', this.onError.bind(this));\n    this.resumable.on('beforeCancel', this.onBeforeCancel.bind(this));\n    this.resumable.on('cancel', this.onCancel.bind(this));\n    this.resumable.on('dragstart', this.onDragStart.bind(this));\n  }\n\n  maxFilesErrorCallback = (files, errorCount) => {\n    let maxFiles = maxNumberOfFilesForFileupload;\n    let message = gettext('Please upload no more than {maxFiles} files at a time.');\n    message = message.replace('{maxFiles}', maxFiles);\n    toaster.danger(message);\n  }\n\n  maxFileSizeErrorCallback = (file) => {\n    let { forbidUploadFileList } = this.state;\n    forbidUploadFileList.push(file);\n    this.setState({forbidUploadFileList: forbidUploadFileList});\n  }\n\n  onChunkingComplete = (resumableFile) => {\n\n    let allFilesUploaded = this.state.allFilesUploaded;\n    if (allFilesUploaded === true) {\n      this.setState({allFilesUploaded: false});\n    }\n\n    //get parent_dir relative_path\n    let path = this.props.path === '/' ? '/' : this.props.path + '/';\n    let fileName = resumableFile.fileName;\n    let relativePath = resumableFile.relativePath;\n    let isFile = fileName === relativePath;\n\n    //update formdata\n    resumableFile.formData = {};\n    if (isFile) { // upload file\n      resumableFile.formData  = {\n        parent_dir: path,\n      };\n    } else { // upload folder\n      let relative_path = relativePath.slice(0, relativePath.lastIndexOf('/') + 1);\n      resumableFile.formData  = {\n        parent_dir: path,\n        relative_path: relative_path\n      };\n    }\n  }\n\n  onFileAdded = (resumableFile, files) => {\n    let isFile = resumableFile.fileName === resumableFile.relativePath;\n    // uploading is file and only upload one file\n    if (isFile && files.length === 1) {\n      let hasRepetition = false;\n      let direntList = this.props.direntList;\n      for (let i = 0; i < direntList.length; i++) {\n        if (direntList[i].type === 'file' && direntList[i].name === resumableFile.fileName) {\n          hasRepetition = true;\n          break;\n        }\n      }\n      if (hasRepetition) {\n        this.setState({\n          isUploadRemindDialogShow: true,\n          currentResumableFile: resumableFile,\n        });\n      } else {\n        this.setUploadFileList(this.resumable.files);\n        let { repoID, path } = this.props;\n        seafileAPI.getFileServerUploadLink(repoID, path).then(res => {\n          this.resumable.opts.target = res.data + '?ret-json=1';\n          this.resumableUpload(resumableFile);\n        }).catch(error => {\n          let errMessage = Utils.getErrorMsg(error);\n          toaster.danger(errMessage);\n        });\n      }\n    } else {\n      this.setUploadFileList(this.resumable.files);\n      if (!this.isUploadLinkLoaded) {\n        this.isUploadLinkLoaded = true;\n        let { repoID, path } = this.props;\n        seafileAPI.getFileServerUploadLink(repoID, path).then(res => {\n          this.resumable.opts.target = res.data + '?ret-json=1';\n          this.resumable.upload();\n        }).catch(error => {\n          let errMessage = Utils.getErrorMsg(error);\n          toaster.danger(errMessage);\n        });\n      }\n    }\n  }\n\n  resumableUpload = (resumableFile) => {\n    let { repoID, path } = this.props;\n    seafileAPI.getFileUploadedBytes(repoID, path, resumableFile.fileName).then(res => {\n      let uploadedBytes = res.data.uploadedBytes;\n      let blockSize = parseInt(resumableUploadFileBlockSize) * 1024 * 1024 || 1024 * 1024;\n      let offset = Math.floor(uploadedBytes / blockSize);\n      resumableFile.markChunksCompleted(offset);\n      this.resumable.upload();\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  filesAddedComplete = (resumable, files) => {\n    let { forbidUploadFileList } = this.state;\n    if (forbidUploadFileList.length > 0 && files.length === 0) {\n      this.setState({\n        isUploadProgressDialogShow: true,\n        totalProgress: 100\n      });\n    }\n  }\n\n  setUploadFileList = () => {\n    let uploadFileList = this.resumable.files;\n    this.setState({\n      uploadFileList: uploadFileList,\n      isUploadProgressDialogShow: true,\n    });\n    Utils.registerGlobalVariable('uploader', 'isUploadProgressDialogShow', true);\n  }\n\n  onFileProgress = (resumableFile) => {\n    let uploadBitrate = this.getBitrate();\n    let uploadFileList = this.state.uploadFileList.map(item => {\n      if (item.uniqueIdentifier === resumableFile.uniqueIdentifier) {\n        if (uploadBitrate) {\n          let lastSize = (item.size - (item.size * item.progress())) * 8;\n          let time = Math.floor(lastSize / uploadBitrate);\n          item.remainingTime = time;\n        }\n      }\n      return item;\n    });\n\n    this.setState({\n      uploadBitrate: uploadBitrate,\n      uploadFileList: uploadFileList\n    });\n  }\n\n  getBitrate = () => {\n    let loaded = 0;\n    let uploadBitrate = 0;\n    let now = new Date().getTime();\n\n    this.resumable.files.forEach(file => {\n      loaded += file.progress() * file.size;\n    });\n\n    if (this.timestamp) {\n      let timeDiff = (now - this.timestamp);\n      if (timeDiff < this.bitrateInterval) {\n        return this.state.uploadBitrate;\n      }\n\n      // 1. Cancel will produce loaded greater than this.loaded\n      // 2. reset can make this.loaded to be 0\n      if (loaded < this.loaded || this.loaded === 0) {\n        this.loaded = loaded; //\n      }\n\n      uploadBitrate = (loaded - this.loaded) * (1000 / timeDiff) * 8;\n    }\n\n    this.timestamp = now;\n    this.loaded = loaded;\n\n    return uploadBitrate;\n  }\n\n  onProgress = () => {\n    let progress = Math.round(this.resumable.progress() * 100);\n    this.setState({totalProgress: progress});\n    Utils.registerGlobalVariable('uploader', 'totalProgress', progress);\n  }\n\n  onFileUploadSuccess = (resumableFile, message) => {\n    let formData = resumableFile.formData;\n    let currentTime = new Date().getTime()/1000;\n    message = formData.replace ? message : JSON.parse(message)[0];\n    if (formData.relative_path) { // upload folder\n      let relative_path = formData.relative_path;\n      let dir_name = relative_path.slice(0, relative_path.indexOf('/'));\n      let dirent = {\n        id: message.id,\n        name: dir_name,\n        type: 'dir',\n        mtime: currentTime,\n      };\n\n      // update folders cache\n      let isExist = this.notifiedFolders.some(item => {return item.name === dirent.name;});\n      if (!isExist) {\n        this.notifiedFolders.push(dirent);\n        this.props.onFileUploadSuccess(dirent);\n      }\n\n      // update uploadFileList\n      let uploadFileList = this.state.uploadFileList.map(item => {\n        if (item.uniqueIdentifier === resumableFile.uniqueIdentifier) {\n          item.newFileName = relative_path + message.name;\n          item.isSaved = true;\n        }\n        return item;\n      });\n      this.setState({uploadFileList: uploadFileList});\n\n      return;\n    }\n\n    if (formData.replace) { // upload file -- replace exist file\n      let fileName = resumableFile.fileName;\n      let dirent = {\n        id: message,\n        name: fileName,\n        type: 'file',\n        mtime: currentTime\n      };\n      this.props.onFileUploadSuccess(dirent); // this contance: just one file\n\n      let uploadFileList = this.state.uploadFileList.map(item => {\n        if (item.uniqueIdentifier === resumableFile.uniqueIdentifier) {\n          item.newFileName = fileName;\n          item.isSaved = true;\n        }\n        return item;\n      });\n      this.setState({uploadFileList: uploadFileList});\n\n      return;\n    }\n\n    // upload file -- add files\n    let dirent = {\n      id: message.id,\n      type: 'file',\n      name: message.name,\n      size: message.size,\n      mtime: currentTime,\n    };\n    this.props.onFileUploadSuccess(dirent); // this contance:  no repetition file\n\n    let uploadFileList = this.state.uploadFileList.map(item => {\n      if (item.uniqueIdentifier === resumableFile.uniqueIdentifier) {\n        item.newFileName = message.name;\n        item.isSaved = true;\n      }\n      return item;\n    });\n    this.setState({uploadFileList: uploadFileList});\n  }\n\n  getFileServerErrorMessage = (key) => {\n    const errorMessage = {\n      'File locked by others.': gettext('File is locked by others.'),       // 403\n      'Invalid filename.': gettext('Invalid filename.'),                    // 440\n      'File already exists.': gettext('File already exists.'),              // 441\n      'File size is too large.': gettext('File size is too large.'),        // 442\n      'Out of quota.': gettext('Out of quota.'),                            // 443\n      'Internal error.': gettext('Internal Server Error'),                  // 500\n    }\n    return errorMessage[key] || key;\n  }\n\n  onFileError = (resumableFile, message) => {\n    let error = '';\n    if (!message) {\n      error = gettext('Network error');\n    } else {\n      // eg: '{\"error\": \"Internal error\" \\n }'\n      let errorMessage = message.replace(/\\n/g, '');\n      errorMessage  = JSON.parse(errorMessage);\n      error = this.getFileServerErrorMessage(errorMessage.error);\n    }\n\n    let uploadFileList = this.state.uploadFileList.map(item => {\n      if (item.uniqueIdentifier === resumableFile.uniqueIdentifier) {\n        this.state.retryFileList.push(item);\n        item.error = error;\n      }\n      return item;\n    });\n\n    this.loaded = 0;  // reset loaded data;\n    this.setState({\n      retryFileList: this.state.retryFileList,\n      uploadFileList: uploadFileList\n    });\n\n  }\n\n  onComplete = () => {\n    this.notifiedFolders = [];\n    // reset upload link loaded\n    this.isUploadLinkLoaded = false;\n    this.setState({allFilesUploaded: true});\n  }\n\n  onPause = () => {\n\n  }\n\n  onError = (message) => {\n    // reset upload link loaded\n    this.isUploadLinkLoaded = false;\n    // After the error, the user can switch windows\n    Utils.registerGlobalVariable('uploader', 'totalProgress', 100);\n  }\n\n  onFileRetry = () => {\n    // todo, cancel upload file, uploded again;\n  }\n\n  onBeforeCancel = () => {\n    // todo, giving a pop message ?\n  }\n\n  onCancel = () => {\n\n  }\n\n  setHeaders = (resumableFile, resumable) => {\n    let offset = resumable.offset;\n    let chunkSize = resumable.getOpt('chunkSize');\n    let fileSize = resumableFile.size === 0 ? 1 : resumableFile.size;\n    let startByte = offset !== 0 ? offset * chunkSize : 0;\n    let endByte = Math.min(fileSize, (offset + 1) * chunkSize) - 1;\n\n    if (fileSize - resumable.endByte < chunkSize && !resumable.getOpt('forceChunkSize')) {\n      endByte = fileSize;\n    }\n\n    let headers = {\n      'Accept': 'application/json; text/javascript, */*; q=0.01',\n      'Content-Disposition': 'attachment; filename=\"' + encodeURI(resumableFile.fileName) + '\"',\n      'Content-Range': 'bytes ' + startByte + '-' + endByte + '/' + fileSize,\n    };\n\n    return headers;\n  }\n\n  setQuery = (resumableFile) => {\n    let formData = resumableFile.formData;\n    return formData;\n  }\n\n  generateUniqueIdentifier = (file) => {\n    let relativePath = file.webkitRelativePath||file.relativePath||file.fileName||file.name;\n    return MD5(relativePath + new Date()) + relativePath;\n  }\n\n  onClick = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    e.stopPropagation();\n  }\n\n  onFileUpload = () => {\n    this.uploadInput.current.removeAttribute('webkitdirectory');\n\n    this.uploadInput.current.click();\n  }\n\n  onFolderUpload = () => {\n    this.uploadInput.current.setAttribute('webkitdirectory', 'webkitdirectory');\n    this.uploadInput.current.click();\n  }\n\n  onDragStart = () => {\n    this.uploadInput.current.setAttribute('webkitdirectory', 'webkitdirectory');\n  }\n\n  onCloseUploadDialog = () => {\n    this.loaded = 0;\n    this.resumable.files = [];\n    // reset upload link loaded\n    this.isUploadLinkLoaded = false;\n    this.setState({isUploadProgressDialogShow: false, uploadFileList: [], forbidUploadFileList: []});\n    Utils.registerGlobalVariable('uploader', 'isUploadProgressDialogShow', false);\n  }\n\n  onUploadCancel = (uploadingItem) => {\n\n    let uploadFileList = this.state.uploadFileList.filter(item => {\n      if (item.uniqueIdentifier === uploadingItem.uniqueIdentifier) {\n        item.cancel(); // execute cancel function will delete the file at the same time\n        return false;\n      }\n      return true;\n    });\n\n    if (!this.resumable.isUploading()) {\n      this.setState({\n        totalProgress: '100',\n        allFilesUploaded: true,\n      });\n      this.loaded = 0;\n    }\n\n    this.setState({uploadFileList: uploadFileList});\n  }\n\n  onCancelAllUploading = () => {\n    let uploadFileList = this.state.uploadFileList.filter(item => {\n      if (Math.round(item.progress() !== 1)) {\n        item.cancel();\n        return false;\n      }\n      return true;\n    });\n\n    this.loaded = 0;\n\n    this.setState({\n      allFilesUploaded: true,\n      totalProgress: '100',\n      uploadFileList: uploadFileList\n    });\n    // reset upload link loaded\n    this.isUploadLinkLoaded = false;\n  }\n\n  onUploadRetry = (resumableFile) => {\n\n    seafileAPI.getFileServerUploadLink(this.props.repoID, this.props.path).then(res => {\n      this.resumable.opts.target = res.data + '?ret-json=1';\n\n      let retryFileList = this.state.retryFileList.filter(item => {\n        return item.uniqueIdentifier !== resumableFile.uniqueIdentifier;\n      });\n      let uploadFileList = this.state.uploadFileList.map(item => {\n        if (item.uniqueIdentifier === resumableFile.uniqueIdentifier) {\n          item.error = null;\n          this.retryUploadFile(item);\n        }\n        return item;\n      });\n\n      this.setState({\n        retryFileList: retryFileList,\n        uploadFileList: uploadFileList\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onUploadRetryAll = () => {\n\n    seafileAPI.getFileServerUploadLink(this.props.repoID, this.props.path).then(res => {\n      this.resumable.opts.target = res.data + '?ret-json=1';\n      this.state.retryFileList.forEach(item => {\n        item.error = false;\n        this.retryUploadFile(item);\n      });\n\n      let uploadFileList = this.state.uploadFileList.slice(0);\n      this.setState({\n        retryFileList: [],\n        uploadFileList: uploadFileList\n      });\n\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  retryUploadFile = (resumableFile) => {\n    let { repoID, path } = this.props;\n    let fileName = resumableFile.fileName;\n    let isFile = resumableFile.fileName === resumableFile.relativePath;\n    if (!isFile) {\n      let relative_path = resumableFile.formData.relative_path;\n      let prefix = path === '/' ? (path + relative_path) : (path + '/' + relative_path);\n      fileName = prefix + fileName;\n    }\n\n    resumableFile.bootstrap();\n    var firedRetry = false;\n    resumableFile.resumableObj.on('chunkingComplete', () => {\n      if(!firedRetry) {\n        seafileAPI.getFileUploadedBytes(repoID, path, fileName).then(res => {\n          let uploadedBytes = res.data.uploadedBytes;\n          let blockSize = parseInt(resumableUploadFileBlockSize) * 1024 * 1024 || 1024 * 1024;\n          let offset = Math.floor(uploadedBytes / blockSize);\n          resumableFile.markChunksCompleted(offset);\n\n          resumableFile.resumableObj.upload();\n\n        }).catch(error => {\n          let errMessage = Utils.getErrorMsg(error);\n          toaster.danger(errMessage);\n        });\n      }\n      firedRetry = true;\n    });\n\n  }\n\n  replaceRepetitionFile = () => {\n    let { repoID, path } = this.props;\n    seafileAPI.getUpdateLink(repoID, path).then(res => {\n      this.resumable.opts.target = res.data;\n\n      let resumableFile = this.resumable.files[this.resumable.files.length - 1];\n      resumableFile.formData['replace'] = 1;\n      resumableFile.formData['target_file'] = resumableFile.formData.parent_dir + resumableFile.fileName;\n      this.setState({isUploadRemindDialogShow: false});\n      this.setUploadFileList(this.resumable.files);\n      this.resumable.upload();\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  uploadFile = () => {\n    let resumableFile = this.resumable.files[this.resumable.files.length - 1];\n    let { repoID, path } = this.props;\n    seafileAPI.getFileServerUploadLink(repoID, path).then((res) => {  // get upload link\n      this.resumable.opts.target = res.data + '?ret-json=1';\n      this.setState({\n        isUploadRemindDialogShow: false,\n        isUploadProgressDialogShow: true,\n        uploadFileList: [...this.state.uploadFileList, resumableFile]\n      }, () => {\n        this.resumable.upload();\n      });\n      Utils.registerGlobalVariable('uploader', 'isUploadProgressDialogShow', true);\n\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  cancelFileUpload = () => {\n    this.resumable.files.pop(); //delete latest file；\n    this.setState({isUploadRemindDialogShow: false});\n  }\n\n  render() {\n    return (\n      <Fragment>\n        <div className=\"file-uploader-container\">\n          <div className=\"file-uploader\">\n            <input className=\"upload-input\" type=\"file\" ref={this.uploadInput} onClick={this.onClick}/>\n          </div>\n        </div>\n        {this.state.isUploadRemindDialogShow &&\n          <UploadRemindDialog\n            currentResumableFile={this.state.currentResumableFile}\n            replaceRepetitionFile={this.replaceRepetitionFile}\n            uploadFile={this.uploadFile}\n            cancelFileUpload={this.cancelFileUpload}\n          />\n        }\n        {this.state.isUploadProgressDialogShow &&\n          <UploadProgressDialog\n            retryFileList={this.state.retryFileList}\n            uploadFileList={this.state.uploadFileList}\n            forbidUploadFileList={this.state.forbidUploadFileList}\n            totalProgress={this.state.totalProgress}\n            uploadBitrate={this.state.uploadBitrate}\n            allFilesUploaded={this.state.allFilesUploaded}\n            onCloseUploadDialog={this.onCloseUploadDialog}\n            onCancelAllUploading={this.onCancelAllUploading}\n            onUploadCancel={this.onUploadCancel}\n            onUploadRetry={this.onUploadRetry}\n            onUploadRetryAll={this.onUploadRetryAll}\n          />\n        }\n      </Fragment>\n    );\n  }\n}\n\nFileUploader.propTypes = propTypes;\n\nexport default FileUploader;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalHeader, ModalBody } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\n\nconst propTypes = {\n  type: PropTypes.oneOf(['move', 'copy']).isRequired,\n  asyncOperatedFilesLength: PropTypes.number.isRequired,\n  asyncOperationProgress: PropTypes.oneOfType([PropTypes.string, PropTypes.number]).isRequired,\n  toggleDialog: PropTypes.func.isRequired,\n};\n\nclass CopyMoveDirentProgressDialog extends React.Component {\n\n  render() {\n\n    let { type , asyncOperationProgress, asyncOperatedFilesLength } = this.props;\n    let title = type === 'move' ? gettext('Move {num} items') : gettext('Copy {num} items');\n    title = title.replace('{num}', asyncOperatedFilesLength);\n    let progressStyle = {\n      width: asyncOperationProgress + '%',\n      lineHeight: '40px',\n      textAlign: 'left',\n    };\n    return (\n      <Modal isOpen={true}>\n        <ModalHeader toggle={this.props.toggleDialog}>{title}</ModalHeader>\n        <ModalBody style={{minHeight: '80px'}}>\n          <div className=\"progress\" style={{height: '40px'}}>\n            <div\n              className=\"progress-bar pl-2\"\n              role=\"progressbar\"\n              style={progressStyle}\n              aria-valuenow={asyncOperationProgress}\n              aria-valuemin=\"0\"\n              aria-valuemax=\"100\"\n            >\n              {asyncOperationProgress + '%'}\n            </div>\n          </div>\n        </ModalBody>\n      </Modal>\n    );\n  }\n}\n\nCopyMoveDirentProgressDialog.propTypes = propTypes;\n\nexport default CopyMoveDirentProgressDialog;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport cookie from 'react-cookies';\nimport moment from 'moment';\nimport { gettext, siteRoot, username, isDocs } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport collabServer from '../../utils/collab-server';\nimport Dirent from '../../models/dirent';\nimport FileTag from '../../models/file-tag';\nimport RepoTag from '../../models/repo-tag';\nimport RepoInfo from '../../models/repo-info';\nimport TreeNode from '../../components/tree-view/tree-node';\nimport treeHelper from '../../components/tree-view/tree-helper';\nimport toaster from '../../components/toast';\nimport ModalPortal from '../../components/modal-portal';\nimport LibDecryptDialog from '../../components/dialog/lib-decrypt-dialog';\nimport LibContentToolbar from './lib-content-toolbar';\nimport LibContentContainer from './lib-content-container';\nimport FileUploader from '../../components/file-uploader/file-uploader';\nimport CopyMoveDirentProgressDialog from '../../components/dialog/copy-move-dirent-progress-dialog';\n\nconst propTypes = {\n  pathPrefix: PropTypes.array.isRequired,\n  onTabNavClick: PropTypes.func.isRequired,\n  onMenuClick: PropTypes.func.isRequired,\n  repoID: PropTypes.string,\n};\n\nclass LibContentView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      currentMode: cookie.load('seafile_view_mode') || 'list',\n      path: '',\n      pathExist: true,\n      isViewFile: false,\n      hash: '',\n      currentRepoInfo: null,\n      repoName: '',\n      repoPermission: true,\n      repoEncrypted: false,\n      libNeedDecrypt: false,\n      isGroupOwnedRepo: false,\n      userPerm: '',\n      selectedDirentList: [],\n      isDraft: false,\n      hasDraft: false,\n      fileTags: [],\n      relatedFiles: [],\n      draftID: '',\n      draftCounts: 0,\n      usedRepoTags: [],\n      readmeMarkdown: null,\n      isTreeDataLoading: true,\n      treeData: treeHelper.buildTree(),\n      currentNode: null,\n      isFileLoading: true,\n      isFileLoadedErr: false,\n      filePermission: '',\n      content: '',\n      lastModified: '',\n      latestContributor: '',\n      isDirentListLoading: true,\n      direntList: [],\n      isDirentSelected: false,\n      sortBy: cookie.load('seafile-repo-dir-sort-by') || 'name', // 'name' or 'time' or 'size'\n      sortOrder: cookie.load('seafile-repo-dir-sort-order') || 'asc', // 'asc' or 'desc'\n      isAllDirentSelected: false,\n      dirID: '',  // for update dir list\n      errorMsg: '',\n      isDirentDetailShow: false,\n      direntDetailPanelTab: '',\n      updateDetail: false,\n      itemsShowLength: 100,\n      isSessionExpired: false,\n      isCopyMoveProgressDialogShow: false,\n      asyncCopyMoveTaskId: '',\n      asyncOperationType: 'move',\n      asyncOperationProgress: 0,\n      asyncOperatedFilesLength: 0,\n    };\n\n    this.oldonpopstate = window.onpopstate;\n    window.onpopstate = this.onpopstate;\n    this.lastModifyTime = new Date();\n    this.isNeedUpdateHistoryState = true; // Load, refresh page, switch mode for the first time, no need to set historyState\n    this.currentMoveItemName = '';\n    this.currentMoveItemPath = '';\n  }\n\n  showDirentDetail = (direntDetailPanelTab) => {\n    if (direntDetailPanelTab) {\n      this.setState({ direntDetailPanelTab: direntDetailPanelTab }, () => {\n        this.setState({ isDirentDetailShow: true });\n      });\n    } else {\n      this.setState({\n        direntDetailPanelTab: '',\n        isDirentDetailShow: true\n      });\n    }\n  }\n\n  toggleDirentDetail = () => {\n    this.setState({\n      direntDetailPanelTab: '',\n      isDirentDetailShow: !this.state.isDirentDetailShow\n    });\n  }\n\n  closeDirentDetail = () => {\n    this.setState({\n      isDirentDetailShow: false,\n      direntDetailPanelTab: '',\n    });\n  }\n\n  componentWillMount() {\n    const hash = window.location.hash;\n    if (hash.slice(0, 1) === '#') {\n      this.setState({hash: hash});\n    }\n  }\n\n  componentDidMount() {\n    // eg: http://127.0.0.1:8000/library/repo_id/repo_name/**/**/\\\n    let repoID = this.props.repoID;\n    let location = window.location.href.split('#')[0];\n    location = decodeURIComponent(location);\n    seafileAPI.getRepoInfo(repoID).then(res => {\n      let repoInfo = new RepoInfo(res.data);\n      let isGroupOwnedRepo = repoInfo.owner_email.indexOf('@seafile_group') > -1;\n      this.setState({\n        currentRepoInfo: repoInfo,\n        repoName: repoInfo.repo_name,\n        libNeedDecrypt: repoInfo.lib_need_decrypt,\n        repoEncrypted: repoInfo.encrypted,\n        repoPermission: repoInfo.permission === 'rw',\n        isGroupOwnedRepo: isGroupOwnedRepo,\n      });\n\n      let repoID = repoInfo.repo_id;\n      let path = location.slice(location.indexOf(repoID) + repoID.length + 1); // get the string after repoID\n      path = path.slice(path.indexOf('/')); // get current path\n\n      this.isNeedUpdateHistoryState = false;\n\n      this.setState({path: path});\n\n      if (!repoInfo.lib_need_decrypt) {\n        this.loadDirData(path);\n      }\n    }).catch(error => {\n      if (error.response) {\n        if (error.response.status == 403) {\n          this.setState({\n            isDirentListLoading: false,\n            errorMsg: gettext('Permission denied')\n          });\n\n          let errorMsg = gettext('Permission denied');\n          toaster.danger(errorMsg);\n        } else {\n          this.setState({\n            isDirentListLoading: false,\n            errorMsg: gettext('Error')\n          });\n        }\n      } else {\n        this.setState({\n          isDirentListLoading: false,\n          errorMsg: gettext('Please check the network.')\n        });\n      }\n    });\n  }\n\n  componentWillUnmount() {\n    window.onpopstate = this.oldonpopstate;\n    collabServer.unwatchRepo(this.props.repoID, this.onRepoUpdateEvent);\n  }\n\n  componentDidUpdate() {\n    this.lastModifyTime = new Date();\n  }\n\n  onpopstate = (event) => {\n    if (event.state && event.state.key) { // root path\n      if (this.state.path === '/') {\n        return;\n      } else {\n        let path = '/';\n        this.loadDirentList(path);\n        this.setState({\n          path: path,\n          isViewFile: false\n        });\n      }\n    } else if (event.state && event.state.path) { // file path\n      let path = event.state.path;\n      if (this.state.currentMode === 'column') {\n        if (Utils.isMarkdownFile(path)) { // Judging not strict\n          this.showFile(path);\n          return;\n        }\n      }\n      this.loadDirentList(path);\n      this.setState({\n        path: path,\n        isViewFile: false\n      });\n    }\n  }\n\n  onRepoUpdateEvent = () => {\n    let currentTime = new Date();\n    if ((parseFloat(currentTime - this.lastModifyTime)/1000) <= 5) {\n      return;\n    }\n    let repoID = this.props.repoID;\n    let { path, dirID } = this.state;\n\n    if (this.state.currentMode === 'column') {\n      if (this.state.isViewFile) {\n        this.updataColumnMarkdownData(path);\n      } else {\n        seafileAPI.dirMetaData(repoID, path).then((res) => {\n          if (res.data.id !== dirID) {\n            this.loadDirentList(path);\n          }\n        }).catch(error => {\n          let errMessage = Utils.getErrorMsg(error);\n          toaster.danger(errMessage);\n        });\n      }\n    } else {\n      seafileAPI.dirMetaData(repoID, path).then((res) => {\n        if (res.data.id !== dirID) {\n          this.loadDirentList(path);\n        }\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    }\n  }\n\n  updateUsedRepoTags = () => {\n    let repoID = this.props.repoID;\n    seafileAPI.listRepoTags(repoID).then(res => {\n      let usedRepoTags = [];\n      res.data.repo_tags.forEach(item => {\n        let usedRepoTag = new RepoTag(item);\n        if (usedRepoTag.fileCount > 0) {\n          usedRepoTags.push(usedRepoTag);\n        }\n      });\n      this.setState({usedRepoTags: usedRepoTags});\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  updateReadmeMarkdown = (direntList) => {\n    this.setState({readmeMarkdown: null});\n    direntList.some(item => {\n      let fileName = item.name.toLowerCase();\n      if (fileName === 'readme.md' || fileName === 'readme.markdown') {\n        this.setState({readmeMarkdown: item});\n        return true;\n      }\n    });\n  }\n\n  updataColumnMarkdownData = (filePath) => {\n    let repoID = this.props.repoID;\n    // update state\n    this.setState({\n      path: filePath,\n      isViewFile: true\n    });\n\n    // update data\n    seafileAPI.getFileInfo(repoID, filePath).then((res) => {\n      let { mtime, permission, last_modifier_name, is_draft, has_draft, draft_id } = res.data;\n      seafileAPI.getFileDownloadLink(repoID, filePath).then((res) => {\n        seafileAPI.getFileContent(res.data).then((res) => {\n          if (this.state.content !== res.data) {\n            this.setState({isFileLoading: true});\n          }\n          this.setState({\n            content: res.data,\n            filePermission: permission,\n            latestContributor: last_modifier_name,\n            lastModified: moment.unix(mtime).fromNow(),\n            isFileLoading: false,\n            isFileLoadedErr: false,\n            isDraft: is_draft,\n            hasDraft: has_draft,\n            draftID: draft_id\n          });\n        });\n      });\n    }).catch(() => {\n      this.setState({\n        isFileLoading: false,\n        isFileLoadedErr: true,\n      });\n    });\n  }\n\n  // load data\n  loadDirData = (path) => {\n    let repoID = this.props.repoID;\n\n    // listen current repo\n    collabServer.watchRepo(repoID, this.onRepoUpdateEvent);\n\n    // list used FileTags\n    this.updateUsedRepoTags();\n\n    // list draft counts and revierw counts\n    if (isDocs) {\n      seafileAPI.getRepoDraftCounts(repoID).then(res => {\n        this.setState({\n          draftCounts: res.data.draft_counts,\n        });\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    }\n\n    if (Utils.isMarkdownFile(path)) {\n      seafileAPI.getFileInfo(this.props.repoID, path).then(() => {\n        if (this.state.currentMode !== 'column') {\n          cookie.save('seafile_view_mode', 'column');\n          this.setState({currentMode: 'column'});\n        }\n        this.loadSidePanel(path);\n        this.showFile(path);\n      }).catch(() => {\n        if (this.state.currentMode === 'column') { // After an error occurs, follow dir\n          this.loadSidePanel(path);\n          this.showDir(path);\n        } else {\n          this.showDir(path);\n        }\n      });\n    } else {\n      if (this.state.currentMode === 'column') {\n        this.loadSidePanel(path);\n        this.showDir(path);\n      } else {\n        this.showDir(path);\n      }\n    }\n  }\n\n  loadSidePanel = (path) => {\n    let repoID = this.props.repoID;\n    if (path === '/') {\n      seafileAPI.listDir(repoID, '/').then(res => {\n        let tree = this.state.treeData;\n        this.addResponseListToNode(res.data.dirent_list, tree.root);\n        this.setState({\n          isTreeDataLoading: false,\n          treeData: tree\n        });\n      }).catch(() => {\n        this.setState({isTreeDataLoading: false});\n      });\n    } else {\n      this.loadNodeAndParentsByPath(path);\n    }\n  }\n\n  showDir = (path) => {\n    let repoID = this.props.repoID;\n\n    if (!this.state.isSessionExpired) {\n      // update stste\n      this.setState({\n        isDirentListLoading: true,\n        isViewFile: false,\n        selectedDirentList: [],\n      });\n    }\n\n    // update data\n    this.loadDirentList(path);\n    this.resetShowLength();\n\n    if (!this.isNeedUpdateHistoryState) {\n      this.isNeedUpdateHistoryState = true;\n      return;\n    }\n    // update location\n    let repoInfo = this.state.currentRepoInfo;\n    let url = siteRoot + 'library/' + repoID + '/' + encodeURIComponent(repoInfo.repo_name) + Utils.encodePath(path);\n    window.history.pushState({url: url, path: path}, path, url);\n  }\n\n  showFile = (filePath) => {\n    let repoID = this.props.repoID;\n\n    if (this.state.currentMode === 'column') {\n      seafileAPI.listFileTags(repoID, filePath).then(res => {\n        let fileTags = res.data.file_tags.map(item => {\n          return new FileTag(item);\n        });\n        this.setState({fileTags: fileTags});\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n\n      seafileAPI.listRelatedFiles(repoID, filePath).then(res => {\n        let relatedFiles = res.data.related_files.map((relatedFile) => {\n          return relatedFile;\n        });\n        this.setState({relatedFiles: relatedFiles});\n      }).catch((error) => {\n        if (error.response.status === 500) {\n          this.setState({relatedFiles: []});\n        }\n      });\n    }\n\n    // update state\n    this.setState({\n      isFileLoading: true,\n      path: filePath,\n      isViewFile: true\n    });\n\n    // update data\n    seafileAPI.getFileInfo(repoID, filePath).then((res) => {\n      let { mtime, permission, last_modifier_name, is_draft, has_draft, draft_id } = res.data;\n      seafileAPI.getFileDownloadLink(repoID, filePath).then((res) => {\n        seafileAPI.getFileContent(res.data).then((res) => {\n          this.setState({\n            content: res.data,\n            filePermission: permission,\n            latestContributor: last_modifier_name,\n            lastModified: moment.unix(mtime).fromNow(),\n            isFileLoading: false,\n            isFileLoadedErr: false,\n            isDraft: is_draft,\n            hasDraft: has_draft,\n            draftID: draft_id\n          });\n        });\n      });\n    }).catch((err) => {\n      let errMsg = Utils.getErrorMsg(err, true);\n      if (!err.response || err.response.status !== 403) {\n        toaster.danger(errMsg);\n      }\n      this.setState({\n        isFileLoading: false,\n        isFileLoadedErr: true,\n      });\n    });\n\n    // update location\n    let repoInfo = this.state.currentRepoInfo;\n    let url = siteRoot + 'library/' + repoID + '/' + encodeURIComponent(repoInfo.repo_name) + Utils.encodePath(filePath);\n    window.history.pushState({url: url, path: filePath}, filePath, url);\n  }\n\n  loadDirentList = (path) => {\n    let repoID = this.props.repoID;\n    seafileAPI.listDir(repoID, path, {'with_thumbnail': true}).then(res => {\n      let direntList = [];\n      let markdownItem = null;\n      res.data.dirent_list.forEach(item => {\n        let fileName = item.name.toLowerCase();\n        if (fileName === 'readme.md' || fileName === 'readme.markdown') {\n          markdownItem = item;\n        }\n        let dirent = new Dirent(item);\n        direntList.push(dirent);\n      });\n\n      this.setState({\n        pathExist: true,\n        userPerm: res.data.user_perm,\n        isDirentListLoading: false,\n        direntList: Utils.sortDirents(direntList, this.state.sortBy, this.state.sortOrder),\n        dirID: res.data.dir_id,\n        readmeMarkdown: markdownItem,\n        path: path,\n        isSessionExpired: false,\n      });\n\n      if (!this.state.repoEncrypted && direntList.length) {\n        this.getThumbnails(repoID, path, this.state.direntList);\n      }\n    }).catch((err) => {\n      Utils.getErrorMsg(err, true);\n      if (err.response && err.response.status === 403) {\n        this.setState({isDirentListLoading: false});\n        return;\n      }\n      this.setState({\n        isDirentListLoading: false,\n        pathExist: false,\n      });\n    });\n  }\n\n  onListContainerScroll = () => {\n    let itemsShowLength = this.state.itemsShowLength + 100;\n    this.setState({itemsShowLength: itemsShowLength});\n  }\n\n  resetShowLength = () => {\n    this.setState({itemsShowLength: 100});\n  }\n\n  getThumbnails = (repoID, path, direntList) => {\n    let items = direntList.filter((item) => {\n      return Utils.imageCheck(item.name) && !item.encoded_thumbnail_src;\n    });\n    if (items.length == 0) {\n      return ;\n    }\n\n    const _this = this;\n    const len = items.length;\n    const thumbnailSize = 48;\n    let getThumbnail = (i) => {\n      const curItem = items[i];\n      const curItemPath = [path, curItem.name].join('/');\n      seafileAPI.createThumbnail(repoID, curItemPath, thumbnailSize).then((res) => {\n        curItem.encoded_thumbnail_src = res.data.encoded_thumbnail_src;\n      }).catch((error) => {\n        // do nothing\n      }).then(() => {\n        if (i < len - 1) {\n          getThumbnail(++i);\n        } else {\n          _this.setState({\n            direntList: direntList\n          });\n        }\n      });\n    };\n    getThumbnail(0);\n  }\n\n  updateMoveCopyTreeNode = (path) => {\n    let repoID = this.props.repoID;\n\n    let tree = this.state.treeData.clone();\n    let node = tree.getNodeByPath(path);\n\n    let nodeChildren = node.children.map(item => item.object);\n    let nodeChildrenNames = nodeChildren.map(item => item.name);\n\n    seafileAPI.listDir(repoID, path).then(res => {\n      let newDirentList = res.data.dirent_list;\n      let newAddedDirents = newDirentList.filter(item => {\n        return !nodeChildrenNames.includes(item.name);\n      });\n      newAddedDirents.map(item => {\n        this.addNodeToTree(item.name, path, item.type);\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  async getAsyncCopyMoveProgress() {\n    let { asyncOperationType, asyncCopyMoveTaskId } = this.state;\n    try {\n      let res = await seafileAPI.queryAsyncOperationProgress(asyncCopyMoveTaskId);\n      let data = res.data;\n      if (data.failed) {\n        let message = gettext('Failed to move files to another library.');\n        if (asyncOperationType === 'copy') {\n          message = gettext('Failed to copy files to another library.');\n        }\n        toaster.danger(message);\n        this.setState({\n          asyncOperationProgress: 0,\n          isCopyMoveProgressDialogShow: false,\n        });\n        return;\n      }\n\n      if (data.successful) {\n        if (asyncOperationType === 'move') {\n          if (this.currentMoveItemName && this.currentMoveItemPath) {\n            if (this.state.currentMode === 'column') {\n              this.deleteTreeNode(this.currentMoveItemPath);\n            }\n            this.moveDirent(this.currentMoveItemName);\n            this.currentMoveItemName = '';\n            this.currentMoveItemPath = '';\n          } else {\n            if (this.state.currentMode === 'column') {\n              let direntPaths = this.getSelectedDirentPaths();\n              this.deleteTreeNodes(direntPaths);\n            }\n            let direntNames = this.getSelectedDirentNames();\n            this.moveDirents(direntNames);\n          }\n        }\n\n        this.setState({isCopyMoveProgressDialogShow: false});\n        let message = gettext('Successfully moved files to another library.');\n        if (asyncOperationType === 'copy') {\n          message = gettext('Successfully copied files to another library.');\n        }\n        toaster.success(message);\n        return;\n      }\n      // init state: total is 0\n      let asyncOperationProgress = !data.total ? 0 : parseInt((data.done/data.total * 100).toFixed(2));\n\n      this.getAsyncCopyMoveProgress();\n      this.setState({asyncOperationProgress: asyncOperationProgress});\n    } catch (error) {\n      this.setState({\n        asyncOperationProgress: 0,\n        isCopyMoveProgressDialogShow: false,\n      });\n    }\n  }\n\n  cancelCopyMoveDirent = () => {\n    let taskId = this.state.asyncCopyMoveTaskId;\n    seafileAPI.cancelCopyMoveOperation(taskId);\n\n    this.currentMoveItemName = '';\n    this.currentMoveItemPath = '';\n    let direntList = this.state.direntList;\n    this.setState({direntList: direntList.slice(0)});\n  }\n\n  onMoveProgressDialogToggle = () => {\n    let { asyncOperationProgress } = this.state;\n    if (asyncOperationProgress !== 100) {\n      this.cancelCopyMoveDirent();\n    }\n\n    this.setState({\n      asyncOperationProgress: 0,\n      isCopyMoveProgressDialogShow: false,\n    });\n  }\n\n  // toolbar operations\n  onMoveItems = (destRepo, destDirentPath) => {\n    let repoID = this.props.repoID;\n    let selectedDirentList = this.state.selectedDirentList;\n    if (repoID !== destRepo.repo_id) {\n      this.setState(() => ({\n        asyncOperatedFilesLength: selectedDirentList.length,\n        asyncOperationProgress: 0,\n        asyncOperationType: 'move',\n        isCopyMoveProgressDialogShow: true\n      }));\n    }\n\n    let dirNames = this.getSelectedDirentNames();\n    let direntPaths = this.getSelectedDirentPaths();\n    seafileAPI.moveDir(repoID, destRepo.repo_id, destDirentPath, this.state.path, dirNames).then(res => {\n      if (repoID !== destRepo.repo_id) {\n        this.setState({\n          asyncCopyMoveTaskId: res.data.task_id,\n        }, () => {\n          // After moving successfully, delete related files\n          this.getAsyncCopyMoveProgress();\n        });\n      }\n\n      if (repoID === destRepo.repo_id) {\n        if (this.state.currentMode === 'column') {\n          this.deleteTreeNodes(direntPaths);\n        }\n\n        this.moveDirents(dirNames);\n\n        // 2. tow columns mode need update left tree\n        if (this.state.currentMode === 'column') {\n          this.updateMoveCopyTreeNode(destDirentPath);\n        }\n\n        // show tip message if move to current repo\n        let message =  Utils.getMoveSuccessMessage(dirNames);\n        toaster.success(message);\n      }\n\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      if (errMessage === gettext('Error')) {\n        errMessage = Utils.getMoveFailedMessage(dirNames);\n      }\n      this.setState({\n        asyncOperationProgress: 0,\n        isCopyMoveProgressDialogShow: false,\n      });\n      toaster.danger(errMessage);\n    });\n  }\n\n  onCopyItems = (destRepo, destDirentPath) => {\n    let repoID = this.props.repoID;\n    let selectedDirentList = this.state.selectedDirentList;\n\n    if (repoID !== destRepo.repo_id) {\n      this.setState({\n        asyncOperatedFilesLength: selectedDirentList.length,\n        asyncOperationProgress: 0,\n        asyncOperationType: 'copy',\n        isCopyMoveProgressDialogShow: true\n      });\n    }\n\n    let dirNames = this.getSelectedDirentNames();\n    seafileAPI.copyDir(repoID, destRepo.repo_id, destDirentPath, this.state.path, dirNames).then(res => {\n      if (repoID !== destRepo.repo_id) {\n        this.setState({\n          asyncCopyMoveTaskId: res.data.task_id,\n        }, () => {\n          this.getAsyncCopyMoveProgress();\n        });\n      }\n\n      if (repoID === destRepo.repo_id) {\n        if (this.state.currentMode === 'column') {\n          this.updateMoveCopyTreeNode(destDirentPath);\n        }\n\n        if (destDirentPath === this.state.path) {\n          this.loadDirentList(this.state.path);\n        }\n\n        // show tip message if copy to current repo\n        let message =  Utils.getCopySuccessfulMessage(dirNames);\n        toaster.success(message);\n      }\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      if (errMessage === gettext('Error')) {\n        errMessage = Utils.getCopyFailedMessage(dirNames);\n      }\n      toaster.danger(errMessage);\n    });\n  }\n\n  onDeleteItems = () => {\n    let repoID = this.props.repoID;\n    let direntPaths = this.getSelectedDirentPaths();\n    let dirNames = this.getSelectedDirentNames();\n\n    this.setState({updateDetail: !this.state.updateDetail});\n    seafileAPI.deleteMutipleDirents(repoID, this.state.path, dirNames).then(res => {\n      if (this.state.currentMode === 'column') {\n        this.deleteTreeNodes(direntPaths);\n      }\n\n      this.deleteDirents(dirNames);\n\n      let msg = '';\n      if (direntPaths.length > 1) {\n        msg = gettext('Successfully deleted {name} and other {n} items.');\n        msg = msg.replace('{name}', dirNames[0]);\n        msg = msg.replace('{n}', dirNames.length - 1);\n      } else {\n        msg = gettext('Successfully deleted {name}.');\n        msg = msg.replace('{name}', dirNames[0]);\n      }\n      toaster.success(msg);\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      if (errMessage === gettext('Error')) {\n        errMessage = gettext('Failed to delete {name} and other {n} items.');\n        errMessage = errMessage.replace('{name}', dirNames[0]);\n        errMessage = errMessage.replace('{n}', dirNames.length - 1);\n      }\n      toaster.danger(errMessage);\n    });\n  }\n\n  onAddFolder = (dirPath) => {\n    let repoID = this.props.repoID;\n    seafileAPI.createDir(repoID, dirPath).then(() => {\n      let name = Utils.getFileName(dirPath);\n      let parentPath = Utils.getDirName(dirPath);\n\n      if (this.state.currentMode === 'column') {\n        this.addNodeToTree(name, parentPath, 'dir');\n      }\n\n      if (parentPath === this.state.path && !this.state.isViewFile) {\n        this.addDirent(name, 'dir');\n      }\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onAddFile = (filePath, isDraft) => {\n    let repoID = this.props.repoID;\n    seafileAPI.createFile(repoID, filePath, isDraft).then(res => {\n      let name = Utils.getFileName(filePath);\n      let parentPath = Utils.getDirName(filePath);\n      if (this.state.currentMode === 'column') {\n        this.addNodeToTree(name, parentPath, 'file');\n      }\n      if (parentPath === this.state.path && !this.state.isViewFile) {\n        this.addDirent(name, 'file', res.data.size);\n      }\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  switchViewMode = (mode) => {\n    if (mode === this.state.currentMode) {\n      return;\n    }\n    if (mode === 'detail') {\n      this.toggleDirentDetail();\n      return;\n    }\n    cookie.save('seafile_view_mode', mode);\n    let path = this.state.path;\n    if (this.state.currentMode === 'column' && this.state.isViewFile) {\n      path = Utils.getDirName(path);\n      this.setState({\n        path: path,\n        isViewFile: false,\n      });\n      let repoInfo = this.state.currentRepoInfo;\n\n      let url = siteRoot + 'library/' + repoInfo.repo_id + '/' + encodeURIComponent(repoInfo.repo_name) + Utils.encodePath(path);\n      window.history.pushState({url: url, path: path}, path, url);\n    }\n\n    if (mode === 'column') {\n      this.loadSidePanel(this.state.path);\n    }\n    this.isNeedUpdateHistoryState = false;\n    this.setState({currentMode: mode});\n    this.showDir(path);\n  }\n\n  onSearchedClick = (item) => {\n    let path = item.is_dir ? item.path.slice(0, item.path.length - 1) : item.path;\n    if (this.state.currentPath === path) {\n      return;\n    }\n    if (this.state.currentMode === 'column') {\n      // load sidePanel\n      let index = -1;\n      let paths = Utils.getPaths(path);\n      for (let i = 0; i < paths.length; i++) {\n        let node = this.state.treeData.getNodeByPath(node);\n        if (!node) {\n          index = i;\n          break;\n        }\n      }\n      if (index === -1) { // all the data has been loaded already.\n        let node = this.state.treeData.getNodeByPath(path);\n        this.setState({currentNode: node});\n      } else {\n        this.loadNodeAndParentsByPath(path);\n      }\n\n      // load mainPanel\n      if (item.is_dir) {\n        this.showDir(path);\n      } else {\n        if (Utils.isMarkdownFile(path)) {\n          this.showFile(path);\n        } else {\n          let url = siteRoot + 'lib/' + item.repo_id + '/file' + Utils.encodePath(path);\n          let isWeChat = Utils.isWeChat();\n          if (!isWeChat) {\n            let newWindow = window.open('about:blank');\n            newWindow.location.href = url;\n          } else {\n            location.href = url;\n          }\n        }\n      }\n    } else {\n      if (item.is_dir) {\n        this.showDir(path);\n      } else {\n        let url = siteRoot + 'lib/' + item.repo_id + '/file' + Utils.encodePath(path);\n        let isWeChat = Utils.isWeChat();\n        if (!isWeChat) {\n          let newWindow = window.open('about:blank');\n          newWindow.location.href = url;\n        } else {\n          location.href = url;\n        }\n      }\n    }\n  }\n\n  onMainNavBarClick = (nodePath) => {\n    //just for dir\n    this.resetSelected();\n    if (this.state.currentMode === 'column') {\n      let tree = this.state.treeData.clone();\n      let node = tree.getNodeByPath(nodePath);\n      tree.expandNode(node);\n      this.setState({treeData: tree, currentNode: node});\n    }\n\n    this.showDir(nodePath);\n  }\n\n  onLinkClick = (link) => {\n    const url = link;\n    let repoID = this.props.repoID;\n    if (Utils.isInternalMarkdownLink(url, repoID)) {\n      let path = Utils.getPathFromInternalMarkdownLink(url, repoID);\n      this.showFile(path);\n    } else if (Utils.isInternalDirLink(url, repoID)) {\n      let path = Utils.getPathFromInternalDirLink(url, repoID);\n      this.showDir(path);\n    } else {\n      window.open(url);\n    }\n  }\n\n  // list&tree operations\n  onMainPanelItemRename = (dirent, newName) => {\n    let path = Utils.joinPath(this.state.path, dirent.name);\n    this.renameItem(path, dirent.isDir(), newName);\n  }\n\n  onMainPanelItemDelete = (dirent) => {\n    let path = Utils.joinPath(this.state.path, dirent.name);\n    this.deleteItem(path, dirent.isDir());\n  }\n\n  onRenameTreeNode = (node, newName) => {\n    this.renameItem(node.path, node.object.isDir(), newName);\n  }\n\n  onDeleteTreeNode = (node) => {\n    this.deleteItem(node.path, node.object.isDir());\n  }\n\n  renameItem = (path, isDir, newName) => {\n    let repoID = this.props.repoID;\n    if (isDir) {\n      seafileAPI.renameDir(repoID, path, newName).then(() => {\n        this.renameItemAjaxCallback(path, newName);\n      }).catch((error) => {\n        let errMessage = Utils.getErrorMsg(error);\n        if (errMessage === gettext('Error')) {\n          let name = Utils.getFileName(path);\n          errMessage = gettext('Renaming {name} failed').replace('{name}', name);\n        }\n        toaster.danger(errMessage);\n      });\n    } else {\n      seafileAPI.renameFile(repoID, path, newName).then(() => {\n        this.renameItemAjaxCallback(path, newName);\n      }).catch((error) => {\n        let errMessage = Utils.getErrorMsg(error);\n        if (errMessage === gettext('Error')) {\n          let name = Utils.getFileName(path);\n          errMessage = gettext('Renaming {name} failed').replace('{name}', name);\n        }\n        toaster.danger(errMessage);\n      });\n    }\n  }\n\n  renameItemAjaxCallback(path, newName) {\n    if (this.state.currentMode === 'column') {\n      this.renameTreeNode(path, newName);\n    }\n    this.renameDirent(path, newName);\n  }\n\n  deleteItem(path, isDir) {\n    let repoID = this.props.repoID;\n    if (isDir) {\n      seafileAPI.deleteDir(repoID, path).then(() => {\n        this.deleteItemAjaxCallback(path, isDir);\n        let name = Utils.getFileName(path);\n        var msg = gettext('Successfully deleted {name}').replace('{name}', name);\n        toaster.success(msg);\n      }).catch((error) => {\n        let errMessage = Utils.getErrorMsg(error);\n        if (errMessage === gettext('Error')) {\n          let name = Utils.getFileName(path);\n          errMessage = gettext('Failed to delete {name}').replace('{name}', name);\n        }\n        toaster.danger(errMessage);\n      });\n    } else {\n      seafileAPI.deleteFile(repoID, path).then(() => {\n        this.deleteItemAjaxCallback(path, isDir);\n        let name = Utils.getFileName(path);\n        var msg = gettext('Successfully deleted {name}').replace('{name}', name);\n        toaster.success(msg);\n      }).catch((error) => {\n        let errMessage = Utils.getErrorMsg(error);\n        if (errMessage === gettext('Error')) {\n          let name = Utils.getFileName(path);\n          errMessage = gettext('Failed to delete {name}').replace('{name}', name);\n        }\n        toaster.danger(errMessage);\n      });\n    }\n  }\n\n  deleteItemAjaxCallback(path) {\n    if (this.state.currentMode === 'column') {\n      this.deleteTreeNode(path);\n    }\n    this.deleteDirent(path);\n  }\n\n  // list operations\n  onMoveItem = (destRepo, dirent, moveToDirentPath, nodeParentPath) => {\n    let repoID = this.props.repoID;\n    //just for view list state\n    let dirName = dirent.name;\n    if (!nodeParentPath) {\n      nodeParentPath = this.state.path;\n    }\n    let direntPath = Utils.joinPath(nodeParentPath, dirName);\n\n    if (repoID !== destRepo.repo_id) {\n      this.setState({\n        asyncOperatedFilesLength: 1,\n        asyncOperationProgress: 0,\n        asyncOperationType: 'move',\n        isCopyMoveProgressDialogShow: true,\n      });\n    }\n\n    seafileAPI.moveDir(repoID, destRepo.repo_id, moveToDirentPath, nodeParentPath, dirName).then(res => {\n      if (repoID !== destRepo.repo_id) {\n        this.setState({asyncCopyMoveTaskId: res.data.task_id}, () => {\n          this.currentMoveItemName = dirName;\n          this.currentMoveItemPath = direntPath;\n          this.getAsyncCopyMoveProgress(dirName, direntPath);\n        });\n      }\n\n      if (this.state.currentMode === 'column') {\n        this.deleteTreeNode(direntPath);\n      }\n\n      // 1. move to current repo\n      // 2. tow columns mode need update left tree\n      if (repoID === destRepo.repo_id && this.state.currentMode === 'column') {\n        this.updateMoveCopyTreeNode(moveToDirentPath);\n      }\n\n      this.moveDirent(direntPath, moveToDirentPath);\n\n      // show tip message if move to current repo\n      if (repoID === destRepo.repo_id) {\n        let message = gettext('Successfully moved {name}.');\n        message = message.replace('{name}', dirName);\n        toaster.success(message);\n      }\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      if (errMessage === gettext('Error')) {\n        errMessage = gettext('Failed to move {name}.');\n        errMessage = errMessage.replace('{name}', dirName);\n      }\n      toaster.danger(errMessage);\n    });\n  }\n\n  onCopyItem = (destRepo, dirent, copyToDirentPath, nodeParentPath) => {\n    let repoID = this.props.repoID;\n    //just for view list state\n    let dirName = dirent.name;\n    if (!nodeParentPath) {\n      nodeParentPath = this.state.path;\n    }\n\n    if (repoID !== destRepo.repo_id) {\n      this.setState({\n        asyncOperatedFilesLength: 1,\n        asyncOperationProgress: 0,\n        asyncOperationType: 'copy',\n        isCopyMoveProgressDialogShow: true\n      });\n    }\n\n    seafileAPI.copyDir(repoID, destRepo.repo_id, copyToDirentPath, nodeParentPath, dirName).then(res => {\n\n      if (repoID !== destRepo.repo_id) {\n        this.setState({\n          asyncCopyMoveTaskId: res.data.task_id,\n        }, () => {\n          this.getAsyncCopyMoveProgress();\n        });\n      }\n\n      if (repoID === destRepo.repo_id) {\n        if (this.state.currentMode === 'column') {\n          this.updateMoveCopyTreeNode(copyToDirentPath);\n        }\n\n        if (copyToDirentPath === nodeParentPath) {\n          this.loadDirentList(this.state.path);\n        }\n\n        let message = gettext('Successfully copied %(name)s.');\n        message = message.replace('%(name)s', dirName);\n        toaster.success(message);\n      }\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      if (errMessage === gettext('Error')) {\n        errMessage = gettext('Failed to copy %(name)s');\n        errMessage = errMessage.replace('%(name)s', dirName);\n      }\n      toaster.danger(errMessage);\n    });\n  }\n\n  onDirentClick = (dirent) => {\n    let direntList = this.state.direntList.map(dirent => {\n      dirent.isSelected = false;\n      return dirent;\n    });\n    if (dirent) {\n      // dirent.isSelected = true;\n      this.setState({\n        direntList: direntList,\n        isDirentSelected: true,\n        selectedDirentList: [dirent],\n      });\n    } else {\n      this.setState({\n        direntList: direntList,\n        isDirentSelected: false,\n        selectedDirentList: [],\n      });\n    }\n  }\n\n  onItemClick = (dirent) => {\n    this.resetSelected();\n    let repoID = this.props.repoID;\n    let direntPath = Utils.joinPath(this.state.path, dirent.name);\n    if (dirent.isDir()) {  // is dir\n      if (this.state.currentMode === 'column') {\n        this.loadTreeNodeByPath(direntPath);\n      }\n      this.showDir(direntPath);\n    } else {  // is file\n      if (this.state.currentMode === 'column' && Utils.isMarkdownFile(direntPath)) {\n        this.showColumnMarkdownFile(direntPath);\n      } else {\n        const url = siteRoot + 'lib/' + repoID + '/file' + Utils.encodePath(direntPath);\n\n        let isWeChat = Utils.isWeChat();\n        if (!isWeChat) {\n          window.open(url);\n        } else {\n          location.href = url;\n        }\n      }\n    }\n  }\n\n  onDirentSelected = (dirent) => {\n    let direntList = this.state.direntList.map(item => {\n      if (item.name === dirent.name) {\n        item.isSelected = !item.isSelected;\n      }\n      return item;\n    });\n    let selectedDirentList = direntList.filter(item => {\n      return item.isSelected;\n    });\n\n    if (selectedDirentList.length) {\n      this.setState({isDirentSelected: true});\n      if (selectedDirentList.length === direntList.length) {\n        this.setState({\n          isAllDirentSelected: true,\n          direntList: direntList,\n          selectedDirentList: selectedDirentList,\n        });\n      } else {\n        this.setState({\n          isAllDirentSelected: false,\n          direntList: direntList,\n          selectedDirentList: selectedDirentList\n        });\n      }\n    } else {\n      this.setState({\n        isDirentSelected: false,\n        isAllDirentSelected: false,\n        direntList: direntList,\n        selectedDirentList: []\n      });\n    }\n  }\n\n  onAllDirentSelected = () => {\n    if (this.state.isAllDirentSelected) {\n      let direntList = this.state.direntList.map(item => {\n        item.isSelected = false;\n        return item;\n      });\n      this.setState({\n        isDirentSelected: false,\n        isAllDirentSelected: false,\n        direntList: direntList,\n        selectedDirentList: [],\n      });\n    } else {\n      let direntList = this.state.direntList.map(item => {\n        item.isSelected = true;\n        return item;\n      });\n      this.setState({\n        isDirentSelected: true,\n        isAllDirentSelected: true,\n        direntList: direntList,\n        selectedDirentList: direntList,\n      });\n    }\n  }\n\n  onFileTagChanged = (dirent, direntPath) => {\n    let repoID = this.props.repoID;\n    seafileAPI.listFileTags(repoID, direntPath).then(res => {\n      let fileTags = res.data.file_tags.map(item => {\n        return new FileTag(item);\n      });\n      this.updateDirent(dirent, 'file_tags', fileTags);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n\n    this.updateUsedRepoTags();\n  }\n\n  onFileUploadSuccess = (direntObject) => {\n    let isExist = this.state.direntList.some(item => {\n      return item.name === direntObject.name && item.type === direntObject.type;\n    });\n    if (isExist) {\n      let direntList = this.state.direntList;\n      for (let i = 0; i < direntList.length; i++) {\n        let dirent = direntList[i];\n        if (dirent.name === direntObject.name && dirent.type === direntObject.type) {\n          let mtime = moment.unix(direntObject.mtime).fromNow();\n          this.updateDirent(dirent, 'mtime', mtime);  // todo file size is need update too, api is not return;\n          break;\n        }\n      }\n    } else {\n      direntObject.permission = 'rw';\n      let dirent = new Dirent(direntObject);\n      if (this.state.currentMode === 'column') {\n        this.addNodeToTree(dirent.name, this.state.path, dirent.type);\n      }\n      if (direntObject.type === 'dir') {\n        this.setState({direntList: [dirent, ...this.state.direntList]});\n      } else {\n        this.setState({direntList: [...this.state.direntList, dirent]});\n        this.updateReadmeMarkdown(this.state.direntList);\n      }\n    }\n  }\n\n  addDirent = (name, type, size) => {\n    let item = this.createDirent(name, type, size);\n    let direntList = this.state.direntList;\n    if (type === 'dir') {\n      direntList.unshift(item);\n    } else {\n      // there will be there conditions;\n      // first: direntList.length === 0;\n      // second: all the direntList's items are dir;\n      // third: direntList has dir and file;\n      let length = direntList.length;\n      if (length === 0 || direntList[length - 1].type === 'dir') {\n        direntList.push(item);\n      } else {\n        let index = 0;\n        for (let i = 0; i <= length; i++) {\n          if (direntList[i].type === 'file') {\n            index = i;\n            break;\n          }\n        }\n        direntList.splice(index, 0, item);\n      }\n    }\n    this.setState({direntList: direntList});\n    this.updateReadmeMarkdown(direntList);\n  }\n\n  renameDirent = (direntPath, newName) => {\n    let repoID = this.props.repoID;\n    let parentPath = Utils.getDirName(direntPath);\n    let newDirentPath = Utils.joinPath(parentPath, newName);\n    if (direntPath === this.state.path) {\n      // the renamed item is current viewed item\n      // example: direntPath = /A/B/C, state.path = /A/B/C\n\n      this.setState({ path: newDirentPath });\n      let repoInfo = this.state.currentRepoInfo;\n      let url = siteRoot + 'library/' + repoID + '/' + encodeURIComponent(repoInfo.repo_name) + newDirentPath;\n      window.history.replaceState({ url: url, path: newDirentPath}, newDirentPath, url);\n    } else if (Utils.isChildPath(direntPath, this.state.path)) {\n      // example: direntPath = /A/B/C/D, state.path = /A/B/C\n      let oldName = Utils.getFileName(direntPath);\n      let direntList = this.state.direntList.map(item => {\n        if (item.name === oldName) {\n          item.name = newName;\n        }\n        return item;\n      });\n      this.setState({ direntList: direntList });\n      this.updateReadmeMarkdown(direntList);\n    } else if (Utils.isAncestorPath(direntPath, this.state.path)) {\n      // example: direntPath = /A/B, state.path = /A/B/C\n      let newPath = Utils.renameAncestorPath(this.state.path, direntPath, newDirentPath);\n      this.setState({ path: newPath });\n\n      let repoInfo = this.state.currentRepoInfo;\n      let url = siteRoot + 'library/' + repoID + '/' + encodeURIComponent(repoInfo.repo_name) + newPath;\n      window.history.replaceState({ url: url, path: newPath}, newPath, url);\n    }\n  }\n\n  deleteDirent(direntPath) {\n    if (direntPath === this.state.path) {\n      // The deleted item is current item\n      let parentPath = Utils.getDirName(direntPath);\n      this.showDir(parentPath);\n    } else if (Utils.isChildPath(direntPath, this.state.path)) {\n      // The deleted item is inside current path\n      let name = Utils.getFileName(direntPath);\n      let direntList = this.state.direntList.filter(item => {\n        return item.name !== name;\n      });\n\n      // Recalculate the state of the selection\n      this.recaculateSelectedStateAfterDirentDeleted(name, direntList);\n\n      this.setState({direntList: direntList});\n      this.updateReadmeMarkdown(direntList);\n    } else if (Utils.isAncestorPath(direntPath, this.state.path)) {\n      // the deleted item is ancester of the current item\n      let parentPath = Utils.getDirName(direntPath);\n      this.showDir(parentPath);\n    }\n    // else do nothing\n  }\n\n  // only one scence: The deleted items are inside current path\n  deleteDirents = (direntNames) => {\n    let direntList = this.state.direntList.filter(item => {\n      return direntNames.indexOf(item.name) === -1;\n    });\n\n    // Recalculate the state of the selection\n    this.recaculateSelectedStateAfterDirentDeleted(name, direntList);\n\n    this.setState({direntList: direntList});\n    this.updateReadmeMarkdown(direntList);\n  }\n\n  moveDirent = (direntPath, moveToDirentPath = null) => {\n    let name = Utils.getFileName(direntPath);\n    if (moveToDirentPath === this.state.path) {\n      this.loadDirentList(this.state.path);\n      return;\n    }\n    let direntList = this.state.direntList.filter(item => {\n      return item.name !== name;\n    });\n\n    // Recalculate the state of the selection\n    this.recaculateSelectedStateAfterDirentDeleted(name, direntList);\n\n    this.setState({direntList: direntList});\n    this.updateReadmeMarkdown(direntList);\n  }\n\n  // only one scence: The moved items are inside current path\n  moveDirents = (direntNames) => {\n    let direntList = this.state.direntList.filter(item => {\n      return direntNames.indexOf(item.name) === -1;\n    });\n\n    // Recalculate the state of the selection\n    this.recaculateSelectedStateAfterDirentDeleted(name, direntList);\n\n    this.setState({direntList: direntList});\n    this.updateReadmeMarkdown(direntList);\n  }\n\n  updateDirent = (dirent, paramKey, paramValue) => {\n    let newDirentList = this.state.direntList.map(item => {\n      if (item.name === dirent.name) {\n        item[paramKey] = paramValue;\n      }\n      return item;\n    });\n    this.setState({direntList: newDirentList});\n  }\n\n  // tree operations\n  loadTreeNodeByPath = (path) => {\n    let repoID = this.props.repoID;\n    let tree = this.state.treeData.clone();\n    let node = tree.getNodeByPath(path);\n    if (!node.isLoaded) {\n      seafileAPI.listDir(repoID, node.path).then(res => {\n        this.addResponseListToNode(res.data.dirent_list, node);\n        let parentNode = tree.getNodeByPath(node.parentNode.path);\n        parentNode.isExpanded = true;\n        this.setState({\n          treeData: tree,\n          currentNode: node\n        });\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    } else {\n      let parentNode = tree.getNodeByPath(node.parentNode.path);\n      parentNode.isExpanded = true;\n      this.setState({treeData: tree, currentNode: node}); //tree\n    }\n  }\n\n  loadNodeAndParentsByPath = (path) => {\n    let repoID = this.props.repoID;\n    let tree = this.state.treeData.clone();\n    if (Utils.isMarkdownFile(path)) {\n      path = Utils.getDirName(path);\n    }\n    seafileAPI.listDir(repoID, path, {with_parents: true}).then(res => {\n      let direntList = res.data.dirent_list;\n      let results = {};\n      for (let i = 0; i < direntList.length; i++) {\n        let object = direntList[i];\n        let parentDir = object.parent_dir;\n        let key = parentDir === '/' ?  '/' : parentDir.slice(0, parentDir.length - 1);\n        if (!results[key]) {\n          results[key] = [];\n        }\n        results[key].push(object);\n      }\n      for (let key in results) {\n        let node = tree.getNodeByPath(key);\n        if (!node.isLoaded) {\n          this.addResponseListToNode(results[key], node);\n        }\n      }\n      this.setState({\n        isTreeDataLoading: false,\n        treeData: tree\n      });\n    }).catch(() => {\n      this.setState({isLoadFailed: true});\n    });\n  }\n\n  onTreeNodeClick = (node) => {\n    this.resetSelected();\n    let repoID = this.props.repoID;\n    if (!this.state.pathExist) {\n      this.setState({pathExist: true});\n    }\n\n    if (node.object.isDir()) {\n      let isLoaded = node.isLoaded;\n      if (!node.isLoaded) {\n        let tree = this.state.treeData.clone();\n        node = tree.getNodeByPath(node.path);\n        seafileAPI.listDir(repoID, node.path).then(res => {\n          this.addResponseListToNode(res.data.dirent_list, node);\n          tree.collapseNode(node);\n          this.setState({treeData: tree});\n        }).catch(error => {\n          let errMessage = Utils.getErrorMsg(error);\n          toaster.danger(errMessage);\n        });\n      }\n      if (isLoaded && node.path === this.state.path) {\n        if (node.isExpanded) {\n          let tree = treeHelper.collapseNode(this.state.treeData, node);\n          this.setState({treeData: tree});\n        } else {\n          let tree = this.state.treeData.clone();\n          node = tree.getNodeByPath(node.path);\n          tree.expandNode(node);\n          this.setState({treeData: tree});\n        }\n      }\n    }\n\n    if (node.path === this.state.path ) {\n      return;\n    }\n\n    if (node.object.isDir()) {  // isDir\n      this.showDir(node.path);\n    } else {\n      if (Utils.isMarkdownFile(node.path)) {\n        if (node.path !== this.state.path) {\n          this.showColumnMarkdownFile(node.path);\n        }\n      } else {\n        const url = siteRoot + 'lib/' + repoID + '/file' + Utils.encodePath(node.path);\n        window.open(url);\n      }\n    }\n  }\n\n  showColumnMarkdownFile = (filePath) => {\n    let repoID = this.props.repoID;\n    seafileAPI.getFileInfo(repoID, filePath).then((res) => {\n      if (res.data.size === 0) {\n        // loading of asynchronously obtained data may be blocked\n        const w = window.open('about:blank');\n        const url = siteRoot + 'lib/' + repoID + '/file' + Utils.encodePath(filePath);\n        w.location.href = url;\n      } else {\n        this.showFile(filePath);\n      }\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onTreeNodeCollapse = (node) => {\n    let tree = treeHelper.collapseNode(this.state.treeData, node);\n    this.setState({treeData: tree});\n  }\n\n  onTreeNodeExpanded = (node) => {\n    let repoID = this.props.repoID;\n    let tree = this.state.treeData.clone();\n    node = tree.getNodeByPath(node.path);\n    if (!node.isLoaded) {\n      seafileAPI.listDir(repoID, node.path).then(res => {\n        this.addResponseListToNode(res.data.dirent_list, node);\n        this.setState({treeData: tree});\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    } else {\n      tree.expandNode(node);\n      this.setState({treeData: tree});\n    }\n  }\n\n  addNodeToTree = (name, parentPath, type) => {\n    let node = this.createTreeNode(name, type);\n    let tree = treeHelper.addNodeToParentByPath(this.state.treeData, node, parentPath);\n    this.setState({treeData: tree});\n  }\n\n  renameTreeNode = (path, newName) => {\n    let tree = treeHelper.renameNodeByPath(this.state.treeData, path, newName);\n    this.setState({treeData: tree});\n  }\n\n  deleteTreeNode = (path) => {\n    let tree = treeHelper.deleteNodeByPath(this.state.treeData, path);\n    this.setState({treeData: tree});\n  }\n\n  deleteTreeNodes = (paths) => {\n    let tree = treeHelper.deleteNodeListByPaths(this.state.treeData, paths);\n    this.setState({treeData: tree});\n  }\n\n  moveTreeNode = (nodePath, moveToPath, moveToRepo, nodeName) => {\n    let repoID = this.props.repoID;\n    if (repoID !== moveToRepo.repo_id) {\n      let tree = treeHelper.deleteNodeByPath(this.state.treeData, nodePath);\n      this.setState({treeData: tree});\n      return;\n    }\n    let tree = treeHelper.moveNodeByPath(this.state.treeData, nodePath, moveToPath, nodeName);\n    this.setState({treeData: tree});\n  }\n\n  copyTreeNode = (nodePath, copyToPath, destRepo, nodeName) => {\n    let repoID = this.props.repoID;\n    if (repoID !== destRepo.repo_id) {\n      return;\n    }\n    let tree = treeHelper.copyNodeByPath(this.state.treeData, nodePath, copyToPath, nodeName);\n    this.setState({treeData: tree});\n  }\n\n  createTreeNode(name, type) {\n    let object = this.createDirent(name, type);\n    return new TreeNode({object});\n  }\n\n  createDirent(name, type, size) {\n    let mtime = new Date().getTime()/1000;\n    let dirent = new Dirent({name, type, mtime, size});\n    return dirent;\n  }\n\n  addResponseListToNode = (list, node) => {\n    node.isLoaded = true;\n    node.isExpanded = true;\n    let direntList = list.map(item => {\n      return new Dirent(item);\n    });\n    direntList = Utils.sortDirents(direntList, 'name', 'asc');\n\n    let nodeList = direntList.map(object => {\n      return new TreeNode({object});\n    });\n    node.addChildren(nodeList);\n  }\n\n  getSelectedDirentPaths = () => {\n    let paths = [];\n    this.state.selectedDirentList.forEach(selectedDirent => {\n      paths.push(Utils.joinPath(this.state.path, selectedDirent.name));\n    });\n    return paths;\n  }\n\n  getSelectedDirentNames = () => {\n    let names = [];\n    this.state.selectedDirentList.forEach(selectedDirent => {\n      names.push(selectedDirent.name);\n    });\n    return names;\n  }\n\n  resetSelected = () => {\n    this.setState({\n      isDirentSelected: false,\n      isAllDirentSelected: false,\n    });\n  }\n\n  recaculateSelectedStateAfterDirentDeleted = (name, newDirentList) => {\n    let selectedDirentList = this.state.selectedDirentList.slice(0);\n    if (selectedDirentList.length > 0) {\n      selectedDirentList = selectedDirentList.filter(item => {\n        return item.name !== name;\n      });\n    }\n    this.setState({\n      selectedDirentList: selectedDirentList,\n      isDirentSelected: selectedDirentList.length > 0,\n      isAllDirentSelected: selectedDirentList.length === newDirentList.length,\n    });\n  }\n\n  onLibDecryptDialog = () => {\n    this.setState({libNeedDecrypt: false});\n    this.loadDirData(this.state.path);\n  }\n\n  goDraftPage = () => {\n    window.open(siteRoot + 'drafts/' + this.state.draftID + '/');\n  }\n\n  sortItems = (sortBy, sortOrder) => {\n    cookie.save('seafile-repo-dir-sort-by', sortBy);\n    cookie.save('seafile-repo-dir-sort-order', sortOrder);\n    this.setState({\n      sortBy: sortBy,\n      sortOrder: sortOrder,\n      items: Utils.sortDirents(this.state.direntList, sortBy, sortOrder)\n    });\n  }\n\n  onUploadFile = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    this.uploader.onFileUpload();\n  }\n\n  onUploadFolder = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    this.uploader.onFolderUpload();\n  }\n\n  onToolbarFileTagChanged = () => {\n    let repoID = this.props.repoID;\n    let filePath = this.state.path;\n    seafileAPI.listFileTags(repoID, filePath).then(res => {\n      let fileTags = res.data.file_tags.map(item => {\n        return new FileTag(item);\n      });\n\n      this.setState({fileTags: fileTags});\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onToolbarRelatedFileChange = () => {\n    let repoID = this.props.repoID;\n    let filePath = this.state.path;\n\n    seafileAPI.listRelatedFiles(repoID, filePath).then(res => {\n      let relatedFiles = res.data.related_files.map((relatedFile) => {\n        return relatedFile;\n      });\n      this.setState({relatedFiles: relatedFiles});\n    }).catch((error) => {\n      if (error.response.status === 500) {\n        this.setState({relatedFiles: []});\n      }\n    });\n  }\n\n  unSelectDirent = () => {\n    this.setState({\n      isDirentSelected: false,\n      selectedDirentList: []\n    });\n    const dirent = {};\n    this.onDirentSelected(dirent);\n  }\n\n  onDeleteRepoTag = (deletedTagID) => {\n    let direntList = this.state.direntList.map(dirent => {\n      if (dirent.file_tags) {\n        let fileTags = dirent.file_tags.filter(item => {\n          return item.repo_tag_id !== deletedTagID;\n        });\n        dirent.file_tags = fileTags;\n      }\n      return dirent;\n    });\n    this.setState({direntList: direntList});\n    this.updateUsedRepoTags();\n  }\n\n  render() {\n    if (this.state.libNeedDecrypt) {\n      return (\n        <ModalPortal>\n          <LibDecryptDialog\n            repoID={this.props.repoID}\n            onLibDecryptDialog={this.onLibDecryptDialog}\n          />\n        </ModalPortal>\n      );\n    }\n\n    if (!this.state.currentRepoInfo) {\n      return '';\n    }\n\n    let enableDirPrivateShare = false;\n    let { currentRepoInfo, userPerm, isCopyMoveProgressDialogShow } = this.state;\n    let showShareBtn = Utils.isHasPermissionToShare(currentRepoInfo, userPerm);\n    let isRepoOwner = currentRepoInfo.owner_email === username;\n    let isVirtual = currentRepoInfo.is_virtual;\n    let isAdmin = currentRepoInfo.is_admin;\n    if (!isVirtual && (isRepoOwner || isAdmin)) {\n      enableDirPrivateShare = true;\n    }\n    let direntItemsList = this.state.direntList.filter((item, index) => {\n      return index < this.state.itemsShowLength;\n    });\n\n    return (\n      <Fragment>\n        <div className=\"main-panel o-hidden\">\n          <div className=\"main-panel-north border-left-show\">\n            <LibContentToolbar\n              isViewFile={this.state.isViewFile}\n              filePermission={this.state.filePermission}\n              isDraft={this.state.isDraft}\n              hasDraft={this.state.hasDraft}\n              fileTags={this.state.fileTags}\n              relatedFiles={this.state.relatedFiles}\n              onFileTagChanged={this.onToolbarFileTagChanged}\n              onRelatedFileChange={this.onToolbarRelatedFileChange}\n              onSideNavMenuClick={this.props.onMenuClick}\n              repoID={this.props.repoID}\n              path={this.state.path}\n              isDirentSelected={this.state.isDirentSelected}\n              selectedDirentList={this.state.selectedDirentList}\n              onItemsMove={this.onMoveItems}\n              onItemsCopy={this.onCopyItems}\n              onItemsDelete={this.onDeleteItems}\n              onItemRename={this.onMainPanelItemRename}\n              direntList={this.state.direntList}\n              repoName={this.state.repoName}\n              repoEncrypted={this.state.repoEncrypted}\n              isGroupOwnedRepo={this.state.isGroupOwnedRepo}\n              userPerm={this.state.userPerm}\n              showShareBtn={showShareBtn}\n              enableDirPrivateShare={enableDirPrivateShare}\n              onAddFile={this.onAddFile}\n              onAddFolder={this.onAddFolder}\n              onUploadFile={this.onUploadFile}\n              onUploadFolder={this.onUploadFolder}\n              currentMode={this.state.currentMode}\n              switchViewMode={this.switchViewMode}\n              onSearchedClick={this.onSearchedClick}\n              isRepoOwner={isRepoOwner}\n              currentRepoInfo={this.state.currentRepoInfo}\n              updateDirent={this.updateDirent}\n              onDirentSelected={this.onDirentSelected}\n              showDirentDetail={this.showDirentDetail}\n              listRelatedFiles={this.listRelatedFiles}\n              unSelectDirent={this.unSelectDirent}\n              onFilesTagChanged={this.onFileTagChanged}\n            />\n          </div>\n          <div className=\"main-panel-center flex-row\">\n            <LibContentContainer\n              pathPrefix={this.props.pathPrefix}\n              currentMode={this.state.currentMode}\n              path={this.state.path}\n              pathExist={this.state.pathExist}\n              currentRepoInfo={this.state.currentRepoInfo}\n              repoID={this.props.repoID}\n              repoPermission={this.state.repoPermission}\n              enableDirPrivateShare={enableDirPrivateShare}\n              userPerm={userPerm}\n              isGroupOwnedRepo={this.state.isGroupOwnedRepo}\n              onTabNavClick={this.props.onTabNavClick}\n              onMainNavBarClick={this.onMainNavBarClick}\n              isViewFile={this.state.isViewFile}\n              hash={this.state.hash}\n              isDraft={this.state.isDraft}\n              hasDraft={this.state.hasDraft}\n              fileTags={this.state.fileTags}\n              relatedFiles={this.state.relatedFiles}\n              goDraftPage={this.goDraftPage}\n              isFileLoading={this.state.isFileLoading}\n              isFileLoadedErr={this.state.isFileLoadedErr}\n              filePermission={this.state.filePermission}\n              content={this.state.content}\n              lastModified={this.state.lastModified}\n              latestContributor={this.state.latestContributor}\n              onLinkClick={this.onLinkClick}\n              isTreeDataLoading={this.state.isTreeDataLoading}\n              treeData={this.state.treeData}\n              currentNode={this.state.currentNode}\n              onNodeClick={this.onTreeNodeClick}\n              onNodeCollapse={this.onTreeNodeCollapse}\n              onNodeExpanded={this.onTreeNodeExpanded}\n              onAddFolderNode={this.onAddFolder}\n              onAddFileNode={this.onAddFile}\n              onRenameNode={this.onRenameTreeNode}\n              onDeleteNode={this.onDeleteTreeNode}\n              draftCounts={this.state.draftCounts}\n              usedRepoTags={this.state.usedRepoTags}\n              readmeMarkdown={this.state.readmeMarkdown}\n              updateUsedRepoTags={this.updateUsedRepoTags}\n              isDirentListLoading={this.state.isDirentListLoading}\n              direntList={direntItemsList}\n              sortBy={this.state.sortBy}\n              sortOrder={this.state.sortOrder}\n              sortItems={this.sortItems}\n              updateDirent={this.updateDirent}\n              onDirentClick={this.onDirentClick}\n              onItemClick={this.onItemClick}\n              onItemSelected={this.onDirentSelected}\n              onItemDelete={this.onMainPanelItemDelete}\n              onItemRename={this.onMainPanelItemRename}\n              onItemMove={this.onMoveItem}\n              onItemCopy={this.onCopyItem}\n              onAddFolder={this.onAddFolder}\n              onAddFile={this.onAddFile}\n              onFileTagChanged={this.onFileTagChanged}\n              isDirentSelected={this.state.isDirentSelected}\n              isAllDirentSelected={this.state.isAllDirentSelected}\n              onAllDirentSelected={this.onAllDirentSelected}\n              isDirentDetailShow={this.state.isDirentDetailShow}\n              selectedDirent={this.state.selectedDirentList && this.state.selectedDirentList[0]}\n              selectedDirentList={this.state.selectedDirentList}\n              onItemsMove={this.onMoveItems}\n              onItemsCopy={this.onCopyItems}\n              onItemsDelete={this.onDeleteItems}\n              closeDirentDetail={this.closeDirentDetail}\n              showDirentDetail={this.showDirentDetail}\n              direntDetailPanelTab={this.state.direntDetailPanelTab}\n              onDeleteRepoTag={this.onDeleteRepoTag}\n              onToolbarFileTagChanged={this.onToolbarFileTagChanged}\n              updateDetail={this.state.updateDetail}\n              onListContainerScroll={this.onListContainerScroll}\n            />\n            {this.state.pathExist && !this.state.isViewFile && (\n              <FileUploader\n                ref={uploader => this.uploader = uploader}\n                dragAndDrop={true}\n                path={this.state.path}\n                repoID={this.props.repoID}\n                direntList={this.state.direntList}\n                onFileUploadSuccess={this.onFileUploadSuccess}\n              />\n            )}\n          </div>\n        </div>\n        {isCopyMoveProgressDialogShow && (\n          <CopyMoveDirentProgressDialog\n            type={this.state.asyncOperationType}\n            asyncOperatedFilesLength={this.state.asyncOperatedFilesLength}\n            asyncOperationProgress={this.state.asyncOperationProgress}\n            toggleDialog={this.onMoveProgressDialogToggle}\n          />\n        )}\n      </Fragment>\n    );\n  }\n}\n\nLibContentView.propTypes = propTypes;\n\nexport default LibContentView;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalHeader, ModalBody, ModalFooter, Button } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\n\nclass DismissGroupDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n  }\n\n  dismissGroup = () => {\n    let that = this;\n    seafileAPI.deleteGroup(this.props.groupID).then((res)=> {\n      that.props.onGroupChanged();\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    return(\n      <Modal isOpen={this.props.showDismissGroupDialog} toggle={this.props.toggleDismissGroupDialog}>\n        <ModalHeader>{gettext('Delete Group')}</ModalHeader>\n        <ModalBody>\n          <span>{gettext('Really want to delete this group?')}</span>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.props.toggleDismissGroupDialog}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.dismissGroup}>{gettext('Delete')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nconst DismissGroupDialogPropTypes = {\n  showDismissGroupDialog: PropTypes.bool.isRequired,\n  toggleDismissGroupDialog: PropTypes.func.isRequired,\n  loadGroup: PropTypes.func.isRequired,\n  groupID: PropTypes.string.isRequired,\n  onGroupChanged: PropTypes.func.isRequired,\n};\n\nDismissGroupDialog.propTypes = DismissGroupDialogPropTypes;\n\nexport default DismissGroupDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Modal, ModalHeader, Input, ModalBody, ModalFooter, Form, FormGroup, Label, Alert } from 'reactstrap';\nimport { gettext, maxFileName } from '../../utils/constants';\n\nconst propTypes = {\n  onCreateRepo: PropTypes.func.isRequired,\n  onCreateToggle: PropTypes.func.isRequired\n};\n\nclass CreateDepartmentRepoDialog extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      repoName: '',\n      errMessage: '',\n      isSubmitBtnActive: false,\n    };\n    this.newInput = React.createRef();\n  }\n\n  handleChange = (e) => {\n    if (!e.target.value.trim()) {\n      this.setState({isSubmitBtnActive: false});\n    } else {\n      this.setState({isSubmitBtnActive: true});\n    }\n\n    this.setState({\n      repoName: e.target.value,\n    });\n  }\n\n  handleSubmit = () => {\n    let isValid = this.validateRepoName();\n    if (isValid) {\n      let repo = this.createRepo(this.state.repoName);\n      this.props.onCreateRepo(repo, 'department');\n    }\n  }\n\n  handleKeyPress = (e) => {\n    if (e.key === 'Enter') {\n      this.handleSubmit();\n      e.preventDefault();\n    }\n  }\n\n  toggle = () => {\n    this.props.onCreateToggle();\n  }\n\n  componentDidMount = () => {\n    this.newInput.focus();\n  }\n\n  validateRepoName = () => {\n    let errMessage = '';\n    let repoName = this.state.repoName.trim();\n    if (!repoName.length) {\n      errMessage = gettext('Name is required');\n      this.setState({errMessage: errMessage});\n      return false;\n    }\n    if (repoName.indexOf('/') > -1) {\n      errMessage = gettext('Name should not include \\'/\\'.');\n      this.setState({errMessage: errMessage});\n      return false;\n    }\n\n    return true;\n  }\n\n  createRepo = (repoName) => {\n    let repo = { repo_name: repoName };\n    return repo;\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true} toggle={this.toggle}>\n        <ModalHeader toggle={this.toggle}>{gettext('New Department Library')}</ModalHeader>\n        <ModalBody>\n          <Form>\n            <FormGroup>\n              <Label for=\"repo-name\">{gettext('Name')}</Label>\n              <Input\n                id=\"repo-name\"\n                onKeyPress={this.handleKeyPress}\n                innerRef={input => {this.newInput = input;}}\n                value={this.state.repoName}\n                onChange={this.handleChange}\n                maxLength={maxFileName}\n              />\n            </FormGroup>\n          </Form>\n          {this.state.errMessage && <Alert color=\"danger\">{this.state.errMessage}</Alert>}\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"primary\" onClick={this.handleSubmit} disabled={!this.state.isSubmitBtnActive}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nCreateDepartmentRepoDialog.propTypes = propTypes;\n\nexport default CreateDepartmentRepoDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport { Modal, ModalHeader, ModalBody, ModalFooter, Input, Button } from 'reactstrap';\nimport toaster from '../toast';\n\nclass RenameGroupDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      newGroupName: this.props.currentGroupName,\n      isSubmitBtnActive: false,\n    };\n  }\n\n  handleGroupNameChange = (event) => {\n    if (!event.target.value.trim()) {\n      this.setState({isSubmitBtnActive: false});\n    } else {\n      this.setState({isSubmitBtnActive: true});\n    }\n\n    let name = event.target.value;\n    this.setState({\n      newGroupName: name\n    });\n  }\n\n  renameGroup = () => {\n    let name = this.state.newGroupName.trim();\n    if (name) {\n      let that = this;\n      seafileAPI.renameGroup(this.props.groupID, name).then((res)=> {\n        that.props.loadGroup(this.props.groupID);\n        that.props.onGroupChanged(res.data.id);\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    }\n    this.setState({\n      newGroupName: '',\n    });\n    this.props.toggleRenameGroupDialog();\n  }\n\n  handleKeyDown = (event) => {\n    if (event.keyCode === 13) {\n      this.renameGroup();\n    }\n  }\n\n  render() {\n    return(\n      <Modal isOpen={this.props.showRenameGroupDialog} toggle={this.props.toggleRenameGroupDialog}>\n        <ModalHeader>{gettext('Rename Group')}</ModalHeader>\n        <ModalBody>\n          <label htmlFor=\"newGroupName\">{gettext('Rename group to')}</label>\n          <Input type=\"text\" id=\"newGroupName\" value={this.state.newGroupName}\n            onChange={this.handleGroupNameChange} onKeyDown={this.handleKeyDown}/>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.props.toggleRenameGroupDialog}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.renameGroup} disabled={!this.state.isSubmitBtnActive}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nconst RenameGroupDialogPropTypes = {\n  showRenameGroupDialog: PropTypes.bool.isRequired,\n  toggleRenameGroupDialog: PropTypes.func.isRequired,\n  loadGroup: PropTypes.func.isRequired,\n  groupID: PropTypes.string.isRequired,\n  onGroupChanged: PropTypes.func.isRequired,\n  currentGroupName: PropTypes.string.isRequired,\n};\n\nRenameGroupDialog.propTypes = RenameGroupDialogPropTypes;\n\nexport default RenameGroupDialog;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api.js';\nimport UserSelect from '../user-select';\nimport { Utils } from '../../utils/utils';\n\nimport '../../css/transfer-group-dialog.css';\n\nconst propTypes = {\n  groupID: PropTypes.string.isRequired,\n  toggleTransferGroupDialog: PropTypes.func.isRequired,\n  onGroupChanged: PropTypes.func.isRequired\n};\n\nclass TransferGroupDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      selectedOption: null,\n      errMessage: '',\n    };\n    this.options = [];\n  }\n\n  handleSelectChange = (option) => {\n    this.setState({\n      selectedOption: option,\n      errMessage: '',\n    });\n    this.options = [];\n  }\n\n  transferGroup = () => {\n    const email = this.state.selectedOption && this.state.selectedOption.email;\n    if (email) {\n      seafileAPI.transferGroup(this.props.groupID, email).then((res) => {\n        this.props.toggleTransferGroupDialog();\n      }).catch((error) => {\n        let errMessage = Utils.getErrorMsg(error);\n        this.setState({errMessage: errMessage});\n      });\n    }\n  }\n\n  toggle = () => {\n    this.props.toggleTransferGroupDialog();\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true} toggle={this.toggle}>\n        <ModalHeader toggle={this.toggle}>{gettext('Transfer Group')}</ModalHeader>\n        <ModalBody>\n          <p>{gettext('Transfer group to')}</p>\n          <UserSelect\n            ref=\"userSelect\"\n            isMulti={false}\n            className=\"reviewer-select\"\n            placeholder={gettext('Please enter 1 or more character')}\n            onSelectChange={this.handleSelectChange}\n          />\n          <div className=\"error\">{this.state.errMessage}</div>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Close')}</Button>\n          <Button color=\"primary\" onClick={this.transferGroup}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nTransferGroupDialog.propTypes = propTypes;\n\nexport default TransferGroupDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Alert, Modal, ModalHeader, ModalBody, ModalFooter, Button } from 'reactstrap';\nimport { gettext, siteRoot, groupImportMembersExtraMsg } from '../../utils/constants';\n\nconst propTypes = {\n  toggleImportMembersDialog: PropTypes.func.isRequired,\n  importMembersInBatch: PropTypes.func.isRequired,\n};\n\nclass ImportMembersDialog extends React.Component {\n  constructor(props) {\n    super(props);\n    this.fileInputRef = React.createRef();\n    this.state = {\n      errorMsg: ''\n    };\n  }\n\n  toggle = () => {\n    this.props.toggleImportMembersDialog();\n  }\n\n  openFileInput = () => {\n    this.fileInputRef.current.click();\n  }\n\n  uploadFile = (e) => {\n    // no file selected\n    if (!this.fileInputRef.current.files.length) {\n      return;\n    }\n    // check file extension\n    let fileName = this.fileInputRef.current.files[0].name;\n    if(fileName.substr(fileName.lastIndexOf('.') + 1) != 'xlsx') {\n      this.setState({\n        errorMsg: gettext('Please choose a .xlsx file.')\n      });\n      return;\n    }\n    const file = this.fileInputRef.current.files[0];\n    this.props.importMembersInBatch(file);\n    this.toggle();\n  }\n\n  render() {\n    let { errorMsg } = this.state;\n    return (\n      <Modal isOpen={true} toggle={this.toggle}>\n        <ModalHeader toggle={this.toggle}>{gettext('Import members from a .xlsx file')}</ModalHeader>\n\n        <ModalBody>\n          <p>{groupImportMembersExtraMsg}</p>\n          <p><a className=\"text-secondary small\" href={`${siteRoot}api/v2.1/group-members-import-example/`}>{gettext('Download an example file')}</a></p>\n          <button className=\"btn btn-outline-primary\" onClick={this.openFileInput}>{gettext('Upload file')}</button>\n          <input className=\"d-none\" type=\"file\" onChange={this.uploadFile} ref={this.fileInputRef} />\n          {errorMsg && <Alert color=\"danger\">{errorMsg}</Alert>}\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Cancel')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nImportMembersDialog.propTypes = propTypes;\n\nexport default ImportMembersDialog;\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter, Table } from 'reactstrap';\nimport { Utils } from '../../utils/utils';\nimport { gettext } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport RoleEditor from '../select-editor/role-editor';\nimport UserSelect from '../user-select';\nimport toaster from '../toast';\nimport Loading from '../loading';\n\nimport '../../css/manage-members-dialog.css';\n\nconst propTypes = {\n  groupID: PropTypes.string.isRequired,\n  toggleManageMembersDialog: PropTypes.func.isRequired,\n  onGroupChanged: PropTypes.func.isRequired,\n  isOwner: PropTypes.bool.isRequired,\n};\n\nclass ManageMembersDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isLoading: true, // first loading\n      isLoadingMore: false,\n      groupMembers: [],\n      page: 1,\n      perPage: 100,\n      hasNextPage: false,\n      selectedOption: null,\n      errMessage: [],\n      isItemFreezed: false\n    };\n  }\n\n  componentDidMount() {\n    this.listGroupMembers(this.state.page);\n  }\n\n  listGroupMembers = (page) => {\n    const { groupID } = this.props;\n    const { perPage, groupMembers } = this.state;\n    seafileAPI.listGroupMembers(groupID, page, perPage).then((res) => {\n      const members = res.data;\n      this.setState({\n        isLoading: false,\n        isLoadingMore: false,\n        page: page,\n        hasNextPage: members.length < perPage ? false : true,\n        groupMembers: groupMembers.concat(members) \n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n      this.setState({\n        isLoading: false,\n        isLoadingMore: false,\n        hasNextPage: false\n      });\n    });\n  }\n\n  onSelectChange = (option) => {\n    this.setState({\n      selectedOption: option,\n      errMessage: [],\n    });\n  }\n\n  addGroupMember = () => {\n    let emails = [];\n    for (let i = 0; i < this.state.selectedOption.length; i++) {\n      emails.push(this.state.selectedOption[i].email);\n    }\n    seafileAPI.addGroupMembers(this.props.groupID, emails).then((res) => {\n      const newMembers = res.data.success;\n      this.setState({\n        groupMembers: [].concat(newMembers, this.state.groupMembers),\n        selectedOption: null,\n      });\n      this.refs.userSelect.clearSelect();\n      if (res.data.failed.length > 0) {\n        this.setState({\n          errMessage: res.data.failed\n        });\n      }\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  toggleItemFreezed = (isFreezed) => {\n    this.setState({\n      isItemFreezed: isFreezed\n    });\n  }\n\n  toggle = () => {\n    this.props.toggleManageMembersDialog();\n  }\n\n  handleScroll = (event) => {\n    // isLoadingMore: to avoid repeated request\n    const { page, hasNextPage, isLoadingMore } = this.state;\n    if (hasNextPage && !isLoadingMore) {\n      const clientHeight = event.target.clientHeight;\n      const scrollHeight = event.target.scrollHeight;\n      const scrollTop    = event.target.scrollTop;\n      const isBottom = (clientHeight + scrollTop + 1 >= scrollHeight);\n      if (isBottom) { // scroll to the bottom\n        this.setState({isLoadingMore: true}, () => {\n          this.listGroupMembers(page + 1); \n        }); \n      }   \n    }   \n  }\n\n  changeMember = (targetMember) => {\n    this.setState({\n      groupMembers: this.state.groupMembers.map((item) => {\n        if (item.email == targetMember.email) {\n          item = targetMember;\n        }\n        return item;\n      })\n    });\n  }\n\n  deleteMember = (targetMember) => {\n    const groupMembers = this.state.groupMembers;\n    groupMembers.splice(groupMembers.indexOf(targetMember), 1);\n    this.setState({\n      groupMembers: groupMembers\n    });\n  }\n\n  render() {\n    const { isLoading, hasNextPage } = this.state;\n    return (\n      <Modal isOpen={true} toggle={this.toggle}>\n        <ModalHeader toggle={this.toggle}>{gettext('Manage group members')}</ModalHeader>\n        <ModalBody>\n          <p>{gettext('Add group member')}</p>\n          <div className='add-members'>\n            <UserSelect\n              placeholder={gettext('Search users...')}\n              onSelectChange={this.onSelectChange}\n              ref=\"userSelect\"\n              isMulti={true}\n              className=\"add-members-select\"\n            />\n            {this.state.selectedOption ?\n              <Button color=\"secondary\" onClick={this.addGroupMember}>{gettext('Submit')}</Button> :\n              <Button color=\"secondary\" disabled>{gettext('Submit')}</Button>\n            }\n          </div>\n          {\n            this.state.errMessage.length > 0 &&\n            this.state.errMessage.map((item, index = 0) => {\n              return (\n                <div className=\"group-error error\" key={index}>{item.error_msg}</div>\n              );\n            })\n          }\n          <div className=\"manage-members\" onScroll={this.handleScroll}>\n            {isLoading ? <Loading /> : (\n              <Fragment>\n                <Table size=\"sm\" className=\"manage-members-table\">\n                  <thead>\n                    <tr>\n                      <th width=\"15%\"></th>\n                      <th width=\"45%\">{gettext('Name')}</th>\n                      <th width=\"30%\">{gettext('Role')}</th>\n                      <th width=\"10%\"></th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {\n                      this.state.groupMembers.length > 0 &&\n                  this.state.groupMembers.map((item, index) => {\n                    return (\n                        <Member\n                          key={index}\n                          item={item}\n                          changeMember={this.changeMember}\n                          deleteMember={this.deleteMember}\n                          groupID={this.props.groupID}\n                          isOwner={this.props.isOwner}\n                          isItemFreezed={this.state.isItemFreezed}\n                          toggleItemFreezed={this.toggleItemFreezed}\n                        />\n                    );\n                  })\n                    }\n                  </tbody>\n                </Table>\n                {hasNextPage && <Loading />}\n              </Fragment>\n            )}\n          </div>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Close')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nManageMembersDialog.propTypes = propTypes;\n\nconst MemberPropTypes = {\n  item: PropTypes.object.isRequired,\n  changeMember: PropTypes.func.isRequired,\n  deleteMember: PropTypes.func.isRequired,\n  groupID: PropTypes.string.isRequired,\n  isOwner: PropTypes.bool.isRequired,\n};\n\nclass Member extends React.PureComponent {\n\n  constructor(props) {\n    super(props);\n    this.roles = ['Admin', 'Member'];\n    this.state = ({\n      highlight: false,\n    });\n  }\n\n  onChangeUserRole = (role) => {\n    let isAdmin = role === 'Admin' ? 'True' : 'False';\n    seafileAPI.setGroupAdmin(this.props.groupID, this.props.item.email, isAdmin).then((res) => {\n      this.props.changeMember(res.data);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  deleteMember = () => {\n    const { item } = this.props;\n    seafileAPI.deleteGroupMember(this.props.groupID, item.email).then((res) => {\n      this.props.deleteMember(item);\n      toaster.success(gettext('Successfully deleted {name}.').replace('{name}', item.name));\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  handleMouseOver = () => {\n    if (this.props.isItemFreezed) return;\n    this.setState({\n      highlight: true,\n    });\n  }\n\n  handleMouseLeave = () => {\n    if (this.props.isItemFreezed) return;\n    this.setState({\n      highlight: false,\n    });\n  }\n\n  translateRole = (role) => {\n    if (role === 'Admin') {\n      return gettext('Admin');\n    }\n    else if (role === 'Member') {\n      return gettext('Member');\n    }\n    else if (role === 'Owner') {\n      return gettext('Owner');\n    }\n  }\n\n  render() {\n    const { item, isOwner } = this.props;\n    const deleteAuthority = (item.role !== 'Owner' && isOwner === true) || (item.role === 'Member' && isOwner === false);\n    return(\n      <tr onMouseOver={this.handleMouseOver} onMouseLeave={this.handleMouseLeave} className={this.state.highlight ? 'editing' : ''}>\n        <th scope=\"row\"><img className=\"avatar\" src={item.avatar_url} alt=\"\"/></th>\n        <td>{item.name}</td>\n        <td>\n          {((isOwner === false) || (isOwner === true && item.role === 'Owner')) &&\n            <span className=\"group-admin\">{this.translateRole(item.role)}</span>\n          }\n          {(isOwner === true && item.role !== 'Owner') &&\n            <RoleEditor\n              isTextMode={true}\n              isEditIconShow={this.state.highlight}\n              currentRole={item.role}\n              roles={this.roles}\n              onRoleChanged={this.onChangeUserRole}\n              toggleItemFreezed={this.props.toggleItemFreezed}\n            />\n          }\n        </td>\n        <td>\n          {(deleteAuthority && !this.props.isItemFreezed) &&\n            <i\n              className=\"fa fa-times delete-group-member-icon\"\n              onClick={this.deleteMember}>\n            </i>\n          }\n        </td>\n      </tr>\n    );\n  }\n}\n\nMember.propTypes = MemberPropTypes;\n\n\nexport default ManageMembersDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalHeader, ModalBody, ModalFooter, Button } from 'reactstrap';\nimport { gettext, username } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\n\nclass LeaveGroupDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n  }\n\n  leaveGroup = () => {\n    seafileAPI.quitGroup(this.props.groupID, username).then((res)=> {\n      this.props.onGroupChanged();\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    return(\n      <Modal isOpen={true} toggle={this.props.toggleLeaveGroupDialog}>\n        <ModalHeader toggle={this.props.toggleLeaveGroupDialog}>{gettext('Leave Group')}</ModalHeader>\n        <ModalBody>\n          <p>{gettext('Really want to leave this group?')}</p>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.props.toggleLeaveGroupDialog}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.leaveGroup}>{gettext('Leave')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nconst LeaveGroupDialogPropTypes = {\n  toggleLeaveGroupDialog: PropTypes.func.isRequired,\n  groupID: PropTypes.string.isRequired,\n  onGroupChanged: PropTypes.func.isRequired,\n};\n\nLeaveGroupDialog.propTypes = LeaveGroupDialogPropTypes;\n\nexport default LeaveGroupDialog;\n","import React,{ Fragment } from 'react';\nimport { Popover } from 'reactstrap';\nimport PropTypes from 'prop-types';\nimport cookie from 'react-cookies';\nimport { gettext, siteRoot, username, canAddRepo } from '../../utils/constants';\nimport { Link } from '@reach/router';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport Loading from '../../components/loading';\nimport EmptyTip from '../../components/empty-tip';\nimport ModalPortal from '../../components/modal-portal';\nimport Group from '../../models/group';\nimport Repo from '../../models/repo';\nimport toaster from '../../components/toast';\nimport CommonToolbar from '../../components/toolbar/common-toolbar';\nimport CreateRepoDialog from '../../components/dialog/create-repo-dialog';\nimport CreateDepartmentRepoDialog from '../../components/dialog/create-department-repo-dialog';\nimport DismissGroupDialog from '../../components/dialog/dismiss-group-dialog';\nimport RenameGroupDialog from '../../components/dialog/rename-group-dialog';\nimport TransferGroupDialog from '../../components/dialog/transfer-group-dialog';\nimport ImportMembersDialog from '../../components/dialog/import-members-dialog';\nimport ManageMembersDialog from '../../components/dialog/manage-members-dialog';\nimport LeaveGroupDialog from '../../components/dialog/leave-group-dialog';\nimport SharedRepoListView from '../../components/shared-repo-list-view/shared-repo-list-view';\nimport LibDetail from '../../components/dirent-detail/lib-details';\nimport SortOptionsDialog from '../../components/dialog/sort-options';\n\nimport '../../css/group-view.css';\n\nconst propTypes = {\n  onShowSidePanel: PropTypes.func.isRequired,\n  onSearchedClick: PropTypes.func.isRequired,\n  onGroupChanged: PropTypes.func.isRequired,\n  onTabNavClick: PropTypes.func.isRequired,\n  groupID: PropTypes.string,\n};\n\nclass GroupView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isLoading: true, // first loading\n      isLoadingMore: false,\n      errMessage: '',\n      emptyTip: null,\n      currentGroup: null,\n      currentRepo: null,\n      isStaff: false,\n      isOwner: false,\n      sortBy: cookie.load('seafile-repo-dir-sort-by') || 'name', // 'name' or 'time' or 'size'\n      sortOrder: cookie.load('seafile-repo-dir-sort-order') || 'asc', // 'asc' or 'desc'\n      isSortOptionsDialogOpen: false,\n      repoList: [],\n      currentPage: 1,\n      perPage: 50,\n      hasNextPage: false,\n      libraryType: 'group',\n      isCreateRepoDialogShow: false,\n      isDepartmentGroup: false,\n      showGroupDropdown: false,\n      showGroupMembersPopover: false,\n      showRenameGroupDialog: false,\n      showDismissGroupDialog: false,\n      showTransferGroupDialog: false,\n      showImportMembersDialog: false,\n      showManageMembersDialog: false,\n      groupMembers: [],\n      isShowDetails: false,\n      isLeaveGroupDialogOpen: false,\n    };\n  }\n\n  componentDidMount() {\n    let groupID = this.props.groupID;\n    this.loadGroup(groupID);\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (nextProps.groupID !== this.props.groupID) {\n      this.loadGroup(nextProps.groupID);\n    }\n  }\n\n  loadGroup = (groupID) => {\n    seafileAPI.getGroup(groupID).then((res) => {\n      let currentGroup = new Group(res.data);\n      let emptyTip = this.getEmptyTip(currentGroup);\n      let isStaff  = currentGroup.admins.indexOf(username) > -1;  //for item operations\n      let isOwner = currentGroup.owner === username ? true : false;\n      let isDepartmentGroup = currentGroup.parent_group_id !== 0;\n      this.setState({\n        emptyTip: emptyTip,\n        currentGroup: currentGroup,\n        isStaff: isStaff,\n        isDepartmentGroup: isDepartmentGroup,\n        isOwner: isOwner,\n        currentPage: 1,\n        repoList: []  // empty it for the current group\n      }, () => {\n        this.loadRepos(this.state.currentPage);\n      });\n    }).catch((error) => {\n      this.setState({\n        isLoading: false,\n        errMessage: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  loadRepos = (page) => {\n    const { perPage } = this.state;\n    seafileAPI.listGroupRepos(this.props.groupID, page, perPage).then((res) => {\n      let hasNextPage = true;\n      if (res.data.length < perPage) {\n        hasNextPage = false;\n      }\n      let repoList = this.state.repoList;\n      let newRepoList = res.data.map(item => {\n        let repo = new Repo(item);\n        return repo;\n      });\n      if (newRepoList.length) {\n        repoList = repoList.concat(newRepoList);\n      }\n      this.setState({\n        isLoading: false,\n        isLoadingMore: false,\n        currentPage: page,\n        hasNextPage: hasNextPage,\n        repoList: Utils.sortRepos(repoList, this.state.sortBy, this.state.sortOrder)\n      });\n    }).catch((error) => {\n      this.setState({\n        isLoading: false,\n        isLoadingMore: false,\n        errMessage: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  getEmptyTip = (currentGroup) => {\n    let emptyTip = null;\n    if (currentGroup) {\n      if (currentGroup.parent_group_id === 0) {\n        emptyTip = (\n          <EmptyTip>\n            <h2>{gettext('No libraries shared with this group')}</h2>\n            <p>{gettext('No libraries have been shared with this group yet. A library shared with a group can be accessed by all group members. You can share a library with a group in \"My Libraries\". You can also create a new library to be shared with this group by clicking the \"New Library\" button in the menu bar.')}</p>\n          </EmptyTip>\n        );\n      } else {\n        if (currentGroup.admins.indexOf(username) == -1) {  // is a member of this group\n          emptyTip = (\n            <EmptyTip>\n              <h2>{gettext('No libraries')}</h2>\n            </EmptyTip>\n          );\n        } else {\n          emptyTip = (\n            <EmptyTip>\n              <h2>{gettext('No libraries')}</h2>\n              <p>{gettext('You can create libraries by clicking the \"New Library\" button above.')}</p>\n            </EmptyTip>\n          );\n        }\n      }\n    }\n    return emptyTip;\n  }\n\n  onCreateRepoToggle = () => {\n    this.setState({isCreateRepoDialogShow: !this.state.isCreateRepoDialogShow});\n  }\n\n  onCreateRepo = (repo, groupOwnerType) => {\n    let groupId = this.props.groupID;\n    if (groupOwnerType && groupOwnerType === 'department') {\n      seafileAPI.createGroupOwnedLibrary(groupId, repo).then(res => { //need modify endpoint api\n        let object = {\n          repo_id: res.data.id,\n          repo_name: res.data.name,\n          owner_name: res.data.group_name,\n          owner_email: res.data.owner,\n          permission: res.data.permission,\n          mtime: res.data.mtime,\n          size: res.data.size,\n          encrypted: res.data.encrypted,\n        };\n        let repo = new Repo(object);\n        let repoList = this.addRepoItem(repo);\n        this.setState({repoList: repoList});\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n\n    } else {\n      seafileAPI.createGroupRepo(groupId, repo).then(res => {\n        let repo = new Repo(res.data);\n        let repoList = this.addRepoItem(repo);\n        this.setState({repoList: repoList});\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    }\n    this.onCreateRepoToggle();\n  }\n\n  onItemDelete = (repo) => {\n    let groupID = this.props.groupID;\n    let repoList = this.state.repoList.filter(item => {\n      return item.repo_id !== repo.repo_id;\n    });\n    this.setState({repoList: repoList});\n    this.loadGroup(groupID);\n  }\n\n  addRepoItem = (repo) => {\n    let newRepoList = this.state.repoList.map(item => {return item;});\n    newRepoList.unshift(repo);\n    return newRepoList;\n  }\n\n  onItemUnshare = (repo) => {\n    let group = this.state.currentGroup;\n    seafileAPI.unshareRepoToGroup(repo.repo_id, group.id).then(() => {\n      let repoList = this.state.repoList.filter(item => {\n        return item.repo_id !== repo.repo_id;\n      });\n      this.setState({repoList: repoList});\n      this.loadGroup(group.id);\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onItemRename = (repo, newName) => {\n    seafileAPI.renameGroupOwnedLibrary(this.props.groupID, repo.repo_id, newName).then(res => {\n      let repoList = this.state.repoList.map(item => {\n        if (item.repo_id === repo.repo_id) {\n          item.repo_name = newName;\n        }\n        return item;\n      });\n      this.setState({repoList: repoList});\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onTabNavClick = (tabName) => {\n    this.props.onTabNavClick(tabName);\n  }\n\n  toggleGroupDropdown = () => {\n    this.setState({\n      showGroupDropdown: !this.state.showGroupDropdown\n    });\n  }\n\n  toggleDismissGroupDialog = () => {\n    this.setState({\n      showDismissGroupDialog: !this.state.showDismissGroupDialog,\n      showGroupDropdown: false,\n    });\n  }\n\n  toggleRenameGroupDialog = () => {\n    this.setState({\n      showRenameGroupDialog: !this.state.showRenameGroupDialog,\n      showGroupDropdown: false,\n    });\n  }\n\n  toggleTransferGroupDialog = () => {\n    this.setState({\n      showTransferGroupDialog: !this.state.showTransferGroupDialog,\n      showGroupDropdown: false,\n    });\n  }\n\n  toggleImportMembersDialog= () => {\n    this.setState({\n      showImportMembersDialog: !this.state.showImportMembersDialog\n    });\n  }\n\n  importMembersInBatch= (file) => {\n    toaster.notify(gettext('It may take some time, please wait.'));\n    seafileAPI.importGroupMembersViaFile(this.state.currentGroup.id, file).then((res) => {\n      res.data.failed.map(item => {\n        const msg = `${item.email}: ${item.error_msg}`;\n        toaster.danger(msg);\n      });\n    }).catch((error) => {\n      let errMsg = Utils.getErrorMsg(error);\n      toaster.danger(errMsg);\n    });\n  }\n\n  toggleManageMembersDialog = () => {\n    this.setState({\n      showManageMembersDialog: !this.state.showManageMembersDialog,\n      showGroupDropdown: false,\n    });\n  }\n\n  toggleLeaveGroupDialog = () => {\n    this.setState({\n      isLeaveGroupDialogOpen: !this.state.isLeaveGroupDialogOpen,\n      showGroupDropdown: false,\n    });\n  }\n\n  listGroupMembers = () => {\n    seafileAPI.listGroupMembers(this.props.groupID).then((res) => {\n      this.setState({\n        groupMembers: res.data\n      });\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  toggleGroupMembersPopover = (state) => {\n    if (state === 'open') {\n      this.listGroupMembers();\n      this.setState({\n        showGroupMembersPopover: true\n      });\n    } else {\n      this.setState({\n        showGroupMembersPopover: false\n      });\n    }\n  }\n\n  onItemDetails = (repo) => {\n    this.setState({\n      isShowDetails: true,\n      currentRepo: repo,\n    });\n  }\n\n  closeDetails = () => {\n    this.setState({isShowDetails: false});\n  }\n\n  sortItems = (sortBy, sortOrder) => {\n    cookie.save('seafile-repo-dir-sort-by', sortBy);\n    cookie.save('seafile-repo-dir-sort-order', sortOrder);\n    this.setState({\n      sortBy: sortBy,\n      sortOrder: sortOrder,\n      repoList: Utils.sortRepos(this.state.repoList, sortBy, sortOrder)\n    });\n  }\n\n  translateRole = (role) => {\n    if (role === 'Admin') {\n      return gettext('Admin');\n    }\n    else if (role === 'Member') {\n      return gettext('Member');\n    }\n    else if (role === 'Owner') {\n      return gettext('Owner');\n    }\n  }\n\n  toggleSortOptionsDialog = () => {\n    this.setState({\n      isSortOptionsDialogOpen: !this.state.isSortOptionsDialogOpen\n    });\n  }\n\n  handleScroll = (event) => {\n    // isLoadingMore: to avoid repeated request\n    const { currentPage, hasNextPage, isLoadingMore } = this.state;\n    if (hasNextPage && !isLoadingMore) {\n      const clientHeight = event.target.clientHeight;\n      const scrollHeight = event.target.scrollHeight;\n      const scrollTop    = event.target.scrollTop;\n      const isBottom = (clientHeight + scrollTop + 1 >= scrollHeight);\n      if (isBottom) { // scroll to the bottom\n        this.setState({isLoadingMore: true}, () => {\n          this.loadRepos(currentPage + 1);\n        });\n      }\n    }\n  }\n\n  render() {\n    let { errMessage, emptyTip, currentGroup, isDepartmentGroup, isStaff } = this.state;\n    let isShowSettingIcon = false;\n    if (currentGroup) { // group message is loaded\n      if (currentGroup.parent_group_id === 0) {\n        isShowSettingIcon = true;\n      } else {\n        if (currentGroup.admins.indexOf(username) > -1) {\n          isShowSettingIcon = true;\n        }\n      }\n    }\n    let useRate = 0;\n    if (isDepartmentGroup && currentGroup.group_quota) {\n      useRate = currentGroup.group_quota_usage / currentGroup.group_quota * 100 + '%';\n    }\n    return (\n      <Fragment>\n        <div className=\"main-panel-north border-left-show\">\n          <div className=\"cur-view-toolbar\">\n            <span className=\"sf2-icon-menu side-nav-toggle hidden-md-up d-md-none\" title=\"Side Nav Menu\" onClick={this.props.onShowSidePanel}></span>\n            <div className=\"operation\">\n              {((!isDepartmentGroup && canAddRepo) || (isDepartmentGroup && isStaff)) && (\n                Utils.isDesktop() ? (\n                  <button className=\"btn btn-secondary operation-item\" title={gettext('New Library')} onClick={this.onCreateRepoToggle}>\n                    <i className=\"fas fa-plus-square text-secondary mr-1\"></i>{gettext('New Library')}\n                  </button>\n                ) : (\n                  <span className=\"sf2-icon-plus mobile-toolbar-icon\" title={gettext('New Library')} onClick={this.onCreateRepoToggle}></span>\n                )\n              )}\n            </div>\n          </div>\n          <CommonToolbar onSearchedClick={this.props.onSearchedClick} />\n        </div>\n        <div className=\"main-panel-center flex-row\">\n          <div className=\"cur-view-container\">\n            <div className=\"cur-view-path\">\n              {currentGroup && (\n                <Fragment>\n                  <div className=\"path-container\">\n                    <Link to={`${siteRoot}groups/`} onClick={() => this.onTabNavClick('groups')}>{gettext('Groups')}</Link>\n                    <span className=\"path-split\">/</span>\n                    <span>{currentGroup.name}</span>\n                    {isDepartmentGroup && (\n                      <Fragment>\n                        <span className=\"department-group-icon fas fa-building\" title={gettext('This is a special group representing a department.')}></span>\n                        {currentGroup.group_quota > 0 &&\n                          <span className=\"department-usage-container\">\n                            <div className=\"department-usage\">\n                              <span id=\"quota-bar\" className=\"department-quota-bar\"><span id=\"quota-usage\" className=\"usage\" style={{width: useRate}}></span></span>\n                              <span className=\"department-quota-info\">{Utils.bytesToSize(currentGroup.group_quota_usage)} / {Utils.bytesToSize(currentGroup.group_quota)}</span>\n                            </div>\n                          </span>\n                        }\n                      </Fragment>\n                    )}\n                  </div>\n                  <div className=\"path-tool\">\n                    { isShowSettingIcon &&\n                    <React.Fragment>\n                      <a href=\"#\" className=\"sf2-icon-cog1 action-icon group-top-action-icon\" title=\"Settings\" id=\"settings\"\n                        onClick={this.toggleGroupDropdown}></a>\n                      <Popover placement=\"bottom\" isOpen={this.state.showGroupDropdown} target=\"settings\"\n                        toggle={this.toggleGroupDropdown} hideArrow={true} className=\"sf-popover\">\n                        <div className=\"sf-popover-hd sf-popover-title\">\n                          <span>{gettext('Settings')}</span>\n                          <a href=\"#\" className=\"sf-popover-close js-close sf2-icon-x1 action-icon\"\n                            onClick={this.toggleGroupDropdown}></a>\n                        </div>\n                        <div className=\"sf-popover-con\">\n                          {(this.state.isStaff || this.state.isOwner) &&\n                          <ul className=\"sf-popover-list\">\n                            <li><a href=\"#\" className=\"sf-popover-item\" onClick={this.toggleRenameGroupDialog} >{gettext('Rename')}</a></li>\n                            {\n                              this.state.isOwner &&\n                              <li><a href=\"#\" className=\"sf-popover-item\" onClick={this.toggleTransferGroupDialog} >{gettext('Transfer')}</a></li>\n                            }\n                          </ul>\n                          }\n                          {(this.state.isStaff || this.state.isOwner) &&\n                          <ul className=\"sf-popover-list\">\n                            <li><a href=\"#\" className=\"sf-popover-item\" onClick={this.toggleImportMembersDialog} >{gettext('Import Members')}</a></li>\n                            <li><a href=\"#\" className=\"sf-popover-item\" onClick={this.toggleManageMembersDialog} >{gettext('Manage Members')}</a></li>\n                          </ul>\n                          }\n                          {\n                            this.state.isOwner &&\n                            <ul className=\"sf-popover-list\">\n                              <li><a href=\"#\" className=\"sf-popover-item\" onClick={this.toggleDismissGroupDialog}>{gettext('Delete Group')}</a></li>\n                            </ul>\n                          }\n                          {/* gourp owner only can dissmiss group, admin could not quit, department member could not quit */}\n                          {(!this.state.isOwner && !this.state.isStaff && !isDepartmentGroup) &&\n                          <ul className=\"sf-popover-list\">\n                            <li><a href=\"#\" className=\"sf-popover-item\" onClick={this.toggleLeaveGroupDialog}>{gettext('Leave Group')}</a></li>\n                          </ul>\n                          }\n                        </div>\n                      </Popover>\n                    </React.Fragment>\n                    }\n                    <a href=\"#\"\n                      className=\"sf2-icon-user2 action-icon group-top-action-icon\"\n                      title={gettext('Members')} id=\"groupMembers\"\n                      onClick={() => this.toggleGroupMembersPopover('open')}>\n                    </a>\n                    <Popover placement=\"bottom\" isOpen={this.state.showGroupMembersPopover} target=\"groupMembers\"\n                      toggle={this.toggleGroupMembersPopover} hideArrow={true} className=\"sf-popover\">\n                      <div className=\"sf-popover-hd sf-popover-title group-member-list-header\">\n                        <span>{gettext('Members')}</span>\n                        <a href=\"#\" className=\"sf-popover-close js-close sf2-icon-x1 action-icon\"\n                          onClick={this.toggleGroupMembersPopover}></a>\n                      </div>\n                      <div className=\"sf-popover-con\">\n                        <ul className=\"sf-popover-list group-member-list\">\n                          {this.state.groupMembers.map((item, index) => {\n                            return (\n                              <li key={index}>\n                                <a href=\"#\" className=\"sf-popover-item user-item d-flex\">\n                                  <img src={item.avatar_url} alt=\"\" className=\"group-member-avatar avatar\"/>\n                                  <span className=\"txt-item ellipsis d-flex\">\n                                    <span className=\"group-member-name ellipsis\">{item.name}</span>\n                                    <span className=\"group-member-admin\">{this.translateRole(item.role)}</span>\n                                  </span>\n                                </a>\n                              </li>\n                            );\n                          })}\n                        </ul>\n                      </div>\n                    </Popover>\n                    {(!Utils.isDesktop() && this.state.repoList.length > 0) && <span className=\"sf3-font sf3-font-sort action-icon\" onClick={this.toggleSortOptionsDialog}></span>}\n                    {this.state.isSortOptionsDialogOpen &&\n                    <SortOptionsDialog\n                      toggleDialog={this.toggleSortOptionsDialog}\n                      sortBy={this.state.sortBy}\n                      sortOrder={this.state.sortOrder}\n                      sortItems={this.sortItems}\n                    />\n                    }\n                  </div>\n                </Fragment>\n              )}\n            </div>\n            <div className=\"cur-view-content d-block\" onScroll={this.handleScroll}>\n              {this.state.isLoading && <Loading />}\n              {(!this.state.isLoading && errMessage) && <div className=\"error text-center mt-2\">{errMessage}</div>}\n              {(!this.state.isLoading && this.state.repoList.length === 0) && emptyTip}\n              {(!this.state.isLoading && this.state.repoList.length > 0) &&\n                <SharedRepoListView\n                  repoList={this.state.repoList}\n                  hasNextPage={this.state.hasNextPage}\n                  currentGroup={this.state.currentGroup}\n                  sortBy={this.state.sortBy}\n                  sortOrder={this.state.sortOrder}\n                  sortItems={this.sortItems}\n                  onItemUnshare={this.onItemUnshare}\n                  onItemDelete={this.onItemDelete}\n                  onItemDetails={this.onItemDetails}\n                  onItemRename={this.onItemRename}\n                />\n              }\n            </div>\n          </div>\n          {this.state.isShowDetails && (\n            <div className=\"cur-view-detail\">\n              <LibDetail currentRepo={this.state.currentRepo} closeDetails={this.closeDetails}/>\n            </div>\n          )}\n        </div>\n        {this.state.isCreateRepoDialogShow && !this.state.isDepartmentGroup && (\n          <ModalPortal>\n            <CreateRepoDialog\n              libraryType={this.state.libraryType}\n              onCreateToggle={this.onCreateRepoToggle}\n              onCreateRepo={this.onCreateRepo}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isCreateRepoDialogShow && this.state.isDepartmentGroup &&\n          <CreateRepoDialog\n            isAdmin={this.state.isAdmin}\n            onCreateToggle={this.onCreateRepoToggle}\n            onCreateRepo={this.onCreateRepo}\n            libraryType='department'\n          />\n        }\n        {this.state.showRenameGroupDialog &&\n          <RenameGroupDialog\n            showRenameGroupDialog={this.state.showRenameGroupDialog}\n            toggleRenameGroupDialog={this.toggleRenameGroupDialog}\n            loadGroup={this.loadGroup}\n            groupID={this.props.groupID}\n            onGroupChanged={this.props.onGroupChanged}\n            currentGroupName={currentGroup.name}\n          />\n        }\n        {this.state.showDismissGroupDialog &&\n          <DismissGroupDialog\n            showDismissGroupDialog={this.state.showDismissGroupDialog}\n            toggleDismissGroupDialog={this.toggleDismissGroupDialog}\n            loadGroup={this.loadGroup}\n            groupID={this.props.groupID}\n            onGroupChanged={this.props.onGroupChanged}\n          />\n        }\n        {this.state.showTransferGroupDialog &&\n          <TransferGroupDialog\n            toggleTransferGroupDialog={this.toggleTransferGroupDialog}\n            groupID={this.props.groupID}\n            onGroupChanged={this.props.onGroupChanged}\n          />\n        }\n        { this.state.showImportMembersDialog &&\n          <ImportMembersDialog\n            toggleImportMembersDialog={this.toggleImportMembersDialog}\n            importMembersInBatch={this.importMembersInBatch}\n          />\n        }\n        {this.state.showManageMembersDialog &&\n          <ManageMembersDialog\n            toggleManageMembersDialog={this.toggleManageMembersDialog}\n            groupID={this.props.groupID}\n            onGroupChanged={this.props.onGroupChanged}\n            isOwner={this.state.isOwner}\n          />\n        }\n        {this.state.isLeaveGroupDialogOpen &&\n          <LeaveGroupDialog\n            toggleLeaveGroupDialog={this.toggleLeaveGroupDialog}\n            groupID={this.props.groupID}\n            onGroupChanged={this.props.onGroupChanged}\n          />\n        }\n      </Fragment>\n    );\n  }\n}\n\nGroupView.propTypes = propTypes;\n\nexport default GroupView;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport MediaQuery from 'react-responsive';\nimport CommonToolbar from './common-toolbar';\nimport { Button } from 'reactstrap';\nimport { gettext, canAddGroup } from '../../utils/constants';\n\nconst propTypes = {\n  searchPlaceholder: PropTypes.string,\n  onShowSidePanel: PropTypes.func.isRequired,\n  onSearchedClick: PropTypes.func.isRequired,\n  toggleAddGroupModal: PropTypes.func.isRequired,\n};\n\nclass GroupsToolbar extends React.Component {\n\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    let { onShowSidePanel, onSearchedClick } = this.props;\n    return (\n      <div className=\"main-panel-north border-left-show\">\n        <div className=\"cur-view-toolbar\">\n          <span title=\"Side Nav Menu\" onClick={onShowSidePanel} className=\"sf2-icon-menu side-nav-toggle hidden-md-up d-md-none\"></span>\n          {canAddGroup && (\n            <div className=\"operation\">\n              <MediaQuery query=\"(min-width: 768px)\">\n                <Button color=\"btn btn-secondary operation-item\" onClick={this.props.toggleAddGroupModal}>\n                  <i className=\"fas fa-plus-square text-secondary mr-1\"></i>{gettext('New Group')}\n                </Button>\n              </MediaQuery>\n              <MediaQuery query=\"(max-width: 767.8px)\">\n                <span className=\"sf2-icon-plus mobile-toolbar-icon\" title={gettext('New Group')} onClick={this.props.toggleAddGroupModal}></span>\n              </MediaQuery>\n            </div>\n          )}\n        </div>\n        <CommonToolbar searchPlaceholder={this.props.searchPlaceholder} onSearchedClick={onSearchedClick}/>\n      </div>\n    );\n  }\n}\n\nGroupsToolbar.propTypes = propTypes;\n\nexport default GroupsToolbar;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Modal, ModalHeader, ModalBody, ModalFooter, Input, Button } from 'reactstrap';\nimport { Utils } from '../../utils/utils';\n\nclass CreateGroupDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      groupName: '',\n      errorMsg: '',\n      isSubmitBtnActive: false,\n    };\n    this.newInput = React.createRef();\n  }\n\n  componentDidMount() {\n    this.newInput.focus();\n    this.newInput.setSelectionRange(0, 0);\n  }\n\n  handleGroupChange = (event) => {\n    let name = event.target.value;\n\n    if (!name.trim()) {\n      this.setState({isSubmitBtnActive: false});\n    } else {\n      this.setState({isSubmitBtnActive: true});\n    }\n    this.setState({\n      groupName: name\n    });\n    if (this.state.errorMsg) {\n      this.setState({\n        errorMsg: ''\n      });\n    }\n  }\n\n  handleSubmitGroup = () => {\n    let name = this.state.groupName.trim();\n    if (name) {\n      let that = this;\n      seafileAPI.createGroup(name).then((res)=> {\n        that.props.onCreateGroup();\n      }).catch((error) => {\n        let errorMsg = Utils.getErrorMsg(error);\n        this.setState({errorMsg: errorMsg});\n      });\n    } else {\n      this.setState({\n        errorMsg: gettext('Name is required')\n      });\n    }\n    this.setState({\n      groupName: '',\n    });\n  }\n\n  handleKeyDown = (e) => {\n    if (e.keyCode === 13) {\n      this.handleSubmitGroup();\n      e.preventDefault();\n    }\n  }\n\n  render() {\n    return(\n      <Modal isOpen={this.props.showAddGroupModal} toggle={this.props.toggleAddGroupModal}>\n        <ModalHeader toggle={this.props.toggleAddGroupModal}>{gettext('New Group')}</ModalHeader>\n        <ModalBody>\n          <label htmlFor=\"groupName\">{gettext('Name')}</label>\n          <Input\n            innerRef={input => {this.newInput = input;}}\n            type=\"text\"\n            id=\"groupName\"\n            value={this.state.groupName}\n            onChange={this.handleGroupChange}\n            onKeyDown={this.handleKeyDown}\n          />\n          <span className=\"error\">{this.state.errorMsg}</span>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.props.toggleAddGroupModal}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.handleSubmitGroup} disabled={!this.state.isSubmitBtnActive}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nconst CreateGroupDialogPropTypes = {\n  toggleAddGroupModal: PropTypes.func.isRequired,\n  onCreateGroup: PropTypes.func.isRequired,\n  showAddGroupModal: PropTypes.bool.isRequired,\n};\n\nCreateGroupDialog.propTypes = CreateGroupDialogPropTypes;\n\nexport default CreateGroupDialog;","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext, siteRoot, canAddGroup } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport Loading from '../../components/loading';\nimport Group from '../../models/group';\nimport Repo from '../../models/repo';\nimport toaster from '../../components/toast';\nimport GroupsToolbar from '../../components/toolbar/groups-toolbar';\nimport SharedRepoListView from '../../components/shared-repo-list-view/shared-repo-list-view';\nimport CreateGroupDialog from '../../components/dialog/create-group-dialog';\nimport LibDetail from '../../components/dirent-detail/lib-details';\nimport EmptyTip from '../../components/empty-tip';\n\nimport '../../css/groups.css';\n\nconst propTypes = {\n  group: PropTypes.object.isRequired,\n  onItemDetails: PropTypes.func.isRequired,\n};\n\n\nclass RepoListViewPanel extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      repoList: [],\n    };\n  }\n\n  componentDidMount() {\n    let group = this.props.group;\n    let repoList = group.repos.map(item => {\n      let repo = new Repo(item);\n      return repo;\n    });\n    this.setState({repoList: repoList});\n  }\n\n  onItemUnshare = (repo) => {\n    let group = this.props.group;\n    seafileAPI.unshareRepoToGroup(repo.repo_id, group.id).then(() => {\n      let repoList = this.state.repoList.filter(item => {\n        return item.repo_id !== repo.repo_id;\n      });\n      this.setState({repoList: repoList});\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  onItemDelete = (repo) => {\n    let repoList = this.state.repoList.filter(item => {\n      return item.repo_id !== repo.repo_id;\n    });\n    this.setState({repoList: repoList});\n  }\n\n  onItemRename = (repo, newName) => {\n    let group = this.props.group;\n    seafileAPI.renameGroupOwnedLibrary(group.id, repo.repo_id, newName).then(res => {\n      let repoList = this.state.repoList.map(item => {\n        if (item.repo_id === repo.repo_id) {\n          item.repo_name = newName;\n        }\n        return item;\n      });\n      this.setState({repoList: repoList});\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    let group = this.props.group;\n    const emptyTip = <p className=\"group-item-empty-tip\">{gettext('No libraries')}</p>;\n    return (\n      <div className=\"group-list-panel\">\n        <h4 className=\"group-item-heading ellipsis\">\n          <a href={`${siteRoot}group/${group.id}/`} title={group.name}>{group.name}</a>\n        </h4>\n        {this.state.repoList.length === 0 ?\n          emptyTip :\n          <SharedRepoListView\n            isShowTableThread={false}\n            isShowRepoOwner={false}\n            currentGroup={this.props.group}\n            repoList={this.state.repoList}\n            onItemUnshare={this.onItemUnshare}\n            onItemDelete={this.onItemDelete}\n            onItemDetails={this.props.onItemDetails}\n            onItemRename={this.onItemRename}\n          />\n        }\n      </div>\n    );\n  }\n}\n\nRepoListViewPanel.propTypes = propTypes;\n\nclass GroupsView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isLoading: true,\n      errorMsg: '',\n      groupList: [],\n      showAddGroupModal: false,\n      isShowDetails: false,\n      currentRepo: null,\n    };\n  }\n\n  listGroups = () => {\n    seafileAPI.listGroups(true).then((res) => {\n      // `{'with_repos': 1}`: list repos of every group\n      // res: {data: [...], status: 200, statusText: \"OK\", headers: {…}, config: {…}, …}\n      let groupList = res.data.map(item => {\n        let group = new Group(item);\n        return group;\n      });\n      this.setState({\n        isLoading: false,\n        groupList: groupList.sort((a, b) => {\n          return a.name.toLowerCase() < b.name.toLowerCase() ? -1 : 1;\n        })\n      });\n    }).catch((error) => {\n      this.setState({\n        isLoading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  toggleAddGroupModal = () => {\n    this.setState({\n      showAddGroupModal: !this.state.showAddGroupModal\n    });\n  }\n\n  onCreateGroup = () => {\n    this.setState({\n      showAddGroupModal: false,\n      isLoading: true,\n      groupList: [],\n    });\n    this.listGroups();\n  }\n\n  componentDidMount() {\n    this.listGroups();\n  }\n\n  onItemDetails = (repo) => {\n    this.setState({\n      isShowDetails: true,\n      currentRepo: repo,\n    });\n  }\n\n  closeDetails = () => {\n    this.setState({isShowDetails: false});\n  }\n\n  render() {\n    const emptyTip = (\n      <EmptyTip>\n        <h2>{gettext('No groups')}</h2>\n        {canAddGroup ?\n          <p>{gettext('You are not in any groups. Groups allow multiple people to collaborate on libraries. You can create a group by clicking the \"New Group\" button in the menu bar.')}</p> :\n          <p>{gettext('You are not in any groups. Groups allow multiple people to collaborate on libraries. Groups you join will be listed here.')}</p>\n        }\n      </EmptyTip>\n    );\n\n    return (\n      <Fragment>\n        <GroupsToolbar\n          onShowSidePanel={this.props.onShowSidePanel}\n          onSearchedClick={this.props.onSearchedClick}\n          toggleAddGroupModal={this.toggleAddGroupModal}\n        />\n        <div className=\"main-panel-center flex-row\">\n          <div className=\"cur-view-container\">\n            <div className=\"cur-view-path\">\n              <h3 className=\"sf-heading\">{gettext('My Groups')}</h3>\n            </div>\n            <div className=\"cur-view-content cur-view-content-groups\">\n              {this.state.isLoading && <Loading />}\n              {(!this.state.isLoading && this.state.errorMsg) && <div className=\"error text-center mt-2\">{this.state.errorMsg}</div>}\n              {(!this.state.isLoading && !this.state.errorMsg && this.state.groupList.length == 0) && emptyTip}\n              {!this.state.isLoading && this.state.groupList.map((group, index) => {\n                return (\n                  <RepoListViewPanel\n                    key={index}\n                    group={group}\n                    onItemDetails={this.onItemDetails}\n                  />\n                );\n              })}\n            </div>\n          </div>\n          {this.state.isShowDetails && (\n            <div className=\"cur-view-detail\">\n              <LibDetail currentRepo={this.state.currentRepo} closeDetails={this.closeDetails}/>\n            </div>\n          )}\n        </div>\n        { this.state.showAddGroupModal &&\n          <CreateGroupDialog\n            toggleAddGroupModal={this.toggleAddGroupModal}\n            onCreateGroup={this.onCreateGroup}\n            showAddGroupModal={this.state.showAddGroupModal}\n          />\n        }\n      </Fragment>\n    );\n  }\n}\n\nconst GroupsViewPropTypes = {\n  onShowSidePanel: PropTypes.func.isRequired,\n  onSearchedClick: PropTypes.func.isRequired,\n};\n\nGroupsView.propTypes = GroupsViewPropTypes;\n\nexport default GroupsView;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport CommonToolbar from './common-toolbar';\nimport { Button } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  onShowSidePanel: PropTypes.func.isRequired,\n  onSearchedClick: PropTypes.func.isRequired,\n  toggleInvitePeopleDialog: PropTypes.func.isRequired,\n};\n\nclass InvitationsToolbar extends React.Component {\n\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    let { onShowSidePanel, onSearchedClick, toggleInvitePeopleDialog } = this.props;\n    return (\n      <div className=\"main-panel-north border-left-show\">\n        <div className=\"cur-view-toolbar\">\n          <span title=\"Side Nav Menu\" onClick={onShowSidePanel} className=\"sf2-icon-menu side-nav-toggle hidden-md-up d-md-none\">\n          </span>\n          {Utils.isDesktop() ? (\n            <div className=\"operation\">\n              <Button color=\"btn btn-secondary operation-item\" onClick={toggleInvitePeopleDialog}>\n                <i className=\"fas fa-plus-square text-secondary mr-1\"></i>{gettext('Invite Guest')}\n              </Button>\n            </div>\n          ) : (\n            <span className=\"sf2-icon-plus mobile-toolbar-icon\" title={gettext('Invite Guest')} onClick={toggleInvitePeopleDialog}></span>\n          )}\n        </div>\n        <CommonToolbar searchPlaceholder={this.props.searchPlaceholder} onSearchedClick={onSearchedClick}/>\n      </div>\n    );\n  }\n}\n\nInvitationsToolbar.propTypes = propTypes;\n\nexport default InvitationsToolbar;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Utils } from '../../utils/utils';\nimport { gettext } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Modal, ModalHeader, ModalBody, ModalFooter, Input, Button } from 'reactstrap';\nimport toaster from '../toast';\nimport Loading from '../loading';\n\nconst InvitePeopleDialogPropTypes = {\n  onInvitePeople: PropTypes.func.isRequired,\n  toggleDialog: PropTypes.func.isRequired,\n};\n\nclass InvitePeopleDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      emails: '',\n      errorMsg: '',\n      isSubmitting: false\n    };\n  }\n\n  handleInputChange = (e) => {\n    let emails = e.target.value;\n    this.setState({\n      emails: emails\n    });\n    if (this.state.errorMsg) {\n      this.setState({\n        errorMsg: ''\n      });\n    }\n  }\n\n  handleKeyDown = (e) => {\n    if (e.keyCode === 13) {\n      e.preventDefault();\n      this.handleSubmitInvite();\n    }\n  }\n\n  handleSubmitInvite = () => {\n    let emails = this.state.emails.trim();\n    if (!emails) {\n      this.setState({\n        errorMsg: gettext('It is required.')\n      });\n      return false;\n    }\n\n    let emailsArray = [];\n    emails = emails.split(',');\n    for (let i = 0, len = emails.length; i < len; i++) {\n      let email = emails[i].trim();\n      if (email) {\n        emailsArray.push(email);\n      }\n    }\n\n    if (!emailsArray.length) {\n      this.setState({\n        errorMsg: gettext('Email is invalid.')\n      });\n      return false;\n    }\n\n    this.setState({\n      isSubmitting: true\n    });\n    seafileAPI.invitePeople(emailsArray).then((res) => {\n      this.props.toggleDialog();\n      const success = res.data.success;\n      if (success.length) {\n        let successMsg = '';\n        if (success.length == 1) {\n          successMsg = gettext('Successfully invited %(email).')\n            .replace('%(email)', success[0].accepter);\n        } else {\n          successMsg = gettext('Successfully invited %(email) and %(num) other people.')\n            .replace('%(email)', success[0].accepter)\n            .replace('%(num)', success.length - 1);\n        }\n        toaster.success(successMsg);\n        this.props.onInvitePeople(success);\n      }\n      const failed = res.data.failed;\n      if (failed.length) {\n        for (let i = 0, len = failed.length; i < len; i++) {\n          let failedMsg = failed[i].email + ': ' + failed[i].error_msg;\n          toaster.danger(failedMsg);\n        }\n      }\n    }).catch((error) => {\n      const errorMsg = Utils.getErrorMsg(error);\n      toaster.danger(errorMsg);\n      this.props.toggleDialog();\n    });\n  }\n\n  render() {\n    const { isSubmitting } = this.state;\n    return (\n      <Modal isOpen={true} toggle={this.props.toggleDialog}>\n        <ModalHeader toggle={this.props.toggleDialog}>{gettext('Invite Guest')}</ModalHeader>\n        <ModalBody>\n          <label htmlFor=\"emails\">{gettext('Emails')}</label>\n          <Input\n            type=\"text\"\n            id=\"emails\"\n            placeholder={gettext('Emails, separated by \\',\\'')}\n            value={this.state.emails}\n            onChange={this.handleInputChange}\n            onKeyDown={this.handleKeyDown}\n          />\n          <p className=\"error mt-2\">{this.state.errorMsg}</p>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.props.toggleDialog}>{gettext('Cancel')}</Button>\n          <Button className=\"submit-btn\" color=\"primary\" onClick={this.handleSubmitInvite} disabled={isSubmitting}>{isSubmitting ? <Loading /> : gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nInvitePeopleDialog.propTypes = InvitePeopleDialogPropTypes;\n\nexport default InvitePeopleDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport Loading from '../loading';\nimport toaster from '../toast';\n\nconst propTypes = {\n  accepter: PropTypes.string.isRequired,\n  token: PropTypes.string.isRequired,\n  revokeInvitation: PropTypes.func.isRequired,\n  toggleDialog: PropTypes.func.isRequired\n};\n\nclass InvitationRevokeDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isSubmitting: false\n    };\n  }\n\n  onRevokeInvitation = () => {\n    this.setState({\n      isSubmitting: true,\n    });\n\n    seafileAPI.revokeInvitation(this.props.token).then((res) => {\n      this.props.revokeInvitation();\n      this.props.toggleDialog();\n      const msg = gettext('Successfully revoked access of user {placeholder}.').replace('{placeholder}', this.props.accepter);\n      toaster.success(msg);\n    }).catch((error) => {\n      const errorMsg = Utils.getErrorMsg(error);\n      toaster.danger(errorMsg);\n      this.props.toggleDialog();\n    });\n  };\n\n  render() {\n    const { accepter, toggleDialog } = this.props;\n    const { isSubmitting } = this.state;\n    const email = '<span class=\"op-target\">' + Utils.HTMLescape(this.props.accepter) + '</span>';\n    const content = gettext('Are you sure to revoke access of user {placeholder} ?').replace('{placeholder}', email);\n\n    return (\n      <Modal isOpen={true} toggle={toggleDialog}>\n        <ModalHeader toggle={toggleDialog}>{gettext('Revoke Access')}</ModalHeader>\n        <ModalBody>\n          <p dangerouslySetInnerHTML={{__html: content}}></p>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={toggleDialog}>{gettext('Cancel')}</Button>\n          <Button className=\"submit-btn\" color=\"primary\" onClick={this.onRevokeInvitation} disabled={isSubmitting}>{isSubmitting ? <Loading /> : gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nInvitationRevokeDialog.propTypes = propTypes;\n\nexport default InvitationRevokeDialog;\n","import React, { Component, Fragment } from 'react';\nimport { Dropdown, DropdownToggle, DropdownItem } from 'reactstrap';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport InvitationsToolbar from '../../components/toolbar/invitations-toolbar';\nimport InvitePeopleDialog from '../../components/dialog/invite-people-dialog';\nimport InvitationRevokeDialog from '../../components/dialog/invitation-revoke-dialog';\nimport Loading from '../../components/loading';\nimport toaster from '../../components/toast';\nimport EmptyTip from '../../components/empty-tip';\n\nimport '../../css/invitations.css';\n\nclass Item extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOpIconShown: false,\n      isOpMenuOpen: false, // for mobile\n      isRevokeDialogOpen: false\n    };\n  }\n\n  toggleOpMenu = () => {\n    this.setState({\n      isOpMenuOpen: !this.state.isOpMenuOpen\n    });\n  }\n\n  onMouseEnter = () => {\n    this.setState({\n      isOpIconShown: true\n    });\n  }\n\n  onMouseLeave = () => {\n    this.setState({\n      isOpIconShown: false\n    });\n  }\n\n  deleteItem = () => {\n    // make the icon avoid being clicked repeatedly\n    this.setState({\n      isOpIconShown: false\n    });\n    const token = this.props.invitation.token;\n    seafileAPI.deleteInvitation(token).then((res) => {\n      this.setState({deleted: true});\n      toaster.success(gettext('Successfully deleted 1 item.'));\n    }).catch((error) => {\n      const errorMsg = Utils.getErrorMsg(error);\n      toaster.danger(errorMsg);\n      this.setState({\n        isOpIconShown: true\n      });\n    });\n  }\n\n  revokeItem = () => {\n    this.setState({deleted: true});\n  }\n\n  toggleRevokeDialog = () => {\n    this.setState({\n      isRevokeDialogOpen: !this.state.isRevokeDialogOpen\n    });\n  }\n\n  render() {\n    const { isOpIconShown, deleted, isRevokeDialogOpen } = this.state;\n\n    if (deleted) {\n      return null;\n    }\n\n    const item = this.props.invitation;\n\n    const desktopItem = (\n      <tr onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave}>\n        <td>{item.accepter}</td>\n        <td>{moment(item.invite_time).format('YYYY-MM-DD')}</td>\n        <td>{moment(item.expire_time).format('YYYY-MM-DD')}</td>\n        <td>{item.accept_time && <i className=\"sf2-icon-tick invite-accept-icon\"></i>}</td>\n        <td>\n          {isOpIconShown && (\n            item.accept_time ?\n              <i\n                className=\"action-icon sf3-font sf3-font-cancel-invitation\"\n                title={gettext('Revoke Access')}\n                onClick={this.toggleRevokeDialog}>\n              </i> :\n              <i\n                className=\"action-icon sf2-icon-x3\"\n                title={gettext('Delete')}\n                onClick={this.deleteItem}>\n              </i>\n          )}\n        </td>\n      </tr>\n    );\n\n    const mobileItem = (\n      <tr>\n        <td>\n          {item.accepter}<br />\n          <span className=\"item-meta-info\">{moment(item.invite_time).format('YYYY-MM-DD')}<span className=\"small\">({gettext('Invite Time')})</span></span>\n          <span className=\"item-meta-info\">{moment(item.expire_time).format('YYYY-MM-DD')}<span className=\"small\">({gettext('Expiration')})</span></span>\n          <span className=\"item-meta-info\">{item.accept_time && gettext('Accepted')}</span>\n        </td>\n        <td>\n          <Dropdown isOpen={this.state.isOpMenuOpen} toggle={this.toggleOpMenu}>\n            <DropdownToggle\n              tag=\"i\"\n              className=\"sf-dropdown-toggle fa fa-ellipsis-v ml-0\"\n              title={gettext('More Operations')}\n              data-toggle=\"dropdown\"\n              aria-expanded={this.state.isOpMenuOpen}\n            />\n            <div className={this.state.isOpMenuOpen ? '' : 'd-none'} onClick={this.toggleOpMenu}>\n              <div className=\"mobile-operation-menu-bg-layer\"></div>\n              <div className=\"mobile-operation-menu\">\n                {item.accept_time ?\n                  <DropdownItem className=\"mobile-menu-item\" onClick={this.toggleRevokeDialog}>{gettext('Revoke Access')}</DropdownItem> :\n                  <DropdownItem className=\"mobile-menu-item\" onClick={this.deleteItem}>{gettext('Delete')}</DropdownItem>\n                }\n              </div>\n            </div>\n          </Dropdown>\n        </td>\n      </tr>\n    );\n\n    return (\n      <Fragment>\n        {this.props.isDesktop ? desktopItem : mobileItem}\n        {isRevokeDialogOpen &&\n        <InvitationRevokeDialog\n          accepter={item.accepter}\n          token={item.token}\n          revokeInvitation={this.revokeItem}\n          toggleDialog={this.toggleRevokeDialog}\n        />\n        }\n      </Fragment>\n    );\n  }\n}\n\nconst ItemPropTypes = {\n  invitation: PropTypes.object.isRequired,\n};\n\nItem.propTypes = ItemPropTypes;\n\nclass Content extends Component {\n\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    const {\n      loading, errorMsg, invitationsList\n    } = this.props.data;\n\n    if (loading) {\n      return <Loading />;\n    }\n\n    if (errorMsg) {\n      return <p className=\"error text-center mt-2\">{errorMsg}</p>;\n    }\n\n    if (!invitationsList.length) {\n      return (\n        <EmptyTip>\n          <h2>{gettext('No guest invitations')}</h2>\n          <p>{gettext('You have not invited any guests yet. A guest can access shared libraries through the web interface allowing more efficient ways to collaborate than through links. You can invite a guest by clicking the \"Invite Guest\" button in the menu bar.')}</p>\n        </EmptyTip>\n      );\n    }\n\n    const isDesktop = Utils.isDesktop();\n    return (\n      <table className={`table-hover${isDesktop ? '': ' table-thead-hidden'}`}>\n        <thead>\n          {isDesktop ?\n            <tr>\n              <th width=\"25%\">{gettext('Email')}</th>\n              <th width=\"20%\">{gettext('Invite Time')}</th>\n              <th width=\"20%\">{gettext('Expiration')}</th>\n              <th width=\"18%\">{gettext('Accepted')}</th>\n              <th width=\"7%\"></th>\n            </tr>\n            :\n            <tr>\n              <th width=\"92%\"></th>\n              <th width=\"8%\"></th>\n            </tr>\n          }\n        </thead>\n        <tbody>\n          {invitationsList.map((invitation, index) => {\n            return (\n              <Item\n                key={index}\n                isDesktop={isDesktop}\n                invitation={invitation}\n              />\n            );\n          })}\n        </tbody>\n      </table>\n    );\n  }\n}\n\nclass InvitationsView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      errorMsg: '',\n      invitationsList: [],\n      isInvitePeopleDialogOpen: false\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.listInvitations().then((res) => {\n      this.setState({\n        invitationsList: res.data,\n        loading: false\n      });\n    }).catch((error) => {\n      this.setState({\n        loading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  onInvitePeople = (invitationsArray) => {\n    invitationsArray.push.apply(invitationsArray, this.state.invitationsList);\n    this.setState({\n      invitationsList: invitationsArray,\n    });\n  }\n\n  toggleInvitePeopleDialog = () => {\n    this.setState({\n      isInvitePeopleDialogOpen: !this.state.isInvitePeopleDialogOpen\n    });\n  }\n\n  render() {\n    return (\n      <Fragment>\n        <InvitationsToolbar\n          onShowSidePanel={this.props.onShowSidePanel}\n          onSearchedClick={this.props.onSearchedClick}\n          toggleInvitePeopleDialog={this.toggleInvitePeopleDialog}\n        />\n        <div className=\"main-panel-center flex-row\">\n          <div className=\"cur-view-container\">\n            <div className=\"cur-view-path\">\n              <h3 className=\"sf-heading\">{gettext('Invite Guest')}</h3>\n            </div>\n            <div className=\"cur-view-content\">\n              <Content data={this.state} />\n            </div>\n          </div>\n        </div>\n        {this.state.isInvitePeopleDialogOpen &&\n        <InvitePeopleDialog\n          onInvitePeople={this.onInvitePeople}\n          toggleDialog={this.toggleInvitePeopleDialog}\n        />\n        }\n      </Fragment>\n    );\n  }\n}\n\nconst InvitationsViewPropTypes = {\n  onShowSidePanel: PropTypes.func.isRequired,\n  onSearchedClick: PropTypes.func.isRequired,\n};\n\nInvitationsView.propTypes = InvitationsViewPropTypes;\n\nexport default InvitationsView;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter, Input } from 'reactstrap';\n\nconst propTypes = {\n  toggleCancel: PropTypes.func.isRequired,\n  addWiki: PropTypes.func.isRequired,\n};\n\nclass NewWikiDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isExist: false,\n      name: '',\n      repoID: '',\n      isSubmitBtnActive: false,\n    };\n    this.newName = React.createRef();\n  }\n\n  componentDidMount() {\n    this.newName.focus();\n    this.newName.setSelectionRange(0, -1);\n  }\n\n  inputNewName = (e) => {\n    if (!event.target.value.trim()) {\n      this.setState({isSubmitBtnActive: false});\n    } else {\n      this.setState({isSubmitBtnActive: true});\n    }\n\n    this.setState({\n      name: e.target.value,\n    });\n  }\n\n  handleKeyPress = (e) => {\n    if (e.key === 'Enter') {\n      this.handleSubmit();\n    }\n  }\n\n  handleSubmit = () => {\n    let { isExist, name, repoID } = this.state;\n    this.props.addWiki(isExist, name, repoID);\n    this.props.toggleCancel();\n  }\n\n  toggle = () => {\n    this.props.toggleCancel();\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true}>\n        <ModalHeader toggle={this.toggle}>{gettext('New Wiki')}</ModalHeader>\n        <ModalBody>\n          <label className=\"form-label\">{gettext('Name')}</label>\n          <Input onKeyPress={this.handleKeyPress} innerRef={input => {this.newName = input;}} value={this.state.name} onChange={this.inputNewName}/>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.handleSubmit} disabled={!this.state.isSubmitBtnActive}>{gettext('Submit')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nNewWikiDialog.propTypes = propTypes;\n\nexport default NewWikiDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport moment from 'moment';\nimport Repo from '../../models/repo';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  toggleCancel: PropTypes.func.isRequired,\n  addWiki: PropTypes.func.isRequired\n};\n\nclass WikiSelectDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      repos: [],\n      repoID: '',\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.listRepos().then(res => {\n      let repoList = res.data.repos\n        .filter(item => {\n          switch (item.type) {\n            case 'mine': // my libraries\n              return !item.encrypted;\n            case 'shared': // libraries shared with me\n              // 'is_admin': the library is shared with 'admin' permission\n              return !item.encrypted && item.is_admin;\n            case 'group':\n            default:\n              return !item.encrypted && !res.data.repos.some(repo => {\n                // just remove the duplicated libraries\n                return repo.type != item.type && repo.repo_id == item.repo_id;\n              });\n          }\n        })\n        .map(item => {\n          let repo = new Repo(item);\n          return repo;\n        });\n      repoList = Utils.sortRepos(repoList, 'name', 'asc');\n      this.setState({repos: repoList});\n    });\n  }\n\n  onChange = (repo) => {\n    this.setState({\n      repoID: repo.repo_id,\n    });\n  }\n\n  handleSubmit = () => {\n    let { repoID } = this.state;\n    this.props.addWiki(repoID);\n    this.props.toggleCancel();\n  }\n\n  toggle = () => {\n    this.props.toggleCancel();\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true}>\n        <ModalHeader toggle={this.toggle}>{gettext('Publish a Library')}</ModalHeader>\n        <ModalBody className=\"dialog-list-container\">\n          <table>\n            <thead>\n              <tr>\n                <th width='6%'>{/* select */}</th>\n                <th width='9%'>{/* icon */}</th>\n                <th width='55%'>{gettext('Name')}</th>\n                <th width='30%'>{gettext('Last Update')}</th>\n              </tr>\n            </thead>\n            <tbody>\n              {this.state.repos.map((repo, index) => {\n                return (\n                  <tr key={index}>\n                    <td className=\"text-center\"><input type=\"radio\" className=\"vam\" name=\"repo\" value={repo.repo_id} onChange={this.onChange.bind(this, repo)} /></td>\n                    <td className=\"text-center\"><img src={Utils.getLibIconUrl(repo, false)} width=\"24\" title={Utils.getLibIconTitle(repo)} alt={Utils.getLibIconTitle(repo)} /></td>\n                    <td>{repo.repo_name}</td>\n                    <td>{moment(repo.last_modified).fromNow()}</td>\n                  </tr>\n                );\n              })}\n            </tbody>\n          </table>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Cancel')}</Button>\n          {this.state.repoID ?\n            <Button color=\"primary\" onClick={this.handleSubmit}>{gettext('Submit')}</Button>:\n            <Button color=\"primary\" disabled>{gettext('Submit')}</Button>\n          }\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nWikiSelectDialog.propTypes = propTypes;\n\nexport default WikiSelectDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\n\nconst propTypes = {\n  toggleCancel: PropTypes.func.isRequired,\n  handleSubmit: PropTypes.func.isRequired,\n};\n\nclass WikiDeleteDialog extends React.Component {\n\n  toggle = () => {\n    this.props.toggleCancel();\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true} toggle={this.toggle}>\n        <ModalHeader toggle={this.toggle}>{gettext('Unpublish Library')}</ModalHeader>\n        <ModalBody>\n          <p>{gettext('Are you sure you want to unpublish this library?')}</p>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Cancel')}</Button>\n          <Button color=\"primary\" onClick={this.props.handleSubmit}>{gettext('Unpublish')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nWikiDeleteDialog.propTypes = propTypes;\n\nexport default WikiDeleteDialog;\n","import React, { Component, Fragment } from 'react';\nimport { Dropdown, DropdownToggle, DropdownItem } from 'reactstrap';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport { siteRoot, gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\n// import { seafileAPI } from '../../utils/seafile-api';\n// import Toast from '../toast';\nimport ModalPortal from '../modal-portal';\nimport WikiDeleteDialog from '../dialog/wiki-delete-dialog';\n// import Rename from '../rename';\n\nconst propTypes = {\n  wiki: PropTypes.object.isRequired,\n  // renameWiki: PropTypes.func.isRequired,\n  deleteWiki: PropTypes.func.isRequired,\n  isItemFreezed: PropTypes.bool.isRequired,\n  onFreezedItem: PropTypes.func.isRequired,\n  onUnfreezedItem: PropTypes.func.isRequired,\n};\n\nclass WikiListItem extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOpMenuOpen: false, // for mobile\n      isShowDeleteDialog: false,\n      // isRenameing: false,\n      highlight: false,\n      // permission: this.props.wiki.permission,\n    };\n  }\n\n  toggleOpMenu = () => {\n    this.setState({\n      isOpMenuOpen: !this.state.isOpMenuOpen\n    });\n  }\n\n  // clickMenuToggle = (e) => {\n  //   e.preventDefault();\n  //   this.onMenuToggle(e);\n  // }\n\n  // onMenuToggle = (e) => {\n  //   let targetType = e.target.dataset.toggle;\n  //   if (targetType !== 'item') {\n  //     if (this.props.isItemFreezed) {\n  //       this.setState({\n  //         highlight: false,\n  //         isShowMenuControl: false,\n  //         isShowWikiMenu: !this.state.isShowWikiMenu\n  //       });\n  //       this.props.onUnfreezedItem();\n  //     } else {\n  //       this.setState({\n  //         isShowWikiMenu: !this.state.isShowWikiMenu\n  //       });\n  //       this.props.onFreezedItem();\n  //     }\n  //   }\n  // }\n\n  onMouseEnter = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({ highlight: true });\n    }\n  }\n\n  onMouseLeave = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({ highlight: false });\n    }\n  }\n\n  // changePerm = (permission) => {\n  //   let wiki = this.props.wiki;\n  //   seafileAPI.updateWikiPermission(wiki.slug, permission).then(() => {\n  //     this.setState({permission: permission});\n  //   }).catch((error) => {\n  //     if(error.response) {\n  //       let errorMsg = error.response.data.error_msg;\n  //       Toast.danger(errorMsg);\n  //     }\n  //   });\n  // }\n\n  // onRenameToggle = (e) => {\n  //   this.props.onFreezedItem();\n  //   this.setState({\n  //     isShowWikiMenu: false,\n  //     isShowMenuControl: false,\n  //     isRenameing: true,\n  //   });\n  // }\n\n  // onRenameConfirm = (newName) => {\n  //   this.renameWiki(newName);\n  //   this.onRenameCancel();\n  // }\n\n  // onRenameCancel = () => {\n  //   this.props.onUnfreezedItem();\n  //   this.setState({isRenameing: false});\n  // }\n\n  onDeleteToggle = () => {\n    this.props.onUnfreezedItem();\n    this.setState({\n      isShowDeleteDialog: !this.state.isShowDeleteDialog,\n    });\n  }\n\n  onDeleteCancel = () => {\n    this.props.onUnfreezedItem();\n    this.setState({\n      isShowDeleteDialog: !this.state.isShowDeleteDialog,\n    });\n  }\n\n  // renameWiki = (newName) => {\n  //   let wiki = this.props.wiki;\n  //   this.props.renameWiki(wiki, newName);\n  // }\n\n  deleteWiki = () => {\n    let wiki = this.props.wiki;\n    this.props.deleteWiki(wiki);\n    this.setState({\n      isShowDeleteDialog: !this.state.isShowDeleteDialog,\n    });\n  }\n\n  render() {\n    let wiki = this.props.wiki;\n    let userProfileURL = `${siteRoot}profile/${encodeURIComponent(wiki.owner)}/`;\n    let fileIconUrl = Utils.getDefaultLibIconUrl(false);\n    let deleteIcon = `action-icon sf2-icon-x3 ${this.state.highlight ? '' : 'invisible'}`;\n\n    const desktopItem = (\n      <tr className={this.state.highlight ? 'tr-highlight' : ''} onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave}>\n        <td><img src={fileIconUrl} width=\"24\" alt=\"\" /></td>\n        <td className=\"name\">\n          <a href={wiki.link}>{wiki.name}</a>\n          {/*this.state.isRenameing ?\n              <Rename wiki={wiki} name={wiki.name} onRenameConfirm={this.onRenameConfirm} onRenameCancel={this.onRenameCancel}/> :\n              <a href={wiki.link}>{wiki.name}</a>\n            */}\n        </td>\n        <td><a href={userProfileURL} target='_blank'>{wiki.owner_nickname}</a></td>\n        <td>{moment(wiki.updated_at).fromNow()}</td>\n        <td className=\"text-center cursor-pointer\">\n          <span className={deleteIcon} onClick={this.onDeleteToggle}></span>\n        </td>\n      </tr>\n    );\n\n    const mobileItem = (\n      <tr className={this.state.highlight ? 'tr-highlight' : ''} onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave}>\n        <td><img src={fileIconUrl} width=\"24\" alt=\"\" /></td>\n        <td>\n          <a href={wiki.link}>{wiki.name}</a><br />\n          <a href={userProfileURL} target='_blank' className=\"item-meta-info\">{wiki.owner_nickname}</a>\n          <span className=\"item-meta-info\">{moment(wiki.updated_at).fromNow()}</span>\n        </td>\n        <td>\n          <Dropdown isOpen={this.state.isOpMenuOpen} toggle={this.toggleOpMenu}>\n            <DropdownToggle\n              tag=\"i\"\n              className=\"sf-dropdown-toggle fa fa-ellipsis-v ml-0\"\n              title={gettext('More Operations')}\n              data-toggle=\"dropdown\"\n              aria-expanded={this.state.isOpMenuOpen}\n            />\n            <div className={this.state.isOpMenuOpen ? '' : 'd-none'} onClick={this.toggleOpMenu}>\n              <div className=\"mobile-operation-menu-bg-layer\"></div>\n              <div className=\"mobile-operation-menu\">\n                <DropdownItem className=\"mobile-menu-item\" onClick={this.onDeleteToggle}>{gettext('Unpublish')}</DropdownItem>\n              </div>\n            </div>\n          </Dropdown>\n        </td>\n      </tr>\n    );\n\n    return (\n      <Fragment>\n        {Utils.isDesktop() ? desktopItem : mobileItem}\n        {this.state.isShowDeleteDialog &&\n          <ModalPortal>\n            <WikiDeleteDialog\n              toggleCancel={this.onDeleteCancel}\n              handleSubmit={this.deleteWiki}\n            />\n          </ModalPortal>\n        }\n      </Fragment>\n    );\n  }\n}\n\nWikiListItem.propTypes = propTypes;\n\nexport default WikiListItem;\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport WikiListItem from './wiki-list-item';\nimport LibsMobileThead from '../libs-mobile-thead';\n\nconst propTypes = {\n  data: PropTypes.object.isRequired,\n  renameWiki: PropTypes.func.isRequired,\n  deleteWiki: PropTypes.func.isRequired,\n};\n\nclass WikiListView extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isItemFreezed: false,\n    };\n  }\n\n  onFreezedItem = () => {\n    this.setState({isItemFreezed: true});\n  }\n\n  onUnfreezedItem = () => {\n    this.setState({isItemFreezed: false});\n  }\n\n  render() {\n    let { loading, errorMsg, wikis } = this.props.data;\n\n    if (loading) {\n      return <span className=\"loading-icon loading-tip\"></span>;\n    } else if (errorMsg) {\n      return <p className=\"error text-center\">{errorMsg}</p>;\n    } else {\n      const isDesktop = Utils.isDesktop();\n      const desktopThead = (\n        <thead>\n          <tr>\n            <th width=\"4%\"></th>\n            <th width=\"36%\">{gettext('Name')}</th>\n            <th width=\"25%\">{gettext('Owner')}</th>\n            <th width=\"25%\">{gettext('Last Update')}</th>\n            <th width=\"10%\">{/* operation */}</th>\n          </tr>\n        </thead>\n      );\n      return (\n        <table className={isDesktop ? '' : 'table-thead-hidden'}>\n          {isDesktop ? desktopThead : <LibsMobileThead />}\n          <tbody>\n            {wikis.map((wiki, index) => {\n              return (\n                <WikiListItem\n                  key={index}\n                  wiki={wiki}\n                  renameWiki={this.props.renameWiki}\n                  deleteWiki={this.props.deleteWiki}\n                  isItemFreezed={this.state.isItemFreezed}\n                  onFreezedItem={this.onFreezedItem}\n                  onUnfreezedItem={this.onUnfreezedItem}\n                />\n              );\n            })}\n          </tbody>\n        </table>\n      );\n    }\n  }\n}\n\nWikiListView.propTypes = propTypes;\n\nexport default WikiListView;\n","import React, { Component, Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Button } from 'reactstrap';\nimport MediaQuery from 'react-responsive';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { gettext } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../../components/toast';\nimport ModalPortal from '../../components/modal-portal';\nimport EmptyTip from '../../components/empty-tip';\nimport CommonToolbar from '../../components/toolbar/common-toolbar';\nimport NewWikiDialog from '../../components/dialog/new-wiki-dialog';\nimport WikiSelectDialog from '../../components/dialog/wiki-select-dialog';\nimport WikiListView from '../../components/wiki-list-view/wiki-list-view';\n\nconst propTypes = {\n  onShowSidePanel: PropTypes.func.isRequired,\n  onSearchedClick: PropTypes.func.isRequired,\n};\n\nclass Wikis extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      errorMsg: '',\n      wikis: [],\n      isShowAddWikiMenu: false,\n      isShowSelectDialog: false,\n      isShowCreateDialog: false,\n    };\n  }\n\n  componentDidMount() {\n    this.getWikis();\n  }\n\n  getWikis = () => {\n    seafileAPI.listWikis().then(res => {\n      this.setState({\n        loading: false,\n        wikis: res.data.data\n      });\n    }).catch((error) => {\n      this.setState({\n        loading: false,\n        errorMsg: Utils.getErrorMsg(error, true) // true: show login tip if 403\n      });\n    });\n  }\n\n  clickMenuToggle = (e) => {\n    e.preventDefault();\n    this.onMenuToggle();\n  }\n\n  onMenuToggle = () => {\n    this.setState({isShowAddWikiMenu: !this.state.isShowAddWikiMenu});\n  }\n\n  onSelectToggle = () => {\n    this.setState({isShowSelectDialog: !this.state.isShowSelectDialog});\n  }\n\n  onCreateToggle = () => {\n    this.setState({isShowCreateDialog: !this.state.isShowCreateDialog});\n  }\n\n  addWiki = (repoID) => {\n    seafileAPI.addWiki(repoID).then((res) => {\n      this.state.wikis.push(res.data);\n      this.setState({wikis: this.state.wikis});\n    }).catch((error) => {\n      if(error.response) {\n        let errorMsg = error.response.data.error_msg;\n        toaster.danger(errorMsg);\n      }\n    });\n  }\n\n  renameWiki = (wiki, newName) => {\n    seafileAPI.renameWiki(wiki.slug, newName).then((res) => {\n      let wikis = this.state.wikis.map((item) => {\n        if (item.name === wiki.name) {\n          item = res.data;\n        }\n        return item;\n      });\n      this.setState({wikis: wikis});\n    }).catch((error) => {\n      if(error.response) {\n        let errorMsg = error.response.data.error_msg;\n        toaster.danger(errorMsg);\n      }\n    });\n  }\n\n  deleteWiki = (wiki) => {\n    seafileAPI.deleteWiki(wiki.slug).then(() => {\n      let wikis = this.state.wikis.filter(item => {\n        return item.name !== wiki.name;\n      });\n      this.setState({wikis: wikis});\n    }).catch((error) => {\n      if(error.response) {\n        let errorMsg = error.response.data.error_msg;\n        toaster.danger(errorMsg);\n      }\n    });\n  }\n\n  render() {\n    return (\n      <Fragment>\n        <div className=\"main-panel-north border-left-show\">\n          <div className=\"cur-view-toolbar\">\n            <span className=\"sf2-icon-menu side-nav-toggle hidden-md-up d-md-none\" title=\"Side Nav Menu\" onClick={this.props.onShowSidePanel}></span>\n            <div className=\"operation\">\n              <Fragment>\n                <MediaQuery query=\"(min-width: 768px)\">\n                  <Button className=\"btn btn-secondary operation-item\" onClick={this.onSelectToggle}>{gettext('Publish a Library')}</Button>\n                </MediaQuery>\n                <MediaQuery query=\"(max-width: 767.8px)\">\n                  <span className=\"sf2-icon-plus mobile-toolbar-icon\" title={gettext('Publish a Library')} onClick={this.onSelectToggle}></span>\n                </MediaQuery>\n              </Fragment>\n            </div>\n          </div>\n          <CommonToolbar onSearchedClick={this.props.onSearchedClick} />\n        </div>\n        <div className=\"main-panel-center\">\n          <div className=\"cur-view-container\" id=\"wikis\">\n            <div className=\"cur-view-path\">\n              <div className=\"path-container\">\n                <h3 className=\"sf-heading m-0\">{gettext('Published Libraries')}</h3>\n              </div>\n            </div>\n            <div className=\"cur-view-content\">\n              {(this.state.loading || this.state.wikis.length !== 0) &&\n                <WikiListView\n                  data={this.state}\n                  renameWiki={this.renameWiki}\n                  deleteWiki={this.deleteWiki}\n                />\n              }\n              {(!this.state.loading && this.state.wikis.length === 0) &&\n                <EmptyTip>\n                  <h2>{gettext('No published libraries')}</h2>\n                  <p>{gettext('You have not published any libraries yet. A published library can be accessed by anyone, not only users, via its URL. You can publish a library by clicking the \"Publish a Library\" button in the menu bar.')}</p>\n                </EmptyTip>\n              }\n            </div>\n          </div>\n        </div>\n        {this.state.isShowCreateDialog && (\n          <ModalPortal>\n            <NewWikiDialog\n              toggleCancel={this.onCreateToggle}\n              addWiki={this.addWiki}\n            />\n          </ModalPortal>\n        )}\n        {this.state.isShowSelectDialog && (\n          <ModalPortal>\n            <WikiSelectDialog\n              toggleCancel={this.onSelectToggle}\n              addWiki={this.addWiki}\n            />\n          </ModalPortal>\n        )}\n      </Fragment>\n    );\n  }\n}\n\nWikis.propTypes = propTypes;\n\nexport default Wikis;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport CommonToolbar from './common-toolbar';\n\nconst propTypes = {\n  searchPlaceholder: PropTypes.string,\n  onShowSidePanel: PropTypes.func.isRequired,\n  onSearchedClick: PropTypes.func.isRequired,\n};\n\nclass GeneralToolbar extends React.Component {\n\n  render() {\n    // todo get repoID?\n    let { onShowSidePanel, onSearchedClick } = this.props;\n    return (\n      <div className=\"main-panel-north\">\n        <div className=\"cur-view-toolbar\">\n          <span\n            className=\"sf2-icon-menu side-nav-toggle hidden-md-up d-md-none\"\n            title=\"Side Nav Menu\"\n            onClick={onShowSidePanel}>\n          </span>\n        </div>\n        <CommonToolbar\n          searchPlaceholder={this.props.searchPlaceholder}\n          onSearchedClick={onSearchedClick}\n        />\n      </div>\n    );\n  }\n}\n\nGeneralToolbar.propTypes = propTypes;\n\nexport default GeneralToolbar;\n","import React, { Fragment } from 'react';\nimport GeneralToolBar from './toolbar/general-toolbar';\n\nconst MainContentWrapper = (WrapperedComponent) => {\n  return class Wrapper extends React.Component {\n\n    constructor(props) {\n      super(props);\n    }\n\n    render() {\n      return (\n        <Fragment>\n          <GeneralToolBar {...this.props} />\n          <WrapperedComponent {...this.props} />\n        </Fragment>\n      );\n    }\n  };\n};\n\nexport default MainContentWrapper;\n","import React, { Component } from 'react';\nimport ReactDOM from 'react-dom';\nimport { Router, navigate } from '@reach/router';\nimport MediaQuery from 'react-responsive';\nimport { Modal } from 'reactstrap';\nimport { siteRoot, canAddRepo, isDocs } from './utils/constants';\nimport { Utils } from './utils/utils';\nimport SystemNotification from './components/system-notification';\nimport SidePanel from './components/side-panel';\nimport MainPanel from './components/main-panel';\nimport DraftsView from './pages/drafts/drafts-view';\nimport DraftContent from './pages/drafts/draft-content';\nimport FilesActivities from './pages/dashboard/files-activities';\nimport Starred from './pages/starred/starred';\nimport LinkedDevices from './pages/linked-devices/linked-devices';\nimport editUtilities from './utils/editor-utilities';\nimport ShareAdminLibraries from './pages/share-admin/libraries';\nimport ShareAdminFolders from './pages/share-admin/folders';\nimport ShareAdminShareLinks from './pages/share-admin/share-links';\nimport ShareAdminUploadLinks from './pages/share-admin/upload-links';\nimport SharedLibraries from './pages/shared-libs/shared-libs';\nimport ShareWithOCM from './pages/share-with-ocm/shared-with-ocm';\nimport OCMRepoDir from './pages/share-with-ocm/remote-dir-view';\nimport MyLibraries from './pages/my-libs/my-libs';\nimport MyLibDeleted from './pages/my-libs/my-libs-deleted';\nimport PublicSharedView from './pages/shared-with-all/public-shared-view';\nimport LibContentView from './pages/lib-content-view/lib-content-view';\nimport Group from './pages/groups/group-view';\nimport Groups from './pages/groups/groups-view';\nimport InvitationsView from './pages/invitations/invitations-view';\nimport Wikis from './pages/wikis/wikis';\nimport MainContentWrapper from './components/main-content-wrapper';\n\nimport './css/layout.css';\nimport './css/toolbar.css';\nimport './css/search.css';\n\nconst FilesActivitiesWrapper = MainContentWrapper(FilesActivities);\nconst DraftsViewWrapper = MainContentWrapper(DraftsView);\nconst StarredWrapper = MainContentWrapper(Starred);\nconst LinkedDevicesWrapper = MainContentWrapper(LinkedDevices);\nconst SharedLibrariesWrapper = MainContentWrapper(SharedLibraries);\nconst SharedWithOCMWrapper = MainContentWrapper(ShareWithOCM);\nconst ShareAdminLibrariesWrapper = MainContentWrapper(ShareAdminLibraries);\nconst ShareAdminFoldersWrapper = MainContentWrapper(ShareAdminFolders);\nconst ShareAdminShareLinksWrapper = MainContentWrapper(ShareAdminShareLinks);\nconst ShareAdminUploadLinksWrapper = MainContentWrapper(ShareAdminUploadLinks);\n\nclass App extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOpen: false,\n      isSidePanelClosed: false,\n      draftCounts: 0,\n      draftList:[],\n      isLoadingDraft: true,\n      currentTab: '/',\n      pathPrefix: [],\n    };\n    this.dirViewPanels = ['my-libs', 'shared-libs', 'org']; // and group\n    window.onpopstate = this.onpopstate;\n  }\n\n  onpopstate = (event) => {\n    if (event.state && event.state.currentTab && event.state.pathPrefix) {\n      let { currentTab, pathPrefix } = event.state;\n      this.setState({currentTab, pathPrefix});\n    }\n  }\n\n  componentWillMount() {\n    if (!Utils.isDesktop()) {\n      this.setState({\n        isSidePanelClosed: true\n      });\n    }\n  }\n\n  navigateClientUrlToLib = () =>{\n    if(window.location.hash && window.location.hash.indexOf('common/lib') != -1){\n      let splitUrlArray = window.location.hash.split('/');\n      let repoID = splitUrlArray[splitUrlArray.length - 2];\n      let url = siteRoot + 'library/' + repoID + '/';\n      navigate(url, {repalce: true});\n    }\n  }\n\n  componentDidMount() {\n    // url from client  e.g. http://127.0.0.1:8000/#common/lib/34e7fb92-e91d-499d-bcde-c30ea8af9828/\n    // navigate to library page http://127.0.0.1:8000/library/34e7fb92-e91d-499d-bcde-c30ea8af9828/\n    this.navigateClientUrlToLib();\n\n    // e.g.  from http://127.0.0.1:8000/drafts/reviews/\n    // get reviews\n    // TODO: need refactor later\n    let href = window.location.href.split('/');\n    if (isDocs) {\n      this.getDrafts();\n    }\n    this.setState({currentTab: href[href.length - 2]});\n  }\n\n  getDrafts = () => {\n    editUtilities.listDrafts().then(res => {\n      this.setState({\n        draftCounts: res.data.draft_counts,\n        draftList: res.data.data,\n        isLoadingDraft: false,\n      });\n    });\n  }\n\n  updateDraftsList = (draft_id) => {\n    this.setState({\n      draftCounts: this.state.draftCounts - 1,\n      draftList: this.state.draftList.filter(draft => draft.id != draft_id),\n    });\n  }\n\n  onCloseSidePanel = () => {\n    this.setState({\n      isSidePanelClosed: !this.state.isSidePanelClosed\n    });\n  }\n\n  onShowSidePanel = () => {\n    this.setState({\n      isSidePanelClosed: !this.state.isSidePanelClosed\n    });\n  }\n\n  onSearchedClick = (selectedItem) => {\n    if (selectedItem.is_dir === true) {\n      this.setState({currentTab: '', pathPrefix: []});\n      let url = siteRoot + 'library/' + selectedItem.repo_id + '/' + selectedItem.repo_name + selectedItem.path;\n      navigate(url, {repalce: true});\n    } else {\n      let url = siteRoot + 'lib/' + selectedItem.repo_id + '/file' + Utils.encodePath(selectedItem.path);\n      let isWeChat = Utils.isWeChat();\n      if (!isWeChat) {\n        let newWindow = window.open('about:blank');\n        newWindow.location.href = url;\n      } else {\n        location.href = url;\n      }\n    }\n  }\n\n  onGroupChanged = (groupID) => {\n    setTimeout(function(){\n      let url;\n      if (groupID) {\n        url = siteRoot + 'group/' + groupID + '/';\n      }\n      else {\n        url = siteRoot + 'groups/';\n      }\n      window.location = url.toString();\n    }, 1);\n  }\n\n  tabItemClick = (tabName, groupID) => {\n    let pathPrefix = [];\n    if (groupID || this.dirViewPanels.indexOf(tabName) > -1) {\n      pathPrefix = this.generatorPrefix(tabName, groupID);\n    }\n    this.setState({\n      currentTab: tabName,\n      pathPrefix: pathPrefix\n    }, () => {\n      let { currentTab, pathPrefix } = this.state;\n      window.history.replaceState({currentTab: currentTab, pathPrefix: pathPrefix}, null);\n    });\n    if (!Utils.isDesktop() && !this.state.isSidePanelClosed) {\n      this.setState({ isSidePanelClosed: true });\n    }\n  }\n\n  generatorPrefix = (tabName, groupID) => {\n    let pathPrefix = [];\n    if (groupID) {\n      let navTab1 = {\n        url: siteRoot + 'groups/',\n        showName: 'Groups',\n        name: 'groups',\n        id: null,\n      };\n      let navTab2 = {\n        url: siteRoot + 'group/' + groupID + '/',\n        showName: tabName,\n        name: tabName,\n        id: groupID,\n      };\n      pathPrefix.push(navTab1);\n      pathPrefix.push(navTab2);\n    } else {\n      let navTab = {\n        url: siteRoot + tabName + '/',\n        showName: this.getTabShowName(tabName),\n        name: tabName,\n        id: null,\n      };\n      pathPrefix.push(navTab);\n    }\n    return pathPrefix;\n  }\n\n  getTabShowName = (tabName) => {\n    if (tabName === 'my-libs') {\n      return 'Libraries';\n    }\n    if (tabName === 'shared-libs') {\n      return 'Shared with me';\n    }\n    if (tabName === 'org') {\n      return 'Shared with all';\n    }\n  }\n\n  toggleSidePanel = () => {\n    this.setState({\n      isSidePanelClosed: !this.state.isSidePanelClosed\n    });\n  }\n\n  render() {\n    let { currentTab, isSidePanelClosed } = this.state;\n\n    const home = canAddRepo ?\n      <MyLibraries path={ siteRoot } onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} /> :\n      <SharedLibrariesWrapper path={ siteRoot } onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} />;\n\n    return (\n      <React.Fragment>\n        <SystemNotification />\n        <div id=\"main\">\n          <SidePanel isSidePanelClosed={this.state.isSidePanelClosed} onCloseSidePanel={this.onCloseSidePanel} currentTab={currentTab} tabItemClick={this.tabItemClick} draftCounts={this.state.draftCounts} />\n          <MainPanel>\n            <Router className=\"reach-router\">\n              {home}\n              <FilesActivitiesWrapper path={siteRoot + 'dashboard'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} />\n              <DraftsViewWrapper path={siteRoot + 'drafts'}\n                onShowSidePanel={this.onShowSidePanel}\n                onSearchedClick={this.onSearchedClick}\n              >\n                <DraftContent\n                  path='/'\n                  getDrafts={this.getDrafts}\n                  isLoadingDraft={this.state.isLoadingDraft}\n                  draftList={this.state.draftList}\n                  updateDraftsList={this.updateDraftsList}\n                />\n              </DraftsViewWrapper>\n              <StarredWrapper path={siteRoot + 'starred'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} />\n              <LinkedDevicesWrapper path={siteRoot + 'linked-devices'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} />\n              <ShareAdminLibrariesWrapper path={siteRoot + 'share-admin-libs'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} />\n              <ShareAdminFoldersWrapper path={siteRoot + 'share-admin-folders'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} />\n              <ShareAdminShareLinksWrapper path={siteRoot + 'share-admin-share-links'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} />\n              <ShareAdminUploadLinksWrapper path={siteRoot + 'share-admin-upload-links'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} />\n              <SharedLibrariesWrapper path={siteRoot + 'shared-libs'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} />\n              <SharedWithOCMWrapper path={siteRoot + 'shared-with-ocm'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} />\n              <MyLibraries path={siteRoot + 'my-libs'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} />\n              <MyLibDeleted path={siteRoot + 'my-libs/deleted/'} onSearchedClick={this.onSearchedClick} />\n              <LibContentView path={siteRoot + 'library/:repoID/*'} pathPrefix={this.state.pathPrefix} onMenuClick={this.onShowSidePanel} onTabNavClick={this.tabItemClick}/>\n              <OCMRepoDir path={siteRoot + 'remote-library/:providerID/:repoID/*'} pathPrefix={this.state.pathPrefix} onMenuClick={this.onShowSidePanel} onTabNavClick={this.tabItemClick}/>\n              <Groups path={siteRoot + 'groups'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick}/>\n              <Group\n                path={siteRoot + 'group/:groupID'}\n                onShowSidePanel={this.onShowSidePanel}\n                onSearchedClick={this.onSearchedClick}\n                onTabNavClick={this.tabItemClick}\n                onGroupChanged={this.onGroupChanged}\n              />\n              <Wikis path={siteRoot + 'published'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick}/>\n              <PublicSharedView path={siteRoot + 'org/'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} onTabNavClick={this.tabItemClick}/>\n              <InvitationsView path={siteRoot + 'invitations/'} onShowSidePanel={this.onShowSidePanel} onSearchedClick={this.onSearchedClick} />\n            </Router>\n          </MainPanel>\n          <MediaQuery query=\"(max-width: 767.8px)\">\n            <Modal zIndex=\"1030\" isOpen={!isSidePanelClosed} toggle={this.toggleSidePanel} contentClassName=\"d-none\"></Modal>\n          </MediaQuery>\n        </div>\n      </React.Fragment>\n    );\n  }\n}\n\nReactDOM.render(\n  <App />,\n  document.getElementById('wrapper')\n);\n","import React ,{ Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, ModalHeader, ModalBody, ModalFooter, Alert } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport FileChooser from '../file-chooser/file-chooser';\nimport '../../css/dirent-detail.css';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  filePath: PropTypes.string.isRequired,\n  toggleCancel: PropTypes.func.isRequired,\n  onRelatedFileChange: PropTypes.func.isRequired,\n  dirent: PropTypes.object.isRequired,\n  onClose: PropTypes.func,\n};\n\nclass AddRelatedFileDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      repo: null,\n      selectedPath: '',\n      isShowFile: true,\n      errMessage: '',\n    };\n  }\n\n  handleSubmit = () => {\n    this.onAddRelatedFile();\n  }\n\n  onAddRelatedFile = () => {\n    let { repo, selectedPath } = this.state;\n    let oRepoID = this.props.repoID;\n    let rRepoID = repo.repo_id;\n    let oFilePath = this.props.filePath;\n    let rFilePath = selectedPath;\n\n    if (oRepoID === rRepoID && oFilePath === rFilePath) {\n      let message = gettext('Can not select self as a related file.');\n      this.setState({errMessage: message});\n      return;\n    }\n\n    seafileAPI.addRelatedFile(oRepoID, rRepoID, oFilePath, rFilePath).then((res) => {\n      this.props.onRelatedFileChange();\n      this.toggle();\n    }).catch((error) => {\n      let errMessage = Utils.getErrorMsg(error);\n      this.setState({errMessage: errMessage});\n    });\n  }\n\n  toggle = () => {\n    this.props.toggleCancel();\n  }\n\n  onDirentItemClick = (repo, selectedPath, dirent) => {\n    if (dirent.type === 'file') {\n      this.setState({\n        repo: repo,\n        selectedPath: selectedPath,\n      });\n    }\n    else {\n      this.setState({\n        repo: null,\n        selectedPath: '',\n      });\n    }\n  }\n\n  onRepoItemClick = (repo) => {\n    this.setState({\n      repo: null,\n      selectedPath: '',\n    });\n  }\n\n  render() {\n    let subtitle = gettext('Select related file for {placeholder}');\n    subtitle = subtitle.replace('{placeholder}', '<span class=\"op-target\">' + Utils.HTMLescape(this.props.dirent.name) + '</span>');\n    return (\n      <div className=\"sf-add-related-file\">\n        <ModalHeader toggle={this.props.onClose}>\n          <span className=\"tag-dialog-back fas fa-sm fa-arrow-left\" onClick={this.toggle} aria-label={gettext('Back')}></span>\n          {gettext('Select File')}\n        </ModalHeader>\n        <ModalBody>\n          <div className=\"related-file-subtitle\" dangerouslySetInnerHTML={{__html: subtitle}}></div>\n          <FileChooser\n            isShowFile={this.state.isShowFile}\n            repoID={this.props.repoID}\n            onDirentItemClick={this.onDirentItemClick}\n            onRepoItemClick={this.onRepoItemClick}\n            mode=\"current_repo_and_other_repos\"\n          />\n          {this.state.errMessage && <Alert color=\"danger\">{this.state.errMessage}</Alert>}\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Cancel')}</Button>\n          { this.state.selectedPath ?\n            <Button color=\"primary\" onClick={this.handleSubmit}>{gettext('Submit')}</Button>\n            :\n            <Button color=\"primary\" disabled>{gettext('Submit')}</Button>\n          }\n        </ModalFooter>\n      </div>\n    );\n  }\n}\n\nAddRelatedFileDialog.propTypes = propTypes;\n\nexport default AddRelatedFileDialog;\n","import React ,{ Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, ModalHeader, ModalBody, ModalFooter, Table } from 'reactstrap';\nimport Dirent from '../../models/dirent';\nimport { gettext, siteRoot } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\nimport '../../css/list-related-file-dialog.css';\n\nconst propTypes = {\n  relatedFiles: PropTypes.array.isRequired,\n  repoID: PropTypes.string.isRequired,\n  filePath: PropTypes.string.isRequired,\n  toggleCancel: PropTypes.func.isRequired,\n  addRelatedFileToggle: PropTypes.func.isRequired,\n  onRelatedFileChange: PropTypes.func.isRequired,\n};\n\nclass ListRelatedFileDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = ({\n      direntList: [],\n    });\n  }\n\n  onDeleteRelatedFile = (item) => {\n    let filePath = this.props.filePath;\n    let repoID = this.props.repoID;\n    let relatedID = item.related_id;\n    seafileAPI.deleteRelatedFile(repoID, filePath, relatedID).then((res) => {\n      this.props.onRelatedFileChange();\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  toggle = () => {\n    this.props.toggleCancel();\n  }\n\n  getDirentList = (relatedFiles) => {\n    if (relatedFiles.length === 0) {\n      this.setState({\n        direntList: [],\n      });\n      return;\n    }\n    let direntList = [];\n    relatedFiles.map((item) => {\n      seafileAPI.getFileInfo(item.repo_id, item.path).then(res => {\n        let dirent = new Dirent(res.data);\n        dirent['repo_name'] = item.repo_name;\n        dirent['related_id'] = item.related_id;\n        dirent['link'] = siteRoot + 'lib/' + item.repo_id + '/file' + Utils.encodePath(item.path);\n        direntList.push(dirent);\n      });\n    });\n    this.setState({direntList: direntList});\n  }\n\n  componentWillMount() {\n    this.getDirentList(this.props.relatedFiles);\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (nextProps.relatedFiles.length !== this.props.relatedFiles.length) {\n      this.getDirentList(nextProps.relatedFiles);\n    }\n  }\n\n  render() {\n    return (\n      <Fragment>\n        <ModalHeader toggle={this.toggle}>{gettext('Related Files')}</ModalHeader>\n        <ModalBody className={this.state.direntList.length > 0 ? 'list-related-file-body' : ''}>\n          <Table hover size=\"sm\" className=\"list-related-file-table\">\n            <thead>\n              <tr>\n                <th width='40%'>{gettext('Name')}</th>\n                <th width='20%'>{gettext('Library Name')}</th>\n                <th width='13%'>{gettext('Size')}</th>\n                <th width='20%'>{gettext('Last Update')}</th>\n                <th width='5%'></th>\n                <th width='2%'></th>\n              </tr>\n            </thead>\n            <tbody>\n              {\n                this.state.direntList.map((relatedFile, index) => {\n                  return (\n                    <React.Fragment key={index}>\n                      <RelatedFile relatedFile={relatedFile} onDeleteRelatedFile={this.onDeleteRelatedFile}/>\n                    </React.Fragment>\n                  );\n                })\n              }\n            </tbody>\n          </Table>\n          <a href=\"#\" className=\"add-related-file-link\" onClick={this.props.addRelatedFileToggle}>{gettext('Add File')}</a>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggle}>{gettext('Close')}</Button>\n        </ModalFooter>\n      </Fragment>\n    );\n  }\n}\n\nListRelatedFileDialog.propTypes = propTypes;\n\nconst RelatedFilePropTypes = {\n  relatedFile: PropTypes.object,\n  onDeleteRelatedFile: PropTypes.func.isRequired,\n};\n\nclass RelatedFile extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = ({\n      active: false,\n    });\n  }\n\n  onMouseEnter = () => {\n    this.setState({\n      active: true\n    });\n  }\n\n  onMouseLeave = () => {\n    this.setState({\n      active: false\n    });\n  }\n\n  render() {\n    let className = this.state.active ? 'action-icon sf2-icon-x3' : 'action-icon vh sf2-icon-x3';\n    const relatedFile = this.props.relatedFile;\n    return (\n      <tr onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave}>\n        <td><a href={relatedFile.link} target='_blank'>{relatedFile.name}</a></td>\n        <td>{relatedFile.repo_name}</td>\n        <td>{relatedFile.size}</td>\n        <td>{relatedFile.mtime_relative}</td>\n        <td><i className={className} onClick={this.props.onDeleteRelatedFile.bind(this, relatedFile)}></i></td>\n        <td></td>\n      </tr>\n    );\n  }\n}\n\nRelatedFile.propTypes = RelatedFilePropTypes;\n\nexport default ListRelatedFileDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal } from 'reactstrap';\nimport AddRelatedFileDialog from './add-related-file-dialog';\nimport ListRelatedFileDialog from './list-related-file-dialog';\nimport ModalPortal from '../modal-portal';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  filePath: PropTypes.string.isRequired,\n  toggleCancel: PropTypes.func.isRequired,\n  onRelatedFileChange: PropTypes.func.isRequired,\n  dirent: PropTypes.object.isRequired,\n  relatedFiles: PropTypes.array,\n  viewMode: PropTypes.oneOf(['list_related_file','add_related_file']).isRequired,\n};\n\nclass RelatedFileDialogs extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      showListRelatedFileDialog: props.viewMode === 'list_related_file',\n    };\n  }\n\n  onAddRelatedFileToggle = () => {\n    this.setState({\n      showListRelatedFileDialog: false,\n    });\n  }\n\n  onCloseAddRelatedFileDialog = () => {\n    this.setState({\n      showListRelatedFileDialog: true,\n    });\n  }\n\n  render() {\n    return (\n      <ModalPortal>\n        <Modal isOpen={true} toggle={this.props.toggleCancel} size='lg' style={{width:'650px'}}>\n          {this.state.showListRelatedFileDialog &&\n            <ListRelatedFileDialog\n              filePath={this.props.filePath}\n              relatedFiles={this.props.relatedFiles}\n              repoID={this.props.repoID}\n              toggleCancel={this.props.toggleCancel}\n              addRelatedFileToggle={this.onAddRelatedFileToggle}\n              onRelatedFileChange={this.props.onRelatedFileChange}\n            />\n          }\n          {!this.state.showListRelatedFileDialog &&\n            <AddRelatedFileDialog\n              filePath={this.props.filePath}\n              repoID={this.props.repoID}\n              toggleCancel={this.onCloseAddRelatedFileDialog}\n              onRelatedFileChange={this.props.onRelatedFileChange}\n              dirent={this.props.dirent}\n              onClose={this.props.toggleCancel}\n            />\n          }\n        </Modal>\n      </ModalPortal>\n    );\n  }\n}\n\nRelatedFileDialogs.propTypes = propTypes;\n\nexport default RelatedFileDialogs;","/**\n * Helpers.\n */\n\nvar s = 1000;\nvar m = s * 60;\nvar h = m * 60;\nvar d = h * 24;\nvar y = d * 365.25;\n\n/**\n * Parse or format the given `val`.\n *\n * Options:\n *\n *  - `long` verbose formatting [false]\n *\n * @param {String|Number} val\n * @param {Object} [options]\n * @throws {Error} throw an error if val is not a non-empty string or a number\n * @return {String|Number}\n * @api public\n */\n\nmodule.exports = function(val, options) {\n  options = options || {};\n  var type = typeof val;\n  if (type === 'string' && val.length > 0) {\n    return parse(val);\n  } else if (type === 'number' && isNaN(val) === false) {\n    return options.long ? fmtLong(val) : fmtShort(val);\n  }\n  throw new Error(\n    'val is not a non-empty string or a valid number. val=' +\n      JSON.stringify(val)\n  );\n};\n\n/**\n * Parse the given `str` and return milliseconds.\n *\n * @param {String} str\n * @return {Number}\n * @api private\n */\n\nfunction parse(str) {\n  str = String(str);\n  if (str.length > 100) {\n    return;\n  }\n  var match = /^((?:\\d+)?\\.?\\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(\n    str\n  );\n  if (!match) {\n    return;\n  }\n  var n = parseFloat(match[1]);\n  var type = (match[2] || 'ms').toLowerCase();\n  switch (type) {\n    case 'years':\n    case 'year':\n    case 'yrs':\n    case 'yr':\n    case 'y':\n      return n * y;\n    case 'days':\n    case 'day':\n    case 'd':\n      return n * d;\n    case 'hours':\n    case 'hour':\n    case 'hrs':\n    case 'hr':\n    case 'h':\n      return n * h;\n    case 'minutes':\n    case 'minute':\n    case 'mins':\n    case 'min':\n    case 'm':\n      return n * m;\n    case 'seconds':\n    case 'second':\n    case 'secs':\n    case 'sec':\n    case 's':\n      return n * s;\n    case 'milliseconds':\n    case 'millisecond':\n    case 'msecs':\n    case 'msec':\n    case 'ms':\n      return n;\n    default:\n      return undefined;\n  }\n}\n\n/**\n * Short format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtShort(ms) {\n  if (ms >= d) {\n    return Math.round(ms / d) + 'd';\n  }\n  if (ms >= h) {\n    return Math.round(ms / h) + 'h';\n  }\n  if (ms >= m) {\n    return Math.round(ms / m) + 'm';\n  }\n  if (ms >= s) {\n    return Math.round(ms / s) + 's';\n  }\n  return ms + 'ms';\n}\n\n/**\n * Long format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtLong(ms) {\n  return plural(ms, d, 'day') ||\n    plural(ms, h, 'hour') ||\n    plural(ms, m, 'minute') ||\n    plural(ms, s, 'second') ||\n    ms + ' ms';\n}\n\n/**\n * Pluralization helper.\n */\n\nfunction plural(ms, n, name) {\n  if (ms < n) {\n    return;\n  }\n  if (ms < n * 1.5) {\n    return Math.floor(ms / n) + ' ' + name;\n  }\n  return Math.ceil(ms / n) + ' ' + name + 's';\n}\n","\n/**\n * Module dependencies.\n */\n\nvar debug = require('debug')('socket.io-parser');\nvar Emitter = require('component-emitter');\nvar binary = require('./binary');\nvar isArray = require('isarray');\nvar isBuf = require('./is-buffer');\n\n/**\n * Protocol version.\n *\n * @api public\n */\n\nexports.protocol = 4;\n\n/**\n * Packet types.\n *\n * @api public\n */\n\nexports.types = [\n  'CONNECT',\n  'DISCONNECT',\n  'EVENT',\n  'ACK',\n  'ERROR',\n  'BINARY_EVENT',\n  'BINARY_ACK'\n];\n\n/**\n * Packet type `connect`.\n *\n * @api public\n */\n\nexports.CONNECT = 0;\n\n/**\n * Packet type `disconnect`.\n *\n * @api public\n */\n\nexports.DISCONNECT = 1;\n\n/**\n * Packet type `event`.\n *\n * @api public\n */\n\nexports.EVENT = 2;\n\n/**\n * Packet type `ack`.\n *\n * @api public\n */\n\nexports.ACK = 3;\n\n/**\n * Packet type `error`.\n *\n * @api public\n */\n\nexports.ERROR = 4;\n\n/**\n * Packet type 'binary event'\n *\n * @api public\n */\n\nexports.BINARY_EVENT = 5;\n\n/**\n * Packet type `binary ack`. For acks with binary arguments.\n *\n * @api public\n */\n\nexports.BINARY_ACK = 6;\n\n/**\n * Encoder constructor.\n *\n * @api public\n */\n\nexports.Encoder = Encoder;\n\n/**\n * Decoder constructor.\n *\n * @api public\n */\n\nexports.Decoder = Decoder;\n\n/**\n * A socket.io Encoder instance\n *\n * @api public\n */\n\nfunction Encoder() {}\n\nvar ERROR_PACKET = exports.ERROR + '\"encode error\"';\n\n/**\n * Encode a packet as a single string if non-binary, or as a\n * buffer sequence, depending on packet type.\n *\n * @param {Object} obj - packet object\n * @param {Function} callback - function to handle encodings (likely engine.write)\n * @return Calls callback with Array of encodings\n * @api public\n */\n\nEncoder.prototype.encode = function(obj, callback){\n  debug('encoding packet %j', obj);\n\n  if (exports.BINARY_EVENT === obj.type || exports.BINARY_ACK === obj.type) {\n    encodeAsBinary(obj, callback);\n  } else {\n    var encoding = encodeAsString(obj);\n    callback([encoding]);\n  }\n};\n\n/**\n * Encode packet as string.\n *\n * @param {Object} packet\n * @return {String} encoded\n * @api private\n */\n\nfunction encodeAsString(obj) {\n\n  // first is type\n  var str = '' + obj.type;\n\n  // attachments if we have them\n  if (exports.BINARY_EVENT === obj.type || exports.BINARY_ACK === obj.type) {\n    str += obj.attachments + '-';\n  }\n\n  // if we have a namespace other than `/`\n  // we append it followed by a comma `,`\n  if (obj.nsp && '/' !== obj.nsp) {\n    str += obj.nsp + ',';\n  }\n\n  // immediately followed by the id\n  if (null != obj.id) {\n    str += obj.id;\n  }\n\n  // json data\n  if (null != obj.data) {\n    var payload = tryStringify(obj.data);\n    if (payload !== false) {\n      str += payload;\n    } else {\n      return ERROR_PACKET;\n    }\n  }\n\n  debug('encoded %j as %s', obj, str);\n  return str;\n}\n\nfunction tryStringify(str) {\n  try {\n    return JSON.stringify(str);\n  } catch(e){\n    return false;\n  }\n}\n\n/**\n * Encode packet as 'buffer sequence' by removing blobs, and\n * deconstructing packet into object with placeholders and\n * a list of buffers.\n *\n * @param {Object} packet\n * @return {Buffer} encoded\n * @api private\n */\n\nfunction encodeAsBinary(obj, callback) {\n\n  function writeEncoding(bloblessData) {\n    var deconstruction = binary.deconstructPacket(bloblessData);\n    var pack = encodeAsString(deconstruction.packet);\n    var buffers = deconstruction.buffers;\n\n    buffers.unshift(pack); // add packet info to beginning of data list\n    callback(buffers); // write all the buffers\n  }\n\n  binary.removeBlobs(obj, writeEncoding);\n}\n\n/**\n * A socket.io Decoder instance\n *\n * @return {Object} decoder\n * @api public\n */\n\nfunction Decoder() {\n  this.reconstructor = null;\n}\n\n/**\n * Mix in `Emitter` with Decoder.\n */\n\nEmitter(Decoder.prototype);\n\n/**\n * Decodes an encoded packet string into packet JSON.\n *\n * @param {String} obj - encoded packet\n * @return {Object} packet\n * @api public\n */\n\nDecoder.prototype.add = function(obj) {\n  var packet;\n  if (typeof obj === 'string') {\n    packet = decodeString(obj);\n    if (exports.BINARY_EVENT === packet.type || exports.BINARY_ACK === packet.type) { // binary packet's json\n      this.reconstructor = new BinaryReconstructor(packet);\n\n      // no attachments, labeled binary but no binary data to follow\n      if (this.reconstructor.reconPack.attachments === 0) {\n        this.emit('decoded', packet);\n      }\n    } else { // non-binary full packet\n      this.emit('decoded', packet);\n    }\n  } else if (isBuf(obj) || obj.base64) { // raw binary data\n    if (!this.reconstructor) {\n      throw new Error('got binary data when not reconstructing a packet');\n    } else {\n      packet = this.reconstructor.takeBinaryData(obj);\n      if (packet) { // received final buffer\n        this.reconstructor = null;\n        this.emit('decoded', packet);\n      }\n    }\n  } else {\n    throw new Error('Unknown type: ' + obj);\n  }\n};\n\n/**\n * Decode a packet String (JSON data)\n *\n * @param {String} str\n * @return {Object} packet\n * @api private\n */\n\nfunction decodeString(str) {\n  var i = 0;\n  // look up type\n  var p = {\n    type: Number(str.charAt(0))\n  };\n\n  if (null == exports.types[p.type]) {\n    return error('unknown packet type ' + p.type);\n  }\n\n  // look up attachments if type binary\n  if (exports.BINARY_EVENT === p.type || exports.BINARY_ACK === p.type) {\n    var buf = '';\n    while (str.charAt(++i) !== '-') {\n      buf += str.charAt(i);\n      if (i == str.length) break;\n    }\n    if (buf != Number(buf) || str.charAt(i) !== '-') {\n      throw new Error('Illegal attachments');\n    }\n    p.attachments = Number(buf);\n  }\n\n  // look up namespace (if any)\n  if ('/' === str.charAt(i + 1)) {\n    p.nsp = '';\n    while (++i) {\n      var c = str.charAt(i);\n      if (',' === c) break;\n      p.nsp += c;\n      if (i === str.length) break;\n    }\n  } else {\n    p.nsp = '/';\n  }\n\n  // look up id\n  var next = str.charAt(i + 1);\n  if ('' !== next && Number(next) == next) {\n    p.id = '';\n    while (++i) {\n      var c = str.charAt(i);\n      if (null == c || Number(c) != c) {\n        --i;\n        break;\n      }\n      p.id += str.charAt(i);\n      if (i === str.length) break;\n    }\n    p.id = Number(p.id);\n  }\n\n  // look up json data\n  if (str.charAt(++i)) {\n    var payload = tryParse(str.substr(i));\n    var isPayloadValid = payload !== false && (p.type === exports.ERROR || isArray(payload));\n    if (isPayloadValid) {\n      p.data = payload;\n    } else {\n      return error('invalid payload');\n    }\n  }\n\n  debug('decoded %s as %j', str, p);\n  return p;\n}\n\nfunction tryParse(str) {\n  try {\n    return JSON.parse(str);\n  } catch(e){\n    return false;\n  }\n}\n\n/**\n * Deallocates a parser's resources\n *\n * @api public\n */\n\nDecoder.prototype.destroy = function() {\n  if (this.reconstructor) {\n    this.reconstructor.finishedReconstruction();\n  }\n};\n\n/**\n * A manager of a binary event's 'buffer sequence'. Should\n * be constructed whenever a packet of type BINARY_EVENT is\n * decoded.\n *\n * @param {Object} packet\n * @return {BinaryReconstructor} initialized reconstructor\n * @api private\n */\n\nfunction BinaryReconstructor(packet) {\n  this.reconPack = packet;\n  this.buffers = [];\n}\n\n/**\n * Method to be called when binary data received from connection\n * after a BINARY_EVENT packet.\n *\n * @param {Buffer | ArrayBuffer} binData - the raw binary data received\n * @return {null | Object} returns null if more binary data is expected or\n *   a reconstructed packet object if all buffers have been received.\n * @api private\n */\n\nBinaryReconstructor.prototype.takeBinaryData = function(binData) {\n  this.buffers.push(binData);\n  if (this.buffers.length === this.reconPack.attachments) { // done with buffer list\n    var packet = binary.reconstructPacket(this.reconPack, this.buffers);\n    this.finishedReconstruction();\n    return packet;\n  }\n  return null;\n};\n\n/**\n * Cleans up binary packet reconstruction variables.\n *\n * @api private\n */\n\nBinaryReconstructor.prototype.finishedReconstruction = function() {\n  this.reconPack = null;\n  this.buffers = [];\n};\n\nfunction error(msg) {\n  return {\n    type: exports.ERROR,\n    data: 'parser error: ' + msg\n  };\n}\n","// browser shim for xmlhttprequest module\n\nvar hasCORS = require('has-cors');\n\nmodule.exports = function (opts) {\n  var xdomain = opts.xdomain;\n\n  // scheme must be same when usign XDomainRequest\n  // http://blogs.msdn.com/b/ieinternals/archive/2010/05/13/xdomainrequest-restrictions-limitations-and-workarounds.aspx\n  var xscheme = opts.xscheme;\n\n  // XDomainRequest has a flow of not sending cookie, therefore it should be disabled as a default.\n  // https://github.com/Automattic/engine.io-client/pull/217\n  var enablesXDR = opts.enablesXDR;\n\n  // XMLHttpRequest can be disabled on IE\n  try {\n    if ('undefined' !== typeof XMLHttpRequest && (!xdomain || hasCORS)) {\n      return new XMLHttpRequest();\n    }\n  } catch (e) { }\n\n  // Use XDomainRequest for IE8 if enablesXDR is true\n  // because loading bar keeps flashing when using jsonp-polling\n  // https://github.com/yujiosaka/socke.io-ie8-loading-example\n  try {\n    if ('undefined' !== typeof XDomainRequest && !xscheme && enablesXDR) {\n      return new XDomainRequest();\n    }\n  } catch (e) { }\n\n  if (!xdomain) {\n    try {\n      return new self[['Active'].concat('Object').join('X')]('Microsoft.XMLHTTP');\n    } catch (e) { }\n  }\n};\n","/**\n * Module dependencies.\n */\n\nvar parser = require('engine.io-parser');\nvar Emitter = require('component-emitter');\n\n/**\n * Module exports.\n */\n\nmodule.exports = Transport;\n\n/**\n * Transport abstract constructor.\n *\n * @param {Object} options.\n * @api private\n */\n\nfunction Transport (opts) {\n  this.path = opts.path;\n  this.hostname = opts.hostname;\n  this.port = opts.port;\n  this.secure = opts.secure;\n  this.query = opts.query;\n  this.timestampParam = opts.timestampParam;\n  this.timestampRequests = opts.timestampRequests;\n  this.readyState = '';\n  this.agent = opts.agent || false;\n  this.socket = opts.socket;\n  this.enablesXDR = opts.enablesXDR;\n\n  // SSL options for Node.js client\n  this.pfx = opts.pfx;\n  this.key = opts.key;\n  this.passphrase = opts.passphrase;\n  this.cert = opts.cert;\n  this.ca = opts.ca;\n  this.ciphers = opts.ciphers;\n  this.rejectUnauthorized = opts.rejectUnauthorized;\n  this.forceNode = opts.forceNode;\n\n  // results of ReactNative environment detection\n  this.isReactNative = opts.isReactNative;\n\n  // other options for Node.js client\n  this.extraHeaders = opts.extraHeaders;\n  this.localAddress = opts.localAddress;\n}\n\n/**\n * Mix in `Emitter`.\n */\n\nEmitter(Transport.prototype);\n\n/**\n * Emits an error.\n *\n * @param {String} str\n * @return {Transport} for chaining\n * @api public\n */\n\nTransport.prototype.onError = function (msg, desc) {\n  var err = new Error(msg);\n  err.type = 'TransportError';\n  err.description = desc;\n  this.emit('error', err);\n  return this;\n};\n\n/**\n * Opens the transport.\n *\n * @api public\n */\n\nTransport.prototype.open = function () {\n  if ('closed' === this.readyState || '' === this.readyState) {\n    this.readyState = 'opening';\n    this.doOpen();\n  }\n\n  return this;\n};\n\n/**\n * Closes the transport.\n *\n * @api private\n */\n\nTransport.prototype.close = function () {\n  if ('opening' === this.readyState || 'open' === this.readyState) {\n    this.doClose();\n    this.onClose();\n  }\n\n  return this;\n};\n\n/**\n * Sends multiple packets.\n *\n * @param {Array} packets\n * @api private\n */\n\nTransport.prototype.send = function (packets) {\n  if ('open' === this.readyState) {\n    this.write(packets);\n  } else {\n    throw new Error('Transport not open');\n  }\n};\n\n/**\n * Called upon open\n *\n * @api private\n */\n\nTransport.prototype.onOpen = function () {\n  this.readyState = 'open';\n  this.writable = true;\n  this.emit('open');\n};\n\n/**\n * Called with data.\n *\n * @param {String} data\n * @api private\n */\n\nTransport.prototype.onData = function (data) {\n  var packet = parser.decodePacket(data, this.socket.binaryType);\n  this.onPacket(packet);\n};\n\n/**\n * Called with a decoded packet.\n */\n\nTransport.prototype.onPacket = function (packet) {\n  this.emit('packet', packet);\n};\n\n/**\n * Called upon close.\n *\n * @api private\n */\n\nTransport.prototype.onClose = function () {\n  this.readyState = 'closed';\n  this.emit('close');\n};\n","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.canUseDOM = undefined;\n\nvar _exenv = require(\"exenv\");\n\nvar _exenv2 = _interopRequireDefault(_exenv);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar EE = _exenv2.default;\n\nvar SafeHTMLElement = EE.canUseDOM ? window.HTMLElement : {};\n\nvar canUseDOM = exports.canUseDOM = EE.canUseDOM;\n\nexports.default = SafeHTMLElement;","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, ModalHeader, ModalBody, ModalFooter, Input } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  onRepoTagCreated: PropTypes.func,\n  toggleCancel: PropTypes.func.isRequired,\n  onClose: PropTypes.func.isRequired\n};\n\nclass CreateTagDialog extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      tagName: '',\n      tagColor: '',\n      newTag: {},\n      errorMsg: '',\n      colorList: ['#FFA8A8', '#FFA94D', '#FFD43B', '#A0EC50', '#A9E34B', '#63E6BE', '#4FD2C9', '#72C3FC', '#91A7FF', '#E599F7', '#B197FC', '#F783AC', '#CED4DA'],\n    };\n    this.newInput = React.createRef();\n  }\n\n  inputNewName = (e) => {\n    this.setState({\n      tagName: e.target.value,\n    });\n    if (this.state.errorMsg) {\n      this.setState({errorMsg: ''});\n    }\n  }\n\n  selectTagcolor = (e) => {\n    this.setState({\n      tagColor: e.target.value,\n    });\n  }\n\n  createTag = () => {\n    let name = this.state.tagName;\n    let color = this.state.tagColor;\n    let repoID = this.props.repoID;\n    seafileAPI.createRepoTag(repoID, name, color).then((res) => {\n      let repoTagID = res.data.repo_tag.repo_tag_id;\n      if (this.props.onRepoTagCreated) this.props.onRepoTagCreated(repoTagID);\n      this.props.toggleCancel();\n    }).catch((error) => {\n      let errMessage;\n      if (error.response.status === 500) {\n        errMessage = gettext('Internal Server Error');\n      } else if (error.response.status === 400) {\n        errMessage = gettext('Tag \"{name}\" already exists.');\n        errMessage = errMessage.replace('{name}', Utils.HTMLescape(name));\n      }\n      this.setState({errorMsg: errMessage});\n    });\n  }\n\n  handleKeyPress = (e) => {\n    if (e.key === 'Enter') {\n      this.createTag();\n    }\n  }\n\n  componentDidMount() {\n    this.setState({\n      tagColor: this.state.colorList[0]\n    });\n    this.newInput.focus();\n    this.newInput.setSelectionRange(0, 0);\n  }\n\n  render() {\n    let colorList = this.state.colorList;\n    let canSave = this.state.tagName.trim() ? true : false;\n    return (\n      <Fragment>\n        <ModalHeader toggle={this.props.onClose}>\n          <span className=\"tag-dialog-back fas fa-sm fa-arrow-left\" onClick={this.props.toggleCancel} aria-label={gettext('Back')}></span>\n          {gettext('New Tag')}\n        </ModalHeader>\n        <ModalBody>\n          <div role=\"form\" className=\"tag-create\">\n            <div className=\"form-group\">\n              <label className=\"form-label\">{gettext('Name')}</label>\n              <Input onKeyPress={this.handleKeyPress} innerRef={input => {this.newInput = input;}} value={this.state.tagName} onChange={this.inputNewName}/>\n              <div className=\"mt-2\"><span className=\"error\">{this.state.errorMsg}</span></div>\n            </div>\n            <div className=\"form-group\">\n              <label className=\"form-label\">{gettext('Select a color')}</label>\n              <div className=\"row gutters-xs\">\n                {colorList.map((item, index)=>{\n                  return (\n                    <div key={index} className=\"col-auto\" onChange={this.selectTagcolor}>\n                      <label className=\"colorinput\">\n                        {index===0 ?\n                          <input name=\"color\" type=\"radio\" value={item} className=\"colorinput-input\" defaultChecked onClick={this.selectTagcolor}></input> :\n                          <input name=\"color\" type=\"radio\" value={item} className=\"colorinput-input\" onClick={this.selectTagcolor}></input>}\n                        <span className=\"colorinput-color\" style={{backgroundColor:item}}></span>\n                      </label>\n                    </div>\n                  );\n                })\n                }\n              </div>\n            </div>\n          </div>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.props.toggleCancel}>{gettext('Cancel')}</Button>\n          {canSave ?\n            <Button color=\"primary\" onClick={this.createTag}>{gettext('Save')}</Button> :\n            <Button color=\"primary\" disabled>{gettext('Save')}</Button>\n          }\n        </ModalFooter>\n      </Fragment>\n    );\n  }\n}\n\nCreateTagDialog.propTypes = propTypes;\n\nexport default CreateTagDialog;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Modal, ModalHeader, ModalBody, ModalFooter, Button } from 'reactstrap';\nimport copy from '../copy-to-clipboard';\nimport { gettext } from '../../utils/constants';\nimport toaster from '../../components/toast';\n\nconst propTypes = {\n  link: PropTypes.string.isRequired,\n  toggleDialog: PropTypes.func.isRequired\n};\n\nclass ShareAdminLink extends React.Component {\n\n  constructor(props) {\n    super(props);\n  }\n\n copyToClipboard = () => {\n   copy(this.props.link);\n   this.props.toggleDialog();\n   toaster.success(gettext('The link is copied to the clipboard.')), {duration: 2};\n }\n\n render() {\n   const { link, toggleDialog } = this.props;\n   return (\n     <Modal isOpen={true} toggle={toggleDialog}>\n       <ModalHeader toggle={toggleDialog}>{gettext('Link')}</ModalHeader>\n       <ModalBody>\n         <a href={link}>{link}</a>\n       </ModalBody>\n       <ModalFooter>\n         <Button color=\"primary\" onClick={this.copyToClipboard}>{gettext('Copy')}</Button>\n         <Button color=\"secondary\" onClick={toggleDialog}>{gettext('Close')}</Button>\n       </ModalFooter>\n     </Modal>\n   );\n }\n}\n\nShareAdminLink.propTypes = propTypes;\n\nexport default ShareAdminLink;\n","/**\r\n * Parses an URI\r\n *\r\n * @author Steven Levithan <stevenlevithan.com> (MIT license)\r\n * @api private\r\n */\r\n\r\nvar re = /^(?:(?![^:@]+:[^:@\\/]*@)(http|https|ws|wss):\\/\\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/;\r\n\r\nvar parts = [\r\n    'source', 'protocol', 'authority', 'userInfo', 'user', 'password', 'host', 'port', 'relative', 'path', 'directory', 'file', 'query', 'anchor'\r\n];\r\n\r\nmodule.exports = function parseuri(str) {\r\n    var src = str,\r\n        b = str.indexOf('['),\r\n        e = str.indexOf(']');\r\n\r\n    if (b != -1 && e != -1) {\r\n        str = str.substring(0, b) + str.substring(b, e).replace(/:/g, ';') + str.substring(e, str.length);\r\n    }\r\n\r\n    var m = re.exec(str || ''),\r\n        uri = {},\r\n        i = 14;\r\n\r\n    while (i--) {\r\n        uri[parts[i]] = m[i] || '';\r\n    }\r\n\r\n    if (b != -1 && e != -1) {\r\n        uri.source = src;\r\n        uri.host = uri.host.substring(1, uri.host.length - 1).replace(/;/g, ':');\r\n        uri.authority = uri.authority.replace('[', '').replace(']', '').replace(/;/g, ':');\r\n        uri.ipv6uri = true;\r\n    }\r\n\r\n    return uri;\r\n};\r\n","var toString = {}.toString;\n\nmodule.exports = Array.isArray || function (arr) {\n  return toString.call(arr) == '[object Array]';\n};\n","\nmodule.exports = isBuf;\n\nvar withNativeBuffer = typeof Buffer === 'function' && typeof Buffer.isBuffer === 'function';\nvar withNativeArrayBuffer = typeof ArrayBuffer === 'function';\n\nvar isView = function (obj) {\n  return typeof ArrayBuffer.isView === 'function' ? ArrayBuffer.isView(obj) : (obj.buffer instanceof ArrayBuffer);\n};\n\n/**\n * Returns true if obj is a buffer or an arraybuffer.\n *\n * @api private\n */\n\nfunction isBuf(obj) {\n  return (withNativeBuffer && Buffer.isBuffer(obj)) ||\n          (withNativeArrayBuffer && (obj instanceof ArrayBuffer || isView(obj)));\n}\n","\n/**\n * Module dependencies.\n */\n\nvar eio = require('engine.io-client');\nvar Socket = require('./socket');\nvar Emitter = require('component-emitter');\nvar parser = require('socket.io-parser');\nvar on = require('./on');\nvar bind = require('component-bind');\nvar debug = require('debug')('socket.io-client:manager');\nvar indexOf = require('indexof');\nvar Backoff = require('backo2');\n\n/**\n * IE6+ hasOwnProperty\n */\n\nvar has = Object.prototype.hasOwnProperty;\n\n/**\n * Module exports\n */\n\nmodule.exports = Manager;\n\n/**\n * `Manager` constructor.\n *\n * @param {String} engine instance or engine uri/opts\n * @param {Object} options\n * @api public\n */\n\nfunction Manager (uri, opts) {\n  if (!(this instanceof Manager)) return new Manager(uri, opts);\n  if (uri && ('object' === typeof uri)) {\n    opts = uri;\n    uri = undefined;\n  }\n  opts = opts || {};\n\n  opts.path = opts.path || '/socket.io';\n  this.nsps = {};\n  this.subs = [];\n  this.opts = opts;\n  this.reconnection(opts.reconnection !== false);\n  this.reconnectionAttempts(opts.reconnectionAttempts || Infinity);\n  this.reconnectionDelay(opts.reconnectionDelay || 1000);\n  this.reconnectionDelayMax(opts.reconnectionDelayMax || 5000);\n  this.randomizationFactor(opts.randomizationFactor || 0.5);\n  this.backoff = new Backoff({\n    min: this.reconnectionDelay(),\n    max: this.reconnectionDelayMax(),\n    jitter: this.randomizationFactor()\n  });\n  this.timeout(null == opts.timeout ? 20000 : opts.timeout);\n  this.readyState = 'closed';\n  this.uri = uri;\n  this.connecting = [];\n  this.lastPing = null;\n  this.encoding = false;\n  this.packetBuffer = [];\n  var _parser = opts.parser || parser;\n  this.encoder = new _parser.Encoder();\n  this.decoder = new _parser.Decoder();\n  this.autoConnect = opts.autoConnect !== false;\n  if (this.autoConnect) this.open();\n}\n\n/**\n * Propagate given event to sockets and emit on `this`\n *\n * @api private\n */\n\nManager.prototype.emitAll = function () {\n  this.emit.apply(this, arguments);\n  for (var nsp in this.nsps) {\n    if (has.call(this.nsps, nsp)) {\n      this.nsps[nsp].emit.apply(this.nsps[nsp], arguments);\n    }\n  }\n};\n\n/**\n * Update `socket.id` of all sockets\n *\n * @api private\n */\n\nManager.prototype.updateSocketIds = function () {\n  for (var nsp in this.nsps) {\n    if (has.call(this.nsps, nsp)) {\n      this.nsps[nsp].id = this.generateId(nsp);\n    }\n  }\n};\n\n/**\n * generate `socket.id` for the given `nsp`\n *\n * @param {String} nsp\n * @return {String}\n * @api private\n */\n\nManager.prototype.generateId = function (nsp) {\n  return (nsp === '/' ? '' : (nsp + '#')) + this.engine.id;\n};\n\n/**\n * Mix in `Emitter`.\n */\n\nEmitter(Manager.prototype);\n\n/**\n * Sets the `reconnection` config.\n *\n * @param {Boolean} true/false if it should automatically reconnect\n * @return {Manager} self or value\n * @api public\n */\n\nManager.prototype.reconnection = function (v) {\n  if (!arguments.length) return this._reconnection;\n  this._reconnection = !!v;\n  return this;\n};\n\n/**\n * Sets the reconnection attempts config.\n *\n * @param {Number} max reconnection attempts before giving up\n * @return {Manager} self or value\n * @api public\n */\n\nManager.prototype.reconnectionAttempts = function (v) {\n  if (!arguments.length) return this._reconnectionAttempts;\n  this._reconnectionAttempts = v;\n  return this;\n};\n\n/**\n * Sets the delay between reconnections.\n *\n * @param {Number} delay\n * @return {Manager} self or value\n * @api public\n */\n\nManager.prototype.reconnectionDelay = function (v) {\n  if (!arguments.length) return this._reconnectionDelay;\n  this._reconnectionDelay = v;\n  this.backoff && this.backoff.setMin(v);\n  return this;\n};\n\nManager.prototype.randomizationFactor = function (v) {\n  if (!arguments.length) return this._randomizationFactor;\n  this._randomizationFactor = v;\n  this.backoff && this.backoff.setJitter(v);\n  return this;\n};\n\n/**\n * Sets the maximum delay between reconnections.\n *\n * @param {Number} delay\n * @return {Manager} self or value\n * @api public\n */\n\nManager.prototype.reconnectionDelayMax = function (v) {\n  if (!arguments.length) return this._reconnectionDelayMax;\n  this._reconnectionDelayMax = v;\n  this.backoff && this.backoff.setMax(v);\n  return this;\n};\n\n/**\n * Sets the connection timeout. `false` to disable\n *\n * @return {Manager} self or value\n * @api public\n */\n\nManager.prototype.timeout = function (v) {\n  if (!arguments.length) return this._timeout;\n  this._timeout = v;\n  return this;\n};\n\n/**\n * Starts trying to reconnect if reconnection is enabled and we have not\n * started reconnecting yet\n *\n * @api private\n */\n\nManager.prototype.maybeReconnectOnOpen = function () {\n  // Only try to reconnect if it's the first time we're connecting\n  if (!this.reconnecting && this._reconnection && this.backoff.attempts === 0) {\n    // keeps reconnection from firing twice for the same reconnection loop\n    this.reconnect();\n  }\n};\n\n/**\n * Sets the current transport `socket`.\n *\n * @param {Function} optional, callback\n * @return {Manager} self\n * @api public\n */\n\nManager.prototype.open =\nManager.prototype.connect = function (fn, opts) {\n  debug('readyState %s', this.readyState);\n  if (~this.readyState.indexOf('open')) return this;\n\n  debug('opening %s', this.uri);\n  this.engine = eio(this.uri, this.opts);\n  var socket = this.engine;\n  var self = this;\n  this.readyState = 'opening';\n  this.skipReconnect = false;\n\n  // emit `open`\n  var openSub = on(socket, 'open', function () {\n    self.onopen();\n    fn && fn();\n  });\n\n  // emit `connect_error`\n  var errorSub = on(socket, 'error', function (data) {\n    debug('connect_error');\n    self.cleanup();\n    self.readyState = 'closed';\n    self.emitAll('connect_error', data);\n    if (fn) {\n      var err = new Error('Connection error');\n      err.data = data;\n      fn(err);\n    } else {\n      // Only do this if there is no fn to handle the error\n      self.maybeReconnectOnOpen();\n    }\n  });\n\n  // emit `connect_timeout`\n  if (false !== this._timeout) {\n    var timeout = this._timeout;\n    debug('connect attempt will timeout after %d', timeout);\n\n    // set timer\n    var timer = setTimeout(function () {\n      debug('connect attempt timed out after %d', timeout);\n      openSub.destroy();\n      socket.close();\n      socket.emit('error', 'timeout');\n      self.emitAll('connect_timeout', timeout);\n    }, timeout);\n\n    this.subs.push({\n      destroy: function () {\n        clearTimeout(timer);\n      }\n    });\n  }\n\n  this.subs.push(openSub);\n  this.subs.push(errorSub);\n\n  return this;\n};\n\n/**\n * Called upon transport open.\n *\n * @api private\n */\n\nManager.prototype.onopen = function () {\n  debug('open');\n\n  // clear old subs\n  this.cleanup();\n\n  // mark as open\n  this.readyState = 'open';\n  this.emit('open');\n\n  // add new subs\n  var socket = this.engine;\n  this.subs.push(on(socket, 'data', bind(this, 'ondata')));\n  this.subs.push(on(socket, 'ping', bind(this, 'onping')));\n  this.subs.push(on(socket, 'pong', bind(this, 'onpong')));\n  this.subs.push(on(socket, 'error', bind(this, 'onerror')));\n  this.subs.push(on(socket, 'close', bind(this, 'onclose')));\n  this.subs.push(on(this.decoder, 'decoded', bind(this, 'ondecoded')));\n};\n\n/**\n * Called upon a ping.\n *\n * @api private\n */\n\nManager.prototype.onping = function () {\n  this.lastPing = new Date();\n  this.emitAll('ping');\n};\n\n/**\n * Called upon a packet.\n *\n * @api private\n */\n\nManager.prototype.onpong = function () {\n  this.emitAll('pong', new Date() - this.lastPing);\n};\n\n/**\n * Called with data.\n *\n * @api private\n */\n\nManager.prototype.ondata = function (data) {\n  this.decoder.add(data);\n};\n\n/**\n * Called when parser fully decodes a packet.\n *\n * @api private\n */\n\nManager.prototype.ondecoded = function (packet) {\n  this.emit('packet', packet);\n};\n\n/**\n * Called upon socket error.\n *\n * @api private\n */\n\nManager.prototype.onerror = function (err) {\n  debug('error', err);\n  this.emitAll('error', err);\n};\n\n/**\n * Creates a new socket for the given `nsp`.\n *\n * @return {Socket}\n * @api public\n */\n\nManager.prototype.socket = function (nsp, opts) {\n  var socket = this.nsps[nsp];\n  if (!socket) {\n    socket = new Socket(this, nsp, opts);\n    this.nsps[nsp] = socket;\n    var self = this;\n    socket.on('connecting', onConnecting);\n    socket.on('connect', function () {\n      socket.id = self.generateId(nsp);\n    });\n\n    if (this.autoConnect) {\n      // manually call here since connecting event is fired before listening\n      onConnecting();\n    }\n  }\n\n  function onConnecting () {\n    if (!~indexOf(self.connecting, socket)) {\n      self.connecting.push(socket);\n    }\n  }\n\n  return socket;\n};\n\n/**\n * Called upon a socket close.\n *\n * @param {Socket} socket\n */\n\nManager.prototype.destroy = function (socket) {\n  var index = indexOf(this.connecting, socket);\n  if (~index) this.connecting.splice(index, 1);\n  if (this.connecting.length) return;\n\n  this.close();\n};\n\n/**\n * Writes a packet.\n *\n * @param {Object} packet\n * @api private\n */\n\nManager.prototype.packet = function (packet) {\n  debug('writing packet %j', packet);\n  var self = this;\n  if (packet.query && packet.type === 0) packet.nsp += '?' + packet.query;\n\n  if (!self.encoding) {\n    // encode, then write to engine with result\n    self.encoding = true;\n    this.encoder.encode(packet, function (encodedPackets) {\n      for (var i = 0; i < encodedPackets.length; i++) {\n        self.engine.write(encodedPackets[i], packet.options);\n      }\n      self.encoding = false;\n      self.processPacketQueue();\n    });\n  } else { // add packet to the queue\n    self.packetBuffer.push(packet);\n  }\n};\n\n/**\n * If packet buffer is non-empty, begins encoding the\n * next packet in line.\n *\n * @api private\n */\n\nManager.prototype.processPacketQueue = function () {\n  if (this.packetBuffer.length > 0 && !this.encoding) {\n    var pack = this.packetBuffer.shift();\n    this.packet(pack);\n  }\n};\n\n/**\n * Clean up transport subscriptions and packet buffer.\n *\n * @api private\n */\n\nManager.prototype.cleanup = function () {\n  debug('cleanup');\n\n  var subsLength = this.subs.length;\n  for (var i = 0; i < subsLength; i++) {\n    var sub = this.subs.shift();\n    sub.destroy();\n  }\n\n  this.packetBuffer = [];\n  this.encoding = false;\n  this.lastPing = null;\n\n  this.decoder.destroy();\n};\n\n/**\n * Close the current socket.\n *\n * @api private\n */\n\nManager.prototype.close =\nManager.prototype.disconnect = function () {\n  debug('disconnect');\n  this.skipReconnect = true;\n  this.reconnecting = false;\n  if ('opening' === this.readyState) {\n    // `onclose` will not fire because\n    // an open event never happened\n    this.cleanup();\n  }\n  this.backoff.reset();\n  this.readyState = 'closed';\n  if (this.engine) this.engine.close();\n};\n\n/**\n * Called upon engine close.\n *\n * @api private\n */\n\nManager.prototype.onclose = function (reason) {\n  debug('onclose');\n\n  this.cleanup();\n  this.backoff.reset();\n  this.readyState = 'closed';\n  this.emit('close', reason);\n\n  if (this._reconnection && !this.skipReconnect) {\n    this.reconnect();\n  }\n};\n\n/**\n * Attempt a reconnection.\n *\n * @api private\n */\n\nManager.prototype.reconnect = function () {\n  if (this.reconnecting || this.skipReconnect) return this;\n\n  var self = this;\n\n  if (this.backoff.attempts >= this._reconnectionAttempts) {\n    debug('reconnect failed');\n    this.backoff.reset();\n    this.emitAll('reconnect_failed');\n    this.reconnecting = false;\n  } else {\n    var delay = this.backoff.duration();\n    debug('will wait %dms before reconnect attempt', delay);\n\n    this.reconnecting = true;\n    var timer = setTimeout(function () {\n      if (self.skipReconnect) return;\n\n      debug('attempting reconnect');\n      self.emitAll('reconnect_attempt', self.backoff.attempts);\n      self.emitAll('reconnecting', self.backoff.attempts);\n\n      // check again for the case socket closed in above events\n      if (self.skipReconnect) return;\n\n      self.open(function (err) {\n        if (err) {\n          debug('reconnect attempt error');\n          self.reconnecting = false;\n          self.reconnect();\n          self.emitAll('reconnect_error', err.data);\n        } else {\n          debug('reconnect success');\n          self.onreconnect();\n        }\n      });\n    }, delay);\n\n    this.subs.push({\n      destroy: function () {\n        clearTimeout(timer);\n      }\n    });\n  }\n};\n\n/**\n * Called upon successful reconnect.\n *\n * @api private\n */\n\nManager.prototype.onreconnect = function () {\n  var attempt = this.backoff.attempts;\n  this.reconnecting = false;\n  this.backoff.reset();\n  this.updateSocketIds();\n  this.emitAll('reconnect', attempt);\n};\n","/**\n * Module dependencies\n */\n\nvar XMLHttpRequest = require('xmlhttprequest-ssl');\nvar XHR = require('./polling-xhr');\nvar JSONP = require('./polling-jsonp');\nvar websocket = require('./websocket');\n\n/**\n * Export transports.\n */\n\nexports.polling = polling;\nexports.websocket = websocket;\n\n/**\n * Polling transport polymorphic constructor.\n * Decides on xhr vs jsonp based on feature detection.\n *\n * @api private\n */\n\nfunction polling (opts) {\n  var xhr;\n  var xd = false;\n  var xs = false;\n  var jsonp = false !== opts.jsonp;\n\n  if (typeof location !== 'undefined') {\n    var isSSL = 'https:' === location.protocol;\n    var port = location.port;\n\n    // some user agents have empty `location.port`\n    if (!port) {\n      port = isSSL ? 443 : 80;\n    }\n\n    xd = opts.hostname !== location.hostname || port !== opts.port;\n    xs = opts.secure !== isSSL;\n  }\n\n  opts.xdomain = xd;\n  opts.xscheme = xs;\n  xhr = new XMLHttpRequest(opts);\n\n  if ('open' in xhr && !opts.forceJSONP) {\n    return new XHR(opts);\n  } else {\n    if (!jsonp) throw new Error('JSONP disabled');\n    return new JSONP(opts);\n  }\n}\n","/**\n * Module dependencies.\n */\n\nvar Transport = require('../transport');\nvar parseqs = require('parseqs');\nvar parser = require('engine.io-parser');\nvar inherit = require('component-inherit');\nvar yeast = require('yeast');\nvar debug = require('debug')('engine.io-client:polling');\n\n/**\n * Module exports.\n */\n\nmodule.exports = Polling;\n\n/**\n * Is XHR2 supported?\n */\n\nvar hasXHR2 = (function () {\n  var XMLHttpRequest = require('xmlhttprequest-ssl');\n  var xhr = new XMLHttpRequest({ xdomain: false });\n  return null != xhr.responseType;\n})();\n\n/**\n * Polling interface.\n *\n * @param {Object} opts\n * @api private\n */\n\nfunction Polling (opts) {\n  var forceBase64 = (opts && opts.forceBase64);\n  if (!hasXHR2 || forceBase64) {\n    this.supportsBinary = false;\n  }\n  Transport.call(this, opts);\n}\n\n/**\n * Inherits from Transport.\n */\n\ninherit(Polling, Transport);\n\n/**\n * Transport name.\n */\n\nPolling.prototype.name = 'polling';\n\n/**\n * Opens the socket (triggers polling). We write a PING message to determine\n * when the transport is open.\n *\n * @api private\n */\n\nPolling.prototype.doOpen = function () {\n  this.poll();\n};\n\n/**\n * Pauses polling.\n *\n * @param {Function} callback upon buffers are flushed and transport is paused\n * @api private\n */\n\nPolling.prototype.pause = function (onPause) {\n  var self = this;\n\n  this.readyState = 'pausing';\n\n  function pause () {\n    debug('paused');\n    self.readyState = 'paused';\n    onPause();\n  }\n\n  if (this.polling || !this.writable) {\n    var total = 0;\n\n    if (this.polling) {\n      debug('we are currently polling - waiting to pause');\n      total++;\n      this.once('pollComplete', function () {\n        debug('pre-pause polling complete');\n        --total || pause();\n      });\n    }\n\n    if (!this.writable) {\n      debug('we are currently writing - waiting to pause');\n      total++;\n      this.once('drain', function () {\n        debug('pre-pause writing complete');\n        --total || pause();\n      });\n    }\n  } else {\n    pause();\n  }\n};\n\n/**\n * Starts polling cycle.\n *\n * @api public\n */\n\nPolling.prototype.poll = function () {\n  debug('polling');\n  this.polling = true;\n  this.doPoll();\n  this.emit('poll');\n};\n\n/**\n * Overloads onData to detect payloads.\n *\n * @api private\n */\n\nPolling.prototype.onData = function (data) {\n  var self = this;\n  debug('polling got data %s', data);\n  var callback = function (packet, index, total) {\n    // if its the first message we consider the transport open\n    if ('opening' === self.readyState) {\n      self.onOpen();\n    }\n\n    // if its a close packet, we close the ongoing requests\n    if ('close' === packet.type) {\n      self.onClose();\n      return false;\n    }\n\n    // otherwise bypass onData and handle the message\n    self.onPacket(packet);\n  };\n\n  // decode payload\n  parser.decodePayload(data, this.socket.binaryType, callback);\n\n  // if an event did not trigger closing\n  if ('closed' !== this.readyState) {\n    // if we got data we're not polling\n    this.polling = false;\n    this.emit('pollComplete');\n\n    if ('open' === this.readyState) {\n      this.poll();\n    } else {\n      debug('ignoring poll - transport state \"%s\"', this.readyState);\n    }\n  }\n};\n\n/**\n * For polling, send a close packet.\n *\n * @api private\n */\n\nPolling.prototype.doClose = function () {\n  var self = this;\n\n  function close () {\n    debug('writing close packet');\n    self.write([{ type: 'close' }]);\n  }\n\n  if ('open' === this.readyState) {\n    debug('transport open - closing');\n    close();\n  } else {\n    // in case we're trying to close while\n    // handshaking is in progress (GH-164)\n    debug('transport not open - deferring close');\n    this.once('open', close);\n  }\n};\n\n/**\n * Writes a packets payload.\n *\n * @param {Array} data packets\n * @param {Function} drain callback\n * @api private\n */\n\nPolling.prototype.write = function (packets) {\n  var self = this;\n  this.writable = false;\n  var callbackfn = function () {\n    self.writable = true;\n    self.emit('drain');\n  };\n\n  parser.encodePayload(packets, this.supportsBinary, function (data) {\n    self.doWrite(data, callbackfn);\n  });\n};\n\n/**\n * Generates uri for connection.\n *\n * @api private\n */\n\nPolling.prototype.uri = function () {\n  var query = this.query || {};\n  var schema = this.secure ? 'https' : 'http';\n  var port = '';\n\n  // cache busting is forced\n  if (false !== this.timestampRequests) {\n    query[this.timestampParam] = yeast();\n  }\n\n  if (!this.supportsBinary && !query.sid) {\n    query.b64 = 1;\n  }\n\n  query = parseqs.encode(query);\n\n  // avoid port if default for schema\n  if (this.port && (('https' === schema && Number(this.port) !== 443) ||\n     ('http' === schema && Number(this.port) !== 80))) {\n    port = ':' + this.port;\n  }\n\n  // prepend ? to query\n  if (query.length) {\n    query = '?' + query;\n  }\n\n  var ipv6 = this.hostname.indexOf(':') !== -1;\n  return schema + '://' + (ipv6 ? '[' + this.hostname + ']' : this.hostname) + port + this.path + query;\n};\n","/* global Blob File */\n\n/*\n * Module requirements.\n */\n\nvar isArray = require('isarray');\n\nvar toString = Object.prototype.toString;\nvar withNativeBlob = typeof Blob === 'function' ||\n                        typeof Blob !== 'undefined' && toString.call(Blob) === '[object BlobConstructor]';\nvar withNativeFile = typeof File === 'function' ||\n                        typeof File !== 'undefined' && toString.call(File) === '[object FileConstructor]';\n\n/**\n * Module exports.\n */\n\nmodule.exports = hasBinary;\n\n/**\n * Checks for binary data.\n *\n * Supports Buffer, ArrayBuffer, Blob and File.\n *\n * @param {Object} anything\n * @api public\n */\n\nfunction hasBinary (obj) {\n  if (!obj || typeof obj !== 'object') {\n    return false;\n  }\n\n  if (isArray(obj)) {\n    for (var i = 0, l = obj.length; i < l; i++) {\n      if (hasBinary(obj[i])) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  if ((typeof Buffer === 'function' && Buffer.isBuffer && Buffer.isBuffer(obj)) ||\n    (typeof ArrayBuffer === 'function' && obj instanceof ArrayBuffer) ||\n    (withNativeBlob && obj instanceof Blob) ||\n    (withNativeFile && obj instanceof File)\n  ) {\n    return true;\n  }\n\n  // see: https://github.com/Automattic/has-binary/pull/4\n  if (obj.toJSON && typeof obj.toJSON === 'function' && arguments.length === 1) {\n    return hasBinary(obj.toJSON(), true);\n  }\n\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key) && hasBinary(obj[key])) {\n      return true;\n    }\n  }\n\n  return false;\n}\n","'use strict';\n\nvar alphabet = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_'.split('')\n  , length = 64\n  , map = {}\n  , seed = 0\n  , i = 0\n  , prev;\n\n/**\n * Return a string representing the specified number.\n *\n * @param {Number} num The number to convert.\n * @returns {String} The string representation of the number.\n * @api public\n */\nfunction encode(num) {\n  var encoded = '';\n\n  do {\n    encoded = alphabet[num % length] + encoded;\n    num = Math.floor(num / length);\n  } while (num > 0);\n\n  return encoded;\n}\n\n/**\n * Return the integer value specified by the given string.\n *\n * @param {String} str The string to convert.\n * @returns {Number} The integer value represented by the string.\n * @api public\n */\nfunction decode(str) {\n  var decoded = 0;\n\n  for (i = 0; i < str.length; i++) {\n    decoded = decoded * length + map[str.charAt(i)];\n  }\n\n  return decoded;\n}\n\n/**\n * Yeast: A tiny growing id generator.\n *\n * @returns {String} A unique id.\n * @api public\n */\nfunction yeast() {\n  var now = encode(+new Date());\n\n  if (now !== prev) return seed = 0, prev = now;\n  return now +'.'+ encode(seed++);\n}\n\n//\n// Map each character to its index.\n//\nfor (; i < length; i++) map[alphabet[i]] = i;\n\n//\n// Expose the `yeast`, `encode` and `decode` functions.\n//\nyeast.encode = encode;\nyeast.decode = decode;\nmodule.exports = yeast;\n","\nvar indexOf = [].indexOf;\n\nmodule.exports = function(arr, obj){\n  if (indexOf) return arr.indexOf(obj);\n  for (var i = 0; i < arr.length; ++i) {\n    if (arr[i] === obj) return i;\n  }\n  return -1;\n};","\n/**\n * Module dependencies.\n */\n\nvar parser = require('socket.io-parser');\nvar Emitter = require('component-emitter');\nvar toArray = require('to-array');\nvar on = require('./on');\nvar bind = require('component-bind');\nvar debug = require('debug')('socket.io-client:socket');\nvar parseqs = require('parseqs');\nvar hasBin = require('has-binary2');\n\n/**\n * Module exports.\n */\n\nmodule.exports = exports = Socket;\n\n/**\n * Internal events (blacklisted).\n * These events can't be emitted by the user.\n *\n * @api private\n */\n\nvar events = {\n  connect: 1,\n  connect_error: 1,\n  connect_timeout: 1,\n  connecting: 1,\n  disconnect: 1,\n  error: 1,\n  reconnect: 1,\n  reconnect_attempt: 1,\n  reconnect_failed: 1,\n  reconnect_error: 1,\n  reconnecting: 1,\n  ping: 1,\n  pong: 1\n};\n\n/**\n * Shortcut to `Emitter#emit`.\n */\n\nvar emit = Emitter.prototype.emit;\n\n/**\n * `Socket` constructor.\n *\n * @api public\n */\n\nfunction Socket (io, nsp, opts) {\n  this.io = io;\n  this.nsp = nsp;\n  this.json = this; // compat\n  this.ids = 0;\n  this.acks = {};\n  this.receiveBuffer = [];\n  this.sendBuffer = [];\n  this.connected = false;\n  this.disconnected = true;\n  this.flags = {};\n  if (opts && opts.query) {\n    this.query = opts.query;\n  }\n  if (this.io.autoConnect) this.open();\n}\n\n/**\n * Mix in `Emitter`.\n */\n\nEmitter(Socket.prototype);\n\n/**\n * Subscribe to open, close and packet events\n *\n * @api private\n */\n\nSocket.prototype.subEvents = function () {\n  if (this.subs) return;\n\n  var io = this.io;\n  this.subs = [\n    on(io, 'open', bind(this, 'onopen')),\n    on(io, 'packet', bind(this, 'onpacket')),\n    on(io, 'close', bind(this, 'onclose'))\n  ];\n};\n\n/**\n * \"Opens\" the socket.\n *\n * @api public\n */\n\nSocket.prototype.open =\nSocket.prototype.connect = function () {\n  if (this.connected) return this;\n\n  this.subEvents();\n  this.io.open(); // ensure open\n  if ('open' === this.io.readyState) this.onopen();\n  this.emit('connecting');\n  return this;\n};\n\n/**\n * Sends a `message` event.\n *\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.send = function () {\n  var args = toArray(arguments);\n  args.unshift('message');\n  this.emit.apply(this, args);\n  return this;\n};\n\n/**\n * Override `emit`.\n * If the event is in `events`, it's emitted normally.\n *\n * @param {String} event name\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.emit = function (ev) {\n  if (events.hasOwnProperty(ev)) {\n    emit.apply(this, arguments);\n    return this;\n  }\n\n  var args = toArray(arguments);\n  var packet = {\n    type: (this.flags.binary !== undefined ? this.flags.binary : hasBin(args)) ? parser.BINARY_EVENT : parser.EVENT,\n    data: args\n  };\n\n  packet.options = {};\n  packet.options.compress = !this.flags || false !== this.flags.compress;\n\n  // event ack callback\n  if ('function' === typeof args[args.length - 1]) {\n    debug('emitting packet with ack id %d', this.ids);\n    this.acks[this.ids] = args.pop();\n    packet.id = this.ids++;\n  }\n\n  if (this.connected) {\n    this.packet(packet);\n  } else {\n    this.sendBuffer.push(packet);\n  }\n\n  this.flags = {};\n\n  return this;\n};\n\n/**\n * Sends a packet.\n *\n * @param {Object} packet\n * @api private\n */\n\nSocket.prototype.packet = function (packet) {\n  packet.nsp = this.nsp;\n  this.io.packet(packet);\n};\n\n/**\n * Called upon engine `open`.\n *\n * @api private\n */\n\nSocket.prototype.onopen = function () {\n  debug('transport is open - connecting');\n\n  // write connect packet if necessary\n  if ('/' !== this.nsp) {\n    if (this.query) {\n      var query = typeof this.query === 'object' ? parseqs.encode(this.query) : this.query;\n      debug('sending connect packet with query %s', query);\n      this.packet({type: parser.CONNECT, query: query});\n    } else {\n      this.packet({type: parser.CONNECT});\n    }\n  }\n};\n\n/**\n * Called upon engine `close`.\n *\n * @param {String} reason\n * @api private\n */\n\nSocket.prototype.onclose = function (reason) {\n  debug('close (%s)', reason);\n  this.connected = false;\n  this.disconnected = true;\n  delete this.id;\n  this.emit('disconnect', reason);\n};\n\n/**\n * Called with socket packet.\n *\n * @param {Object} packet\n * @api private\n */\n\nSocket.prototype.onpacket = function (packet) {\n  var sameNamespace = packet.nsp === this.nsp;\n  var rootNamespaceError = packet.type === parser.ERROR && packet.nsp === '/';\n\n  if (!sameNamespace && !rootNamespaceError) return;\n\n  switch (packet.type) {\n    case parser.CONNECT:\n      this.onconnect();\n      break;\n\n    case parser.EVENT:\n      this.onevent(packet);\n      break;\n\n    case parser.BINARY_EVENT:\n      this.onevent(packet);\n      break;\n\n    case parser.ACK:\n      this.onack(packet);\n      break;\n\n    case parser.BINARY_ACK:\n      this.onack(packet);\n      break;\n\n    case parser.DISCONNECT:\n      this.ondisconnect();\n      break;\n\n    case parser.ERROR:\n      this.emit('error', packet.data);\n      break;\n  }\n};\n\n/**\n * Called upon a server event.\n *\n * @param {Object} packet\n * @api private\n */\n\nSocket.prototype.onevent = function (packet) {\n  var args = packet.data || [];\n  debug('emitting event %j', args);\n\n  if (null != packet.id) {\n    debug('attaching ack callback to event');\n    args.push(this.ack(packet.id));\n  }\n\n  if (this.connected) {\n    emit.apply(this, args);\n  } else {\n    this.receiveBuffer.push(args);\n  }\n};\n\n/**\n * Produces an ack callback to emit with an event.\n *\n * @api private\n */\n\nSocket.prototype.ack = function (id) {\n  var self = this;\n  var sent = false;\n  return function () {\n    // prevent double callbacks\n    if (sent) return;\n    sent = true;\n    var args = toArray(arguments);\n    debug('sending ack %j', args);\n\n    self.packet({\n      type: hasBin(args) ? parser.BINARY_ACK : parser.ACK,\n      id: id,\n      data: args\n    });\n  };\n};\n\n/**\n * Called upon a server acknowlegement.\n *\n * @param {Object} packet\n * @api private\n */\n\nSocket.prototype.onack = function (packet) {\n  var ack = this.acks[packet.id];\n  if ('function' === typeof ack) {\n    debug('calling ack %s with %j', packet.id, packet.data);\n    ack.apply(this, packet.data);\n    delete this.acks[packet.id];\n  } else {\n    debug('bad ack %s', packet.id);\n  }\n};\n\n/**\n * Called upon server connect.\n *\n * @api private\n */\n\nSocket.prototype.onconnect = function () {\n  this.connected = true;\n  this.disconnected = false;\n  this.emit('connect');\n  this.emitBuffered();\n};\n\n/**\n * Emit buffered events (received and emitted).\n *\n * @api private\n */\n\nSocket.prototype.emitBuffered = function () {\n  var i;\n  for (i = 0; i < this.receiveBuffer.length; i++) {\n    emit.apply(this, this.receiveBuffer[i]);\n  }\n  this.receiveBuffer = [];\n\n  for (i = 0; i < this.sendBuffer.length; i++) {\n    this.packet(this.sendBuffer[i]);\n  }\n  this.sendBuffer = [];\n};\n\n/**\n * Called upon server disconnect.\n *\n * @api private\n */\n\nSocket.prototype.ondisconnect = function () {\n  debug('server disconnect (%s)', this.nsp);\n  this.destroy();\n  this.onclose('io server disconnect');\n};\n\n/**\n * Called upon forced client/server side disconnections,\n * this method ensures the manager stops tracking us and\n * that reconnections don't get triggered for this.\n *\n * @api private.\n */\n\nSocket.prototype.destroy = function () {\n  if (this.subs) {\n    // clean subscriptions to avoid reconnections\n    for (var i = 0; i < this.subs.length; i++) {\n      this.subs[i].destroy();\n    }\n    this.subs = null;\n  }\n\n  this.io.destroy(this);\n};\n\n/**\n * Disconnects the socket manually.\n *\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.close =\nSocket.prototype.disconnect = function () {\n  if (this.connected) {\n    debug('performing disconnect (%s)', this.nsp);\n    this.packet({ type: parser.DISCONNECT });\n  }\n\n  // remove socket from pool\n  this.destroy();\n\n  if (this.connected) {\n    // fire events\n    this.onclose('io client disconnect');\n  }\n  return this;\n};\n\n/**\n * Sets the compress flag.\n *\n * @param {Boolean} if `true`, compresses the sending data\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.compress = function (compress) {\n  this.flags.compress = compress;\n  return this;\n};\n\n/**\n * Sets the binary flag\n *\n * @param {Boolean} whether the emitted data contains binary\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.binary = function (binary) {\n  this.flags.binary = binary;\n  return this;\n};\n","\n/**\n * Module exports.\n */\n\nmodule.exports = on;\n\n/**\n * Helper for subscriptions.\n *\n * @param {Object|EventEmitter} obj with `Emitter` mixin or `EventEmitter`\n * @param {String} event name\n * @param {Function} callback\n * @api public\n */\n\nfunction on (obj, ev, fn) {\n  obj.on(ev, fn);\n  return {\n    destroy: function () {\n      obj.removeListener(ev, fn);\n    }\n  };\n}\n","/**\n * Slice reference.\n */\n\nvar slice = [].slice;\n\n/**\n * Bind `obj` to `fn`.\n *\n * @param {Object} obj\n * @param {Function|String} fn or string\n * @return {Function}\n * @api public\n */\n\nmodule.exports = function(obj, fn){\n  if ('string' == typeof fn) fn = obj[fn];\n  if ('function' != typeof fn) throw new Error('bind() requires a function');\n  var args = slice.call(arguments, 2);\n  return function(){\n    return fn.apply(obj, args.concat(slice.call(arguments)));\n  }\n};\n","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = findTabbableDescendants;\n/*!\n * Adapted from jQuery UI core\n *\n * http://jqueryui.com\n *\n * Copyright 2014 jQuery Foundation and other contributors\n * Released under the MIT license.\n * http://jquery.org/license\n *\n * http://api.jqueryui.com/category/ui-core/\n */\n\nvar tabbableNode = /input|select|textarea|button|object/;\n\nfunction hidesContents(element) {\n  var zeroSize = element.offsetWidth <= 0 && element.offsetHeight <= 0;\n\n  // If the node is empty, this is good enough\n  if (zeroSize && !element.innerHTML) return true;\n\n  // Otherwise we need to check some styles\n  var style = window.getComputedStyle(element);\n  return zeroSize ? style.getPropertyValue(\"overflow\") !== \"visible\" ||\n  // if 'overflow: visible' set, check if there is actually any overflow\n  element.scrollWidth <= 0 && element.scrollHeight <= 0 : style.getPropertyValue(\"display\") == \"none\";\n}\n\nfunction visible(element) {\n  var parentElement = element;\n  while (parentElement) {\n    if (parentElement === document.body) break;\n    if (hidesContents(parentElement)) return false;\n    parentElement = parentElement.parentNode;\n  }\n  return true;\n}\n\nfunction focusable(element, isTabIndexNotNaN) {\n  var nodeName = element.nodeName.toLowerCase();\n  var res = tabbableNode.test(nodeName) && !element.disabled || (nodeName === \"a\" ? element.href || isTabIndexNotNaN : isTabIndexNotNaN);\n  return res && visible(element);\n}\n\nfunction tabbable(element) {\n  var tabIndex = element.getAttribute(\"tabindex\");\n  if (tabIndex === null) tabIndex = undefined;\n  var isTabIndexNaN = isNaN(tabIndex);\n  return (isTabIndexNaN || tabIndex >= 0) && focusable(element, !isTabIndexNaN);\n}\n\nfunction findTabbableDescendants(element) {\n  return [].slice.call(element.querySelectorAll(\"*\"), 0).filter(tabbable);\n}\nmodule.exports = exports[\"default\"];","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.assertNodeList = assertNodeList;\nexports.setElement = setElement;\nexports.validateElement = validateElement;\nexports.hide = hide;\nexports.show = show;\nexports.documentNotReadyOrSSRTesting = documentNotReadyOrSSRTesting;\nexports.resetForTesting = resetForTesting;\n\nvar _warning = require(\"warning\");\n\nvar _warning2 = _interopRequireDefault(_warning);\n\nvar _safeHTMLElement = require(\"./safeHTMLElement\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar globalElement = null;\n\nfunction assertNodeList(nodeList, selector) {\n  if (!nodeList || !nodeList.length) {\n    throw new Error(\"react-modal: No elements were found for selector \" + selector + \".\");\n  }\n}\n\nfunction setElement(element) {\n  var useElement = element;\n  if (typeof useElement === \"string\" && _safeHTMLElement.canUseDOM) {\n    var el = document.querySelectorAll(useElement);\n    assertNodeList(el, useElement);\n    useElement = \"length\" in el ? el[0] : el;\n  }\n  globalElement = useElement || globalElement;\n  return globalElement;\n}\n\nfunction validateElement(appElement) {\n  if (!appElement && !globalElement) {\n    (0, _warning2.default)(false, [\"react-modal: App element is not defined.\", \"Please use `Modal.setAppElement(el)` or set `appElement={el}`.\", \"This is needed so screen readers don't see main content\", \"when modal is opened. It is not recommended, but you can opt-out\", \"by setting `ariaHideApp={false}`.\"].join(\" \"));\n\n    return false;\n  }\n\n  return true;\n}\n\nfunction hide(appElement) {\n  if (validateElement(appElement)) {\n    (appElement || globalElement).setAttribute(\"aria-hidden\", \"true\");\n  }\n}\n\nfunction show(appElement) {\n  if (validateElement(appElement)) {\n    (appElement || globalElement).removeAttribute(\"aria-hidden\");\n  }\n}\n\nfunction documentNotReadyOrSSRTesting() {\n  globalElement = null;\n}\n\nfunction resetForTesting() {\n  globalElement = null;\n}","\n/**\n * Module dependencies.\n */\n\nvar url = require('./url');\nvar parser = require('socket.io-parser');\nvar Manager = require('./manager');\nvar debug = require('debug')('socket.io-client');\n\n/**\n * Module exports.\n */\n\nmodule.exports = exports = lookup;\n\n/**\n * Managers cache.\n */\n\nvar cache = exports.managers = {};\n\n/**\n * Looks up an existing `Manager` for multiplexing.\n * If the user summons:\n *\n *   `io('http://localhost/a');`\n *   `io('http://localhost/b');`\n *\n * We reuse the existing instance based on same scheme/port/host,\n * and we initialize sockets for each namespace.\n *\n * @api public\n */\n\nfunction lookup (uri, opts) {\n  if (typeof uri === 'object') {\n    opts = uri;\n    uri = undefined;\n  }\n\n  opts = opts || {};\n\n  var parsed = url(uri);\n  var source = parsed.source;\n  var id = parsed.id;\n  var path = parsed.path;\n  var sameNamespace = cache[id] && path in cache[id].nsps;\n  var newConnection = opts.forceNew || opts['force new connection'] ||\n                      false === opts.multiplex || sameNamespace;\n\n  var io;\n\n  if (newConnection) {\n    debug('ignoring socket cache for %s', source);\n    io = Manager(source, opts);\n  } else {\n    if (!cache[id]) {\n      debug('new io instance for %s', source);\n      cache[id] = Manager(source, opts);\n    }\n    io = cache[id];\n  }\n  if (parsed.query && !opts.query) {\n    opts.query = parsed.query;\n  }\n  return io.socket(parsed.path, opts);\n}\n\n/**\n * Protocol version.\n *\n * @api public\n */\n\nexports.protocol = parser.protocol;\n\n/**\n * `connect`.\n *\n * @param {String} uri\n * @api public\n */\n\nexports.connect = lookup;\n\n/**\n * Expose constructors for standalone build.\n *\n * @api public\n */\n\nexports.Manager = require('./manager');\nexports.Socket = require('./socket');\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport MarkdownViewer from '@seafile/seafile-editor/dist/viewer/markdown-viewer';\nimport { gettext, repoID, slug, serviceURL, isPublicWiki, siteRoot, sharedToken, mediaUrl } from '../utils/constants';\nimport { Card, CardTitle, CardText } from 'reactstrap';\nimport Loading from './loading';\nimport { seafileAPI } from '../utils/seafile-api';\nimport { Utils } from '../utils/utils';\nimport toaster from './toast';\nimport '../css/related-files-list.css';\n\nconst propTypes = {\n  children: PropTypes.object,\n  isFileLoading: PropTypes.bool.isRequired,\n  markdownContent: PropTypes.string.isRequired,\n  latestContributor: PropTypes.string.isRequired,\n  lastModified: PropTypes.string.isRequired,\n  onLinkClick: PropTypes.func.isRequired,\n  isWiki: PropTypes.bool,\n  isTOCShow: PropTypes.bool,\n  // for dir-column-file component(import repoID is undefined)\n  repoID: PropTypes.string,\n  path: PropTypes.string,\n};\n\nconst contentClass = 'wiki-page-content';\n\nclass WikiMarkdownViewer extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      activeTitleIndex: 0,\n      relatedFiles: [],\n    };\n    this.markdownContainer = React.createRef();\n    this.links = [];\n    this.titlesInfo = [];\n  }\n\n  componentDidMount() {\n    // Bind event when first loaded\n    this.links = document.querySelectorAll(`.${contentClass} a`);\n    this.links.forEach(link => {\n      link.addEventListener('click', this.onLinkClick);\n    });\n    this.listRelatedFiles();\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (this.props.markdownContent === nextProps.markdownContent) {\n      return;\n    }\n    // Unbound event when updating\n    this.links.forEach(link => {\n      link.removeEventListener('click', this.onLinkClick);\n    });\n    this.listRelatedFiles();\n  }\n\n  componentDidUpdate() {\n    // Update completed, rebind event\n    this.links = document.querySelectorAll(`.${contentClass} a`);\n    this.links.forEach(link => {\n      link.addEventListener('click', this.onLinkClick);\n    });\n  }\n\n  componentWillUnmount() {\n    // Unbound events when the component is destroyed\n    this.links.forEach(link => {\n      link.removeEventListener('click', this.onLinkClick);\n    });\n  }\n\n  onContentRendered = (markdownViewer) => {\n    this.titlesInfo = markdownViewer.titlesInfo;\n  }\n\n  listRelatedFiles = () => {\n    // for dir-column-file component(import repoID is undefined)\n    if (this.props.repoID && this.props.path) {\n      seafileAPI.listRelatedFiles(this.props.repoID, this.props.path).then(res => {\n        this.setState({\n          relatedFiles: res.data.related_files\n        });\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    }\n  }\n\n  onLinkClick = (event) => {\n    event.preventDefault();\n    event.stopPropagation();\n    let link = '';\n    if (event.target.tagName !== 'A') {\n      let target = event.target.parentNode;\n      while (target.tagName !== 'A') {\n        target = target.parentNode;\n      }\n      link = target.href;\n    } else {\n      link = event.target.href;\n    }\n    this.props.onLinkClick(link);\n  }\n\n  onScrollHandler = () => {\n    const contentScrollTop = this.markdownContainer.current.scrollTop + 180;\n    let titlesLength = this.titlesInfo.length;\n    let activeTitleIndex;\n    if (contentScrollTop <= this.titlesInfo[0]) {\n      activeTitleIndex = 0;\n      this.setState({activeTitleIndex: activeTitleIndex});\n      return;\n    }\n    if (contentScrollTop > this.titlesInfo[titlesLength - 1]) {\n      activeTitleIndex = this.titlesInfo.length - 1;\n      this.setState({activeTitleIndex: activeTitleIndex});\n      return;\n    }\n    for (let i = 0; i < titlesLength; i++) {\n      if (contentScrollTop > this.titlesInfo[i]) {\n        continue;\n      } else {\n        activeTitleIndex = i - 1;\n        break;\n      }\n    }\n    this.setState({activeTitleIndex: activeTitleIndex});\n  }\n\n  changeInlineNode = (item) => {\n    if (item.object == 'inline') {\n      let url, imagePath;\n\n      // change image url\n      if (item.type == 'image' && isPublicWiki) {\n        url = item.data.src;\n        const re = new RegExp(serviceURL + '/lib/' + repoID +'/file.*raw=1');\n        // different repo\n        if (re.test(url)) {\n          // get image path\n          let index = url.indexOf('/file');\n          let index2 = url.indexOf('?');\n          imagePath = url.substring(index + 5, index2);\n        } else if (/^\\.\\.\\/*/.test(url) || /^\\.\\/*/.test(url)) {\n          const path = this.props.path;\n          const originalPath = path.slice(0, path.lastIndexOf('/')) + '/' + url;\n          imagePath = Utils.pathNormalize(originalPath);\n        } else {\n          return;\n        }\n        item.data.src = serviceURL + '/view-image-via-public-wiki/?slug=' + slug + '&path=' + imagePath;\n      }\n\n      else if (item.type == 'link') {\n        url = item.data.href;\n        // change file url\n        if (Utils.isInternalFileLink(url, repoID)) {\n          if (Utils.isInternalMarkdownLink(url, repoID)) {\n            let path = Utils.getPathFromInternalMarkdownLink(url, repoID);\n            // replace url\n            item.data.href = serviceURL + '/published/' + slug + path;\n          } else {\n            item.data.href = url.replace(/(.*)lib\\/([-0-9a-f]{36})\\/file(.*)/g, (match, p1, p2, p3) => {\n              return `${p1}d/${sharedToken}/files/?p=${p3}&dl=1`;\n            });\n          }\n        }\n        // change dir url\n        else if (Utils.isInternalDirLink(url, repoID)) {\n          let path = Utils.getPathFromInternalDirLink(url, repoID);\n          // replace url\n          item.data.href = serviceURL + '/published/' + slug + path;\n        }\n      }\n    }\n\n    return item;\n  }\n\n  modifyValueBeforeRender = (value) => {\n    let newNodes = Utils.changeMarkdownNodes(value, this.changeInlineNode);\n    return newNodes;\n  }\n\n  renderMarkdown = () => {\n    let isTOCShow = true;\n    if (this.props.isTOCShow === false) {\n      isTOCShow = false;\n    }\n    if (this.props.isWiki) {\n      return (\n        <MarkdownViewer\n          showTOC={isTOCShow}\n          scriptSource={mediaUrl + 'js/mathjax/tex-svg.js'}\n          markdownContent={this.props.markdownContent}\n          activeTitleIndex={this.state.activeTitleIndex}\n          onContentRendered={this.onContentRendered}\n          modifyValueBeforeRender={this.modifyValueBeforeRender}\n        />\n      );\n    }\n\n    return (\n      <MarkdownViewer\n        showTOC={isTOCShow}\n        scriptSource={mediaUrl + 'js/mathjax/tex-svg.js'}\n        markdownContent={this.props.markdownContent}\n        activeTitleIndex={this.state.activeTitleIndex}\n        onContentRendered={this.onContentRendered}\n      />\n    );\n  }\n\n  renderRelatedFiles = () => {\n    const relatedFiles = this.state.relatedFiles;\n    if (relatedFiles.length > 0) {\n      return (\n        <div className=\"sf-releted-files\" id=\"sf-releted-files\">\n          <div className=\"sf-releted-files-header\">\n            <h4>{gettext('related files')}</h4>\n          </div>\n          {\n            relatedFiles.map((relatedFile, index) => {\n              let href = siteRoot + 'lib/' + relatedFile.repo_id + '/file' + Utils.encodePath(relatedFile.path);\n              return(\n                <div className=\"sf-releted-file\" key={index}>\n                  <a href={href} target=\"_blank\">\n                    <Card body size=\"sm\">\n                      <CardTitle>{relatedFile.name}</CardTitle>\n                      <CardText>{relatedFile.repo_name}</CardText>\n                      <span className=\"sf-releted-file-arrow\"></span>\n                    </Card>\n                  </a>\n                </div>\n              );\n            })\n          }\n        </div>\n      );\n    } else {\n      return null;\n    }\n  }\n\n  render() {\n    if (this.props.isFileLoading) {\n      return <Loading />;\n    }\n    // In dir-column-file repoID is one of props, width is 100%; In wiki-viewer repoID is not props, width isn't 100%\n    let contentClassName = `${this.props.repoID ? contentClass + ' w-100' : contentClass}`;\n    return (\n      <div ref={this.markdownContainer} className=\"wiki-page-container\" onScroll={this.onScrollHandler.bind(this)}>\n        <div className={contentClassName}>\n          {this.props.children}\n          {this.renderMarkdown()}\n          {this.props.isWiki && this.renderRelatedFiles()}\n          <p id=\"wiki-page-last-modified\">{gettext('Last modified by')} {this.props.latestContributor}, <span>{this.props.lastModified}</span></p>\n        </div>\n      </div>\n    );\n  }\n}\n\nconst defaultProps = {\n  isWiki: false,\n};\n\nWikiMarkdownViewer.propTypes = propTypes;\nMarkdownViewer.defaultProps = defaultProps;\n\nexport default WikiMarkdownViewer;\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport Modal from 'react-modal';\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (typeof call === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nfunction _iterableToArray(iter) {\n  if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter);\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === \"[object Arguments]\")) {\n    return;\n  }\n\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n}\n\n/**\n * Placeholder for future translate functionality\n */\nfunction translate(str) {\n  var replaceStrings = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n\n  if (!str) {\n    return '';\n  }\n\n  var translated = str;\n\n  if (replaceStrings) {\n    Object.keys(replaceStrings).forEach(function (placeholder) {\n      translated = translated.replace(placeholder, replaceStrings[placeholder]);\n    });\n  }\n\n  return translated;\n}\nfunction getWindowWidth() {\n  return typeof global.window !== 'undefined' ? global.window.innerWidth : 0;\n}\nfunction getWindowHeight() {\n  return typeof global.window !== 'undefined' ? global.window.innerHeight : 0;\n} // Get the highest window context that isn't cross-origin\n// (When in an iframe)\n\nfunction getHighestSafeWindowContext() {\n  var self = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : global.window.self;\n  var referrer = self.document.referrer; // If we reached the top level, return self\n\n  if (self === global.window.top || !referrer) {\n    return self;\n  }\n\n  var getOrigin = function getOrigin(href) {\n    return href.match(/(.*\\/\\/.*?)(\\/|$)/)[1];\n  }; // If parent is the same origin, we can move up one context\n  // Reference: https://stackoverflow.com/a/21965342/1601953\n\n\n  if (getOrigin(self.location.href) === getOrigin(referrer)) {\n    return getHighestSafeWindowContext(self.parent);\n  } // If a different origin, we consider the current level\n  // as the top reachable one\n\n\n  return self;\n}\n\n// Min image zoom level\nvar MIN_ZOOM_LEVEL = 0; // Max image zoom level\n\nvar MAX_ZOOM_LEVEL = 300; // Size ratio between previous and next zoom levels\n\nvar ZOOM_RATIO = 1.007; // How much to increase/decrease the zoom level when the zoom buttons are clicked\n\nvar ZOOM_BUTTON_INCREMENT_SIZE = 100; // Used to judge the amount of horizontal scroll needed to initiate a image move\n\nvar WHEEL_MOVE_Y_THRESHOLD = 1;\nvar KEYS = {\n  ESC: 27,\n  LEFT_ARROW: 37,\n  RIGHT_ARROW: 39\n}; // Actions\n\nvar ACTION_NONE = 0;\nvar ACTION_MOVE = 1;\nvar ACTION_SWIPE = 2;\nvar ACTION_PINCH = 3;\n\nvar SOURCE_ANY = 0;\nvar SOURCE_MOUSE = 1;\nvar SOURCE_TOUCH = 2;\nvar SOURCE_POINTER = 3; // Minimal swipe distance\n\nvar MIN_SWIPE_DISTANCE = 200;\n\nvar ReactImageLightbox =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(ReactImageLightbox, _Component);\n\n  _createClass(ReactImageLightbox, null, [{\n    key: \"isTargetMatchImage\",\n    value: function isTargetMatchImage(target) {\n      return target && /ril-image-current/.test(target.className);\n    }\n  }, {\n    key: \"parseMouseEvent\",\n    value: function parseMouseEvent(mouseEvent) {\n      return {\n        id: 'mouse',\n        source: SOURCE_MOUSE,\n        x: parseInt(mouseEvent.clientX, 10),\n        y: parseInt(mouseEvent.clientY, 10)\n      };\n    }\n  }, {\n    key: \"parseTouchPointer\",\n    value: function parseTouchPointer(touchPointer) {\n      return {\n        id: touchPointer.identifier,\n        source: SOURCE_TOUCH,\n        x: parseInt(touchPointer.clientX, 10),\n        y: parseInt(touchPointer.clientY, 10)\n      };\n    }\n  }, {\n    key: \"parsePointerEvent\",\n    value: function parsePointerEvent(pointerEvent) {\n      return {\n        id: pointerEvent.pointerId,\n        source: SOURCE_POINTER,\n        x: parseInt(pointerEvent.clientX, 10),\n        y: parseInt(pointerEvent.clientY, 10)\n      };\n    } // Request to transition to the previous image\n\n  }, {\n    key: \"getTransform\",\n    value: function getTransform(_ref) {\n      var _ref$x = _ref.x,\n          x = _ref$x === void 0 ? 0 : _ref$x,\n          _ref$y = _ref.y,\n          y = _ref$y === void 0 ? 0 : _ref$y,\n          _ref$zoom = _ref.zoom,\n          zoom = _ref$zoom === void 0 ? 1 : _ref$zoom,\n          width = _ref.width,\n          targetWidth = _ref.targetWidth;\n      var nextX = x;\n      var windowWidth = getWindowWidth();\n\n      if (width > windowWidth) {\n        nextX += (windowWidth - width) / 2;\n      }\n\n      var scaleFactor = zoom * (targetWidth / width);\n      return {\n        transform: \"translate3d(\".concat(nextX, \"px,\").concat(y, \"px,0) scale3d(\").concat(scaleFactor, \",\").concat(scaleFactor, \",1)\")\n      };\n    }\n  }]);\n\n  function ReactImageLightbox(props) {\n    var _this;\n\n    _classCallCheck(this, ReactImageLightbox);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ReactImageLightbox).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"handleWheel\", function (event) {\n      event.preventDefault();\n    });\n\n    _this.state = {\n      //-----------------------------\n      // Animation\n      //-----------------------------\n      // Lightbox is closing\n      // When Lightbox is mounted, if animation is enabled it will open with the reverse of the closing animation\n      isClosing: !props.animationDisabled,\n      // Component parts should animate (e.g., when images are moving, or image is being zoomed)\n      shouldAnimate: false,\n      //-----------------------------\n      // Zoom settings\n      //-----------------------------\n      // Zoom level of image\n      zoomLevel: MIN_ZOOM_LEVEL,\n      //-----------------------------\n      // Image position settings\n      //-----------------------------\n      // Horizontal offset from center\n      offsetX: 0,\n      // Vertical offset from center\n      offsetY: 0,\n      // image load error for srcType\n      loadErrorStatus: {}\n    }; // Refs\n\n    _this.outerEl = React.createRef();\n    _this.zoomInBtn = React.createRef();\n    _this.zoomOutBtn = React.createRef();\n    _this.caption = React.createRef();\n    _this.closeIfClickInner = _this.closeIfClickInner.bind(_assertThisInitialized(_this));\n    _this.handleImageDoubleClick = _this.handleImageDoubleClick.bind(_assertThisInitialized(_this));\n    _this.handleImageMouseWheel = _this.handleImageMouseWheel.bind(_assertThisInitialized(_this));\n    _this.handleKeyInput = _this.handleKeyInput.bind(_assertThisInitialized(_this));\n    _this.handleMouseUp = _this.handleMouseUp.bind(_assertThisInitialized(_this));\n    _this.handleMouseDown = _this.handleMouseDown.bind(_assertThisInitialized(_this));\n    _this.handleMouseMove = _this.handleMouseMove.bind(_assertThisInitialized(_this));\n    _this.handleOuterMousewheel = _this.handleOuterMousewheel.bind(_assertThisInitialized(_this));\n    _this.handleTouchStart = _this.handleTouchStart.bind(_assertThisInitialized(_this));\n    _this.handleTouchMove = _this.handleTouchMove.bind(_assertThisInitialized(_this));\n    _this.handleTouchEnd = _this.handleTouchEnd.bind(_assertThisInitialized(_this));\n    _this.handlePointerEvent = _this.handlePointerEvent.bind(_assertThisInitialized(_this));\n    _this.handleCaptionMousewheel = _this.handleCaptionMousewheel.bind(_assertThisInitialized(_this));\n    _this.handleWindowResize = _this.handleWindowResize.bind(_assertThisInitialized(_this));\n    _this.handleZoomInButtonClick = _this.handleZoomInButtonClick.bind(_assertThisInitialized(_this));\n    _this.handleZoomOutButtonClick = _this.handleZoomOutButtonClick.bind(_assertThisInitialized(_this));\n    _this.requestClose = _this.requestClose.bind(_assertThisInitialized(_this));\n    _this.requestMoveNext = _this.requestMoveNext.bind(_assertThisInitialized(_this));\n    _this.requestMovePrev = _this.requestMovePrev.bind(_assertThisInitialized(_this));\n    return _this;\n  } // eslint-disable-next-line camelcase\n\n\n  _createClass(ReactImageLightbox, [{\n    key: \"UNSAFE_componentWillMount\",\n    value: function UNSAFE_componentWillMount() {\n      // Timeouts - always clear it before umount\n      this.timeouts = []; // Current action\n\n      this.currentAction = ACTION_NONE; // Events source\n\n      this.eventsSource = SOURCE_ANY; // Empty pointers list\n\n      this.pointerList = []; // Prevent inner close\n\n      this.preventInnerClose = false;\n      this.preventInnerCloseTimeout = null; // Used to disable animation when changing props.mainSrc|nextSrc|prevSrc\n\n      this.keyPressed = false; // Used to store load state / dimensions of images\n\n      this.imageCache = {}; // Time the last keydown event was called (used in keyboard action rate limiting)\n\n      this.lastKeyDownTime = 0; // Used for debouncing window resize event\n\n      this.resizeTimeout = null; // Used to determine when actions are triggered by the scroll wheel\n\n      this.wheelActionTimeout = null;\n      this.resetScrollTimeout = null;\n      this.scrollX = 0;\n      this.scrollY = 0; // Used in panning zoomed images\n\n      this.moveStartX = 0;\n      this.moveStartY = 0;\n      this.moveStartOffsetX = 0;\n      this.moveStartOffsetY = 0; // Used to swipe\n\n      this.swipeStartX = 0;\n      this.swipeStartY = 0;\n      this.swipeEndX = 0;\n      this.swipeEndY = 0; // Used to pinch\n\n      this.pinchTouchList = null;\n      this.pinchDistance = 0; // Used to differentiate between images with identical src\n\n      this.keyCounter = 0; // Used to detect a move when all src's remain unchanged (four or more of the same image in a row)\n\n      this.moveRequested = false;\n\n      if (!this.props.animationDisabled) {\n        // Make opening animation play\n        this.setState({\n          isClosing: false\n        });\n      }\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      // Prevents cross-origin errors when using a cross-origin iframe\n      this.windowContext = getHighestSafeWindowContext();\n      this.listeners = {\n        resize: this.handleWindowResize,\n        mouseup: this.handleMouseUp,\n        touchend: this.handleTouchEnd,\n        touchcancel: this.handleTouchEnd,\n        pointerdown: this.handlePointerEvent,\n        pointermove: this.handlePointerEvent,\n        pointerup: this.handlePointerEvent,\n        pointercancel: this.handlePointerEvent\n      };\n      Object.keys(this.listeners).forEach(function (type) {\n        _this2.windowContext.addEventListener(type, _this2.listeners[type]);\n      });\n      document.addEventListener('wheel', this.handleWheel, {\n        passive: false\n      });\n      this.loadAllImages();\n    } // eslint-disable-next-line camelcase\n\n  }, {\n    key: \"UNSAFE_componentWillReceiveProps\",\n    value: function UNSAFE_componentWillReceiveProps(nextProps) {\n      var _this3 = this;\n\n      // Iterate through the source types for prevProps and nextProps to\n      //  determine if any of the sources changed\n      var sourcesChanged = false;\n      var prevSrcDict = {};\n      var nextSrcDict = {};\n      this.getSrcTypes().forEach(function (srcType) {\n        if (_this3.props[srcType.name] !== nextProps[srcType.name]) {\n          sourcesChanged = true;\n          prevSrcDict[_this3.props[srcType.name]] = true;\n          nextSrcDict[nextProps[srcType.name]] = true;\n        }\n      });\n\n      if (sourcesChanged || this.moveRequested) {\n        // Reset the loaded state for images not rendered next\n        Object.keys(prevSrcDict).forEach(function (prevSrc) {\n          if (!(prevSrc in nextSrcDict) && prevSrc in _this3.imageCache) {\n            _this3.imageCache[prevSrc].loaded = false;\n          }\n        });\n        this.moveRequested = false; // Load any new images\n\n        this.loadAllImages(nextProps);\n      }\n    }\n  }, {\n    key: \"shouldComponentUpdate\",\n    value: function shouldComponentUpdate() {\n      // Wait for move...\n      return !this.moveRequested;\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      var _this4 = this;\n\n      this.didUnmount = true;\n      Object.keys(this.listeners).forEach(function (type) {\n        _this4.windowContext.removeEventListener(type, _this4.listeners[type]);\n      });\n      document.removeEventListener('wheel', this.handleWheel, {\n        passive: false\n      });\n      this.timeouts.forEach(function (tid) {\n        return clearTimeout(tid);\n      });\n    }\n  }, {\n    key: \"setTimeout\",\n    value: function (_setTimeout) {\n      function setTimeout(_x, _x2) {\n        return _setTimeout.apply(this, arguments);\n      }\n\n      setTimeout.toString = function () {\n        return _setTimeout.toString();\n      };\n\n      return setTimeout;\n    }(function (func, time) {\n      var _this5 = this;\n\n      var id = setTimeout(function () {\n        _this5.timeouts = _this5.timeouts.filter(function (tid) {\n          return tid !== id;\n        });\n        func();\n      }, time);\n      this.timeouts.push(id);\n      return id;\n    })\n  }, {\n    key: \"setPreventInnerClose\",\n    value: function setPreventInnerClose() {\n      var _this6 = this;\n\n      if (this.preventInnerCloseTimeout) {\n        this.clearTimeout(this.preventInnerCloseTimeout);\n      }\n\n      this.preventInnerClose = true;\n      this.preventInnerCloseTimeout = this.setTimeout(function () {\n        _this6.preventInnerClose = false;\n        _this6.preventInnerCloseTimeout = null;\n      }, 100);\n    } // Get info for the best suited image to display with the given srcType\n\n  }, {\n    key: \"getBestImageForType\",\n    value: function getBestImageForType(srcType) {\n      var imageSrc = this.props[srcType];\n      var fitSizes = {};\n\n      if (this.isImageLoaded(imageSrc)) {\n        // Use full-size image if available\n        fitSizes = this.getFitSizes(this.imageCache[imageSrc].width, this.imageCache[imageSrc].height);\n      } else if (this.isImageLoaded(this.props[\"\".concat(srcType, \"Thumbnail\")])) {\n        // Fall back to using thumbnail if the image has not been loaded\n        imageSrc = this.props[\"\".concat(srcType, \"Thumbnail\")];\n        fitSizes = this.getFitSizes(this.imageCache[imageSrc].width, this.imageCache[imageSrc].height, true);\n      } else {\n        return null;\n      }\n\n      return {\n        src: imageSrc,\n        height: this.imageCache[imageSrc].height,\n        width: this.imageCache[imageSrc].width,\n        targetHeight: fitSizes.height,\n        targetWidth: fitSizes.width\n      };\n    } // Get sizing for when an image is larger than the window\n\n  }, {\n    key: \"getFitSizes\",\n    value: function getFitSizes(width, height, stretch) {\n      var boxSize = this.getLightboxRect();\n      var maxHeight = boxSize.height - this.props.imagePadding * 2;\n      var maxWidth = boxSize.width - this.props.imagePadding * 2;\n\n      if (!stretch) {\n        maxHeight = Math.min(maxHeight, height);\n        maxWidth = Math.min(maxWidth, width);\n      }\n\n      var maxRatio = maxWidth / maxHeight;\n      var srcRatio = width / height;\n\n      if (maxRatio > srcRatio) {\n        // height is the constraining dimension of the photo\n        return {\n          width: width * maxHeight / height,\n          height: maxHeight\n        };\n      }\n\n      return {\n        width: maxWidth,\n        height: height * maxWidth / width\n      };\n    }\n  }, {\n    key: \"getMaxOffsets\",\n    value: function getMaxOffsets() {\n      var zoomLevel = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.state.zoomLevel;\n      var currentImageInfo = this.getBestImageForType('mainSrc');\n\n      if (currentImageInfo === null) {\n        return {\n          maxX: 0,\n          minX: 0,\n          maxY: 0,\n          minY: 0\n        };\n      }\n\n      var boxSize = this.getLightboxRect();\n      var zoomMultiplier = this.getZoomMultiplier(zoomLevel);\n      var maxX = 0;\n\n      if (zoomMultiplier * currentImageInfo.width - boxSize.width < 0) {\n        // if there is still blank space in the X dimension, don't limit except to the opposite edge\n        maxX = (boxSize.width - zoomMultiplier * currentImageInfo.width) / 2;\n      } else {\n        maxX = (zoomMultiplier * currentImageInfo.width - boxSize.width) / 2;\n      }\n\n      var maxY = 0;\n\n      if (zoomMultiplier * currentImageInfo.height - boxSize.height < 0) {\n        // if there is still blank space in the Y dimension, don't limit except to the opposite edge\n        maxY = (boxSize.height - zoomMultiplier * currentImageInfo.height) / 2;\n      } else {\n        maxY = (zoomMultiplier * currentImageInfo.height - boxSize.height) / 2;\n      }\n\n      return {\n        maxX: maxX,\n        maxY: maxY,\n        minX: -1 * maxX,\n        minY: -1 * maxY\n      };\n    } // Get image src types\n\n  }, {\n    key: \"getSrcTypes\",\n    value: function getSrcTypes() {\n      return [{\n        name: 'mainSrc',\n        keyEnding: \"i\".concat(this.keyCounter)\n      }, {\n        name: 'mainSrcThumbnail',\n        keyEnding: \"t\".concat(this.keyCounter)\n      }, {\n        name: 'nextSrc',\n        keyEnding: \"i\".concat(this.keyCounter + 1)\n      }, {\n        name: 'nextSrcThumbnail',\n        keyEnding: \"t\".concat(this.keyCounter + 1)\n      }, {\n        name: 'prevSrc',\n        keyEnding: \"i\".concat(this.keyCounter - 1)\n      }, {\n        name: 'prevSrcThumbnail',\n        keyEnding: \"t\".concat(this.keyCounter - 1)\n      }];\n    }\n    /**\n     * Get sizing when the image is scaled\n     */\n\n  }, {\n    key: \"getZoomMultiplier\",\n    value: function getZoomMultiplier() {\n      var zoomLevel = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.state.zoomLevel;\n      return Math.pow(ZOOM_RATIO, zoomLevel);\n    }\n    /**\n     * Get the size of the lightbox in pixels\n     */\n\n  }, {\n    key: \"getLightboxRect\",\n    value: function getLightboxRect() {\n      if (this.outerEl.current) {\n        return this.outerEl.current.getBoundingClientRect();\n      }\n\n      return {\n        width: getWindowWidth(),\n        height: getWindowHeight(),\n        top: 0,\n        right: 0,\n        bottom: 0,\n        left: 0\n      };\n    }\n  }, {\n    key: \"clearTimeout\",\n    value: function (_clearTimeout) {\n      function clearTimeout(_x3) {\n        return _clearTimeout.apply(this, arguments);\n      }\n\n      clearTimeout.toString = function () {\n        return _clearTimeout.toString();\n      };\n\n      return clearTimeout;\n    }(function (id) {\n      this.timeouts = this.timeouts.filter(function (tid) {\n        return tid !== id;\n      });\n      clearTimeout(id);\n    }) // Change zoom level\n\n  }, {\n    key: \"changeZoom\",\n    value: function changeZoom(zoomLevel, clientX, clientY) {\n      // Ignore if zoom disabled\n      if (!this.props.enableZoom) {\n        return;\n      } // Constrain zoom level to the set bounds\n\n\n      var nextZoomLevel = Math.max(MIN_ZOOM_LEVEL, Math.min(MAX_ZOOM_LEVEL, zoomLevel)); // Ignore requests that don't change the zoom level\n\n      if (nextZoomLevel === this.state.zoomLevel) {\n        return;\n      }\n\n      if (nextZoomLevel === MIN_ZOOM_LEVEL) {\n        // Snap back to center if zoomed all the way out\n        this.setState({\n          zoomLevel: nextZoomLevel,\n          offsetX: 0,\n          offsetY: 0\n        });\n        return;\n      }\n\n      var imageBaseSize = this.getBestImageForType('mainSrc');\n\n      if (imageBaseSize === null) {\n        return;\n      }\n\n      var currentZoomMultiplier = this.getZoomMultiplier();\n      var nextZoomMultiplier = this.getZoomMultiplier(nextZoomLevel); // Default to the center of the image to zoom when no mouse position specified\n\n      var boxRect = this.getLightboxRect();\n      var pointerX = typeof clientX !== 'undefined' ? clientX - boxRect.left : boxRect.width / 2;\n      var pointerY = typeof clientY !== 'undefined' ? clientY - boxRect.top : boxRect.height / 2;\n      var currentImageOffsetX = (boxRect.width - imageBaseSize.width * currentZoomMultiplier) / 2;\n      var currentImageOffsetY = (boxRect.height - imageBaseSize.height * currentZoomMultiplier) / 2;\n      var currentImageRealOffsetX = currentImageOffsetX - this.state.offsetX;\n      var currentImageRealOffsetY = currentImageOffsetY - this.state.offsetY;\n      var currentPointerXRelativeToImage = (pointerX - currentImageRealOffsetX) / currentZoomMultiplier;\n      var currentPointerYRelativeToImage = (pointerY - currentImageRealOffsetY) / currentZoomMultiplier;\n      var nextImageRealOffsetX = pointerX - currentPointerXRelativeToImage * nextZoomMultiplier;\n      var nextImageRealOffsetY = pointerY - currentPointerYRelativeToImage * nextZoomMultiplier;\n      var nextImageOffsetX = (boxRect.width - imageBaseSize.width * nextZoomMultiplier) / 2;\n      var nextImageOffsetY = (boxRect.height - imageBaseSize.height * nextZoomMultiplier) / 2;\n      var nextOffsetX = nextImageOffsetX - nextImageRealOffsetX;\n      var nextOffsetY = nextImageOffsetY - nextImageRealOffsetY; // When zooming out, limit the offset so things don't get left askew\n\n      if (this.currentAction !== ACTION_PINCH) {\n        var maxOffsets = this.getMaxOffsets();\n\n        if (this.state.zoomLevel > nextZoomLevel) {\n          nextOffsetX = Math.max(maxOffsets.minX, Math.min(maxOffsets.maxX, nextOffsetX));\n          nextOffsetY = Math.max(maxOffsets.minY, Math.min(maxOffsets.maxY, nextOffsetY));\n        }\n      }\n\n      this.setState({\n        zoomLevel: nextZoomLevel,\n        offsetX: nextOffsetX,\n        offsetY: nextOffsetY\n      });\n    }\n  }, {\n    key: \"closeIfClickInner\",\n    value: function closeIfClickInner(event) {\n      if (!this.preventInnerClose && event.target.className.search(/\\bril-inner\\b/) > -1) {\n        this.requestClose(event);\n      }\n    }\n    /**\n     * Handle user keyboard actions\n     */\n\n  }, {\n    key: \"handleKeyInput\",\n    value: function handleKeyInput(event) {\n      event.stopPropagation(); // Ignore key input during animations\n\n      if (this.isAnimating()) {\n        return;\n      } // Allow slightly faster navigation through the images when user presses keys repeatedly\n\n\n      if (event.type === 'keyup') {\n        this.lastKeyDownTime -= this.props.keyRepeatKeyupBonus;\n        return;\n      }\n\n      var keyCode = event.which || event.keyCode; // Ignore key presses that happen too close to each other (when rapid fire key pressing or holding down the key)\n      // But allow it if it's a lightbox closing action\n\n      var currentTime = new Date();\n\n      if (currentTime.getTime() - this.lastKeyDownTime < this.props.keyRepeatLimit && keyCode !== KEYS.ESC) {\n        return;\n      }\n\n      this.lastKeyDownTime = currentTime.getTime();\n\n      switch (keyCode) {\n        // ESC key closes the lightbox\n        case KEYS.ESC:\n          event.preventDefault();\n          this.requestClose(event);\n          break;\n        // Left arrow key moves to previous image\n\n        case KEYS.LEFT_ARROW:\n          if (!this.props.prevSrc) {\n            return;\n          }\n\n          event.preventDefault();\n          this.keyPressed = true;\n          this.requestMovePrev(event);\n          break;\n        // Right arrow key moves to next image\n\n        case KEYS.RIGHT_ARROW:\n          if (!this.props.nextSrc) {\n            return;\n          }\n\n          event.preventDefault();\n          this.keyPressed = true;\n          this.requestMoveNext(event);\n          break;\n      }\n    }\n    /**\n     * Handle a mouse wheel event over the lightbox container\n     */\n\n  }, {\n    key: \"handleOuterMousewheel\",\n    value: function handleOuterMousewheel(event) {\n      var _this7 = this;\n\n      // Prevent scrolling of the background\n      event.stopPropagation();\n      this.clearTimeout(this.resetScrollTimeout);\n      this.resetScrollTimeout = this.setTimeout(function () {\n        _this7.scrollX = 0;\n        _this7.scrollY = 0;\n      }, 300);\n    }\n  }, {\n    key: \"handleImageMouseWheel\",\n    value: function handleImageMouseWheel(event) {\n      // when gesture move up/down/left/right, event.deltaY is integer, move image\n      if (parseInt(event.deltaY) === parseFloat(event.deltaY)) {\n        if (Math.abs(event.deltaY) > Math.abs(event.deltaX)) {\n          var newOffsetY = this.state.offsetY + event.deltaY;\n          this.setState({\n            offsetY: newOffsetY\n          });\n        } else {\n          var newOffsetX = this.state.offsetX + event.deltaX;\n          this.setState({\n            offsetX: newOffsetX\n          });\n        }\n\n        return;\n      } // when gesture zoom in or zoom out, event.deltaY is decimal, zoom image\n\n\n      var yThreshold = WHEEL_MOVE_Y_THRESHOLD;\n\n      if (Math.abs(event.deltaY) >= Math.abs(event.deltaX)) {\n        event.stopPropagation(); // If the vertical scroll amount was large enough, perform a zoom\n\n        if (Math.abs(event.deltaY) < yThreshold) {\n          return;\n        }\n\n        this.scrollX = 0;\n        this.scrollY += event.deltaY;\n        this.changeZoom(this.state.zoomLevel - event.deltaY, event.clientX, event.clientY);\n      }\n    }\n    /**\n     * Handle a double click on the current image\n     */\n\n  }, {\n    key: \"handleImageDoubleClick\",\n    value: function handleImageDoubleClick(event) {\n      if (this.state.zoomLevel > MIN_ZOOM_LEVEL) {\n        // A double click when zoomed in zooms all the way out\n        this.changeZoom(MIN_ZOOM_LEVEL, event.clientX, event.clientY);\n      } else {\n        // A double click when zoomed all the way out zooms in\n        this.changeZoom(this.state.zoomLevel + ZOOM_BUTTON_INCREMENT_SIZE, event.clientX, event.clientY);\n      }\n    }\n  }, {\n    key: \"shouldHandleEvent\",\n    value: function shouldHandleEvent(source) {\n      if (this.eventsSource === source) {\n        return true;\n      }\n\n      if (this.eventsSource === SOURCE_ANY) {\n        this.eventsSource = source;\n        return true;\n      }\n\n      switch (source) {\n        case SOURCE_MOUSE:\n          return false;\n\n        case SOURCE_TOUCH:\n          this.eventsSource = SOURCE_TOUCH;\n          this.filterPointersBySource();\n          return true;\n\n        case SOURCE_POINTER:\n          if (this.eventsSource === SOURCE_MOUSE) {\n            this.eventsSource = SOURCE_POINTER;\n            this.filterPointersBySource();\n            return true;\n          }\n\n          return false;\n\n        default:\n          return false;\n      }\n    }\n  }, {\n    key: \"addPointer\",\n    value: function addPointer(pointer) {\n      this.pointerList.push(pointer);\n    }\n  }, {\n    key: \"removePointer\",\n    value: function removePointer(pointer) {\n      this.pointerList = this.pointerList.filter(function (_ref2) {\n        var id = _ref2.id;\n        return id !== pointer.id;\n      });\n    }\n  }, {\n    key: \"filterPointersBySource\",\n    value: function filterPointersBySource() {\n      var _this8 = this;\n\n      this.pointerList = this.pointerList.filter(function (_ref3) {\n        var source = _ref3.source;\n        return source === _this8.eventsSource;\n      });\n    }\n  }, {\n    key: \"handleMouseDown\",\n    value: function handleMouseDown(event) {\n      if (this.shouldHandleEvent(SOURCE_MOUSE) && ReactImageLightbox.isTargetMatchImage(event.target)) {\n        this.addPointer(ReactImageLightbox.parseMouseEvent(event));\n        this.multiPointerStart(event);\n      }\n    }\n  }, {\n    key: \"handleMouseMove\",\n    value: function handleMouseMove(event) {\n      if (this.shouldHandleEvent(SOURCE_MOUSE)) {\n        this.multiPointerMove(event, [ReactImageLightbox.parseMouseEvent(event)]);\n      }\n    }\n  }, {\n    key: \"handleMouseUp\",\n    value: function handleMouseUp(event) {\n      if (this.shouldHandleEvent(SOURCE_MOUSE)) {\n        this.removePointer(ReactImageLightbox.parseMouseEvent(event));\n        this.multiPointerEnd(event);\n      }\n    }\n  }, {\n    key: \"handlePointerEvent\",\n    value: function handlePointerEvent(event) {\n      if (this.shouldHandleEvent(SOURCE_POINTER)) {\n        switch (event.type) {\n          case 'pointerdown':\n            if (ReactImageLightbox.isTargetMatchImage(event.target)) {\n              this.addPointer(ReactImageLightbox.parsePointerEvent(event));\n              this.multiPointerStart(event);\n            }\n\n            break;\n\n          case 'pointermove':\n            this.multiPointerMove(event, [ReactImageLightbox.parsePointerEvent(event)]);\n            break;\n\n          case 'pointerup':\n          case 'pointercancel':\n            this.removePointer(ReactImageLightbox.parsePointerEvent(event));\n            this.multiPointerEnd(event);\n            break;\n        }\n      }\n    }\n  }, {\n    key: \"handleTouchStart\",\n    value: function handleTouchStart(event) {\n      var _this9 = this;\n\n      if (this.shouldHandleEvent(SOURCE_TOUCH) && ReactImageLightbox.isTargetMatchImage(event.target)) {\n        [].forEach.call(event.changedTouches, function (eventTouch) {\n          return _this9.addPointer(ReactImageLightbox.parseTouchPointer(eventTouch));\n        });\n        this.multiPointerStart(event);\n      }\n    }\n  }, {\n    key: \"handleTouchMove\",\n    value: function handleTouchMove(event) {\n      if (this.shouldHandleEvent(SOURCE_TOUCH)) {\n        this.multiPointerMove(event, [].map.call(event.changedTouches, function (eventTouch) {\n          return ReactImageLightbox.parseTouchPointer(eventTouch);\n        }));\n      }\n    }\n  }, {\n    key: \"handleTouchEnd\",\n    value: function handleTouchEnd(event) {\n      var _this10 = this;\n\n      if (this.shouldHandleEvent(SOURCE_TOUCH)) {\n        [].map.call(event.changedTouches, function (touch) {\n          return _this10.removePointer(ReactImageLightbox.parseTouchPointer(touch));\n        });\n        this.multiPointerEnd(event);\n      }\n    }\n  }, {\n    key: \"decideMoveOrSwipe\",\n    value: function decideMoveOrSwipe(pointer) {\n      if (this.state.zoomLevel <= MIN_ZOOM_LEVEL) {\n        this.handleSwipeStart(pointer);\n      } else {\n        this.handleMoveStart(pointer);\n      }\n    }\n  }, {\n    key: \"multiPointerStart\",\n    value: function multiPointerStart(event) {\n      this.handleEnd(null);\n\n      switch (this.pointerList.length) {\n        case 1:\n          {\n            event.preventDefault();\n            this.decideMoveOrSwipe(this.pointerList[0]);\n            break;\n          }\n\n        case 2:\n          {\n            event.preventDefault();\n            this.handlePinchStart(this.pointerList);\n            break;\n          }\n      }\n    }\n  }, {\n    key: \"multiPointerMove\",\n    value: function multiPointerMove(event, pointerList) {\n      switch (this.currentAction) {\n        case ACTION_MOVE:\n          {\n            event.preventDefault();\n            this.handleMove(pointerList[0]);\n            break;\n          }\n\n        case ACTION_SWIPE:\n          {\n            event.preventDefault();\n            this.handleSwipe(pointerList[0]);\n            break;\n          }\n\n        case ACTION_PINCH:\n          {\n            event.preventDefault();\n            this.handlePinch(pointerList);\n            break;\n          }\n      }\n    }\n  }, {\n    key: \"multiPointerEnd\",\n    value: function multiPointerEnd(event) {\n      if (this.currentAction !== ACTION_NONE) {\n        this.setPreventInnerClose();\n        this.handleEnd(event);\n      }\n\n      switch (this.pointerList.length) {\n        case 0:\n          {\n            this.eventsSource = SOURCE_ANY;\n            break;\n          }\n\n        case 1:\n          {\n            event.preventDefault();\n            this.decideMoveOrSwipe(this.pointerList[0]);\n            break;\n          }\n\n        case 2:\n          {\n            event.preventDefault();\n            this.handlePinchStart(this.pointerList);\n            break;\n          }\n      }\n    }\n  }, {\n    key: \"handleEnd\",\n    value: function handleEnd(event) {\n      switch (this.currentAction) {\n        case ACTION_MOVE:\n          this.handleMoveEnd(event);\n          break;\n\n        case ACTION_SWIPE:\n          this.handleSwipeEnd(event);\n          break;\n\n        case ACTION_PINCH:\n          this.handlePinchEnd(event);\n          break;\n      }\n    } // Handle move start over the lightbox container\n    // This happens:\n    // - On a mouseDown event\n    // - On a touchstart event\n\n  }, {\n    key: \"handleMoveStart\",\n    value: function handleMoveStart(_ref4) {\n      var clientX = _ref4.x,\n          clientY = _ref4.y;\n\n      if (!this.props.enableZoom) {\n        return;\n      }\n\n      this.currentAction = ACTION_MOVE;\n      this.moveStartX = clientX;\n      this.moveStartY = clientY;\n      this.moveStartOffsetX = this.state.offsetX;\n      this.moveStartOffsetY = this.state.offsetY;\n    } // Handle dragging over the lightbox container\n    // This happens:\n    // - After a mouseDown and before a mouseUp event\n    // - After a touchstart and before a touchend event\n\n  }, {\n    key: \"handleMove\",\n    value: function handleMove(_ref5) {\n      var clientX = _ref5.x,\n          clientY = _ref5.y;\n      var newOffsetX = this.moveStartX - clientX + this.moveStartOffsetX;\n      var newOffsetY = this.moveStartY - clientY + this.moveStartOffsetY;\n\n      if (this.state.offsetX !== newOffsetX || this.state.offsetY !== newOffsetY) {\n        this.setState({\n          offsetX: newOffsetX,\n          offsetY: newOffsetY\n        });\n      }\n    }\n  }, {\n    key: \"handleMoveEnd\",\n    value: function handleMoveEnd() {\n      var _this11 = this;\n\n      this.currentAction = ACTION_NONE;\n      this.moveStartX = 0;\n      this.moveStartY = 0;\n      this.moveStartOffsetX = 0;\n      this.moveStartOffsetY = 0; // Snap image back into frame if outside max offset range\n\n      var maxOffsets = this.getMaxOffsets();\n      var nextOffsetX = Math.max(maxOffsets.minX, Math.min(maxOffsets.maxX, this.state.offsetX));\n      var nextOffsetY = Math.max(maxOffsets.minY, Math.min(maxOffsets.maxY, this.state.offsetY));\n\n      if (nextOffsetX !== this.state.offsetX || nextOffsetY !== this.state.offsetY) {\n        this.setState({\n          offsetX: nextOffsetX,\n          offsetY: nextOffsetY,\n          shouldAnimate: true\n        });\n        this.setTimeout(function () {\n          _this11.setState({\n            shouldAnimate: false\n          });\n        }, this.props.animationDuration);\n      }\n    }\n  }, {\n    key: \"handleSwipeStart\",\n    value: function handleSwipeStart(_ref6) {\n      var clientX = _ref6.x,\n          clientY = _ref6.y;\n      this.currentAction = ACTION_SWIPE;\n      this.swipeStartX = clientX;\n      this.swipeStartY = clientY;\n      this.swipeEndX = clientX;\n      this.swipeEndY = clientY;\n    }\n  }, {\n    key: \"handleSwipe\",\n    value: function handleSwipe(_ref7) {\n      var clientX = _ref7.x,\n          clientY = _ref7.y;\n      this.swipeEndX = clientX;\n      this.swipeEndY = clientY;\n    }\n  }, {\n    key: \"handleSwipeEnd\",\n    value: function handleSwipeEnd(event) {\n      var xDiff = this.swipeEndX - this.swipeStartX;\n      var xDiffAbs = Math.abs(xDiff);\n      var yDiffAbs = Math.abs(this.swipeEndY - this.swipeStartY);\n      this.currentAction = ACTION_NONE;\n      this.swipeStartX = 0;\n      this.swipeStartY = 0;\n      this.swipeEndX = 0;\n      this.swipeEndY = 0;\n\n      if (!event || this.isAnimating() || xDiffAbs < yDiffAbs * 1.5) {\n        return;\n      }\n\n      if (xDiffAbs < MIN_SWIPE_DISTANCE) {\n        var boxRect = this.getLightboxRect();\n\n        if (xDiffAbs < boxRect.width / 4) {\n          return;\n        }\n      }\n\n      if (xDiff > 0 && this.props.prevSrc) {\n        event.preventDefault();\n        this.requestMovePrev();\n      } else if (xDiff < 0 && this.props.nextSrc) {\n        event.preventDefault();\n        this.requestMoveNext();\n      }\n    }\n  }, {\n    key: \"calculatePinchDistance\",\n    value: function calculatePinchDistance() {\n      var _ref8 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.pinchTouchList,\n          _ref9 = _slicedToArray(_ref8, 2),\n          a = _ref9[0],\n          b = _ref9[1];\n\n      return Math.sqrt(Math.pow(a.x - b.x, 2) + Math.pow(a.y - b.y, 2));\n    }\n  }, {\n    key: \"calculatePinchCenter\",\n    value: function calculatePinchCenter() {\n      var _ref10 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.pinchTouchList,\n          _ref11 = _slicedToArray(_ref10, 2),\n          a = _ref11[0],\n          b = _ref11[1];\n\n      return {\n        x: a.x - (a.x - b.x) / 2,\n        y: a.y - (a.y - b.y) / 2\n      };\n    }\n  }, {\n    key: \"handlePinchStart\",\n    value: function handlePinchStart(pointerList) {\n      if (!this.props.enableZoom) {\n        return;\n      }\n\n      this.currentAction = ACTION_PINCH;\n      this.pinchTouchList = pointerList.map(function (_ref12) {\n        var id = _ref12.id,\n            x = _ref12.x,\n            y = _ref12.y;\n        return {\n          id: id,\n          x: x,\n          y: y\n        };\n      });\n      this.pinchDistance = this.calculatePinchDistance();\n    }\n  }, {\n    key: \"handlePinch\",\n    value: function handlePinch(pointerList) {\n      this.pinchTouchList = this.pinchTouchList.map(function (oldPointer) {\n        for (var i = 0; i < pointerList.length; i += 1) {\n          if (pointerList[i].id === oldPointer.id) {\n            return pointerList[i];\n          }\n        }\n\n        return oldPointer;\n      });\n      var newDistance = this.calculatePinchDistance();\n      var zoomLevel = this.state.zoomLevel + newDistance - this.pinchDistance;\n      this.pinchDistance = newDistance;\n\n      var _this$calculatePinchC = this.calculatePinchCenter(this.pinchTouchList),\n          clientX = _this$calculatePinchC.x,\n          clientY = _this$calculatePinchC.y;\n\n      this.changeZoom(zoomLevel, clientX, clientY);\n    }\n  }, {\n    key: \"handlePinchEnd\",\n    value: function handlePinchEnd() {\n      this.currentAction = ACTION_NONE;\n      this.pinchTouchList = null;\n      this.pinchDistance = 0;\n    } // Handle the window resize event\n\n  }, {\n    key: \"handleWindowResize\",\n    value: function handleWindowResize() {\n      this.clearTimeout(this.resizeTimeout);\n      this.resizeTimeout = this.setTimeout(this.forceUpdate.bind(this), 100);\n    }\n  }, {\n    key: \"handleZoomInButtonClick\",\n    value: function handleZoomInButtonClick() {\n      var nextZoomLevel = this.state.zoomLevel + ZOOM_BUTTON_INCREMENT_SIZE;\n      this.changeZoom(nextZoomLevel);\n\n      if (nextZoomLevel === MAX_ZOOM_LEVEL) {\n        this.zoomOutBtn.current.focus();\n      }\n    }\n  }, {\n    key: \"handleZoomOutButtonClick\",\n    value: function handleZoomOutButtonClick() {\n      var nextZoomLevel = this.state.zoomLevel - ZOOM_BUTTON_INCREMENT_SIZE;\n      this.changeZoom(nextZoomLevel);\n\n      if (nextZoomLevel === MIN_ZOOM_LEVEL) {\n        this.zoomInBtn.current.focus();\n      }\n    }\n  }, {\n    key: \"handleCaptionMousewheel\",\n    value: function handleCaptionMousewheel(event) {\n      event.stopPropagation();\n\n      if (!this.caption.current) {\n        return;\n      }\n\n      var _this$caption$current = this.caption.current.getBoundingClientRect(),\n          height = _this$caption$current.height;\n\n      var _this$caption$current2 = this.caption.current,\n          scrollHeight = _this$caption$current2.scrollHeight,\n          scrollTop = _this$caption$current2.scrollTop;\n\n      if (event.deltaY > 0 && height + scrollTop >= scrollHeight || event.deltaY < 0 && scrollTop <= 0) {\n        event.preventDefault();\n      }\n    } // Detach key and mouse input events\n\n  }, {\n    key: \"isAnimating\",\n    value: function isAnimating() {\n      return this.state.shouldAnimate || this.state.isClosing;\n    } // Check if image is loaded\n\n  }, {\n    key: \"isImageLoaded\",\n    value: function isImageLoaded(imageSrc) {\n      return imageSrc && imageSrc in this.imageCache && this.imageCache[imageSrc].loaded;\n    } // Load image from src and call callback with image width and height on load\n\n  }, {\n    key: \"loadImage\",\n    value: function loadImage(srcType, imageSrc, done) {\n      var _this12 = this;\n\n      // Return the image info if it is already cached\n      if (this.isImageLoaded(imageSrc)) {\n        this.setTimeout(function () {\n          done();\n        }, 1);\n        return;\n      }\n\n      var inMemoryImage = new global.Image();\n\n      if (this.props.imageCrossOrigin) {\n        inMemoryImage.crossOrigin = this.props.imageCrossOrigin;\n      }\n\n      inMemoryImage.onerror = function (errorEvent) {\n        _this12.props.onImageLoadError(imageSrc, srcType, errorEvent); // failed to load so set the state loadErrorStatus\n\n\n        _this12.setState(function (prevState) {\n          return {\n            loadErrorStatus: _objectSpread2({}, prevState.loadErrorStatus, _defineProperty({}, srcType, true))\n          };\n        });\n\n        done(errorEvent);\n      };\n\n      inMemoryImage.onload = function () {\n        _this12.props.onImageLoad(imageSrc, srcType, inMemoryImage);\n\n        _this12.imageCache[imageSrc] = {\n          loaded: true,\n          width: inMemoryImage.width,\n          height: inMemoryImage.height\n        };\n        done();\n      };\n\n      inMemoryImage.src = imageSrc;\n    } // Load all images and their thumbnails\n\n  }, {\n    key: \"loadAllImages\",\n    value: function loadAllImages() {\n      var _this13 = this;\n\n      var props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.props;\n\n      var generateLoadDoneCallback = function generateLoadDoneCallback(srcType, imageSrc) {\n        return function (err) {\n          // Give up showing image on error\n          if (err) {\n            return;\n          } // Don't rerender if the src is not the same as when the load started\n          // or if the component has unmounted\n\n\n          if (_this13.props[srcType] !== imageSrc || _this13.didUnmount) {\n            return;\n          } // Force rerender with the new image\n\n\n          _this13.forceUpdate();\n        };\n      }; // Load the images\n\n\n      this.getSrcTypes().forEach(function (srcType) {\n        var type = srcType.name; // there is no error when we try to load it initially\n\n        if (props[type] && _this13.state.loadErrorStatus[type]) {\n          _this13.setState(function (prevState) {\n            return {\n              loadErrorStatus: _objectSpread2({}, prevState.loadErrorStatus, _defineProperty({}, type, false))\n            };\n          });\n        } // Load unloaded images\n\n\n        if (props[type] && !_this13.isImageLoaded(props[type])) {\n          _this13.loadImage(type, props[type], generateLoadDoneCallback(type, props[type]));\n        }\n      });\n    } // Request that the lightbox be closed\n\n  }, {\n    key: \"requestClose\",\n    value: function requestClose(event) {\n      var _this14 = this;\n\n      // Call the parent close request\n      var closeLightbox = function closeLightbox() {\n        return _this14.props.onCloseRequest(event);\n      };\n\n      if (this.props.animationDisabled || event.type === 'keydown' && !this.props.animationOnKeyInput) {\n        // No animation\n        closeLightbox();\n        return;\n      } // With animation\n      // Start closing animation\n\n\n      this.setState({\n        isClosing: true\n      }); // Perform the actual closing at the end of the animation\n\n      this.setTimeout(closeLightbox, this.props.animationDuration);\n    }\n  }, {\n    key: \"requestMove\",\n    value: function requestMove(direction, event) {\n      var _this15 = this;\n\n      // Reset the zoom level on image move\n      var nextState = {\n        zoomLevel: MIN_ZOOM_LEVEL,\n        offsetX: 0,\n        offsetY: 0\n      }; // Enable animated states\n\n      if (!this.props.animationDisabled && (!this.keyPressed || this.props.animationOnKeyInput)) {\n        nextState.shouldAnimate = true;\n        this.setTimeout(function () {\n          return _this15.setState({\n            shouldAnimate: false\n          });\n        }, this.props.animationDuration);\n      }\n\n      this.keyPressed = false;\n      this.moveRequested = true;\n\n      if (direction === 'prev') {\n        this.keyCounter -= 1;\n        this.setState(nextState);\n        this.props.onMovePrevRequest(event);\n      } else {\n        this.keyCounter += 1;\n        this.setState(nextState);\n        this.props.onMoveNextRequest(event);\n      }\n    } // Request to transition to the next image\n\n  }, {\n    key: \"requestMoveNext\",\n    value: function requestMoveNext(event) {\n      this.requestMove('next', event);\n    } // Request to transition to the previous image\n\n  }, {\n    key: \"requestMovePrev\",\n    value: function requestMovePrev(event) {\n      this.requestMove('prev', event);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this16 = this;\n\n      var _this$props = this.props,\n          animationDisabled = _this$props.animationDisabled,\n          animationDuration = _this$props.animationDuration,\n          clickOutsideToClose = _this$props.clickOutsideToClose,\n          discourageDownloads = _this$props.discourageDownloads,\n          enableZoom = _this$props.enableZoom,\n          imageTitle = _this$props.imageTitle,\n          nextSrc = _this$props.nextSrc,\n          prevSrc = _this$props.prevSrc,\n          toolbarButtons = _this$props.toolbarButtons,\n          reactModalStyle = _this$props.reactModalStyle,\n          _onAfterOpen = _this$props.onAfterOpen,\n          imageCrossOrigin = _this$props.imageCrossOrigin,\n          reactModalProps = _this$props.reactModalProps;\n      var _this$state = this.state,\n          zoomLevel = _this$state.zoomLevel,\n          offsetX = _this$state.offsetX,\n          offsetY = _this$state.offsetY,\n          isClosing = _this$state.isClosing,\n          loadErrorStatus = _this$state.loadErrorStatus;\n      var boxSize = this.getLightboxRect();\n      var transitionStyle = {}; // Transition settings for sliding animations\n\n      if (!animationDisabled && this.isAnimating()) {\n        transitionStyle = _objectSpread2({}, transitionStyle, {\n          transition: \"transform \".concat(animationDuration, \"ms\")\n        });\n      } // Key endings to differentiate between images with the same src\n\n\n      var keyEndings = {};\n      this.getSrcTypes().forEach(function (_ref13) {\n        var name = _ref13.name,\n            keyEnding = _ref13.keyEnding;\n        keyEndings[name] = keyEnding;\n      }); // Images to be displayed\n\n      var images = [];\n\n      var addImage = function addImage(srcType, imageClass, transforms) {\n        // Ignore types that have no source defined for their full size image\n        if (!_this16.props[srcType]) {\n          return;\n        }\n\n        var bestImageInfo = _this16.getBestImageForType(srcType);\n\n        var imageStyle = _objectSpread2({}, transitionStyle, {}, ReactImageLightbox.getTransform(_objectSpread2({}, transforms, {}, bestImageInfo)));\n\n        if (zoomLevel > MIN_ZOOM_LEVEL) {\n          imageStyle.cursor = 'move';\n        } // support IE 9 and 11\n\n\n        var hasTrueValue = function hasTrueValue(object) {\n          return Object.keys(object).some(function (key) {\n            return object[key];\n          });\n        }; // when error on one of the loads then push custom error stuff\n\n\n        if (bestImageInfo === null && hasTrueValue(loadErrorStatus)) {\n          images.push(React.createElement(\"div\", {\n            className: \"\".concat(imageClass, \" ril__image ril-errored\"),\n            style: imageStyle,\n            key: _this16.props[srcType] + keyEndings[srcType]\n          }, React.createElement(\"div\", {\n            className: \"ril__errorContainer\"\n          }, _this16.props.imageLoadErrorMessage)));\n          return;\n        }\n\n        if (bestImageInfo === null) {\n          var loadingIcon = React.createElement(\"div\", {\n            className: \"ril-loading-circle ril__loadingCircle ril__loadingContainer__icon\"\n          }, _toConsumableArray(new Array(12)).map(function (_, index) {\n            return React.createElement(\"div\", {\n              // eslint-disable-next-line react/no-array-index-key\n              key: index,\n              className: \"ril-loading-circle-point ril__loadingCirclePoint\"\n            });\n          })); // Fall back to loading icon if the thumbnail has not been loaded\n\n          images.push(React.createElement(\"div\", {\n            className: \"\".concat(imageClass, \" ril__image ril-not-loaded\"),\n            style: imageStyle,\n            key: _this16.props[srcType] + keyEndings[srcType]\n          }, React.createElement(\"div\", {\n            className: \"ril__loadingContainer\"\n          }, loadingIcon)));\n          return;\n        }\n\n        var imageSrc = bestImageInfo.src;\n\n        if (discourageDownloads) {\n          imageStyle.backgroundImage = \"url('\".concat(imageSrc, \"')\");\n          images.push(React.createElement(\"div\", {\n            className: \"\".concat(imageClass, \" ril__image ril__imageDiscourager\"),\n            onDoubleClick: _this16.handleImageDoubleClick,\n            onWheel: _this16.handleImageMouseWheel,\n            style: imageStyle,\n            key: imageSrc + keyEndings[srcType]\n          }, React.createElement(\"div\", {\n            className: \"ril-download-blocker ril__downloadBlocker\"\n          })));\n        } else {\n          images.push(React.createElement(\"img\", _extends({}, imageCrossOrigin ? {\n            crossOrigin: imageCrossOrigin\n          } : {}, {\n            className: \"\".concat(imageClass, \" ril__image\"),\n            onDoubleClick: _this16.handleImageDoubleClick,\n            onWheel: _this16.handleImageMouseWheel,\n            onDragStart: function onDragStart(e) {\n              return e.preventDefault();\n            },\n            style: imageStyle,\n            src: imageSrc,\n            key: imageSrc + keyEndings[srcType],\n            alt: typeof imageTitle === 'string' ? imageTitle : translate('Image'),\n            draggable: false\n          })));\n        }\n      };\n\n      var zoomMultiplier = this.getZoomMultiplier(); // Next Image (displayed on the right)\n\n      addImage('nextSrc', 'ril-image-next ril__imageNext', {\n        x: boxSize.width\n      }); // Main Image\n\n      addImage('mainSrc', 'ril-image-current', {\n        x: -1 * offsetX,\n        y: -1 * offsetY,\n        zoom: zoomMultiplier\n      }); // Previous Image (displayed on the left)\n\n      addImage('prevSrc', 'ril-image-prev ril__imagePrev', {\n        x: -1 * boxSize.width\n      });\n      var modalStyle = {\n        overlay: _objectSpread2({\n          zIndex: 1000,\n          backgroundColor: 'transparent'\n        }, reactModalStyle.overlay),\n        content: _objectSpread2({\n          backgroundColor: 'transparent',\n          overflow: 'hidden',\n          // Needed, otherwise keyboard shortcuts scroll the page\n          border: 'none',\n          borderRadius: 0,\n          padding: 0,\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0\n        }, reactModalStyle.content)\n      };\n      return React.createElement(Modal, _extends({\n        isOpen: true,\n        onRequestClose: clickOutsideToClose ? this.requestClose : undefined,\n        onAfterOpen: function onAfterOpen() {\n          // Focus on the div with key handlers\n          if (_this16.outerEl.current) {\n            _this16.outerEl.current.focus();\n          }\n\n          _onAfterOpen();\n        },\n        style: modalStyle,\n        contentLabel: translate('Lightbox'),\n        appElement: typeof global.window !== 'undefined' ? global.window.document.body : undefined\n      }, reactModalProps), React.createElement(\"div\", {\n        // eslint-disable-line jsx-a11y/no-static-element-interactions\n        // Floating modal with closing animations\n        className: \"ril-outer ril__outer ril__outerAnimating \".concat(this.props.wrapperClassName, \" \").concat(isClosing ? 'ril-closing ril__outerClosing' : ''),\n        style: {\n          transition: \"opacity \".concat(animationDuration, \"ms\"),\n          animationDuration: \"\".concat(animationDuration, \"ms\"),\n          animationDirection: isClosing ? 'normal' : 'reverse'\n        },\n        ref: this.outerEl,\n        onWheel: this.handleOuterMousewheel,\n        onMouseMove: this.handleMouseMove,\n        onMouseDown: this.handleMouseDown,\n        onTouchStart: this.handleTouchStart,\n        onTouchMove: this.handleTouchMove,\n        tabIndex: \"-1\" // Enables key handlers on div\n        ,\n        onKeyDown: this.handleKeyInput,\n        onKeyUp: this.handleKeyInput\n      }, React.createElement(\"div\", {\n        // eslint-disable-line jsx-a11y/no-static-element-interactions, jsx-a11y/click-events-have-key-events\n        // Image holder\n        className: \"ril-inner ril__inner\",\n        onClick: clickOutsideToClose ? this.closeIfClickInner : undefined\n      }, images), prevSrc && React.createElement(\"button\", {\n        // Move to previous image button\n        type: \"button\",\n        className: \"ril-prev-button ril__navButtons ril__navButtonPrev\",\n        key: \"prev\",\n        \"aria-label\": this.props.prevLabel,\n        onClick: !this.isAnimating() ? this.requestMovePrev : undefined // Ignore clicks during animation\n\n      }), nextSrc && React.createElement(\"button\", {\n        // Move to next image button\n        type: \"button\",\n        className: \"ril-next-button ril__navButtons ril__navButtonNext\",\n        key: \"next\",\n        \"aria-label\": this.props.nextLabel,\n        onClick: !this.isAnimating() ? this.requestMoveNext : undefined // Ignore clicks during animation\n\n      }), React.createElement(\"div\", {\n        // Lightbox toolbar\n        className: \"ril-toolbar ril__toolbar\"\n      }, React.createElement(\"ul\", {\n        className: \"ril-toolbar-left ril__toolbarSide ril__toolbarLeftSide\"\n      }, React.createElement(\"li\", {\n        className: \"ril-toolbar__item ril__toolbarItem\"\n      }, React.createElement(\"span\", {\n        className: \"ril-toolbar__item__child ril__toolbarItemChild\"\n      }, imageTitle))), React.createElement(\"ul\", {\n        className: \"ril-toolbar-right ril__toolbarSide ril__toolbarRightSide\"\n      }, toolbarButtons && toolbarButtons.map(function (button, i) {\n        return React.createElement(\"li\", {\n          key: \"button_\".concat(i + 1),\n          className: \"ril-toolbar__item ril__toolbarItem\"\n        }, button);\n      }), enableZoom && React.createElement(\"li\", {\n        className: \"ril-toolbar__item ril__toolbarItem\"\n      }, React.createElement(\"button\", {\n        // Lightbox zoom in button\n        type: \"button\",\n        key: \"zoom-in\",\n        \"aria-label\": this.props.zoomInLabel,\n        className: ['ril-zoom-in', 'ril__toolbarItemChild', 'ril__builtinButton', 'ril__zoomInButton'].concat(_toConsumableArray(zoomLevel === MAX_ZOOM_LEVEL ? ['ril__builtinButtonDisabled'] : [])).join(' '),\n        ref: this.zoomInBtn,\n        disabled: this.isAnimating() || zoomLevel === MAX_ZOOM_LEVEL,\n        onClick: !this.isAnimating() && zoomLevel !== MAX_ZOOM_LEVEL ? this.handleZoomInButtonClick : undefined\n      })), enableZoom && React.createElement(\"li\", {\n        className: \"ril-toolbar__item ril__toolbarItem\"\n      }, React.createElement(\"button\", {\n        // Lightbox zoom out button\n        type: \"button\",\n        key: \"zoom-out\",\n        \"aria-label\": this.props.zoomOutLabel,\n        className: ['ril-zoom-out', 'ril__toolbarItemChild', 'ril__builtinButton', 'ril__zoomOutButton'].concat(_toConsumableArray(zoomLevel === MIN_ZOOM_LEVEL ? ['ril__builtinButtonDisabled'] : [])).join(' '),\n        ref: this.zoomOutBtn,\n        disabled: this.isAnimating() || zoomLevel === MIN_ZOOM_LEVEL,\n        onClick: !this.isAnimating() && zoomLevel !== MIN_ZOOM_LEVEL ? this.handleZoomOutButtonClick : undefined\n      })), React.createElement(\"li\", {\n        className: \"ril-toolbar__item ril__toolbarItem\"\n      }, React.createElement(\"button\", {\n        // Lightbox close button\n        type: \"button\",\n        key: \"close\",\n        \"aria-label\": this.props.closeLabel,\n        className: \"ril-close ril-toolbar__item__child ril__toolbarItemChild ril__builtinButton ril__closeButton\",\n        onClick: !this.isAnimating() ? this.requestClose : undefined // Ignore clicks during animation\n\n      })))), this.props.imageCaption && // eslint-disable-next-line jsx-a11y/no-static-element-interactions\n      React.createElement(\"div\", {\n        // Image caption\n        onWheel: this.handleCaptionMousewheel,\n        onMouseDown: function onMouseDown(event) {\n          return event.stopPropagation();\n        },\n        className: \"ril-caption ril__caption\",\n        ref: this.caption\n      }, React.createElement(\"div\", {\n        className: \"ril-caption-content ril__captionContent\"\n      }, this.props.imageCaption))));\n    }\n  }]);\n\n  return ReactImageLightbox;\n}(Component);\n\nReactImageLightbox.propTypes = {\n  //-----------------------------\n  // Image sources\n  //-----------------------------\n  // Main display image url\n  mainSrc: PropTypes.string.isRequired,\n  // eslint-disable-line react/no-unused-prop-types\n  // Previous display image url (displayed to the left)\n  // If left undefined, movePrev actions will not be performed, and the button not displayed\n  prevSrc: PropTypes.string,\n  // Next display image url (displayed to the right)\n  // If left undefined, moveNext actions will not be performed, and the button not displayed\n  nextSrc: PropTypes.string,\n  //-----------------------------\n  // Image thumbnail sources\n  //-----------------------------\n  // Thumbnail image url corresponding to props.mainSrc\n  mainSrcThumbnail: PropTypes.string,\n  // eslint-disable-line react/no-unused-prop-types\n  // Thumbnail image url corresponding to props.prevSrc\n  prevSrcThumbnail: PropTypes.string,\n  // eslint-disable-line react/no-unused-prop-types\n  // Thumbnail image url corresponding to props.nextSrc\n  nextSrcThumbnail: PropTypes.string,\n  // eslint-disable-line react/no-unused-prop-types\n  //-----------------------------\n  // Event Handlers\n  //-----------------------------\n  // Close window event\n  // Should change the parent state such that the lightbox is not rendered\n  onCloseRequest: PropTypes.func.isRequired,\n  // Move to previous image event\n  // Should change the parent state such that props.prevSrc becomes props.mainSrc,\n  //  props.mainSrc becomes props.nextSrc, etc.\n  onMovePrevRequest: PropTypes.func,\n  // Move to next image event\n  // Should change the parent state such that props.nextSrc becomes props.mainSrc,\n  //  props.mainSrc becomes props.prevSrc, etc.\n  onMoveNextRequest: PropTypes.func,\n  // Called when an image fails to load\n  // (imageSrc: string, srcType: string, errorEvent: object): void\n  onImageLoadError: PropTypes.func,\n  // Called when image successfully loads\n  onImageLoad: PropTypes.func,\n  // Open window event\n  onAfterOpen: PropTypes.func,\n  //-----------------------------\n  // Download discouragement settings\n  //-----------------------------\n  // Enable download discouragement (prevents [right-click -> Save Image As...])\n  discourageDownloads: PropTypes.bool,\n  //-----------------------------\n  // Animation settings\n  //-----------------------------\n  // Disable all animation\n  animationDisabled: PropTypes.bool,\n  // Disable animation on actions performed with keyboard shortcuts\n  animationOnKeyInput: PropTypes.bool,\n  // Animation duration (ms)\n  animationDuration: PropTypes.number,\n  //-----------------------------\n  // Keyboard shortcut settings\n  //-----------------------------\n  // Required interval of time (ms) between key actions\n  // (prevents excessively fast navigation of images)\n  keyRepeatLimit: PropTypes.number,\n  // Amount of time (ms) restored after each keyup\n  // (makes rapid key presses slightly faster than holding down the key to navigate images)\n  keyRepeatKeyupBonus: PropTypes.number,\n  //-----------------------------\n  // Image info\n  //-----------------------------\n  // Image title\n  imageTitle: PropTypes.node,\n  // Image caption\n  imageCaption: PropTypes.node,\n  // Optional crossOrigin attribute\n  imageCrossOrigin: PropTypes.string,\n  //-----------------------------\n  // Lightbox style\n  //-----------------------------\n  // Set z-index style, etc., for the parent react-modal (format: https://github.com/reactjs/react-modal#styles )\n  reactModalStyle: PropTypes.object,\n  // Padding (px) between the edge of the window and the lightbox\n  imagePadding: PropTypes.number,\n  wrapperClassName: PropTypes.string,\n  //-----------------------------\n  // Other\n  //-----------------------------\n  // Array of custom toolbar buttons\n  toolbarButtons: PropTypes.arrayOf(PropTypes.node),\n  // When true, clicks outside of the image close the lightbox\n  clickOutsideToClose: PropTypes.bool,\n  // Set to false to disable zoom functionality and hide zoom buttons\n  enableZoom: PropTypes.bool,\n  // Override props set on react-modal (https://github.com/reactjs/react-modal)\n  reactModalProps: PropTypes.shape({}),\n  // Aria-labels\n  nextLabel: PropTypes.string,\n  prevLabel: PropTypes.string,\n  zoomInLabel: PropTypes.string,\n  zoomOutLabel: PropTypes.string,\n  closeLabel: PropTypes.string,\n  imageLoadErrorMessage: PropTypes.node\n};\nReactImageLightbox.defaultProps = {\n  imageTitle: null,\n  imageCaption: null,\n  toolbarButtons: null,\n  reactModalProps: {},\n  animationDisabled: false,\n  animationDuration: 300,\n  animationOnKeyInput: false,\n  clickOutsideToClose: true,\n  closeLabel: 'Close lightbox',\n  discourageDownloads: false,\n  enableZoom: true,\n  imagePadding: 10,\n  imageCrossOrigin: null,\n  keyRepeatKeyupBonus: 40,\n  keyRepeatLimit: 180,\n  mainSrcThumbnail: null,\n  nextLabel: 'Next image',\n  nextSrc: null,\n  nextSrcThumbnail: null,\n  onAfterOpen: function onAfterOpen() {},\n  onImageLoadError: function onImageLoadError() {},\n  onImageLoad: function onImageLoad() {},\n  onMoveNextRequest: function onMoveNextRequest() {},\n  onMovePrevRequest: function onMovePrevRequest() {},\n  prevLabel: 'Previous image',\n  prevSrc: null,\n  prevSrcThumbnail: null,\n  reactModalStyle: {},\n  wrapperClassName: '',\n  zoomInLabel: 'Zoom in',\n  zoomOutLabel: 'Zoom out',\n  imageLoadErrorMessage: 'This image failed to load'\n};\n\nexport default ReactImageLightbox;\n","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _Modal = require(\"./components/Modal\");\n\nvar _Modal2 = _interopRequireDefault(_Modal);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = _Modal2.default;\nmodule.exports = exports[\"default\"];","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { permission } from '../../utils/constants';\nimport TextTranslation from '../../utils/text-translation';\nimport ItemDropdownMenu from '../dropdown-menu/item-dropdown-menu';\n\nconst propTypes = {\n  repoPermission: PropTypes.bool,\n  node: PropTypes.object.isRequired,\n  currentPath: PropTypes.string.isRequired,\n  paddingLeft: PropTypes.number.isRequired,\n  isNodeMenuShow: PropTypes.bool.isRequired,\n  isItemFreezed: PropTypes.bool.isRequired,\n  onNodeClick: PropTypes.func.isRequired,\n  onNodeExpanded: PropTypes.func.isRequired,\n  onNodeCollapse: PropTypes.func.isRequired,\n  onNodeDragStart: PropTypes.func.isRequired,\n  freezeItem: PropTypes.func.isRequired,\n  unfreezeItem: PropTypes.func.isRequired,\n  onMenuItemClick: PropTypes.func,\n  onNodeDragMove: PropTypes.func,\n  onNodeDrop: PropTypes.func,\n  handleContextClick: PropTypes.func.isRequired,\n  onNodeDragEnter: PropTypes.func.isRequired,\n  onNodeDragLeave:PropTypes.func.isRequired,\n};\n\nclass TreeNodeView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isHighlight: false,\n      isShowOperationMenu: false,\n      isNodeDropShow: false,\n    };\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (!nextProps.isItemFreezed) {\n      this.setState({\n        isShowOperationMenu: false,\n        isHighlight: false,\n      });\n    }\n  }\n\n  onMouseEnter = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        isShowOperationMenu: true,\n        isHighlight: true,\n      });\n    }\n  }\n\n  onMouseOver = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        isShowOperationMenu: true,\n        isHighlight: true,\n      });\n    }\n  }\n\n  onMouseLeave = () => {\n    if (!this.props.isItemFreezed) {\n      this.setState({\n        isShowOperationMenu: false,\n        isHighlight: false,\n      });\n    }\n  }\n\n  onNodeClick = () => {\n    this.props.onNodeClick(this.props.node);\n  }\n\n  onLoadToggle = (e) => {\n    e.stopPropagation();\n    let { node } = this.props;\n    if (node.isExpanded) {\n      this.props.onNodeCollapse(node);\n    } else {\n      this.props.onNodeExpanded(node);\n    }\n  }\n\n  onNodeDragStart = (e) => {\n    this.props.onNodeDragStart(e, this.props.node);\n  }\n\n  onNodeDragEnter = (e) => {\n    if (this.props.node.object.type === 'dir') {\n      this.setState({isNodeDropShow: true});\n    }\n    this.props.onNodeDragEnter(e, this.props.node);\n  }\n\n  onNodeDragMove = (e) => {\n    this.props.onNodeDragMove(e);\n  }\n\n  onNodeDragLeave = (e) => {\n    this.setState({isNodeDropShow: false});\n    this.props.onNodeDragLeave(e, this.props.node);\n  }\n\n  onNodeDrop = (e) => {\n    e.stopPropagation();\n    this.setState({isNodeDropShow: false});\n    this.props.onNodeDrop(e, this.props.node);\n  }\n\n  unfreezeItem = () => {\n    this.setState({isShowOperationMenu: false});\n    this.props.unfreezeItem();\n  }\n\n  onMenuItemClick = (operation, event, node) => {\n    this.props.onMenuItemClick(operation, node);\n  }\n\n  onItemMouseDown = (event) => {\n    event.stopPropagation();\n    if (event.button === 2) {\n      return;\n    }\n  }\n\n  onItemContextMenu = (event) => {\n    this.handleContextClick(event);\n  }\n\n  handleContextClick = (event) => {\n    this.props.handleContextClick(event, this.props.node);\n    this.setState({isShowOperationMenu: false});\n  }\n\n  getNodeTypeAndIcon = () => {\n    let { node } = this.props;\n    let icon = '';\n    let type = '';\n    if (node.object.type === 'dir') {\n      icon = <i className=\"far fa-folder\"></i>;\n      type = 'dir';\n    } else {\n      let index = node.object.name.lastIndexOf('.');\n      if (index === -1) {\n        icon = <i className=\"far fa-file\"></i>;\n        type = 'file';\n      } else {\n        let suffix = node.object.name.slice(index).toLowerCase();\n        if (suffix === '.png' || suffix === '.jpg' || suffix === '.jpeg' || suffix === '.gif' || suffix === '.bmp') {\n          icon = <i className=\"far fa-image\"></i>;\n          type = 'image';\n        }\n        else if (suffix === '.md' || suffix === '.markdown') {\n          icon = <i className=\"far fa-file-alt\"></i>;\n          type = 'file';\n        }\n        else {\n          icon = <i className=\"far fa-file\"></i>;\n          type = 'file';\n        }\n      }\n    }\n    return {icon, type};\n  }\n\n  caculateMenuList(node) {\n    let { NEW_FOLDER, NEW_FILE, COPY, MOVE, RENAME, DELETE, OPEN_VIA_CLIENT} =  TextTranslation;\n\n    if (node.object.type === 'dir') {\n      return [NEW_FOLDER, NEW_FILE, COPY, MOVE, RENAME, DELETE];\n    }\n\n    return [RENAME, DELETE, COPY, MOVE, OPEN_VIA_CLIENT];\n  }\n\n  renderChildren = () => {\n    let { node, paddingLeft } = this.props;\n    if (!node.hasChildren()) {\n      return '';\n    }\n    return (\n      <div className=\"children\" style={{paddingLeft: paddingLeft}}>\n        {node.children.map(item => {\n          return (\n            <TreeNodeView\n              key={item.path}\n              node={item}\n              paddingLeft={paddingLeft}\n              repoPermission={this.props.repoPermission}\n              currentPath={this.props.currentPath}\n              isNodeMenuShow={this.props.isNodeMenuShow}\n              isItemFreezed={this.props.isItemFreezed}\n              onNodeClick={this.props.onNodeClick}\n              onNodeCollapse={this.props.onNodeCollapse}\n              onNodeExpanded={this.props.onNodeExpanded}\n              freezeItem={this.props.freezeItem}\n              onMenuItemClick={this.props.onMenuItemClick}\n              unfreezeItem={this.unfreezeItem}\n              onNodeDragStart={this.props.onNodeDragStart}\n              onNodeDragMove={this.props.onNodeDragMove}\n              onNodeDrop={this.props.onNodeDrop}\n              onNodeDragEnter={this.props.onNodeDragEnter}\n              onNodeDragLeave={this.props.onNodeDragLeave}\n              handleContextClick={this.props.handleContextClick}\n            />\n          );\n        })}\n      </div>\n    );\n  }\n\n  render() {\n    let { currentPath, node, isNodeMenuShow } = this.props;\n    let { type, icon } = this.getNodeTypeAndIcon();\n    let hlClass = this.state.isHighlight ? 'tree-node-inner-hover ' : '';\n    if (node.path === currentPath) {\n      hlClass = 'tree-node-hight-light';\n    }\n    return (\n      <div className=\"tree-node\">\n        <div\n          type={type}\n          className={`tree-node-inner text-nowrap ${hlClass} ${node.path === '/'? 'hide': ''} ${this.state.isNodeDropShow ? 'tree-node-drop' : ''}`}\n          title={node.object.name}\n          onMouseEnter={this.onMouseEnter}\n          onMouseOver={this.onMouseOver}\n          onMouseLeave={this.onMouseLeave}\n          onMouseDown={this.onItemMouseDown}\n          onContextMenu={this.onItemContextMenu}\n          onClick={this.onNodeClick}\n        >\n          <div className=\"tree-node-text\" draggable=\"true\" onDragStart={this.onNodeDragStart} onDragEnter={this.onNodeDragEnter} onDragLeave={this.onNodeDragLeave} onDragOver={this.onNodeDragMove} onDrop={this.onNodeDrop}>{node.object.name}</div>\n          <div className=\"left-icon\">\n            {type === 'dir' && (!node.isLoaded ||  (node.isLoaded && node.hasChildren())) && (\n              <i\n                className={`folder-toggle-icon fa ${node.isExpanded ? 'fa-caret-down' : 'fa-caret-right'}`}\n                onMouseDown={e => e.stopPropagation()}\n                onClick={this.onLoadToggle}\n              ></i>\n            )}\n            <i className=\"tree-node-icon\">{icon}</i>\n          </div>\n          {isNodeMenuShow && (\n            <div className=\"right-icon\">\n              {((this.props.repoPermission || permission) && this.state.isShowOperationMenu) && (\n                <ItemDropdownMenu\n                  item={this.props.node}\n                  toggleClass={'fas fa-ellipsis-v'}\n                  getMenuList={this.caculateMenuList}\n                  onMenuItemClick={this.onMenuItemClick}\n                  freezeItem={this.props.freezeItem}\n                  unfreezeItem={this.unfreezeItem}\n                />\n              )}\n            </div>\n          )}\n        </div>\n        {node.isExpanded && this.renderChildren()}\n      </div>\n    );\n  }\n}\n\nTreeNodeView.propTypes = propTypes;\n\nexport default TreeNodeView;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport TextTranslation from '../../utils/text-translation';\nimport TreeNodeView from './tree-node-view';\nimport ContextMenu from '../context-menu/context-menu';\nimport { hideMenu, showMenu } from '../context-menu/actions';\nimport { Utils } from '../../utils/utils';\n\nconst propTypes = {\n  repoPermission: PropTypes.bool,\n  isNodeMenuShow: PropTypes.bool.isRequired,\n  treeData: PropTypes.object.isRequired,\n  currentPath: PropTypes.string.isRequired,\n  onMenuItemClick: PropTypes.func,\n  onNodeClick: PropTypes.func.isRequired,\n  onNodeExpanded: PropTypes.func.isRequired,\n  onNodeCollapse: PropTypes.func.isRequired,\n  onItemMove: PropTypes.func,\n  currentRepoInfo: PropTypes.object,\n  selectedDirentList: PropTypes.array,\n  onItemsMove: PropTypes.func,\n};\n\nconst PADDING_LEFT = 20;\n\nclass TreeView extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isItemFreezed: false,\n      isTreeViewDropTipShow: false,\n    };\n  }\n\n  onItemMove = (repo, dirent, selectedPath, currentPath) => {\n    this.props.onItemMove(repo, dirent, selectedPath, currentPath);\n  }\n\n  onNodeDragStart = (e, node) => {\n    if (Utils.isIEBrower()) {\n      return false;\n    }\n    let dragStartNodeData = {nodeDirent: node.object, nodeParentPath: node.parentNode.path, nodeRootPath: node.path};\n    dragStartNodeData = JSON.stringify(dragStartNodeData);\n\n    e.dataTransfer.effectAllowed = 'move';\n    e.dataTransfer.setData('applicaiton/drag-item-info', dragStartNodeData);\n  }\n\n  onNodeDragEnter = (e, node) => {\n    if (Utils.isIEBrower()) {\n      return false;\n    }\n    e.persist();\n    if (e.target.className === 'tree-view tree ') {\n      this.setState({\n        isTreeViewDropTipShow: true,\n      });\n    }\n  }\n\n  onNodeDragMove = (e) => {\n    if (Utils.isIEBrower()) {\n      return false;\n    }\n    e.preventDefault();\n    e.dataTransfer.dropEffect = 'move';\n  }\n\n  onNodeDragLeave = (e, node) => {\n    if (Utils.isIEBrower()) {\n      return false;\n    }\n    if (e.target.className === 'tree-view tree tree-view-drop') {\n      this.setState({\n        isTreeViewDropTipShow: false,\n      });\n    }\n  }\n\n  onNodeDrop = (e, node) => {\n    if (Utils.isIEBrower()) {\n      return false;\n    }\n    if (e.dataTransfer.files.length) { // uploaded files\n      return;\n    }\n    let dragStartNodeData = e.dataTransfer.getData('applicaiton/drag-item-info');\n    dragStartNodeData = JSON.parse(dragStartNodeData);\n\n    let {nodeDirent, nodeParentPath, nodeRootPath} = dragStartNodeData;\n    let dropNodeData = node;\n\n    if (Array.isArray(dragStartNodeData)) { //move items\n      if (!dropNodeData) { //move items to root\n        if (dragStartNodeData[0].nodeParentPath === '/') {\n          this.setState({isTreeViewDropTipShow: false});\n          return;\n        }\n        this.props.onItemsMove(this.props.currentRepoInfo, '/');\n        this.setState({isTreeViewDropTipShow: false});\n        return;\n      }\n      this.onMoveItems(dragStartNodeData, dropNodeData, this.props.currentRepoInfo, dropNodeData.path);\n      return;\n    }\n\n    if (!dropNodeData) {\n      if (nodeParentPath === '/') {\n        this.setState({isTreeViewDropTipShow: false});\n        return;\n      }\n      this.onItemMove(this.props.currentRepoInfo, nodeDirent, '/', nodeParentPath);\n      this.setState({isTreeViewDropTipShow: false});\n      return;\n    }\n\n    if (dropNodeData.object.type !== 'dir') {\n      return;\n    }\n\n    if (nodeParentPath === dropNodeData.path) {\n      return;\n    }\n\n    // copy the dirent to itself. eg: A/B -> A/B\n    if (nodeParentPath === dropNodeData.parentNode.path) {\n      if (dropNodeData.object.name === nodeDirent.name) {\n        return;\n      }\n    }\n\n    // copy the dirent to it's child. eg: A/B -> A/B/C\n    if (dropNodeData.object.type === 'dir' && nodeDirent.type === 'dir') {\n      if (dropNodeData.parentNode.path !== nodeParentPath) {\n        let paths = Utils.getPaths(dropNodeData.path);\n        if (paths.includes(nodeRootPath)) {\n          return;\n        }\n      }\n    }\n\n    this.onItemMove(this.props.currentRepoInfo, nodeDirent, dropNodeData.path, nodeParentPath);\n  }\n\n  onMoveItems = (dragStartNodeData, dropNodeData, destRepo, destDirentPath) => {\n    let direntPaths = [];\n    let paths = Utils.getPaths(destDirentPath);\n    dragStartNodeData.forEach(dirent => {\n      let path = dirent.nodeRootPath;\n      direntPaths.push(path);\n    });\n\n    if (dropNodeData.object.type !== 'dir') {\n      return;\n    }\n\n    // move dirents to one of them. eg: A/B, A/C -> A/B\n    if (direntPaths.some(direntPath => { return direntPath === destDirentPath;})) {\n      return;\n    }\n\n    // move dirents to current path\n    if (dragStartNodeData[0].nodeParentPath && dragStartNodeData[0].nodeParentPath === dropNodeData.path ) {\n      return;\n    }\n\n    // move dirents to one of their child. eg: A/B, A/D -> A/B/C\n    let isChildPath = direntPaths.some(direntPath => {\n      return paths.includes(direntPath);\n    });\n    if (isChildPath) {\n      return;\n    }\n\n    this.props.onItemsMove(destRepo, destDirentPath);\n  }\n\n  freezeItem = () => {\n    this.setState({isItemFreezed: true});\n  }\n\n  unfreezeItem = () => {\n    this.setState({isItemFreezed: false});\n  }\n\n  onMenuItemClick = (operation, node) => {\n    this.props.onMenuItemClick(operation, node);\n    hideMenu();\n  }\n\n  onMouseDown = (event) => {\n    event.stopPropagation();\n    if (event.button === 2) {\n      return;\n    }\n  }\n\n  onContextMenu = (event) => {\n    event.preventDefault();\n\n    let currentRepoInfo = this.props.currentRepoInfo;\n    if (currentRepoInfo.permission !== 'admin' && currentRepoInfo.permission !== 'rw') {\n      return '';\n    }\n    this.handleContextClick(event);\n  }\n\n  handleContextClick = (event, node) => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    if (!this.props.isNodeMenuShow) {\n      return;\n    }\n\n    let x = event.clientX || (event.touches && event.touches[0].pageX);\n    let y = event.clientY || (event.touches && event.touches[0].pageY);\n\n    if (this.props.posX) {\n      x -= this.props.posX;\n    }\n    if (this.props.posY) {\n      y -= this.props.posY;\n    }\n\n    hideMenu();\n\n    let menuList = this.getMenuList(node);\n\n    let showMenuConfig = {\n      id: 'tree-node-contextmenu',\n      position: { x, y },\n      target: event.target,\n      currentObject: node,\n      menuList: menuList,\n    };\n\n    showMenu(showMenuConfig);\n  }\n\n  getMenuList = (node) => {\n    let menuList = [];\n\n    let { NEW_FOLDER, NEW_FILE, COPY, MOVE, RENAME, DELETE, OPEN_VIA_CLIENT } = TextTranslation;\n\n    if (!node) {\n      return [NEW_FOLDER, NEW_FILE];\n    }\n\n    if (node.object.type === 'dir') {\n      menuList = [NEW_FOLDER, NEW_FILE, COPY, MOVE, RENAME, DELETE];\n    } else {\n      menuList = [RENAME, DELETE, COPY, MOVE, OPEN_VIA_CLIENT];\n    }\n\n    return menuList;\n  }\n\n  onShowMenu = () => {\n    this.freezeItem();\n  }\n\n  onHideMenu = () => {\n    this.unfreezeItem();\n  }\n\n  render() {\n    return (\n      <div\n        className={`tree-view tree ${this.state.isTreeViewDropTipShow ? 'tree-view-drop' : ''}`}\n        onDrop={this.onNodeDrop}\n        onDragEnter={this.onNodeDragEnter}\n        onDragLeave={this.onNodeDragLeave}\n        onMouseDown={this.onMouseDown}\n        onContextMenu={this.onContextMenu}\n      >\n        <TreeNodeView\n          repoPermission={this.props.repoPermission}\n          node={this.props.treeData.root}\n          currentPath={this.props.currentPath}\n          paddingLeft={PADDING_LEFT}\n          isNodeMenuShow={this.props.isNodeMenuShow}\n          isItemFreezed={this.state.isItemFreezed}\n          onNodeClick={this.props.onNodeClick}\n          onMenuItemClick={this.props.onMenuItemClick}\n          onNodeExpanded={this.props.onNodeExpanded}\n          onNodeCollapse={this.props.onNodeCollapse}\n          onNodeDragStart={this.onNodeDragStart}\n          freezeItem={this.freezeItem}\n          unfreezeItem={this.unfreezeItem}\n          onNodeDragMove={this.onNodeDragMove}\n          onNodeDrop={this.onNodeDrop}\n          onNodeDragEnter={this.onNodeDragEnter}\n          onNodeDragLeave={this.onNodeDragLeave}\n          handleContextClick={this.handleContextClick}\n        />\n        <ContextMenu\n          id={'tree-node-contextmenu'}\n          onMenuItemClick={this.onMenuItemClick}\n          onHideMenu={this.onHideMenu}\n          onShowMenu={this.onShowMenu}\n        />\n      </div>\n    );\n  }\n}\n\nTreeView.propTypes = propTypes;\n\nexport default TreeView;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { mediaUrl } from '../utils/constants';\n\nconst propTypes = {\n  forDialog: PropTypes.bool\n};\n\nclass EmptyTip extends React.Component {\n\n  render() {\n    return (\n      <div className={this.props.forDialog ? 'text-center mt-8' : 'empty-tip'}>\n        <img src={`${mediaUrl}img/no-items-tip.png`} alt=\"\" width=\"100\" height=\"100\" className=\"no-items-img-tip\" />\n        {this.props.children}\n      </div>\n    );\n  }\n}\n\nEmptyTip.propTypes = propTypes;\n\nexport default EmptyTip;\n","\n/**\n * Module dependencies.\n */\n\nvar parseuri = require('parseuri');\nvar debug = require('debug')('socket.io-client:url');\n\n/**\n * Module exports.\n */\n\nmodule.exports = url;\n\n/**\n * URL parser.\n *\n * @param {String} url\n * @param {Object} An object meant to mimic window.location.\n *                 Defaults to window.location.\n * @api public\n */\n\nfunction url (uri, loc) {\n  var obj = uri;\n\n  // default to window.location\n  loc = loc || (typeof location !== 'undefined' && location);\n  if (null == uri) uri = loc.protocol + '//' + loc.host;\n\n  // relative path support\n  if ('string' === typeof uri) {\n    if ('/' === uri.charAt(0)) {\n      if ('/' === uri.charAt(1)) {\n        uri = loc.protocol + uri;\n      } else {\n        uri = loc.host + uri;\n      }\n    }\n\n    if (!/^(https?|wss?):\\/\\//.test(uri)) {\n      debug('protocol-less url %s', uri);\n      if ('undefined' !== typeof loc) {\n        uri = loc.protocol + '//' + uri;\n      } else {\n        uri = 'https://' + uri;\n      }\n    }\n\n    // parse\n    debug('parse %s', uri);\n    obj = parseuri(uri);\n  }\n\n  // make sure we treat `localhost:80` and `localhost` equally\n  if (!obj.port) {\n    if (/^(http|ws)$/.test(obj.protocol)) {\n      obj.port = '80';\n    } else if (/^(http|ws)s$/.test(obj.protocol)) {\n      obj.port = '443';\n    }\n  }\n\n  obj.path = obj.path || '/';\n\n  var ipv6 = obj.host.indexOf(':') !== -1;\n  var host = ipv6 ? '[' + obj.host + ']' : obj.host;\n\n  // define unique id\n  obj.id = obj.protocol + '://' + host + ':' + obj.port;\n  // define href\n  obj.href = obj.protocol + '://' + host + (loc && loc.port === obj.port ? '' : (':' + obj.port));\n\n  return obj;\n}\n","\n/**\n * This is the common logic for both the Node.js and web browser\n * implementations of `debug()`.\n *\n * Expose `debug()` as the module.\n */\n\nexports = module.exports = createDebug.debug = createDebug['default'] = createDebug;\nexports.coerce = coerce;\nexports.disable = disable;\nexports.enable = enable;\nexports.enabled = enabled;\nexports.humanize = require('ms');\n\n/**\n * Active `debug` instances.\n */\nexports.instances = [];\n\n/**\n * The currently active debug mode names, and names to skip.\n */\n\nexports.names = [];\nexports.skips = [];\n\n/**\n * Map of special \"%n\" handling functions, for the debug \"format\" argument.\n *\n * Valid key names are a single, lower or upper-case letter, i.e. \"n\" and \"N\".\n */\n\nexports.formatters = {};\n\n/**\n * Select a color.\n * @param {String} namespace\n * @return {Number}\n * @api private\n */\n\nfunction selectColor(namespace) {\n  var hash = 0, i;\n\n  for (i in namespace) {\n    hash  = ((hash << 5) - hash) + namespace.charCodeAt(i);\n    hash |= 0; // Convert to 32bit integer\n  }\n\n  return exports.colors[Math.abs(hash) % exports.colors.length];\n}\n\n/**\n * Create a debugger with the given `namespace`.\n *\n * @param {String} namespace\n * @return {Function}\n * @api public\n */\n\nfunction createDebug(namespace) {\n\n  var prevTime;\n\n  function debug() {\n    // disabled?\n    if (!debug.enabled) return;\n\n    var self = debug;\n\n    // set `diff` timestamp\n    var curr = +new Date();\n    var ms = curr - (prevTime || curr);\n    self.diff = ms;\n    self.prev = prevTime;\n    self.curr = curr;\n    prevTime = curr;\n\n    // turn the `arguments` into a proper Array\n    var args = new Array(arguments.length);\n    for (var i = 0; i < args.length; i++) {\n      args[i] = arguments[i];\n    }\n\n    args[0] = exports.coerce(args[0]);\n\n    if ('string' !== typeof args[0]) {\n      // anything else let's inspect with %O\n      args.unshift('%O');\n    }\n\n    // apply any `formatters` transformations\n    var index = 0;\n    args[0] = args[0].replace(/%([a-zA-Z%])/g, function(match, format) {\n      // if we encounter an escaped % then don't increase the array index\n      if (match === '%%') return match;\n      index++;\n      var formatter = exports.formatters[format];\n      if ('function' === typeof formatter) {\n        var val = args[index];\n        match = formatter.call(self, val);\n\n        // now we need to remove `args[index]` since it's inlined in the `format`\n        args.splice(index, 1);\n        index--;\n      }\n      return match;\n    });\n\n    // apply env-specific formatting (colors, etc.)\n    exports.formatArgs.call(self, args);\n\n    var logFn = debug.log || exports.log || console.log.bind(console);\n    logFn.apply(self, args);\n  }\n\n  debug.namespace = namespace;\n  debug.enabled = exports.enabled(namespace);\n  debug.useColors = exports.useColors();\n  debug.color = selectColor(namespace);\n  debug.destroy = destroy;\n\n  // env-specific initialization logic for debug instances\n  if ('function' === typeof exports.init) {\n    exports.init(debug);\n  }\n\n  exports.instances.push(debug);\n\n  return debug;\n}\n\nfunction destroy () {\n  var index = exports.instances.indexOf(this);\n  if (index !== -1) {\n    exports.instances.splice(index, 1);\n    return true;\n  } else {\n    return false;\n  }\n}\n\n/**\n * Enables a debug mode by namespaces. This can include modes\n * separated by a colon and wildcards.\n *\n * @param {String} namespaces\n * @api public\n */\n\nfunction enable(namespaces) {\n  exports.save(namespaces);\n\n  exports.names = [];\n  exports.skips = [];\n\n  var i;\n  var split = (typeof namespaces === 'string' ? namespaces : '').split(/[\\s,]+/);\n  var len = split.length;\n\n  for (i = 0; i < len; i++) {\n    if (!split[i]) continue; // ignore empty strings\n    namespaces = split[i].replace(/\\*/g, '.*?');\n    if (namespaces[0] === '-') {\n      exports.skips.push(new RegExp('^' + namespaces.substr(1) + '$'));\n    } else {\n      exports.names.push(new RegExp('^' + namespaces + '$'));\n    }\n  }\n\n  for (i = 0; i < exports.instances.length; i++) {\n    var instance = exports.instances[i];\n    instance.enabled = exports.enabled(instance.namespace);\n  }\n}\n\n/**\n * Disable debug output.\n *\n * @api public\n */\n\nfunction disable() {\n  exports.enable('');\n}\n\n/**\n * Returns true if the given mode name is enabled, false otherwise.\n *\n * @param {String} name\n * @return {Boolean}\n * @api public\n */\n\nfunction enabled(name) {\n  if (name[name.length - 1] === '*') {\n    return true;\n  }\n  var i, len;\n  for (i = 0, len = exports.skips.length; i < len; i++) {\n    if (exports.skips[i].test(name)) {\n      return false;\n    }\n  }\n  for (i = 0, len = exports.names.length; i < len; i++) {\n    if (exports.names[i].test(name)) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * Coerce `val`.\n *\n * @param {Mixed} val\n * @return {Mixed}\n * @api private\n */\n\nfunction coerce(val) {\n  if (val instanceof Error) return val.stack || val.message;\n  return val;\n}\n","/**\n * This is the web browser implementation of `debug()`.\n *\n * Expose `debug()` as the module.\n */\n\nexports = module.exports = require('./debug');\nexports.log = log;\nexports.formatArgs = formatArgs;\nexports.save = save;\nexports.load = load;\nexports.useColors = useColors;\nexports.storage = 'undefined' != typeof chrome\n               && 'undefined' != typeof chrome.storage\n                  ? chrome.storage.local\n                  : localstorage();\n\n/**\n * Colors.\n */\n\nexports.colors = [\n  '#0000CC', '#0000FF', '#0033CC', '#0033FF', '#0066CC', '#0066FF', '#0099CC',\n  '#0099FF', '#00CC00', '#00CC33', '#00CC66', '#00CC99', '#00CCCC', '#00CCFF',\n  '#3300CC', '#3300FF', '#3333CC', '#3333FF', '#3366CC', '#3366FF', '#3399CC',\n  '#3399FF', '#33CC00', '#33CC33', '#33CC66', '#33CC99', '#33CCCC', '#33CCFF',\n  '#6600CC', '#6600FF', '#6633CC', '#6633FF', '#66CC00', '#66CC33', '#9900CC',\n  '#9900FF', '#9933CC', '#9933FF', '#99CC00', '#99CC33', '#CC0000', '#CC0033',\n  '#CC0066', '#CC0099', '#CC00CC', '#CC00FF', '#CC3300', '#CC3333', '#CC3366',\n  '#CC3399', '#CC33CC', '#CC33FF', '#CC6600', '#CC6633', '#CC9900', '#CC9933',\n  '#CCCC00', '#CCCC33', '#FF0000', '#FF0033', '#FF0066', '#FF0099', '#FF00CC',\n  '#FF00FF', '#FF3300', '#FF3333', '#FF3366', '#FF3399', '#FF33CC', '#FF33FF',\n  '#FF6600', '#FF6633', '#FF9900', '#FF9933', '#FFCC00', '#FFCC33'\n];\n\n/**\n * Currently only WebKit-based Web Inspectors, Firefox >= v31,\n * and the Firebug extension (any Firefox version) are known\n * to support \"%c\" CSS customizations.\n *\n * TODO: add a `localStorage` variable to explicitly enable/disable colors\n */\n\nfunction useColors() {\n  // NB: In an Electron preload script, document will be defined but not fully\n  // initialized. Since we know we're in Chrome, we'll just detect this case\n  // explicitly\n  if (typeof window !== 'undefined' && window.process && window.process.type === 'renderer') {\n    return true;\n  }\n\n  // Internet Explorer and Edge do not support colors.\n  if (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/(edge|trident)\\/(\\d+)/)) {\n    return false;\n  }\n\n  // is webkit? http://stackoverflow.com/a/16459606/376773\n  // document is undefined in react-native: https://github.com/facebook/react-native/pull/1632\n  return (typeof document !== 'undefined' && document.documentElement && document.documentElement.style && document.documentElement.style.WebkitAppearance) ||\n    // is firebug? http://stackoverflow.com/a/398120/376773\n    (typeof window !== 'undefined' && window.console && (window.console.firebug || (window.console.exception && window.console.table))) ||\n    // is firefox >= v31?\n    // https://developer.mozilla.org/en-US/docs/Tools/Web_Console#Styling_messages\n    (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/firefox\\/(\\d+)/) && parseInt(RegExp.$1, 10) >= 31) ||\n    // double check webkit in userAgent just in case we are in a worker\n    (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/applewebkit\\/(\\d+)/));\n}\n\n/**\n * Map %j to `JSON.stringify()`, since no Web Inspectors do that by default.\n */\n\nexports.formatters.j = function(v) {\n  try {\n    return JSON.stringify(v);\n  } catch (err) {\n    return '[UnexpectedJSONParseError]: ' + err.message;\n  }\n};\n\n\n/**\n * Colorize log arguments if enabled.\n *\n * @api public\n */\n\nfunction formatArgs(args) {\n  var useColors = this.useColors;\n\n  args[0] = (useColors ? '%c' : '')\n    + this.namespace\n    + (useColors ? ' %c' : ' ')\n    + args[0]\n    + (useColors ? '%c ' : ' ')\n    + '+' + exports.humanize(this.diff);\n\n  if (!useColors) return;\n\n  var c = 'color: ' + this.color;\n  args.splice(1, 0, c, 'color: inherit')\n\n  // the final \"%c\" is somewhat tricky, because there could be other\n  // arguments passed either before or after the %c, so we need to\n  // figure out the correct index to insert the CSS into\n  var index = 0;\n  var lastC = 0;\n  args[0].replace(/%[a-zA-Z%]/g, function(match) {\n    if ('%%' === match) return;\n    index++;\n    if ('%c' === match) {\n      // we only are interested in the *last* %c\n      // (the user may have provided their own)\n      lastC = index;\n    }\n  });\n\n  args.splice(lastC, 0, c);\n}\n\n/**\n * Invokes `console.log()` when available.\n * No-op when `console.log` is not a \"function\".\n *\n * @api public\n */\n\nfunction log() {\n  // this hackery is required for IE8/9, where\n  // the `console.log` function doesn't have 'apply'\n  return 'object' === typeof console\n    && console.log\n    && Function.prototype.apply.call(console.log, console, arguments);\n}\n\n/**\n * Save `namespaces`.\n *\n * @param {String} namespaces\n * @api private\n */\n\nfunction save(namespaces) {\n  try {\n    if (null == namespaces) {\n      exports.storage.removeItem('debug');\n    } else {\n      exports.storage.debug = namespaces;\n    }\n  } catch(e) {}\n}\n\n/**\n * Load `namespaces`.\n *\n * @return {String} returns the previously persisted debug modes\n * @api private\n */\n\nfunction load() {\n  var r;\n  try {\n    r = exports.storage.debug;\n  } catch(e) {}\n\n  // If debug isn't set in LS, and we're in Electron, try to load $DEBUG\n  if (!r && typeof process !== 'undefined' && 'env' in process) {\n    r = process.env.DEBUG;\n  }\n\n  return r;\n}\n\n/**\n * Enable namespaces listed in `localStorage.debug` initially.\n */\n\nexports.enable(load());\n\n/**\n * Localstorage attempts to return the localstorage.\n *\n * This is necessary because safari throws\n * when a user disables cookies/localstorage\n * and you attempt to access it.\n *\n * @return {LocalStorage}\n * @api private\n */\n\nfunction localstorage() {\n  try {\n    return window.localStorage;\n  } catch (e) {}\n}\n","\n/**\n * This is the common logic for both the Node.js and web browser\n * implementations of `debug()`.\n *\n * Expose `debug()` as the module.\n */\n\nexports = module.exports = createDebug.debug = createDebug['default'] = createDebug;\nexports.coerce = coerce;\nexports.disable = disable;\nexports.enable = enable;\nexports.enabled = enabled;\nexports.humanize = require('ms');\n\n/**\n * Active `debug` instances.\n */\nexports.instances = [];\n\n/**\n * The currently active debug mode names, and names to skip.\n */\n\nexports.names = [];\nexports.skips = [];\n\n/**\n * Map of special \"%n\" handling functions, for the debug \"format\" argument.\n *\n * Valid key names are a single, lower or upper-case letter, i.e. \"n\" and \"N\".\n */\n\nexports.formatters = {};\n\n/**\n * Select a color.\n * @param {String} namespace\n * @return {Number}\n * @api private\n */\n\nfunction selectColor(namespace) {\n  var hash = 0, i;\n\n  for (i in namespace) {\n    hash  = ((hash << 5) - hash) + namespace.charCodeAt(i);\n    hash |= 0; // Convert to 32bit integer\n  }\n\n  return exports.colors[Math.abs(hash) % exports.colors.length];\n}\n\n/**\n * Create a debugger with the given `namespace`.\n *\n * @param {String} namespace\n * @return {Function}\n * @api public\n */\n\nfunction createDebug(namespace) {\n\n  var prevTime;\n\n  function debug() {\n    // disabled?\n    if (!debug.enabled) return;\n\n    var self = debug;\n\n    // set `diff` timestamp\n    var curr = +new Date();\n    var ms = curr - (prevTime || curr);\n    self.diff = ms;\n    self.prev = prevTime;\n    self.curr = curr;\n    prevTime = curr;\n\n    // turn the `arguments` into a proper Array\n    var args = new Array(arguments.length);\n    for (var i = 0; i < args.length; i++) {\n      args[i] = arguments[i];\n    }\n\n    args[0] = exports.coerce(args[0]);\n\n    if ('string' !== typeof args[0]) {\n      // anything else let's inspect with %O\n      args.unshift('%O');\n    }\n\n    // apply any `formatters` transformations\n    var index = 0;\n    args[0] = args[0].replace(/%([a-zA-Z%])/g, function(match, format) {\n      // if we encounter an escaped % then don't increase the array index\n      if (match === '%%') return match;\n      index++;\n      var formatter = exports.formatters[format];\n      if ('function' === typeof formatter) {\n        var val = args[index];\n        match = formatter.call(self, val);\n\n        // now we need to remove `args[index]` since it's inlined in the `format`\n        args.splice(index, 1);\n        index--;\n      }\n      return match;\n    });\n\n    // apply env-specific formatting (colors, etc.)\n    exports.formatArgs.call(self, args);\n\n    var logFn = debug.log || exports.log || console.log.bind(console);\n    logFn.apply(self, args);\n  }\n\n  debug.namespace = namespace;\n  debug.enabled = exports.enabled(namespace);\n  debug.useColors = exports.useColors();\n  debug.color = selectColor(namespace);\n  debug.destroy = destroy;\n\n  // env-specific initialization logic for debug instances\n  if ('function' === typeof exports.init) {\n    exports.init(debug);\n  }\n\n  exports.instances.push(debug);\n\n  return debug;\n}\n\nfunction destroy () {\n  var index = exports.instances.indexOf(this);\n  if (index !== -1) {\n    exports.instances.splice(index, 1);\n    return true;\n  } else {\n    return false;\n  }\n}\n\n/**\n * Enables a debug mode by namespaces. This can include modes\n * separated by a colon and wildcards.\n *\n * @param {String} namespaces\n * @api public\n */\n\nfunction enable(namespaces) {\n  exports.save(namespaces);\n\n  exports.names = [];\n  exports.skips = [];\n\n  var i;\n  var split = (typeof namespaces === 'string' ? namespaces : '').split(/[\\s,]+/);\n  var len = split.length;\n\n  for (i = 0; i < len; i++) {\n    if (!split[i]) continue; // ignore empty strings\n    namespaces = split[i].replace(/\\*/g, '.*?');\n    if (namespaces[0] === '-') {\n      exports.skips.push(new RegExp('^' + namespaces.substr(1) + '$'));\n    } else {\n      exports.names.push(new RegExp('^' + namespaces + '$'));\n    }\n  }\n\n  for (i = 0; i < exports.instances.length; i++) {\n    var instance = exports.instances[i];\n    instance.enabled = exports.enabled(instance.namespace);\n  }\n}\n\n/**\n * Disable debug output.\n *\n * @api public\n */\n\nfunction disable() {\n  exports.enable('');\n}\n\n/**\n * Returns true if the given mode name is enabled, false otherwise.\n *\n * @param {String} name\n * @return {Boolean}\n * @api public\n */\n\nfunction enabled(name) {\n  if (name[name.length - 1] === '*') {\n    return true;\n  }\n  var i, len;\n  for (i = 0, len = exports.skips.length; i < len; i++) {\n    if (exports.skips[i].test(name)) {\n      return false;\n    }\n  }\n  for (i = 0, len = exports.names.length; i < len; i++) {\n    if (exports.names[i].test(name)) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * Coerce `val`.\n *\n * @param {Mixed} val\n * @return {Mixed}\n * @api private\n */\n\nfunction coerce(val) {\n  if (val instanceof Error) return val.stack || val.message;\n  return val;\n}\n","/*global Blob,File*/\n\n/**\n * Module requirements\n */\n\nvar isArray = require('isarray');\nvar isBuf = require('./is-buffer');\nvar toString = Object.prototype.toString;\nvar withNativeBlob = typeof Blob === 'function' || (typeof Blob !== 'undefined' && toString.call(Blob) === '[object BlobConstructor]');\nvar withNativeFile = typeof File === 'function' || (typeof File !== 'undefined' && toString.call(File) === '[object FileConstructor]');\n\n/**\n * Replaces every Buffer | ArrayBuffer in packet with a numbered placeholder.\n * Anything with blobs or files should be fed through removeBlobs before coming\n * here.\n *\n * @param {Object} packet - socket.io event packet\n * @return {Object} with deconstructed packet and list of buffers\n * @api public\n */\n\nexports.deconstructPacket = function(packet) {\n  var buffers = [];\n  var packetData = packet.data;\n  var pack = packet;\n  pack.data = _deconstructPacket(packetData, buffers);\n  pack.attachments = buffers.length; // number of binary 'attachments'\n  return {packet: pack, buffers: buffers};\n};\n\nfunction _deconstructPacket(data, buffers) {\n  if (!data) return data;\n\n  if (isBuf(data)) {\n    var placeholder = { _placeholder: true, num: buffers.length };\n    buffers.push(data);\n    return placeholder;\n  } else if (isArray(data)) {\n    var newData = new Array(data.length);\n    for (var i = 0; i < data.length; i++) {\n      newData[i] = _deconstructPacket(data[i], buffers);\n    }\n    return newData;\n  } else if (typeof data === 'object' && !(data instanceof Date)) {\n    var newData = {};\n    for (var key in data) {\n      newData[key] = _deconstructPacket(data[key], buffers);\n    }\n    return newData;\n  }\n  return data;\n}\n\n/**\n * Reconstructs a binary packet from its placeholder packet and buffers\n *\n * @param {Object} packet - event packet with placeholders\n * @param {Array} buffers - binary buffers to put in placeholder positions\n * @return {Object} reconstructed packet\n * @api public\n */\n\nexports.reconstructPacket = function(packet, buffers) {\n  packet.data = _reconstructPacket(packet.data, buffers);\n  packet.attachments = undefined; // no longer useful\n  return packet;\n};\n\nfunction _reconstructPacket(data, buffers) {\n  if (!data) return data;\n\n  if (data && data._placeholder) {\n    return buffers[data.num]; // appropriate buffer (should be natural order anyway)\n  } else if (isArray(data)) {\n    for (var i = 0; i < data.length; i++) {\n      data[i] = _reconstructPacket(data[i], buffers);\n    }\n  } else if (typeof data === 'object') {\n    for (var key in data) {\n      data[key] = _reconstructPacket(data[key], buffers);\n    }\n  }\n\n  return data;\n}\n\n/**\n * Asynchronously removes Blobs or Files from data via\n * FileReader's readAsArrayBuffer method. Used before encoding\n * data as msgpack. Calls callback with the blobless data.\n *\n * @param {Object} data\n * @param {Function} callback\n * @api private\n */\n\nexports.removeBlobs = function(data, callback) {\n  function _removeBlobs(obj, curKey, containingObject) {\n    if (!obj) return obj;\n\n    // convert any blob\n    if ((withNativeBlob && obj instanceof Blob) ||\n        (withNativeFile && obj instanceof File)) {\n      pendingBlobs++;\n\n      // async filereader\n      var fileReader = new FileReader();\n      fileReader.onload = function() { // this.result == arraybuffer\n        if (containingObject) {\n          containingObject[curKey] = this.result;\n        }\n        else {\n          bloblessData = this.result;\n        }\n\n        // if nothing pending its callback time\n        if(! --pendingBlobs) {\n          callback(bloblessData);\n        }\n      };\n\n      fileReader.readAsArrayBuffer(obj); // blob -> arraybuffer\n    } else if (isArray(obj)) { // handle array\n      for (var i = 0; i < obj.length; i++) {\n        _removeBlobs(obj[i], i, obj);\n      }\n    } else if (typeof obj === 'object' && !isBuf(obj)) { // and object\n      for (var key in obj) {\n        _removeBlobs(obj[key], key, obj);\n      }\n    }\n  }\n\n  var pendingBlobs = 0;\n  var bloblessData = data;\n  _removeBlobs(bloblessData);\n  if (!pendingBlobs) {\n    callback(bloblessData);\n  }\n};\n","\nmodule.exports = require('./socket');\n\n/**\n * Exports parser\n *\n * @api public\n *\n */\nmodule.exports.parser = require('engine.io-parser');\n","/**\n * Module dependencies.\n */\n\nvar transports = require('./transports/index');\nvar Emitter = require('component-emitter');\nvar debug = require('debug')('engine.io-client:socket');\nvar index = require('indexof');\nvar parser = require('engine.io-parser');\nvar parseuri = require('parseuri');\nvar parseqs = require('parseqs');\n\n/**\n * Module exports.\n */\n\nmodule.exports = Socket;\n\n/**\n * Socket constructor.\n *\n * @param {String|Object} uri or options\n * @param {Object} options\n * @api public\n */\n\nfunction Socket (uri, opts) {\n  if (!(this instanceof Socket)) return new Socket(uri, opts);\n\n  opts = opts || {};\n\n  if (uri && 'object' === typeof uri) {\n    opts = uri;\n    uri = null;\n  }\n\n  if (uri) {\n    uri = parseuri(uri);\n    opts.hostname = uri.host;\n    opts.secure = uri.protocol === 'https' || uri.protocol === 'wss';\n    opts.port = uri.port;\n    if (uri.query) opts.query = uri.query;\n  } else if (opts.host) {\n    opts.hostname = parseuri(opts.host).host;\n  }\n\n  this.secure = null != opts.secure ? opts.secure\n    : (typeof location !== 'undefined' && 'https:' === location.protocol);\n\n  if (opts.hostname && !opts.port) {\n    // if no port is specified manually, use the protocol default\n    opts.port = this.secure ? '443' : '80';\n  }\n\n  this.agent = opts.agent || false;\n  this.hostname = opts.hostname ||\n    (typeof location !== 'undefined' ? location.hostname : 'localhost');\n  this.port = opts.port || (typeof location !== 'undefined' && location.port\n      ? location.port\n      : (this.secure ? 443 : 80));\n  this.query = opts.query || {};\n  if ('string' === typeof this.query) this.query = parseqs.decode(this.query);\n  this.upgrade = false !== opts.upgrade;\n  this.path = (opts.path || '/engine.io').replace(/\\/$/, '') + '/';\n  this.forceJSONP = !!opts.forceJSONP;\n  this.jsonp = false !== opts.jsonp;\n  this.forceBase64 = !!opts.forceBase64;\n  this.enablesXDR = !!opts.enablesXDR;\n  this.timestampParam = opts.timestampParam || 't';\n  this.timestampRequests = opts.timestampRequests;\n  this.transports = opts.transports || ['polling', 'websocket'];\n  this.transportOptions = opts.transportOptions || {};\n  this.readyState = '';\n  this.writeBuffer = [];\n  this.prevBufferLen = 0;\n  this.policyPort = opts.policyPort || 843;\n  this.rememberUpgrade = opts.rememberUpgrade || false;\n  this.binaryType = null;\n  this.onlyBinaryUpgrades = opts.onlyBinaryUpgrades;\n  this.perMessageDeflate = false !== opts.perMessageDeflate ? (opts.perMessageDeflate || {}) : false;\n\n  if (true === this.perMessageDeflate) this.perMessageDeflate = {};\n  if (this.perMessageDeflate && null == this.perMessageDeflate.threshold) {\n    this.perMessageDeflate.threshold = 1024;\n  }\n\n  // SSL options for Node.js client\n  this.pfx = opts.pfx || null;\n  this.key = opts.key || null;\n  this.passphrase = opts.passphrase || null;\n  this.cert = opts.cert || null;\n  this.ca = opts.ca || null;\n  this.ciphers = opts.ciphers || null;\n  this.rejectUnauthorized = opts.rejectUnauthorized === undefined ? true : opts.rejectUnauthorized;\n  this.forceNode = !!opts.forceNode;\n\n  // detect ReactNative environment\n  this.isReactNative = (typeof navigator !== 'undefined' && typeof navigator.product === 'string' && navigator.product.toLowerCase() === 'reactnative');\n\n  // other options for Node.js or ReactNative client\n  if (typeof self === 'undefined' || this.isReactNative) {\n    if (opts.extraHeaders && Object.keys(opts.extraHeaders).length > 0) {\n      this.extraHeaders = opts.extraHeaders;\n    }\n\n    if (opts.localAddress) {\n      this.localAddress = opts.localAddress;\n    }\n  }\n\n  // set on handshake\n  this.id = null;\n  this.upgrades = null;\n  this.pingInterval = null;\n  this.pingTimeout = null;\n\n  // set on heartbeat\n  this.pingIntervalTimer = null;\n  this.pingTimeoutTimer = null;\n\n  this.open();\n}\n\nSocket.priorWebsocketSuccess = false;\n\n/**\n * Mix in `Emitter`.\n */\n\nEmitter(Socket.prototype);\n\n/**\n * Protocol version.\n *\n * @api public\n */\n\nSocket.protocol = parser.protocol; // this is an int\n\n/**\n * Expose deps for legacy compatibility\n * and standalone browser access.\n */\n\nSocket.Socket = Socket;\nSocket.Transport = require('./transport');\nSocket.transports = require('./transports/index');\nSocket.parser = require('engine.io-parser');\n\n/**\n * Creates transport of the given type.\n *\n * @param {String} transport name\n * @return {Transport}\n * @api private\n */\n\nSocket.prototype.createTransport = function (name) {\n  debug('creating transport \"%s\"', name);\n  var query = clone(this.query);\n\n  // append engine.io protocol identifier\n  query.EIO = parser.protocol;\n\n  // transport name\n  query.transport = name;\n\n  // per-transport options\n  var options = this.transportOptions[name] || {};\n\n  // session id if we already have one\n  if (this.id) query.sid = this.id;\n\n  var transport = new transports[name]({\n    query: query,\n    socket: this,\n    agent: options.agent || this.agent,\n    hostname: options.hostname || this.hostname,\n    port: options.port || this.port,\n    secure: options.secure || this.secure,\n    path: options.path || this.path,\n    forceJSONP: options.forceJSONP || this.forceJSONP,\n    jsonp: options.jsonp || this.jsonp,\n    forceBase64: options.forceBase64 || this.forceBase64,\n    enablesXDR: options.enablesXDR || this.enablesXDR,\n    timestampRequests: options.timestampRequests || this.timestampRequests,\n    timestampParam: options.timestampParam || this.timestampParam,\n    policyPort: options.policyPort || this.policyPort,\n    pfx: options.pfx || this.pfx,\n    key: options.key || this.key,\n    passphrase: options.passphrase || this.passphrase,\n    cert: options.cert || this.cert,\n    ca: options.ca || this.ca,\n    ciphers: options.ciphers || this.ciphers,\n    rejectUnauthorized: options.rejectUnauthorized || this.rejectUnauthorized,\n    perMessageDeflate: options.perMessageDeflate || this.perMessageDeflate,\n    extraHeaders: options.extraHeaders || this.extraHeaders,\n    forceNode: options.forceNode || this.forceNode,\n    localAddress: options.localAddress || this.localAddress,\n    requestTimeout: options.requestTimeout || this.requestTimeout,\n    protocols: options.protocols || void (0),\n    isReactNative: this.isReactNative\n  });\n\n  return transport;\n};\n\nfunction clone (obj) {\n  var o = {};\n  for (var i in obj) {\n    if (obj.hasOwnProperty(i)) {\n      o[i] = obj[i];\n    }\n  }\n  return o;\n}\n\n/**\n * Initializes transport to use and starts probe.\n *\n * @api private\n */\nSocket.prototype.open = function () {\n  var transport;\n  if (this.rememberUpgrade && Socket.priorWebsocketSuccess && this.transports.indexOf('websocket') !== -1) {\n    transport = 'websocket';\n  } else if (0 === this.transports.length) {\n    // Emit error on next tick so it can be listened to\n    var self = this;\n    setTimeout(function () {\n      self.emit('error', 'No transports available');\n    }, 0);\n    return;\n  } else {\n    transport = this.transports[0];\n  }\n  this.readyState = 'opening';\n\n  // Retry with the next transport if the transport is disabled (jsonp: false)\n  try {\n    transport = this.createTransport(transport);\n  } catch (e) {\n    this.transports.shift();\n    this.open();\n    return;\n  }\n\n  transport.open();\n  this.setTransport(transport);\n};\n\n/**\n * Sets the current transport. Disables the existing one (if any).\n *\n * @api private\n */\n\nSocket.prototype.setTransport = function (transport) {\n  debug('setting transport %s', transport.name);\n  var self = this;\n\n  if (this.transport) {\n    debug('clearing existing transport %s', this.transport.name);\n    this.transport.removeAllListeners();\n  }\n\n  // set up transport\n  this.transport = transport;\n\n  // set up transport listeners\n  transport\n  .on('drain', function () {\n    self.onDrain();\n  })\n  .on('packet', function (packet) {\n    self.onPacket(packet);\n  })\n  .on('error', function (e) {\n    self.onError(e);\n  })\n  .on('close', function () {\n    self.onClose('transport close');\n  });\n};\n\n/**\n * Probes a transport.\n *\n * @param {String} transport name\n * @api private\n */\n\nSocket.prototype.probe = function (name) {\n  debug('probing transport \"%s\"', name);\n  var transport = this.createTransport(name, { probe: 1 });\n  var failed = false;\n  var self = this;\n\n  Socket.priorWebsocketSuccess = false;\n\n  function onTransportOpen () {\n    if (self.onlyBinaryUpgrades) {\n      var upgradeLosesBinary = !this.supportsBinary && self.transport.supportsBinary;\n      failed = failed || upgradeLosesBinary;\n    }\n    if (failed) return;\n\n    debug('probe transport \"%s\" opened', name);\n    transport.send([{ type: 'ping', data: 'probe' }]);\n    transport.once('packet', function (msg) {\n      if (failed) return;\n      if ('pong' === msg.type && 'probe' === msg.data) {\n        debug('probe transport \"%s\" pong', name);\n        self.upgrading = true;\n        self.emit('upgrading', transport);\n        if (!transport) return;\n        Socket.priorWebsocketSuccess = 'websocket' === transport.name;\n\n        debug('pausing current transport \"%s\"', self.transport.name);\n        self.transport.pause(function () {\n          if (failed) return;\n          if ('closed' === self.readyState) return;\n          debug('changing transport and sending upgrade packet');\n\n          cleanup();\n\n          self.setTransport(transport);\n          transport.send([{ type: 'upgrade' }]);\n          self.emit('upgrade', transport);\n          transport = null;\n          self.upgrading = false;\n          self.flush();\n        });\n      } else {\n        debug('probe transport \"%s\" failed', name);\n        var err = new Error('probe error');\n        err.transport = transport.name;\n        self.emit('upgradeError', err);\n      }\n    });\n  }\n\n  function freezeTransport () {\n    if (failed) return;\n\n    // Any callback called by transport should be ignored since now\n    failed = true;\n\n    cleanup();\n\n    transport.close();\n    transport = null;\n  }\n\n  // Handle any error that happens while probing\n  function onerror (err) {\n    var error = new Error('probe error: ' + err);\n    error.transport = transport.name;\n\n    freezeTransport();\n\n    debug('probe transport \"%s\" failed because of error: %s', name, err);\n\n    self.emit('upgradeError', error);\n  }\n\n  function onTransportClose () {\n    onerror('transport closed');\n  }\n\n  // When the socket is closed while we're probing\n  function onclose () {\n    onerror('socket closed');\n  }\n\n  // When the socket is upgraded while we're probing\n  function onupgrade (to) {\n    if (transport && to.name !== transport.name) {\n      debug('\"%s\" works - aborting \"%s\"', to.name, transport.name);\n      freezeTransport();\n    }\n  }\n\n  // Remove all listeners on the transport and on self\n  function cleanup () {\n    transport.removeListener('open', onTransportOpen);\n    transport.removeListener('error', onerror);\n    transport.removeListener('close', onTransportClose);\n    self.removeListener('close', onclose);\n    self.removeListener('upgrading', onupgrade);\n  }\n\n  transport.once('open', onTransportOpen);\n  transport.once('error', onerror);\n  transport.once('close', onTransportClose);\n\n  this.once('close', onclose);\n  this.once('upgrading', onupgrade);\n\n  transport.open();\n};\n\n/**\n * Called when connection is deemed open.\n *\n * @api public\n */\n\nSocket.prototype.onOpen = function () {\n  debug('socket open');\n  this.readyState = 'open';\n  Socket.priorWebsocketSuccess = 'websocket' === this.transport.name;\n  this.emit('open');\n  this.flush();\n\n  // we check for `readyState` in case an `open`\n  // listener already closed the socket\n  if ('open' === this.readyState && this.upgrade && this.transport.pause) {\n    debug('starting upgrade probes');\n    for (var i = 0, l = this.upgrades.length; i < l; i++) {\n      this.probe(this.upgrades[i]);\n    }\n  }\n};\n\n/**\n * Handles a packet.\n *\n * @api private\n */\n\nSocket.prototype.onPacket = function (packet) {\n  if ('opening' === this.readyState || 'open' === this.readyState ||\n      'closing' === this.readyState) {\n    debug('socket receive: type \"%s\", data \"%s\"', packet.type, packet.data);\n\n    this.emit('packet', packet);\n\n    // Socket is live - any packet counts\n    this.emit('heartbeat');\n\n    switch (packet.type) {\n      case 'open':\n        this.onHandshake(JSON.parse(packet.data));\n        break;\n\n      case 'pong':\n        this.setPing();\n        this.emit('pong');\n        break;\n\n      case 'error':\n        var err = new Error('server error');\n        err.code = packet.data;\n        this.onError(err);\n        break;\n\n      case 'message':\n        this.emit('data', packet.data);\n        this.emit('message', packet.data);\n        break;\n    }\n  } else {\n    debug('packet received with socket readyState \"%s\"', this.readyState);\n  }\n};\n\n/**\n * Called upon handshake completion.\n *\n * @param {Object} handshake obj\n * @api private\n */\n\nSocket.prototype.onHandshake = function (data) {\n  this.emit('handshake', data);\n  this.id = data.sid;\n  this.transport.query.sid = data.sid;\n  this.upgrades = this.filterUpgrades(data.upgrades);\n  this.pingInterval = data.pingInterval;\n  this.pingTimeout = data.pingTimeout;\n  this.onOpen();\n  // In case open handler closes socket\n  if ('closed' === this.readyState) return;\n  this.setPing();\n\n  // Prolong liveness of socket on heartbeat\n  this.removeListener('heartbeat', this.onHeartbeat);\n  this.on('heartbeat', this.onHeartbeat);\n};\n\n/**\n * Resets ping timeout.\n *\n * @api private\n */\n\nSocket.prototype.onHeartbeat = function (timeout) {\n  clearTimeout(this.pingTimeoutTimer);\n  var self = this;\n  self.pingTimeoutTimer = setTimeout(function () {\n    if ('closed' === self.readyState) return;\n    self.onClose('ping timeout');\n  }, timeout || (self.pingInterval + self.pingTimeout));\n};\n\n/**\n * Pings server every `this.pingInterval` and expects response\n * within `this.pingTimeout` or closes connection.\n *\n * @api private\n */\n\nSocket.prototype.setPing = function () {\n  var self = this;\n  clearTimeout(self.pingIntervalTimer);\n  self.pingIntervalTimer = setTimeout(function () {\n    debug('writing ping packet - expecting pong within %sms', self.pingTimeout);\n    self.ping();\n    self.onHeartbeat(self.pingTimeout);\n  }, self.pingInterval);\n};\n\n/**\n* Sends a ping packet.\n*\n* @api private\n*/\n\nSocket.prototype.ping = function () {\n  var self = this;\n  this.sendPacket('ping', function () {\n    self.emit('ping');\n  });\n};\n\n/**\n * Called on `drain` event\n *\n * @api private\n */\n\nSocket.prototype.onDrain = function () {\n  this.writeBuffer.splice(0, this.prevBufferLen);\n\n  // setting prevBufferLen = 0 is very important\n  // for example, when upgrading, upgrade packet is sent over,\n  // and a nonzero prevBufferLen could cause problems on `drain`\n  this.prevBufferLen = 0;\n\n  if (0 === this.writeBuffer.length) {\n    this.emit('drain');\n  } else {\n    this.flush();\n  }\n};\n\n/**\n * Flush write buffers.\n *\n * @api private\n */\n\nSocket.prototype.flush = function () {\n  if ('closed' !== this.readyState && this.transport.writable &&\n    !this.upgrading && this.writeBuffer.length) {\n    debug('flushing %d packets in socket', this.writeBuffer.length);\n    this.transport.send(this.writeBuffer);\n    // keep track of current length of writeBuffer\n    // splice writeBuffer and callbackBuffer on `drain`\n    this.prevBufferLen = this.writeBuffer.length;\n    this.emit('flush');\n  }\n};\n\n/**\n * Sends a message.\n *\n * @param {String} message.\n * @param {Function} callback function.\n * @param {Object} options.\n * @return {Socket} for chaining.\n * @api public\n */\n\nSocket.prototype.write =\nSocket.prototype.send = function (msg, options, fn) {\n  this.sendPacket('message', msg, options, fn);\n  return this;\n};\n\n/**\n * Sends a packet.\n *\n * @param {String} packet type.\n * @param {String} data.\n * @param {Object} options.\n * @param {Function} callback function.\n * @api private\n */\n\nSocket.prototype.sendPacket = function (type, data, options, fn) {\n  if ('function' === typeof data) {\n    fn = data;\n    data = undefined;\n  }\n\n  if ('function' === typeof options) {\n    fn = options;\n    options = null;\n  }\n\n  if ('closing' === this.readyState || 'closed' === this.readyState) {\n    return;\n  }\n\n  options = options || {};\n  options.compress = false !== options.compress;\n\n  var packet = {\n    type: type,\n    data: data,\n    options: options\n  };\n  this.emit('packetCreate', packet);\n  this.writeBuffer.push(packet);\n  if (fn) this.once('flush', fn);\n  this.flush();\n};\n\n/**\n * Closes the connection.\n *\n * @api private\n */\n\nSocket.prototype.close = function () {\n  if ('opening' === this.readyState || 'open' === this.readyState) {\n    this.readyState = 'closing';\n\n    var self = this;\n\n    if (this.writeBuffer.length) {\n      this.once('drain', function () {\n        if (this.upgrading) {\n          waitForUpgrade();\n        } else {\n          close();\n        }\n      });\n    } else if (this.upgrading) {\n      waitForUpgrade();\n    } else {\n      close();\n    }\n  }\n\n  function close () {\n    self.onClose('forced close');\n    debug('socket closing - telling transport to close');\n    self.transport.close();\n  }\n\n  function cleanupAndClose () {\n    self.removeListener('upgrade', cleanupAndClose);\n    self.removeListener('upgradeError', cleanupAndClose);\n    close();\n  }\n\n  function waitForUpgrade () {\n    // wait for upgrade to finish since we can't send packets while pausing a transport\n    self.once('upgrade', cleanupAndClose);\n    self.once('upgradeError', cleanupAndClose);\n  }\n\n  return this;\n};\n\n/**\n * Called upon transport error\n *\n * @api private\n */\n\nSocket.prototype.onError = function (err) {\n  debug('socket error %j', err);\n  Socket.priorWebsocketSuccess = false;\n  this.emit('error', err);\n  this.onClose('transport error', err);\n};\n\n/**\n * Called upon transport close.\n *\n * @api private\n */\n\nSocket.prototype.onClose = function (reason, desc) {\n  if ('opening' === this.readyState || 'open' === this.readyState || 'closing' === this.readyState) {\n    debug('socket close with reason: \"%s\"', reason);\n    var self = this;\n\n    // clear timers\n    clearTimeout(this.pingIntervalTimer);\n    clearTimeout(this.pingTimeoutTimer);\n\n    // stop event from firing again for transport\n    this.transport.removeAllListeners('close');\n\n    // ensure transport won't stay open\n    this.transport.close();\n\n    // ignore further transport communication\n    this.transport.removeAllListeners();\n\n    // set ready state\n    this.readyState = 'closed';\n\n    // clear session id\n    this.id = null;\n\n    // emit close event\n    this.emit('close', reason, desc);\n\n    // clean buffers after, so users can still\n    // grab the buffers on `close` event\n    self.writeBuffer = [];\n    self.prevBufferLen = 0;\n  }\n};\n\n/**\n * Filters upgrades, returning only those matching client transports.\n *\n * @param {Array} server upgrades\n * @api private\n *\n */\n\nSocket.prototype.filterUpgrades = function (upgrades) {\n  var filteredUpgrades = [];\n  for (var i = 0, j = upgrades.length; i < j; i++) {\n    if (~index(this.transports, upgrades[i])) filteredUpgrades.push(upgrades[i]);\n  }\n  return filteredUpgrades;\n};\n","\n/**\n * Module exports.\n *\n * Logic borrowed from Modernizr:\n *\n *   - https://github.com/Modernizr/Modernizr/blob/master/feature-detects/cors.js\n */\n\ntry {\n  module.exports = typeof XMLHttpRequest !== 'undefined' &&\n    'withCredentials' in new XMLHttpRequest();\n} catch (err) {\n  // if XMLHttp support is disabled in IE then it will throw\n  // when trying to create\n  module.exports = false;\n}\n","/* global attachEvent */\n\n/**\n * Module requirements.\n */\n\nvar XMLHttpRequest = require('xmlhttprequest-ssl');\nvar Polling = require('./polling');\nvar Emitter = require('component-emitter');\nvar inherit = require('component-inherit');\nvar debug = require('debug')('engine.io-client:polling-xhr');\n\n/**\n * Module exports.\n */\n\nmodule.exports = XHR;\nmodule.exports.Request = Request;\n\n/**\n * Empty function\n */\n\nfunction empty () {}\n\n/**\n * XHR Polling constructor.\n *\n * @param {Object} opts\n * @api public\n */\n\nfunction XHR (opts) {\n  Polling.call(this, opts);\n  this.requestTimeout = opts.requestTimeout;\n  this.extraHeaders = opts.extraHeaders;\n\n  if (typeof location !== 'undefined') {\n    var isSSL = 'https:' === location.protocol;\n    var port = location.port;\n\n    // some user agents have empty `location.port`\n    if (!port) {\n      port = isSSL ? 443 : 80;\n    }\n\n    this.xd = (typeof location !== 'undefined' && opts.hostname !== location.hostname) ||\n      port !== opts.port;\n    this.xs = opts.secure !== isSSL;\n  }\n}\n\n/**\n * Inherits from Polling.\n */\n\ninherit(XHR, Polling);\n\n/**\n * XHR supports binary\n */\n\nXHR.prototype.supportsBinary = true;\n\n/**\n * Creates a request.\n *\n * @param {String} method\n * @api private\n */\n\nXHR.prototype.request = function (opts) {\n  opts = opts || {};\n  opts.uri = this.uri();\n  opts.xd = this.xd;\n  opts.xs = this.xs;\n  opts.agent = this.agent || false;\n  opts.supportsBinary = this.supportsBinary;\n  opts.enablesXDR = this.enablesXDR;\n\n  // SSL options for Node.js client\n  opts.pfx = this.pfx;\n  opts.key = this.key;\n  opts.passphrase = this.passphrase;\n  opts.cert = this.cert;\n  opts.ca = this.ca;\n  opts.ciphers = this.ciphers;\n  opts.rejectUnauthorized = this.rejectUnauthorized;\n  opts.requestTimeout = this.requestTimeout;\n\n  // other options for Node.js client\n  opts.extraHeaders = this.extraHeaders;\n\n  return new Request(opts);\n};\n\n/**\n * Sends data.\n *\n * @param {String} data to send.\n * @param {Function} called upon flush.\n * @api private\n */\n\nXHR.prototype.doWrite = function (data, fn) {\n  var isBinary = typeof data !== 'string' && data !== undefined;\n  var req = this.request({ method: 'POST', data: data, isBinary: isBinary });\n  var self = this;\n  req.on('success', fn);\n  req.on('error', function (err) {\n    self.onError('xhr post error', err);\n  });\n  this.sendXhr = req;\n};\n\n/**\n * Starts a poll cycle.\n *\n * @api private\n */\n\nXHR.prototype.doPoll = function () {\n  debug('xhr poll');\n  var req = this.request();\n  var self = this;\n  req.on('data', function (data) {\n    self.onData(data);\n  });\n  req.on('error', function (err) {\n    self.onError('xhr poll error', err);\n  });\n  this.pollXhr = req;\n};\n\n/**\n * Request constructor\n *\n * @param {Object} options\n * @api public\n */\n\nfunction Request (opts) {\n  this.method = opts.method || 'GET';\n  this.uri = opts.uri;\n  this.xd = !!opts.xd;\n  this.xs = !!opts.xs;\n  this.async = false !== opts.async;\n  this.data = undefined !== opts.data ? opts.data : null;\n  this.agent = opts.agent;\n  this.isBinary = opts.isBinary;\n  this.supportsBinary = opts.supportsBinary;\n  this.enablesXDR = opts.enablesXDR;\n  this.requestTimeout = opts.requestTimeout;\n\n  // SSL options for Node.js client\n  this.pfx = opts.pfx;\n  this.key = opts.key;\n  this.passphrase = opts.passphrase;\n  this.cert = opts.cert;\n  this.ca = opts.ca;\n  this.ciphers = opts.ciphers;\n  this.rejectUnauthorized = opts.rejectUnauthorized;\n\n  // other options for Node.js client\n  this.extraHeaders = opts.extraHeaders;\n\n  this.create();\n}\n\n/**\n * Mix in `Emitter`.\n */\n\nEmitter(Request.prototype);\n\n/**\n * Creates the XHR object and sends the request.\n *\n * @api private\n */\n\nRequest.prototype.create = function () {\n  var opts = { agent: this.agent, xdomain: this.xd, xscheme: this.xs, enablesXDR: this.enablesXDR };\n\n  // SSL options for Node.js client\n  opts.pfx = this.pfx;\n  opts.key = this.key;\n  opts.passphrase = this.passphrase;\n  opts.cert = this.cert;\n  opts.ca = this.ca;\n  opts.ciphers = this.ciphers;\n  opts.rejectUnauthorized = this.rejectUnauthorized;\n\n  var xhr = this.xhr = new XMLHttpRequest(opts);\n  var self = this;\n\n  try {\n    debug('xhr open %s: %s', this.method, this.uri);\n    xhr.open(this.method, this.uri, this.async);\n    try {\n      if (this.extraHeaders) {\n        xhr.setDisableHeaderCheck && xhr.setDisableHeaderCheck(true);\n        for (var i in this.extraHeaders) {\n          if (this.extraHeaders.hasOwnProperty(i)) {\n            xhr.setRequestHeader(i, this.extraHeaders[i]);\n          }\n        }\n      }\n    } catch (e) {}\n\n    if ('POST' === this.method) {\n      try {\n        if (this.isBinary) {\n          xhr.setRequestHeader('Content-type', 'application/octet-stream');\n        } else {\n          xhr.setRequestHeader('Content-type', 'text/plain;charset=UTF-8');\n        }\n      } catch (e) {}\n    }\n\n    try {\n      xhr.setRequestHeader('Accept', '*/*');\n    } catch (e) {}\n\n    // ie6 check\n    if ('withCredentials' in xhr) {\n      xhr.withCredentials = true;\n    }\n\n    if (this.requestTimeout) {\n      xhr.timeout = this.requestTimeout;\n    }\n\n    if (this.hasXDR()) {\n      xhr.onload = function () {\n        self.onLoad();\n      };\n      xhr.onerror = function () {\n        self.onError(xhr.responseText);\n      };\n    } else {\n      xhr.onreadystatechange = function () {\n        if (xhr.readyState === 2) {\n          try {\n            var contentType = xhr.getResponseHeader('Content-Type');\n            if (self.supportsBinary && contentType === 'application/octet-stream') {\n              xhr.responseType = 'arraybuffer';\n            }\n          } catch (e) {}\n        }\n        if (4 !== xhr.readyState) return;\n        if (200 === xhr.status || 1223 === xhr.status) {\n          self.onLoad();\n        } else {\n          // make sure the `error` event handler that's user-set\n          // does not throw in the same tick and gets caught here\n          setTimeout(function () {\n            self.onError(xhr.status);\n          }, 0);\n        }\n      };\n    }\n\n    debug('xhr data %s', this.data);\n    xhr.send(this.data);\n  } catch (e) {\n    // Need to defer since .create() is called directly fhrom the constructor\n    // and thus the 'error' event can only be only bound *after* this exception\n    // occurs.  Therefore, also, we cannot throw here at all.\n    setTimeout(function () {\n      self.onError(e);\n    }, 0);\n    return;\n  }\n\n  if (typeof document !== 'undefined') {\n    this.index = Request.requestsCount++;\n    Request.requests[this.index] = this;\n  }\n};\n\n/**\n * Called upon successful response.\n *\n * @api private\n */\n\nRequest.prototype.onSuccess = function () {\n  this.emit('success');\n  this.cleanup();\n};\n\n/**\n * Called if we have data.\n *\n * @api private\n */\n\nRequest.prototype.onData = function (data) {\n  this.emit('data', data);\n  this.onSuccess();\n};\n\n/**\n * Called upon error.\n *\n * @api private\n */\n\nRequest.prototype.onError = function (err) {\n  this.emit('error', err);\n  this.cleanup(true);\n};\n\n/**\n * Cleans up house.\n *\n * @api private\n */\n\nRequest.prototype.cleanup = function (fromError) {\n  if ('undefined' === typeof this.xhr || null === this.xhr) {\n    return;\n  }\n  // xmlhttprequest\n  if (this.hasXDR()) {\n    this.xhr.onload = this.xhr.onerror = empty;\n  } else {\n    this.xhr.onreadystatechange = empty;\n  }\n\n  if (fromError) {\n    try {\n      this.xhr.abort();\n    } catch (e) {}\n  }\n\n  if (typeof document !== 'undefined') {\n    delete Request.requests[this.index];\n  }\n\n  this.xhr = null;\n};\n\n/**\n * Called upon load.\n *\n * @api private\n */\n\nRequest.prototype.onLoad = function () {\n  var data;\n  try {\n    var contentType;\n    try {\n      contentType = this.xhr.getResponseHeader('Content-Type');\n    } catch (e) {}\n    if (contentType === 'application/octet-stream') {\n      data = this.xhr.response || this.xhr.responseText;\n    } else {\n      data = this.xhr.responseText;\n    }\n  } catch (e) {\n    this.onError(e);\n  }\n  if (null != data) {\n    this.onData(data);\n  }\n};\n\n/**\n * Check if it has XDomainRequest.\n *\n * @api private\n */\n\nRequest.prototype.hasXDR = function () {\n  return typeof XDomainRequest !== 'undefined' && !this.xs && this.enablesXDR;\n};\n\n/**\n * Aborts the request.\n *\n * @api public\n */\n\nRequest.prototype.abort = function () {\n  this.cleanup();\n};\n\n/**\n * Aborts pending requests when unloading the window. This is needed to prevent\n * memory leaks (e.g. when using IE) and to ensure that no spurious error is\n * emitted.\n */\n\nRequest.requestsCount = 0;\nRequest.requests = {};\n\nif (typeof document !== 'undefined') {\n  if (typeof attachEvent === 'function') {\n    attachEvent('onunload', unloadHandler);\n  } else if (typeof addEventListener === 'function') {\n    var terminationEvent = 'onpagehide' in self ? 'pagehide' : 'unload';\n    addEventListener(terminationEvent, unloadHandler, false);\n  }\n}\n\nfunction unloadHandler () {\n  for (var i in Request.requests) {\n    if (Request.requests.hasOwnProperty(i)) {\n      Request.requests[i].abort();\n    }\n  }\n}\n","\n/**\n * Gets the keys for an object.\n *\n * @return {Array} keys\n * @api private\n */\n\nmodule.exports = Object.keys || function keys (obj){\n  var arr = [];\n  var has = Object.prototype.hasOwnProperty;\n\n  for (var i in obj) {\n    if (has.call(obj, i)) {\n      arr.push(i);\n    }\n  }\n  return arr;\n};\n","var toString = {}.toString;\n\nmodule.exports = Array.isArray || function (arr) {\n  return toString.call(arr) == '[object Array]';\n};\n","/**\n * An abstraction for slicing an arraybuffer even when\n * ArrayBuffer.prototype.slice is not supported\n *\n * @api public\n */\n\nmodule.exports = function(arraybuffer, start, end) {\n  var bytes = arraybuffer.byteLength;\n  start = start || 0;\n  end = end || bytes;\n\n  if (arraybuffer.slice) { return arraybuffer.slice(start, end); }\n\n  if (start < 0) { start += bytes; }\n  if (end < 0) { end += bytes; }\n  if (end > bytes) { end = bytes; }\n\n  if (start >= bytes || start >= end || bytes === 0) {\n    return new ArrayBuffer(0);\n  }\n\n  var abv = new Uint8Array(arraybuffer);\n  var result = new Uint8Array(end - start);\n  for (var i = start, ii = 0; i < end; i++, ii++) {\n    result[ii] = abv[i];\n  }\n  return result.buffer;\n};\n","module.exports = after\n\nfunction after(count, callback, err_cb) {\n    var bail = false\n    err_cb = err_cb || noop\n    proxy.count = count\n\n    return (count === 0) ? callback() : proxy\n\n    function proxy(err, result) {\n        if (proxy.count <= 0) {\n            throw new Error('after called too many times')\n        }\n        --proxy.count\n\n        // after first error, rest are passed to err_cb\n        if (err) {\n            bail = true\n            callback(err)\n            // future error callbacks will go to error handler\n            callback = err_cb\n        } else if (proxy.count === 0 && !bail) {\n            callback(null, result)\n        }\n    }\n}\n\nfunction noop() {}\n","/*! https://mths.be/utf8js v2.1.2 by @mathias */\n\nvar stringFromCharCode = String.fromCharCode;\n\n// Taken from https://mths.be/punycode\nfunction ucs2decode(string) {\n\tvar output = [];\n\tvar counter = 0;\n\tvar length = string.length;\n\tvar value;\n\tvar extra;\n\twhile (counter < length) {\n\t\tvalue = string.charCodeAt(counter++);\n\t\tif (value >= 0xD800 && value <= 0xDBFF && counter < length) {\n\t\t\t// high surrogate, and there is a next character\n\t\t\textra = string.charCodeAt(counter++);\n\t\t\tif ((extra & 0xFC00) == 0xDC00) { // low surrogate\n\t\t\t\toutput.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);\n\t\t\t} else {\n\t\t\t\t// unmatched surrogate; only append this code unit, in case the next\n\t\t\t\t// code unit is the high surrogate of a surrogate pair\n\t\t\t\toutput.push(value);\n\t\t\t\tcounter--;\n\t\t\t}\n\t\t} else {\n\t\t\toutput.push(value);\n\t\t}\n\t}\n\treturn output;\n}\n\n// Taken from https://mths.be/punycode\nfunction ucs2encode(array) {\n\tvar length = array.length;\n\tvar index = -1;\n\tvar value;\n\tvar output = '';\n\twhile (++index < length) {\n\t\tvalue = array[index];\n\t\tif (value > 0xFFFF) {\n\t\t\tvalue -= 0x10000;\n\t\t\toutput += stringFromCharCode(value >>> 10 & 0x3FF | 0xD800);\n\t\t\tvalue = 0xDC00 | value & 0x3FF;\n\t\t}\n\t\toutput += stringFromCharCode(value);\n\t}\n\treturn output;\n}\n\nfunction checkScalarValue(codePoint, strict) {\n\tif (codePoint >= 0xD800 && codePoint <= 0xDFFF) {\n\t\tif (strict) {\n\t\t\tthrow Error(\n\t\t\t\t'Lone surrogate U+' + codePoint.toString(16).toUpperCase() +\n\t\t\t\t' is not a scalar value'\n\t\t\t);\n\t\t}\n\t\treturn false;\n\t}\n\treturn true;\n}\n/*--------------------------------------------------------------------------*/\n\nfunction createByte(codePoint, shift) {\n\treturn stringFromCharCode(((codePoint >> shift) & 0x3F) | 0x80);\n}\n\nfunction encodeCodePoint(codePoint, strict) {\n\tif ((codePoint & 0xFFFFFF80) == 0) { // 1-byte sequence\n\t\treturn stringFromCharCode(codePoint);\n\t}\n\tvar symbol = '';\n\tif ((codePoint & 0xFFFFF800) == 0) { // 2-byte sequence\n\t\tsymbol = stringFromCharCode(((codePoint >> 6) & 0x1F) | 0xC0);\n\t}\n\telse if ((codePoint & 0xFFFF0000) == 0) { // 3-byte sequence\n\t\tif (!checkScalarValue(codePoint, strict)) {\n\t\t\tcodePoint = 0xFFFD;\n\t\t}\n\t\tsymbol = stringFromCharCode(((codePoint >> 12) & 0x0F) | 0xE0);\n\t\tsymbol += createByte(codePoint, 6);\n\t}\n\telse if ((codePoint & 0xFFE00000) == 0) { // 4-byte sequence\n\t\tsymbol = stringFromCharCode(((codePoint >> 18) & 0x07) | 0xF0);\n\t\tsymbol += createByte(codePoint, 12);\n\t\tsymbol += createByte(codePoint, 6);\n\t}\n\tsymbol += stringFromCharCode((codePoint & 0x3F) | 0x80);\n\treturn symbol;\n}\n\nfunction utf8encode(string, opts) {\n\topts = opts || {};\n\tvar strict = false !== opts.strict;\n\n\tvar codePoints = ucs2decode(string);\n\tvar length = codePoints.length;\n\tvar index = -1;\n\tvar codePoint;\n\tvar byteString = '';\n\twhile (++index < length) {\n\t\tcodePoint = codePoints[index];\n\t\tbyteString += encodeCodePoint(codePoint, strict);\n\t}\n\treturn byteString;\n}\n\n/*--------------------------------------------------------------------------*/\n\nfunction readContinuationByte() {\n\tif (byteIndex >= byteCount) {\n\t\tthrow Error('Invalid byte index');\n\t}\n\n\tvar continuationByte = byteArray[byteIndex] & 0xFF;\n\tbyteIndex++;\n\n\tif ((continuationByte & 0xC0) == 0x80) {\n\t\treturn continuationByte & 0x3F;\n\t}\n\n\t// If we end up here, it’s not a continuation byte\n\tthrow Error('Invalid continuation byte');\n}\n\nfunction decodeSymbol(strict) {\n\tvar byte1;\n\tvar byte2;\n\tvar byte3;\n\tvar byte4;\n\tvar codePoint;\n\n\tif (byteIndex > byteCount) {\n\t\tthrow Error('Invalid byte index');\n\t}\n\n\tif (byteIndex == byteCount) {\n\t\treturn false;\n\t}\n\n\t// Read first byte\n\tbyte1 = byteArray[byteIndex] & 0xFF;\n\tbyteIndex++;\n\n\t// 1-byte sequence (no continuation bytes)\n\tif ((byte1 & 0x80) == 0) {\n\t\treturn byte1;\n\t}\n\n\t// 2-byte sequence\n\tif ((byte1 & 0xE0) == 0xC0) {\n\t\tbyte2 = readContinuationByte();\n\t\tcodePoint = ((byte1 & 0x1F) << 6) | byte2;\n\t\tif (codePoint >= 0x80) {\n\t\t\treturn codePoint;\n\t\t} else {\n\t\t\tthrow Error('Invalid continuation byte');\n\t\t}\n\t}\n\n\t// 3-byte sequence (may include unpaired surrogates)\n\tif ((byte1 & 0xF0) == 0xE0) {\n\t\tbyte2 = readContinuationByte();\n\t\tbyte3 = readContinuationByte();\n\t\tcodePoint = ((byte1 & 0x0F) << 12) | (byte2 << 6) | byte3;\n\t\tif (codePoint >= 0x0800) {\n\t\t\treturn checkScalarValue(codePoint, strict) ? codePoint : 0xFFFD;\n\t\t} else {\n\t\t\tthrow Error('Invalid continuation byte');\n\t\t}\n\t}\n\n\t// 4-byte sequence\n\tif ((byte1 & 0xF8) == 0xF0) {\n\t\tbyte2 = readContinuationByte();\n\t\tbyte3 = readContinuationByte();\n\t\tbyte4 = readContinuationByte();\n\t\tcodePoint = ((byte1 & 0x07) << 0x12) | (byte2 << 0x0C) |\n\t\t\t(byte3 << 0x06) | byte4;\n\t\tif (codePoint >= 0x010000 && codePoint <= 0x10FFFF) {\n\t\t\treturn codePoint;\n\t\t}\n\t}\n\n\tthrow Error('Invalid UTF-8 detected');\n}\n\nvar byteArray;\nvar byteCount;\nvar byteIndex;\nfunction utf8decode(byteString, opts) {\n\topts = opts || {};\n\tvar strict = false !== opts.strict;\n\n\tbyteArray = ucs2decode(byteString);\n\tbyteCount = byteArray.length;\n\tbyteIndex = 0;\n\tvar codePoints = [];\n\tvar tmp;\n\twhile ((tmp = decodeSymbol(strict)) !== false) {\n\t\tcodePoints.push(tmp);\n\t}\n\treturn ucs2encode(codePoints);\n}\n\nmodule.exports = {\n\tversion: '2.1.2',\n\tencode: utf8encode,\n\tdecode: utf8decode\n};\n","/*\n * base64-arraybuffer\n * https://github.com/niklasvh/base64-arraybuffer\n *\n * Copyright (c) 2012 Niklas von Hertzen\n * Licensed under the MIT license.\n */\n(function(){\n  \"use strict\";\n\n  var chars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\n\n  // Use a lookup table to find the index.\n  var lookup = new Uint8Array(256);\n  for (var i = 0; i < chars.length; i++) {\n    lookup[chars.charCodeAt(i)] = i;\n  }\n\n  exports.encode = function(arraybuffer) {\n    var bytes = new Uint8Array(arraybuffer),\n    i, len = bytes.length, base64 = \"\";\n\n    for (i = 0; i < len; i+=3) {\n      base64 += chars[bytes[i] >> 2];\n      base64 += chars[((bytes[i] & 3) << 4) | (bytes[i + 1] >> 4)];\n      base64 += chars[((bytes[i + 1] & 15) << 2) | (bytes[i + 2] >> 6)];\n      base64 += chars[bytes[i + 2] & 63];\n    }\n\n    if ((len % 3) === 2) {\n      base64 = base64.substring(0, base64.length - 1) + \"=\";\n    } else if (len % 3 === 1) {\n      base64 = base64.substring(0, base64.length - 2) + \"==\";\n    }\n\n    return base64;\n  };\n\n  exports.decode =  function(base64) {\n    var bufferLength = base64.length * 0.75,\n    len = base64.length, i, p = 0,\n    encoded1, encoded2, encoded3, encoded4;\n\n    if (base64[base64.length - 1] === \"=\") {\n      bufferLength--;\n      if (base64[base64.length - 2] === \"=\") {\n        bufferLength--;\n      }\n    }\n\n    var arraybuffer = new ArrayBuffer(bufferLength),\n    bytes = new Uint8Array(arraybuffer);\n\n    for (i = 0; i < len; i+=4) {\n      encoded1 = lookup[base64.charCodeAt(i)];\n      encoded2 = lookup[base64.charCodeAt(i+1)];\n      encoded3 = lookup[base64.charCodeAt(i+2)];\n      encoded4 = lookup[base64.charCodeAt(i+3)];\n\n      bytes[p++] = (encoded1 << 2) | (encoded2 >> 4);\n      bytes[p++] = ((encoded2 & 15) << 4) | (encoded3 >> 2);\n      bytes[p++] = ((encoded3 & 3) << 6) | (encoded4 & 63);\n    }\n\n    return arraybuffer;\n  };\n})();\n","/**\r\n * Create a blob builder even when vendor prefixes exist\r\n */\r\n\r\nvar BlobBuilder = typeof BlobBuilder !== 'undefined' ? BlobBuilder :\r\n  typeof WebKitBlobBuilder !== 'undefined' ? WebKitBlobBuilder :\r\n  typeof MSBlobBuilder !== 'undefined' ? MSBlobBuilder :\r\n  typeof MozBlobBuilder !== 'undefined' ? MozBlobBuilder : \r\n  false;\r\n\r\n/**\r\n * Check if Blob constructor is supported\r\n */\r\n\r\nvar blobSupported = (function() {\r\n  try {\r\n    var a = new Blob(['hi']);\r\n    return a.size === 2;\r\n  } catch(e) {\r\n    return false;\r\n  }\r\n})();\r\n\r\n/**\r\n * Check if Blob constructor supports ArrayBufferViews\r\n * Fails in Safari 6, so we need to map to ArrayBuffers there.\r\n */\r\n\r\nvar blobSupportsArrayBufferView = blobSupported && (function() {\r\n  try {\r\n    var b = new Blob([new Uint8Array([1,2])]);\r\n    return b.size === 2;\r\n  } catch(e) {\r\n    return false;\r\n  }\r\n})();\r\n\r\n/**\r\n * Check if BlobBuilder is supported\r\n */\r\n\r\nvar blobBuilderSupported = BlobBuilder\r\n  && BlobBuilder.prototype.append\r\n  && BlobBuilder.prototype.getBlob;\r\n\r\n/**\r\n * Helper function that maps ArrayBufferViews to ArrayBuffers\r\n * Used by BlobBuilder constructor and old browsers that didn't\r\n * support it in the Blob constructor.\r\n */\r\n\r\nfunction mapArrayBufferViews(ary) {\r\n  return ary.map(function(chunk) {\r\n    if (chunk.buffer instanceof ArrayBuffer) {\r\n      var buf = chunk.buffer;\r\n\r\n      // if this is a subarray, make a copy so we only\r\n      // include the subarray region from the underlying buffer\r\n      if (chunk.byteLength !== buf.byteLength) {\r\n        var copy = new Uint8Array(chunk.byteLength);\r\n        copy.set(new Uint8Array(buf, chunk.byteOffset, chunk.byteLength));\r\n        buf = copy.buffer;\r\n      }\r\n\r\n      return buf;\r\n    }\r\n\r\n    return chunk;\r\n  });\r\n}\r\n\r\nfunction BlobBuilderConstructor(ary, options) {\r\n  options = options || {};\r\n\r\n  var bb = new BlobBuilder();\r\n  mapArrayBufferViews(ary).forEach(function(part) {\r\n    bb.append(part);\r\n  });\r\n\r\n  return (options.type) ? bb.getBlob(options.type) : bb.getBlob();\r\n};\r\n\r\nfunction BlobConstructor(ary, options) {\r\n  return new Blob(mapArrayBufferViews(ary), options || {});\r\n};\r\n\r\nif (typeof Blob !== 'undefined') {\r\n  BlobBuilderConstructor.prototype = Blob.prototype;\r\n  BlobConstructor.prototype = Blob.prototype;\r\n}\r\n\r\nmodule.exports = (function() {\r\n  if (blobSupported) {\r\n    return blobSupportsArrayBufferView ? Blob : BlobConstructor;\r\n  } else if (blobBuilderSupported) {\r\n    return BlobBuilderConstructor;\r\n  } else {\r\n    return undefined;\r\n  }\r\n})();\r\n","\n/**\n * This is the common logic for both the Node.js and web browser\n * implementations of `debug()`.\n *\n * Expose `debug()` as the module.\n */\n\nexports = module.exports = createDebug.debug = createDebug['default'] = createDebug;\nexports.coerce = coerce;\nexports.disable = disable;\nexports.enable = enable;\nexports.enabled = enabled;\nexports.humanize = require('ms');\n\n/**\n * Active `debug` instances.\n */\nexports.instances = [];\n\n/**\n * The currently active debug mode names, and names to skip.\n */\n\nexports.names = [];\nexports.skips = [];\n\n/**\n * Map of special \"%n\" handling functions, for the debug \"format\" argument.\n *\n * Valid key names are a single, lower or upper-case letter, i.e. \"n\" and \"N\".\n */\n\nexports.formatters = {};\n\n/**\n * Select a color.\n * @param {String} namespace\n * @return {Number}\n * @api private\n */\n\nfunction selectColor(namespace) {\n  var hash = 0, i;\n\n  for (i in namespace) {\n    hash  = ((hash << 5) - hash) + namespace.charCodeAt(i);\n    hash |= 0; // Convert to 32bit integer\n  }\n\n  return exports.colors[Math.abs(hash) % exports.colors.length];\n}\n\n/**\n * Create a debugger with the given `namespace`.\n *\n * @param {String} namespace\n * @return {Function}\n * @api public\n */\n\nfunction createDebug(namespace) {\n\n  var prevTime;\n\n  function debug() {\n    // disabled?\n    if (!debug.enabled) return;\n\n    var self = debug;\n\n    // set `diff` timestamp\n    var curr = +new Date();\n    var ms = curr - (prevTime || curr);\n    self.diff = ms;\n    self.prev = prevTime;\n    self.curr = curr;\n    prevTime = curr;\n\n    // turn the `arguments` into a proper Array\n    var args = new Array(arguments.length);\n    for (var i = 0; i < args.length; i++) {\n      args[i] = arguments[i];\n    }\n\n    args[0] = exports.coerce(args[0]);\n\n    if ('string' !== typeof args[0]) {\n      // anything else let's inspect with %O\n      args.unshift('%O');\n    }\n\n    // apply any `formatters` transformations\n    var index = 0;\n    args[0] = args[0].replace(/%([a-zA-Z%])/g, function(match, format) {\n      // if we encounter an escaped % then don't increase the array index\n      if (match === '%%') return match;\n      index++;\n      var formatter = exports.formatters[format];\n      if ('function' === typeof formatter) {\n        var val = args[index];\n        match = formatter.call(self, val);\n\n        // now we need to remove `args[index]` since it's inlined in the `format`\n        args.splice(index, 1);\n        index--;\n      }\n      return match;\n    });\n\n    // apply env-specific formatting (colors, etc.)\n    exports.formatArgs.call(self, args);\n\n    var logFn = debug.log || exports.log || console.log.bind(console);\n    logFn.apply(self, args);\n  }\n\n  debug.namespace = namespace;\n  debug.enabled = exports.enabled(namespace);\n  debug.useColors = exports.useColors();\n  debug.color = selectColor(namespace);\n  debug.destroy = destroy;\n\n  // env-specific initialization logic for debug instances\n  if ('function' === typeof exports.init) {\n    exports.init(debug);\n  }\n\n  exports.instances.push(debug);\n\n  return debug;\n}\n\nfunction destroy () {\n  var index = exports.instances.indexOf(this);\n  if (index !== -1) {\n    exports.instances.splice(index, 1);\n    return true;\n  } else {\n    return false;\n  }\n}\n\n/**\n * Enables a debug mode by namespaces. This can include modes\n * separated by a colon and wildcards.\n *\n * @param {String} namespaces\n * @api public\n */\n\nfunction enable(namespaces) {\n  exports.save(namespaces);\n\n  exports.names = [];\n  exports.skips = [];\n\n  var i;\n  var split = (typeof namespaces === 'string' ? namespaces : '').split(/[\\s,]+/);\n  var len = split.length;\n\n  for (i = 0; i < len; i++) {\n    if (!split[i]) continue; // ignore empty strings\n    namespaces = split[i].replace(/\\*/g, '.*?');\n    if (namespaces[0] === '-') {\n      exports.skips.push(new RegExp('^' + namespaces.substr(1) + '$'));\n    } else {\n      exports.names.push(new RegExp('^' + namespaces + '$'));\n    }\n  }\n\n  for (i = 0; i < exports.instances.length; i++) {\n    var instance = exports.instances[i];\n    instance.enabled = exports.enabled(instance.namespace);\n  }\n}\n\n/**\n * Disable debug output.\n *\n * @api public\n */\n\nfunction disable() {\n  exports.enable('');\n}\n\n/**\n * Returns true if the given mode name is enabled, false otherwise.\n *\n * @param {String} name\n * @return {Boolean}\n * @api public\n */\n\nfunction enabled(name) {\n  if (name[name.length - 1] === '*') {\n    return true;\n  }\n  var i, len;\n  for (i = 0, len = exports.skips.length; i < len; i++) {\n    if (exports.skips[i].test(name)) {\n      return false;\n    }\n  }\n  for (i = 0, len = exports.names.length; i < len; i++) {\n    if (exports.names[i].test(name)) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * Coerce `val`.\n *\n * @param {Mixed} val\n * @return {Mixed}\n * @api private\n */\n\nfunction coerce(val) {\n  if (val instanceof Error) return val.stack || val.message;\n  return val;\n}\n","/**\n * Module requirements.\n */\n\nvar Polling = require('./polling');\nvar inherit = require('component-inherit');\n\n/**\n * Module exports.\n */\n\nmodule.exports = JSONPPolling;\n\n/**\n * Cached regular expressions.\n */\n\nvar rNewline = /\\n/g;\nvar rEscapedNewline = /\\\\n/g;\n\n/**\n * Global JSONP callbacks.\n */\n\nvar callbacks;\n\n/**\n * Noop.\n */\n\nfunction empty () { }\n\n/**\n * Until https://github.com/tc39/proposal-global is shipped.\n */\nfunction glob () {\n  return typeof self !== 'undefined' ? self\n      : typeof window !== 'undefined' ? window\n      : typeof global !== 'undefined' ? global : {};\n}\n\n/**\n * JSONP Polling constructor.\n *\n * @param {Object} opts.\n * @api public\n */\n\nfunction JSONPPolling (opts) {\n  Polling.call(this, opts);\n\n  this.query = this.query || {};\n\n  // define global callbacks array if not present\n  // we do this here (lazily) to avoid unneeded global pollution\n  if (!callbacks) {\n    // we need to consider multiple engines in the same page\n    var global = glob();\n    callbacks = global.___eio = (global.___eio || []);\n  }\n\n  // callback identifier\n  this.index = callbacks.length;\n\n  // add callback to jsonp global\n  var self = this;\n  callbacks.push(function (msg) {\n    self.onData(msg);\n  });\n\n  // append to query string\n  this.query.j = this.index;\n\n  // prevent spurious errors from being emitted when the window is unloaded\n  if (typeof addEventListener === 'function') {\n    addEventListener('beforeunload', function () {\n      if (self.script) self.script.onerror = empty;\n    }, false);\n  }\n}\n\n/**\n * Inherits from Polling.\n */\n\ninherit(JSONPPolling, Polling);\n\n/*\n * JSONP only supports binary as base64 encoded strings\n */\n\nJSONPPolling.prototype.supportsBinary = false;\n\n/**\n * Closes the socket.\n *\n * @api private\n */\n\nJSONPPolling.prototype.doClose = function () {\n  if (this.script) {\n    this.script.parentNode.removeChild(this.script);\n    this.script = null;\n  }\n\n  if (this.form) {\n    this.form.parentNode.removeChild(this.form);\n    this.form = null;\n    this.iframe = null;\n  }\n\n  Polling.prototype.doClose.call(this);\n};\n\n/**\n * Starts a poll cycle.\n *\n * @api private\n */\n\nJSONPPolling.prototype.doPoll = function () {\n  var self = this;\n  var script = document.createElement('script');\n\n  if (this.script) {\n    this.script.parentNode.removeChild(this.script);\n    this.script = null;\n  }\n\n  script.async = true;\n  script.src = this.uri();\n  script.onerror = function (e) {\n    self.onError('jsonp poll error', e);\n  };\n\n  var insertAt = document.getElementsByTagName('script')[0];\n  if (insertAt) {\n    insertAt.parentNode.insertBefore(script, insertAt);\n  } else {\n    (document.head || document.body).appendChild(script);\n  }\n  this.script = script;\n\n  var isUAgecko = 'undefined' !== typeof navigator && /gecko/i.test(navigator.userAgent);\n\n  if (isUAgecko) {\n    setTimeout(function () {\n      var iframe = document.createElement('iframe');\n      document.body.appendChild(iframe);\n      document.body.removeChild(iframe);\n    }, 100);\n  }\n};\n\n/**\n * Writes with a hidden iframe.\n *\n * @param {String} data to send\n * @param {Function} called upon flush.\n * @api private\n */\n\nJSONPPolling.prototype.doWrite = function (data, fn) {\n  var self = this;\n\n  if (!this.form) {\n    var form = document.createElement('form');\n    var area = document.createElement('textarea');\n    var id = this.iframeId = 'eio_iframe_' + this.index;\n    var iframe;\n\n    form.className = 'socketio';\n    form.style.position = 'absolute';\n    form.style.top = '-1000px';\n    form.style.left = '-1000px';\n    form.target = id;\n    form.method = 'POST';\n    form.setAttribute('accept-charset', 'utf-8');\n    area.name = 'd';\n    form.appendChild(area);\n    document.body.appendChild(form);\n\n    this.form = form;\n    this.area = area;\n  }\n\n  this.form.action = this.uri();\n\n  function complete () {\n    initIframe();\n    fn();\n  }\n\n  function initIframe () {\n    if (self.iframe) {\n      try {\n        self.form.removeChild(self.iframe);\n      } catch (e) {\n        self.onError('jsonp polling iframe removal error', e);\n      }\n    }\n\n    try {\n      // ie6 dynamic iframes with target=\"\" support (thanks Chris Lambacher)\n      var html = '<iframe src=\"javascript:0\" name=\"' + self.iframeId + '\">';\n      iframe = document.createElement(html);\n    } catch (e) {\n      iframe = document.createElement('iframe');\n      iframe.name = self.iframeId;\n      iframe.src = 'javascript:0';\n    }\n\n    iframe.id = self.iframeId;\n\n    self.form.appendChild(iframe);\n    self.iframe = iframe;\n  }\n\n  initIframe();\n\n  // escape \\n to prevent it from being converted into \\r\\n by some UAs\n  // double escaping is required for escaped new lines because unescaping of new lines can be done safely on server-side\n  data = data.replace(rEscapedNewline, '\\\\\\n');\n  this.area.value = data.replace(rNewline, '\\\\n');\n\n  try {\n    this.form.submit();\n  } catch (e) {}\n\n  if (this.iframe.attachEvent) {\n    this.iframe.onreadystatechange = function () {\n      if (self.iframe.readyState === 'complete') {\n        complete();\n      }\n    };\n  } else {\n    this.iframe.onload = complete;\n  }\n};\n","/**\n * Module dependencies.\n */\n\nvar Transport = require('../transport');\nvar parser = require('engine.io-parser');\nvar parseqs = require('parseqs');\nvar inherit = require('component-inherit');\nvar yeast = require('yeast');\nvar debug = require('debug')('engine.io-client:websocket');\nvar BrowserWebSocket, NodeWebSocket;\nif (typeof self === 'undefined') {\n  try {\n    NodeWebSocket = require('ws');\n  } catch (e) { }\n} else {\n  BrowserWebSocket = self.WebSocket || self.MozWebSocket;\n}\n\n/**\n * Get either the `WebSocket` or `MozWebSocket` globals\n * in the browser or try to resolve WebSocket-compatible\n * interface exposed by `ws` for Node-like environment.\n */\n\nvar WebSocket = BrowserWebSocket || NodeWebSocket;\n\n/**\n * Module exports.\n */\n\nmodule.exports = WS;\n\n/**\n * WebSocket transport constructor.\n *\n * @api {Object} connection options\n * @api public\n */\n\nfunction WS (opts) {\n  var forceBase64 = (opts && opts.forceBase64);\n  if (forceBase64) {\n    this.supportsBinary = false;\n  }\n  this.perMessageDeflate = opts.perMessageDeflate;\n  this.usingBrowserWebSocket = BrowserWebSocket && !opts.forceNode;\n  this.protocols = opts.protocols;\n  if (!this.usingBrowserWebSocket) {\n    WebSocket = NodeWebSocket;\n  }\n  Transport.call(this, opts);\n}\n\n/**\n * Inherits from Transport.\n */\n\ninherit(WS, Transport);\n\n/**\n * Transport name.\n *\n * @api public\n */\n\nWS.prototype.name = 'websocket';\n\n/*\n * WebSockets support binary\n */\n\nWS.prototype.supportsBinary = true;\n\n/**\n * Opens socket.\n *\n * @api private\n */\n\nWS.prototype.doOpen = function () {\n  if (!this.check()) {\n    // let probe timeout\n    return;\n  }\n\n  var uri = this.uri();\n  var protocols = this.protocols;\n  var opts = {\n    agent: this.agent,\n    perMessageDeflate: this.perMessageDeflate\n  };\n\n  // SSL options for Node.js client\n  opts.pfx = this.pfx;\n  opts.key = this.key;\n  opts.passphrase = this.passphrase;\n  opts.cert = this.cert;\n  opts.ca = this.ca;\n  opts.ciphers = this.ciphers;\n  opts.rejectUnauthorized = this.rejectUnauthorized;\n  if (this.extraHeaders) {\n    opts.headers = this.extraHeaders;\n  }\n  if (this.localAddress) {\n    opts.localAddress = this.localAddress;\n  }\n\n  try {\n    this.ws = this.usingBrowserWebSocket && !this.isReactNative ? (protocols ? new WebSocket(uri, protocols) : new WebSocket(uri)) : new WebSocket(uri, protocols, opts);\n  } catch (err) {\n    return this.emit('error', err);\n  }\n\n  if (this.ws.binaryType === undefined) {\n    this.supportsBinary = false;\n  }\n\n  if (this.ws.supports && this.ws.supports.binary) {\n    this.supportsBinary = true;\n    this.ws.binaryType = 'nodebuffer';\n  } else {\n    this.ws.binaryType = 'arraybuffer';\n  }\n\n  this.addEventListeners();\n};\n\n/**\n * Adds event listeners to the socket\n *\n * @api private\n */\n\nWS.prototype.addEventListeners = function () {\n  var self = this;\n\n  this.ws.onopen = function () {\n    self.onOpen();\n  };\n  this.ws.onclose = function () {\n    self.onClose();\n  };\n  this.ws.onmessage = function (ev) {\n    self.onData(ev.data);\n  };\n  this.ws.onerror = function (e) {\n    self.onError('websocket error', e);\n  };\n};\n\n/**\n * Writes data to socket.\n *\n * @param {Array} array of packets.\n * @api private\n */\n\nWS.prototype.write = function (packets) {\n  var self = this;\n  this.writable = false;\n\n  // encodePacket efficient as it uses WS framing\n  // no need for encodePayload\n  var total = packets.length;\n  for (var i = 0, l = total; i < l; i++) {\n    (function (packet) {\n      parser.encodePacket(packet, self.supportsBinary, function (data) {\n        if (!self.usingBrowserWebSocket) {\n          // always create a new object (GH-437)\n          var opts = {};\n          if (packet.options) {\n            opts.compress = packet.options.compress;\n          }\n\n          if (self.perMessageDeflate) {\n            var len = 'string' === typeof data ? Buffer.byteLength(data) : data.length;\n            if (len < self.perMessageDeflate.threshold) {\n              opts.compress = false;\n            }\n          }\n        }\n\n        // Sometimes the websocket has already been closed but the browser didn't\n        // have a chance of informing us about it yet, in that case send will\n        // throw an error\n        try {\n          if (self.usingBrowserWebSocket) {\n            // TypeError is thrown when passing the second argument on Safari\n            self.ws.send(data);\n          } else {\n            self.ws.send(data, opts);\n          }\n        } catch (e) {\n          debug('websocket closed before onclose event');\n        }\n\n        --total || done();\n      });\n    })(packets[i]);\n  }\n\n  function done () {\n    self.emit('flush');\n\n    // fake drain\n    // defer to next tick to allow Socket to clear writeBuffer\n    setTimeout(function () {\n      self.writable = true;\n      self.emit('drain');\n    }, 0);\n  }\n};\n\n/**\n * Called upon close\n *\n * @api private\n */\n\nWS.prototype.onClose = function () {\n  Transport.prototype.onClose.call(this);\n};\n\n/**\n * Closes socket.\n *\n * @api private\n */\n\nWS.prototype.doClose = function () {\n  if (typeof this.ws !== 'undefined') {\n    this.ws.close();\n  }\n};\n\n/**\n * Generates uri for connection.\n *\n * @api private\n */\n\nWS.prototype.uri = function () {\n  var query = this.query || {};\n  var schema = this.secure ? 'wss' : 'ws';\n  var port = '';\n\n  // avoid port if default for schema\n  if (this.port && (('wss' === schema && Number(this.port) !== 443) ||\n    ('ws' === schema && Number(this.port) !== 80))) {\n    port = ':' + this.port;\n  }\n\n  // append timestamp to URI\n  if (this.timestampRequests) {\n    query[this.timestampParam] = yeast();\n  }\n\n  // communicate binary support capabilities\n  if (!this.supportsBinary) {\n    query.b64 = 1;\n  }\n\n  query = parseqs.encode(query);\n\n  // prepend ? to query\n  if (query.length) {\n    query = '?' + query;\n  }\n\n  var ipv6 = this.hostname.indexOf(':') !== -1;\n  return schema + '://' + (ipv6 ? '[' + this.hostname + ']' : this.hostname) + port + this.path + query;\n};\n\n/**\n * Feature detection for WebSocket.\n *\n * @return {Boolean} whether this transport is available.\n * @api public\n */\n\nWS.prototype.check = function () {\n  return !!WebSocket && !('__initialize' in WebSocket && this.name === WS.prototype.name);\n};\n","module.exports = toArray\n\nfunction toArray(list, index) {\n    var array = []\n\n    index = index || 0\n\n    for (var i = index || 0; i < list.length; i++) {\n        array[i - index] = list[i]\n    }\n\n    return array\n}\n","\n/**\n * Expose `Backoff`.\n */\n\nmodule.exports = Backoff;\n\n/**\n * Initialize backoff timer with `opts`.\n *\n * - `min` initial timeout in milliseconds [100]\n * - `max` max timeout [10000]\n * - `jitter` [0]\n * - `factor` [2]\n *\n * @param {Object} opts\n * @api public\n */\n\nfunction Backoff(opts) {\n  opts = opts || {};\n  this.ms = opts.min || 100;\n  this.max = opts.max || 10000;\n  this.factor = opts.factor || 2;\n  this.jitter = opts.jitter > 0 && opts.jitter <= 1 ? opts.jitter : 0;\n  this.attempts = 0;\n}\n\n/**\n * Return the backoff duration.\n *\n * @return {Number}\n * @api public\n */\n\nBackoff.prototype.duration = function(){\n  var ms = this.ms * Math.pow(this.factor, this.attempts++);\n  if (this.jitter) {\n    var rand =  Math.random();\n    var deviation = Math.floor(rand * this.jitter * ms);\n    ms = (Math.floor(rand * 10) & 1) == 0  ? ms - deviation : ms + deviation;\n  }\n  return Math.min(ms, this.max) | 0;\n};\n\n/**\n * Reset the number of attempts.\n *\n * @api public\n */\n\nBackoff.prototype.reset = function(){\n  this.attempts = 0;\n};\n\n/**\n * Set the minimum duration\n *\n * @api public\n */\n\nBackoff.prototype.setMin = function(min){\n  this.ms = min;\n};\n\n/**\n * Set the maximum duration\n *\n * @api public\n */\n\nBackoff.prototype.setMax = function(max){\n  this.max = max;\n};\n\n/**\n * Set the jitter\n *\n * @api public\n */\n\nBackoff.prototype.setJitter = function(jitter){\n  this.jitter = jitter;\n};\n\n","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.bodyOpenClassName = exports.portalClassName = undefined;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _react = require(\"react\");\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _reactDom = require(\"react-dom\");\n\nvar _reactDom2 = _interopRequireDefault(_reactDom);\n\nvar _propTypes = require(\"prop-types\");\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _ModalPortal = require(\"./ModalPortal\");\n\nvar _ModalPortal2 = _interopRequireDefault(_ModalPortal);\n\nvar _ariaAppHider = require(\"../helpers/ariaAppHider\");\n\nvar ariaAppHider = _interopRequireWildcard(_ariaAppHider);\n\nvar _safeHTMLElement = require(\"../helpers/safeHTMLElement\");\n\nvar _safeHTMLElement2 = _interopRequireDefault(_safeHTMLElement);\n\nvar _reactLifecyclesCompat = require(\"react-lifecycles-compat\");\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar portalClassName = exports.portalClassName = \"ReactModalPortal\";\nvar bodyOpenClassName = exports.bodyOpenClassName = \"ReactModal__Body--open\";\n\nvar isReact16 = _reactDom2.default.createPortal !== undefined;\n\nvar getCreatePortal = function getCreatePortal() {\n  return isReact16 ? _reactDom2.default.createPortal : _reactDom2.default.unstable_renderSubtreeIntoContainer;\n};\n\nfunction getParentElement(parentSelector) {\n  return parentSelector();\n}\n\nvar Modal = function (_Component) {\n  _inherits(Modal, _Component);\n\n  function Modal() {\n    var _ref;\n\n    var _temp, _this, _ret;\n\n    _classCallCheck(this, Modal);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = Modal.__proto__ || Object.getPrototypeOf(Modal)).call.apply(_ref, [this].concat(args))), _this), _this.removePortal = function () {\n      !isReact16 && _reactDom2.default.unmountComponentAtNode(_this.node);\n      var parent = getParentElement(_this.props.parentSelector);\n      parent.removeChild(_this.node);\n    }, _this.portalRef = function (ref) {\n      _this.portal = ref;\n    }, _this.renderPortal = function (props) {\n      var createPortal = getCreatePortal();\n      var portal = createPortal(_this, _react2.default.createElement(_ModalPortal2.default, _extends({ defaultStyles: Modal.defaultStyles }, props)), _this.node);\n      _this.portalRef(portal);\n    }, _temp), _possibleConstructorReturn(_this, _ret);\n  }\n\n  _createClass(Modal, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      if (!_safeHTMLElement.canUseDOM) return;\n\n      if (!isReact16) {\n        this.node = document.createElement(\"div\");\n      }\n      this.node.className = this.props.portalClassName;\n\n      var parent = getParentElement(this.props.parentSelector);\n      parent.appendChild(this.node);\n\n      !isReact16 && this.renderPortal(this.props);\n    }\n  }, {\n    key: \"getSnapshotBeforeUpdate\",\n    value: function getSnapshotBeforeUpdate(prevProps) {\n      var prevParent = getParentElement(prevProps.parentSelector);\n      var nextParent = getParentElement(this.props.parentSelector);\n      return { prevParent: prevParent, nextParent: nextParent };\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, _, snapshot) {\n      if (!_safeHTMLElement.canUseDOM) return;\n      var _props = this.props,\n          isOpen = _props.isOpen,\n          portalClassName = _props.portalClassName;\n\n\n      if (prevProps.portalClassName !== portalClassName) {\n        this.node.className = portalClassName;\n      }\n\n      var prevParent = snapshot.prevParent,\n          nextParent = snapshot.nextParent;\n\n      if (nextParent !== prevParent) {\n        prevParent.removeChild(this.node);\n        nextParent.appendChild(this.node);\n      }\n\n      // Stop unnecessary renders if modal is remaining closed\n      if (!prevProps.isOpen && !isOpen) return;\n\n      !isReact16 && this.renderPortal(this.props);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      if (!_safeHTMLElement.canUseDOM || !this.node || !this.portal) return;\n\n      var state = this.portal.state;\n      var now = Date.now();\n      var closesAt = state.isOpen && this.props.closeTimeoutMS && (state.closesAt || now + this.props.closeTimeoutMS);\n\n      if (closesAt) {\n        if (!state.beforeClose) {\n          this.portal.closeWithTimeout();\n        }\n\n        setTimeout(this.removePortal, closesAt - now);\n      } else {\n        this.removePortal();\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      if (!_safeHTMLElement.canUseDOM || !isReact16) {\n        return null;\n      }\n\n      if (!this.node && isReact16) {\n        this.node = document.createElement(\"div\");\n      }\n\n      var createPortal = getCreatePortal();\n      return createPortal(_react2.default.createElement(_ModalPortal2.default, _extends({\n        ref: this.portalRef,\n        defaultStyles: Modal.defaultStyles\n      }, this.props)), this.node);\n    }\n  }], [{\n    key: \"setAppElement\",\n    value: function setAppElement(element) {\n      ariaAppHider.setElement(element);\n    }\n\n    /* eslint-disable react/no-unused-prop-types */\n\n    /* eslint-enable react/no-unused-prop-types */\n\n  }]);\n\n  return Modal;\n}(_react.Component);\n\nModal.propTypes = {\n  isOpen: _propTypes2.default.bool.isRequired,\n  style: _propTypes2.default.shape({\n    content: _propTypes2.default.object,\n    overlay: _propTypes2.default.object\n  }),\n  portalClassName: _propTypes2.default.string,\n  bodyOpenClassName: _propTypes2.default.string,\n  htmlOpenClassName: _propTypes2.default.string,\n  className: _propTypes2.default.oneOfType([_propTypes2.default.string, _propTypes2.default.shape({\n    base: _propTypes2.default.string.isRequired,\n    afterOpen: _propTypes2.default.string.isRequired,\n    beforeClose: _propTypes2.default.string.isRequired\n  })]),\n  overlayClassName: _propTypes2.default.oneOfType([_propTypes2.default.string, _propTypes2.default.shape({\n    base: _propTypes2.default.string.isRequired,\n    afterOpen: _propTypes2.default.string.isRequired,\n    beforeClose: _propTypes2.default.string.isRequired\n  })]),\n  appElement: _propTypes2.default.instanceOf(_safeHTMLElement2.default),\n  onAfterOpen: _propTypes2.default.func,\n  onRequestClose: _propTypes2.default.func,\n  closeTimeoutMS: _propTypes2.default.number,\n  ariaHideApp: _propTypes2.default.bool,\n  shouldFocusAfterRender: _propTypes2.default.bool,\n  shouldCloseOnOverlayClick: _propTypes2.default.bool,\n  shouldReturnFocusAfterClose: _propTypes2.default.bool,\n  parentSelector: _propTypes2.default.func,\n  aria: _propTypes2.default.object,\n  data: _propTypes2.default.object,\n  role: _propTypes2.default.string,\n  contentLabel: _propTypes2.default.string,\n  shouldCloseOnEsc: _propTypes2.default.bool,\n  overlayRef: _propTypes2.default.func,\n  contentRef: _propTypes2.default.func\n};\nModal.defaultProps = {\n  isOpen: false,\n  portalClassName: portalClassName,\n  bodyOpenClassName: bodyOpenClassName,\n  role: \"dialog\",\n  ariaHideApp: true,\n  closeTimeoutMS: 0,\n  shouldFocusAfterRender: true,\n  shouldCloseOnEsc: true,\n  shouldCloseOnOverlayClick: true,\n  shouldReturnFocusAfterClose: true,\n  parentSelector: function parentSelector() {\n    return document.body;\n  }\n};\nModal.defaultStyles = {\n  overlay: {\n    position: \"fixed\",\n    top: 0,\n    left: 0,\n    right: 0,\n    bottom: 0,\n    backgroundColor: \"rgba(255, 255, 255, 0.75)\"\n  },\n  content: {\n    position: \"absolute\",\n    top: \"40px\",\n    left: \"40px\",\n    right: \"40px\",\n    bottom: \"40px\",\n    border: \"1px solid #ccc\",\n    background: \"#fff\",\n    overflow: \"auto\",\n    WebkitOverflowScrolling: \"touch\",\n    borderRadius: \"4px\",\n    outline: \"none\",\n    padding: \"20px\"\n  }\n};\n\n\n(0, _reactLifecyclesCompat.polyfill)(Modal);\n\nexports.default = Modal;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _react = require(\"react\");\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require(\"prop-types\");\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _focusManager = require(\"../helpers/focusManager\");\n\nvar focusManager = _interopRequireWildcard(_focusManager);\n\nvar _scopeTab = require(\"../helpers/scopeTab\");\n\nvar _scopeTab2 = _interopRequireDefault(_scopeTab);\n\nvar _ariaAppHider = require(\"../helpers/ariaAppHider\");\n\nvar ariaAppHider = _interopRequireWildcard(_ariaAppHider);\n\nvar _classList = require(\"../helpers/classList\");\n\nvar classList = _interopRequireWildcard(_classList);\n\nvar _safeHTMLElement = require(\"../helpers/safeHTMLElement\");\n\nvar _safeHTMLElement2 = _interopRequireDefault(_safeHTMLElement);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n// so that our CSS is statically analyzable\nvar CLASS_NAMES = {\n  overlay: \"ReactModal__Overlay\",\n  content: \"ReactModal__Content\"\n};\n\nvar TAB_KEY = 9;\nvar ESC_KEY = 27;\n\nvar ariaHiddenInstances = 0;\n\nvar ModalPortal = function (_Component) {\n  _inherits(ModalPortal, _Component);\n\n  function ModalPortal(props) {\n    _classCallCheck(this, ModalPortal);\n\n    var _this = _possibleConstructorReturn(this, (ModalPortal.__proto__ || Object.getPrototypeOf(ModalPortal)).call(this, props));\n\n    _this.setOverlayRef = function (overlay) {\n      _this.overlay = overlay;\n      _this.props.overlayRef && _this.props.overlayRef(overlay);\n    };\n\n    _this.setContentRef = function (content) {\n      _this.content = content;\n      _this.props.contentRef && _this.props.contentRef(content);\n    };\n\n    _this.afterClose = function () {\n      var _this$props = _this.props,\n          appElement = _this$props.appElement,\n          ariaHideApp = _this$props.ariaHideApp,\n          htmlOpenClassName = _this$props.htmlOpenClassName,\n          bodyOpenClassName = _this$props.bodyOpenClassName;\n\n      // Remove classes.\n\n      bodyOpenClassName && classList.remove(document.body, bodyOpenClassName);\n\n      htmlOpenClassName && classList.remove(document.getElementsByTagName(\"html\")[0], htmlOpenClassName);\n\n      // Reset aria-hidden attribute if all modals have been removed\n      if (ariaHideApp && ariaHiddenInstances > 0) {\n        ariaHiddenInstances -= 1;\n\n        if (ariaHiddenInstances === 0) {\n          ariaAppHider.show(appElement);\n        }\n      }\n\n      if (_this.props.shouldFocusAfterRender) {\n        if (_this.props.shouldReturnFocusAfterClose) {\n          focusManager.returnFocus();\n          focusManager.teardownScopedFocus();\n        } else {\n          focusManager.popWithoutFocus();\n        }\n      }\n\n      if (_this.props.onAfterClose) {\n        _this.props.onAfterClose();\n      }\n    };\n\n    _this.open = function () {\n      _this.beforeOpen();\n      if (_this.state.afterOpen && _this.state.beforeClose) {\n        clearTimeout(_this.closeTimer);\n        _this.setState({ beforeClose: false });\n      } else {\n        if (_this.props.shouldFocusAfterRender) {\n          focusManager.setupScopedFocus(_this.node);\n          focusManager.markForFocusLater();\n        }\n\n        _this.setState({ isOpen: true }, function () {\n          _this.setState({ afterOpen: true });\n\n          if (_this.props.isOpen && _this.props.onAfterOpen) {\n            _this.props.onAfterOpen({\n              overlayEl: _this.overlay,\n              contentEl: _this.content\n            });\n          }\n        });\n      }\n    };\n\n    _this.close = function () {\n      if (_this.props.closeTimeoutMS > 0) {\n        _this.closeWithTimeout();\n      } else {\n        _this.closeWithoutTimeout();\n      }\n    };\n\n    _this.focusContent = function () {\n      return _this.content && !_this.contentHasFocus() && _this.content.focus();\n    };\n\n    _this.closeWithTimeout = function () {\n      var closesAt = Date.now() + _this.props.closeTimeoutMS;\n      _this.setState({ beforeClose: true, closesAt: closesAt }, function () {\n        _this.closeTimer = setTimeout(_this.closeWithoutTimeout, _this.state.closesAt - Date.now());\n      });\n    };\n\n    _this.closeWithoutTimeout = function () {\n      _this.setState({\n        beforeClose: false,\n        isOpen: false,\n        afterOpen: false,\n        closesAt: null\n      }, _this.afterClose);\n    };\n\n    _this.handleKeyDown = function (event) {\n      if (event.keyCode === TAB_KEY) {\n        (0, _scopeTab2.default)(_this.content, event);\n      }\n\n      if (_this.props.shouldCloseOnEsc && event.keyCode === ESC_KEY) {\n        event.stopPropagation();\n        _this.requestClose(event);\n      }\n    };\n\n    _this.handleOverlayOnClick = function (event) {\n      if (_this.shouldClose === null) {\n        _this.shouldClose = true;\n      }\n\n      if (_this.shouldClose && _this.props.shouldCloseOnOverlayClick) {\n        if (_this.ownerHandlesClose()) {\n          _this.requestClose(event);\n        } else {\n          _this.focusContent();\n        }\n      }\n      _this.shouldClose = null;\n    };\n\n    _this.handleContentOnMouseUp = function () {\n      _this.shouldClose = false;\n    };\n\n    _this.handleOverlayOnMouseDown = function (event) {\n      if (!_this.props.shouldCloseOnOverlayClick && event.target == _this.overlay) {\n        event.preventDefault();\n      }\n    };\n\n    _this.handleContentOnClick = function () {\n      _this.shouldClose = false;\n    };\n\n    _this.handleContentOnMouseDown = function () {\n      _this.shouldClose = false;\n    };\n\n    _this.requestClose = function (event) {\n      return _this.ownerHandlesClose() && _this.props.onRequestClose(event);\n    };\n\n    _this.ownerHandlesClose = function () {\n      return _this.props.onRequestClose;\n    };\n\n    _this.shouldBeClosed = function () {\n      return !_this.state.isOpen && !_this.state.beforeClose;\n    };\n\n    _this.contentHasFocus = function () {\n      return document.activeElement === _this.content || _this.content.contains(document.activeElement);\n    };\n\n    _this.buildClassName = function (which, additional) {\n      var classNames = (typeof additional === \"undefined\" ? \"undefined\" : _typeof(additional)) === \"object\" ? additional : {\n        base: CLASS_NAMES[which],\n        afterOpen: CLASS_NAMES[which] + \"--after-open\",\n        beforeClose: CLASS_NAMES[which] + \"--before-close\"\n      };\n      var className = classNames.base;\n      if (_this.state.afterOpen) {\n        className = className + \" \" + classNames.afterOpen;\n      }\n      if (_this.state.beforeClose) {\n        className = className + \" \" + classNames.beforeClose;\n      }\n      return typeof additional === \"string\" && additional ? className + \" \" + additional : className;\n    };\n\n    _this.attributesFromObject = function (prefix, items) {\n      return Object.keys(items).reduce(function (acc, name) {\n        acc[prefix + \"-\" + name] = items[name];\n        return acc;\n      }, {});\n    };\n\n    _this.state = {\n      afterOpen: false,\n      beforeClose: false\n    };\n\n    _this.shouldClose = null;\n    _this.moveFromContentToOverlay = null;\n    return _this;\n  }\n\n  _createClass(ModalPortal, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      if (this.props.isOpen) {\n        this.open();\n      }\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState) {\n      if (process.env.NODE_ENV !== \"production\") {\n        if (prevProps.bodyOpenClassName !== this.props.bodyOpenClassName) {\n          // eslint-disable-next-line no-console\n          console.warn('React-Modal: \"bodyOpenClassName\" prop has been modified. ' + \"This may cause unexpected behavior when multiple modals are open.\");\n        }\n        if (prevProps.htmlOpenClassName !== this.props.htmlOpenClassName) {\n          // eslint-disable-next-line no-console\n          console.warn('React-Modal: \"htmlOpenClassName\" prop has been modified. ' + \"This may cause unexpected behavior when multiple modals are open.\");\n        }\n      }\n\n      if (this.props.isOpen && !prevProps.isOpen) {\n        this.open();\n      } else if (!this.props.isOpen && prevProps.isOpen) {\n        this.close();\n      }\n\n      // Focus only needs to be set once when the modal is being opened\n      if (this.props.shouldFocusAfterRender && this.state.isOpen && !prevState.isOpen) {\n        this.focusContent();\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      if (this.state.isOpen) {\n        this.afterClose();\n      }\n      clearTimeout(this.closeTimer);\n    }\n  }, {\n    key: \"beforeOpen\",\n    value: function beforeOpen() {\n      var _props = this.props,\n          appElement = _props.appElement,\n          ariaHideApp = _props.ariaHideApp,\n          htmlOpenClassName = _props.htmlOpenClassName,\n          bodyOpenClassName = _props.bodyOpenClassName;\n\n      // Add classes.\n\n      bodyOpenClassName && classList.add(document.body, bodyOpenClassName);\n\n      htmlOpenClassName && classList.add(document.getElementsByTagName(\"html\")[0], htmlOpenClassName);\n\n      if (ariaHideApp) {\n        ariaHiddenInstances += 1;\n        ariaAppHider.hide(appElement);\n      }\n    }\n\n    // Don't steal focus from inner elements\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _props2 = this.props,\n          id = _props2.id,\n          className = _props2.className,\n          overlayClassName = _props2.overlayClassName,\n          defaultStyles = _props2.defaultStyles;\n\n      var contentStyles = className ? {} : defaultStyles.content;\n      var overlayStyles = overlayClassName ? {} : defaultStyles.overlay;\n\n      return this.shouldBeClosed() ? null : _react2.default.createElement(\n        \"div\",\n        {\n          ref: this.setOverlayRef,\n          className: this.buildClassName(\"overlay\", overlayClassName),\n          style: _extends({}, overlayStyles, this.props.style.overlay),\n          onClick: this.handleOverlayOnClick,\n          onMouseDown: this.handleOverlayOnMouseDown\n        },\n        _react2.default.createElement(\n          \"div\",\n          _extends({\n            id: id,\n            ref: this.setContentRef,\n            style: _extends({}, contentStyles, this.props.style.content),\n            className: this.buildClassName(\"content\", className),\n            tabIndex: \"-1\",\n            onKeyDown: this.handleKeyDown,\n            onMouseDown: this.handleContentOnMouseDown,\n            onMouseUp: this.handleContentOnMouseUp,\n            onClick: this.handleContentOnClick,\n            role: this.props.role,\n            \"aria-label\": this.props.contentLabel\n          }, this.attributesFromObject(\"aria\", this.props.aria || {}), this.attributesFromObject(\"data\", this.props.data || {}), {\n            \"data-testid\": this.props.testId\n          }),\n          this.props.children\n        )\n      );\n    }\n  }]);\n\n  return ModalPortal;\n}(_react.Component);\n\nModalPortal.defaultProps = {\n  style: {\n    overlay: {},\n    content: {}\n  },\n  defaultStyles: {}\n};\nModalPortal.propTypes = {\n  isOpen: _propTypes2.default.bool.isRequired,\n  defaultStyles: _propTypes2.default.shape({\n    content: _propTypes2.default.object,\n    overlay: _propTypes2.default.object\n  }),\n  style: _propTypes2.default.shape({\n    content: _propTypes2.default.object,\n    overlay: _propTypes2.default.object\n  }),\n  className: _propTypes2.default.oneOfType([_propTypes2.default.string, _propTypes2.default.object]),\n  overlayClassName: _propTypes2.default.oneOfType([_propTypes2.default.string, _propTypes2.default.object]),\n  bodyOpenClassName: _propTypes2.default.string,\n  htmlOpenClassName: _propTypes2.default.string,\n  ariaHideApp: _propTypes2.default.bool,\n  appElement: _propTypes2.default.instanceOf(_safeHTMLElement2.default),\n  onAfterOpen: _propTypes2.default.func,\n  onAfterClose: _propTypes2.default.func,\n  onRequestClose: _propTypes2.default.func,\n  closeTimeoutMS: _propTypes2.default.number,\n  shouldFocusAfterRender: _propTypes2.default.bool,\n  shouldCloseOnOverlayClick: _propTypes2.default.bool,\n  shouldReturnFocusAfterClose: _propTypes2.default.bool,\n  role: _propTypes2.default.string,\n  contentLabel: _propTypes2.default.string,\n  aria: _propTypes2.default.object,\n  data: _propTypes2.default.object,\n  children: _propTypes2.default.node,\n  shouldCloseOnEsc: _propTypes2.default.bool,\n  overlayRef: _propTypes2.default.func,\n  contentRef: _propTypes2.default.func,\n  id: _propTypes2.default.string,\n  testId: _propTypes2.default.string\n};\nexports.default = ModalPortal;\nmodule.exports = exports[\"default\"];","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.handleBlur = handleBlur;\nexports.handleFocus = handleFocus;\nexports.markForFocusLater = markForFocusLater;\nexports.returnFocus = returnFocus;\nexports.popWithoutFocus = popWithoutFocus;\nexports.setupScopedFocus = setupScopedFocus;\nexports.teardownScopedFocus = teardownScopedFocus;\n\nvar _tabbable = require(\"../helpers/tabbable\");\n\nvar _tabbable2 = _interopRequireDefault(_tabbable);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar focusLaterElements = [];\nvar modalElement = null;\nvar needToFocus = false;\n\nfunction handleBlur() {\n  needToFocus = true;\n}\n\nfunction handleFocus() {\n  if (needToFocus) {\n    needToFocus = false;\n    if (!modalElement) {\n      return;\n    }\n    // need to see how jQuery shims document.on('focusin') so we don't need the\n    // setTimeout, firefox doesn't support focusin, if it did, we could focus\n    // the element outside of a setTimeout. Side-effect of this implementation\n    // is that the document.body gets focus, and then we focus our element right\n    // after, seems fine.\n    setTimeout(function () {\n      if (modalElement.contains(document.activeElement)) {\n        return;\n      }\n      var el = (0, _tabbable2.default)(modalElement)[0] || modalElement;\n      el.focus();\n    }, 0);\n  }\n}\n\nfunction markForFocusLater() {\n  focusLaterElements.push(document.activeElement);\n}\n\n/* eslint-disable no-console */\nfunction returnFocus() {\n  var toFocus = null;\n  try {\n    if (focusLaterElements.length !== 0) {\n      toFocus = focusLaterElements.pop();\n      toFocus.focus();\n    }\n    return;\n  } catch (e) {\n    console.warn([\"You tried to return focus to\", toFocus, \"but it is not in the DOM anymore\"].join(\" \"));\n  }\n}\n/* eslint-enable no-console */\n\nfunction popWithoutFocus() {\n  focusLaterElements.length > 0 && focusLaterElements.pop();\n}\n\nfunction setupScopedFocus(element) {\n  modalElement = element;\n\n  if (window.addEventListener) {\n    window.addEventListener(\"blur\", handleBlur, false);\n    document.addEventListener(\"focus\", handleFocus, true);\n  } else {\n    window.attachEvent(\"onBlur\", handleBlur);\n    document.attachEvent(\"onFocus\", handleFocus);\n  }\n}\n\nfunction teardownScopedFocus() {\n  modalElement = null;\n\n  if (window.addEventListener) {\n    window.removeEventListener(\"blur\", handleBlur);\n    document.removeEventListener(\"focus\", handleFocus);\n  } else {\n    window.detachEvent(\"onBlur\", handleBlur);\n    document.detachEvent(\"onFocus\", handleFocus);\n  }\n}","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = scopeTab;\n\nvar _tabbable = require(\"./tabbable\");\n\nvar _tabbable2 = _interopRequireDefault(_tabbable);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction scopeTab(node, event) {\n  var tabbable = (0, _tabbable2.default)(node);\n\n  if (!tabbable.length) {\n    // Do nothing, since there are no elements that can receive focus.\n    event.preventDefault();\n    return;\n  }\n\n  var shiftKey = event.shiftKey;\n  var head = tabbable[0];\n  var tail = tabbable[tabbable.length - 1];\n\n  // proceed with default browser behavior on tab.\n  // Focus on last element on shift + tab.\n  if (node === document.activeElement) {\n    if (!shiftKey) return;\n    target = tail;\n  }\n\n  var target;\n  if (tail === document.activeElement && !shiftKey) {\n    target = head;\n  }\n\n  if (head === document.activeElement && shiftKey) {\n    target = tail;\n  }\n\n  if (target) {\n    event.preventDefault();\n    target.focus();\n    return;\n  }\n\n  // Safari radio issue.\n  //\n  // Safari does not move the focus to the radio button,\n  // so we need to force it to really walk through all elements.\n  //\n  // This is very error prone, since we are trying to guess\n  // if it is a safari browser from the first occurence between\n  // chrome or safari.\n  //\n  // The chrome user agent contains the first ocurrence\n  // as the 'chrome/version' and later the 'safari/version'.\n  var checkSafari = /(\\bChrome\\b|\\bSafari\\b)\\//.exec(navigator.userAgent);\n  var isSafariDesktop = checkSafari != null && checkSafari[1] != \"Chrome\" && /\\biPod\\b|\\biPad\\b/g.exec(navigator.userAgent) == null;\n\n  // If we are not in safari desktop, let the browser control\n  // the focus\n  if (!isSafariDesktop) return;\n\n  var x = tabbable.indexOf(document.activeElement);\n\n  if (x > -1) {\n    x += shiftKey ? -1 : 1;\n  }\n\n  // If the tabbable element does not exist,\n  // focus head/tail based on shiftKey\n  if (typeof tabbable[x] === \"undefined\") {\n    event.preventDefault();\n    target = shiftKey ? tail : head;\n    target.focus();\n    return;\n  }\n\n  event.preventDefault();\n\n  tabbable[x].focus();\n}\nmodule.exports = exports[\"default\"];","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\n/**\n * Similar to invariant but only logs a warning if the condition is not met.\n * This can be used to log issues in development environments in critical\n * paths. Removing the logging code for production environments will keep the\n * same logic and follow the same code paths.\n */\n\nvar __DEV__ = process.env.NODE_ENV !== 'production';\n\nvar warning = function() {};\n\nif (__DEV__) {\n  var printWarning = function printWarning(format, args) {\n    var len = arguments.length;\n    args = new Array(len > 1 ? len - 1 : 0);\n    for (var key = 1; key < len; key++) {\n      args[key - 1] = arguments[key];\n    }\n    var argIndex = 0;\n    var message = 'Warning: ' +\n      format.replace(/%s/g, function() {\n        return args[argIndex++];\n      });\n    if (typeof console !== 'undefined') {\n      console.error(message);\n    }\n    try {\n      // --- Welcome to debugging React ---\n      // This error was thrown as a convenience so that you can use this stack\n      // to find the callsite that caused this warning to fire.\n      throw new Error(message);\n    } catch (x) {}\n  }\n\n  warning = function(condition, format, args) {\n    var len = arguments.length;\n    args = new Array(len > 2 ? len - 2 : 0);\n    for (var key = 2; key < len; key++) {\n      args[key - 2] = arguments[key];\n    }\n    if (format === undefined) {\n      throw new Error(\n          '`warning(condition, format, ...args)` requires a warning ' +\n          'message argument'\n      );\n    }\n    if (!condition) {\n      printWarning.apply(null, [format].concat(args));\n    }\n  };\n}\n\nmodule.exports = warning;\n","/*!\n  Copyright (c) 2015 Jed Watson.\n  Based on code that is Copyright 2013-2015, Facebook, Inc.\n  All rights reserved.\n*/\n/* global define */\n\n(function () {\n\t'use strict';\n\n\tvar canUseDOM = !!(\n\t\ttypeof window !== 'undefined' &&\n\t\twindow.document &&\n\t\twindow.document.createElement\n\t);\n\n\tvar ExecutionEnvironment = {\n\n\t\tcanUseDOM: canUseDOM,\n\n\t\tcanUseWorkers: typeof Worker !== 'undefined',\n\n\t\tcanUseEventListeners:\n\t\t\tcanUseDOM && !!(window.addEventListener || window.attachEvent),\n\n\t\tcanUseViewport: canUseDOM && !!window.screen\n\n\t};\n\n\tif (typeof define === 'function' && typeof define.amd === 'object' && define.amd) {\n\t\tdefine(function () {\n\t\t\treturn ExecutionEnvironment;\n\t\t});\n\t} else if (typeof module !== 'undefined' && module.exports) {\n\t\tmodule.exports = ExecutionEnvironment;\n\t} else {\n\t\twindow.ExecutionEnvironment = ExecutionEnvironment;\n\t}\n\n}());\n","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.dumpClassLists = dumpClassLists;\nvar htmlClassList = {};\nvar docBodyClassList = {};\n\nfunction dumpClassLists() {\n  if (process.env.NODE_ENV !== \"production\") {\n    var classes = document.getElementsByTagName(\"html\")[0].className;\n    var buffer = \"Show tracked classes:\\n\\n\";\n\n    buffer += \"<html /> (\" + classes + \"):\\n\";\n    for (var x in htmlClassList) {\n      buffer += \"  \" + x + \" \" + htmlClassList[x] + \"\\n\";\n    }\n\n    classes = document.body.className;\n\n    // eslint-disable-next-line max-len\n    buffer += \"\\n\\ndoc.body (\" + classes + \"):\\n\";\n    for (var _x in docBodyClassList) {\n      buffer += \"  \" + _x + \" \" + docBodyClassList[_x] + \"\\n\";\n    }\n\n    buffer += \"\\n\";\n\n    // eslint-disable-next-line no-console\n    console.log(buffer);\n  }\n}\n\n/**\n * Track the number of reference of a class.\n * @param {object} poll The poll to receive the reference.\n * @param {string} className The class name.\n * @return {string}\n */\nvar incrementReference = function incrementReference(poll, className) {\n  if (!poll[className]) {\n    poll[className] = 0;\n  }\n  poll[className] += 1;\n  return className;\n};\n\n/**\n * Drop the reference of a class.\n * @param {object} poll The poll to receive the reference.\n * @param {string} className The class name.\n * @return {string}\n */\nvar decrementReference = function decrementReference(poll, className) {\n  if (poll[className]) {\n    poll[className] -= 1;\n  }\n  return className;\n};\n\n/**\n * Track a class and add to the given class list.\n * @param {Object} classListRef A class list of an element.\n * @param {Object} poll         The poll to be used.\n * @param {Array}  classes      The list of classes to be tracked.\n */\nvar trackClass = function trackClass(classListRef, poll, classes) {\n  classes.forEach(function (className) {\n    incrementReference(poll, className);\n    classListRef.add(className);\n  });\n};\n\n/**\n * Untrack a class and remove from the given class list if the reference\n * reaches 0.\n * @param {Object} classListRef A class list of an element.\n * @param {Object} poll         The poll to be used.\n * @param {Array}  classes      The list of classes to be untracked.\n */\nvar untrackClass = function untrackClass(classListRef, poll, classes) {\n  classes.forEach(function (className) {\n    decrementReference(poll, className);\n    poll[className] === 0 && classListRef.remove(className);\n  });\n};\n\n/**\n * Public inferface to add classes to the document.body.\n * @param {string} bodyClass The class string to be added.\n *                           It may contain more then one class\n *                           with ' ' as separator.\n */\nvar add = exports.add = function add(element, classString) {\n  return trackClass(element.classList, element.nodeName.toLowerCase() == \"html\" ? htmlClassList : docBodyClassList, classString.split(\" \"));\n};\n\n/**\n * Public inferface to remove classes from the document.body.\n * @param {string} bodyClass The class string to be added.\n *                           It may contain more then one class\n *                           with ' ' as separator.\n */\nvar remove = exports.remove = function remove(element, classString) {\n  return untrackClass(element.classList, element.nodeName.toLowerCase() == \"html\" ? htmlClassList : docBodyClassList, classString.split(\" \"));\n};","module.exports = require(\"regenerator-runtime\");\n","import assign from 'object-assign';\n\nimport { store } from './helpers';\n\nexport const MENU_SHOW = 'REACT_CONTEXTMENU_SHOW';\nexport const MENU_HIDE = 'REACT_CONTEXTMENU_HIDE';\n\n\nexport function dispatchGlobalEvent(eventName, opts, target = window) {\n  // Compatibale with IE\n  // @see http://stackoverflow.com/questions/26596123/internet-explorer-9-10-11-event-constructor-doesnt-work\n  let event;\n\n  if (typeof window.CustomEvent === 'function') {\n    event = new window.CustomEvent(eventName, { detail: opts });\n  } else {\n    event = document.createEvent('CustomEvent');\n    event.initCustomEvent(eventName, false, true, opts);\n  }\n\n  if (target) {\n    target.dispatchEvent(event);\n    assign(store, opts);\n  }\n}\n\nexport function showMenu(opts = {}, target) {\n  dispatchGlobalEvent(MENU_SHOW, assign({}, opts, { type: MENU_SHOW }), target);\n}\n\nexport function hideMenu(opts = {}, target) {\n  dispatchGlobalEvent(MENU_HIDE, assign({}, opts, { type: MENU_HIDE }), target);\n}\n","export function callIfExists(func, ...args) {\n  return (typeof func === 'function') && func(...args);\n}\n\nexport function hasOwnProp(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nexport function uniqueId() {\n  return Math.random().toString(36).substring(7);\n}\n\nexport const store = {};\n\nexport const canUseDOM = Boolean(\n  typeof window !== 'undefined' && window.document && window.document.createElement\n);\n","\r\n/**\r\n * Expose `Emitter`.\r\n */\r\n\r\nif (typeof module !== 'undefined') {\r\n  module.exports = Emitter;\r\n}\r\n\r\n/**\r\n * Initialize a new `Emitter`.\r\n *\r\n * @api public\r\n */\r\n\r\nfunction Emitter(obj) {\r\n  if (obj) return mixin(obj);\r\n};\r\n\r\n/**\r\n * Mixin the emitter properties.\r\n *\r\n * @param {Object} obj\r\n * @return {Object}\r\n * @api private\r\n */\r\n\r\nfunction mixin(obj) {\r\n  for (var key in Emitter.prototype) {\r\n    obj[key] = Emitter.prototype[key];\r\n  }\r\n  return obj;\r\n}\r\n\r\n/**\r\n * Listen on the given `event` with `fn`.\r\n *\r\n * @param {String} event\r\n * @param {Function} fn\r\n * @return {Emitter}\r\n * @api public\r\n */\r\n\r\nEmitter.prototype.on =\r\nEmitter.prototype.addEventListener = function(event, fn){\r\n  this._callbacks = this._callbacks || {};\r\n  (this._callbacks['$' + event] = this._callbacks['$' + event] || [])\r\n    .push(fn);\r\n  return this;\r\n};\r\n\r\n/**\r\n * Adds an `event` listener that will be invoked a single\r\n * time then automatically removed.\r\n *\r\n * @param {String} event\r\n * @param {Function} fn\r\n * @return {Emitter}\r\n * @api public\r\n */\r\n\r\nEmitter.prototype.once = function(event, fn){\r\n  function on() {\r\n    this.off(event, on);\r\n    fn.apply(this, arguments);\r\n  }\r\n\r\n  on.fn = fn;\r\n  this.on(event, on);\r\n  return this;\r\n};\r\n\r\n/**\r\n * Remove the given callback for `event` or all\r\n * registered callbacks.\r\n *\r\n * @param {String} event\r\n * @param {Function} fn\r\n * @return {Emitter}\r\n * @api public\r\n */\r\n\r\nEmitter.prototype.off =\r\nEmitter.prototype.removeListener =\r\nEmitter.prototype.removeAllListeners =\r\nEmitter.prototype.removeEventListener = function(event, fn){\r\n  this._callbacks = this._callbacks || {};\r\n\r\n  // all\r\n  if (0 == arguments.length) {\r\n    this._callbacks = {};\r\n    return this;\r\n  }\r\n\r\n  // specific event\r\n  var callbacks = this._callbacks['$' + event];\r\n  if (!callbacks) return this;\r\n\r\n  // remove all handlers\r\n  if (1 == arguments.length) {\r\n    delete this._callbacks['$' + event];\r\n    return this;\r\n  }\r\n\r\n  // remove specific handler\r\n  var cb;\r\n  for (var i = 0; i < callbacks.length; i++) {\r\n    cb = callbacks[i];\r\n    if (cb === fn || cb.fn === fn) {\r\n      callbacks.splice(i, 1);\r\n      break;\r\n    }\r\n  }\r\n  return this;\r\n};\r\n\r\n/**\r\n * Emit `event` with the given args.\r\n *\r\n * @param {String} event\r\n * @param {Mixed} ...\r\n * @return {Emitter}\r\n */\r\n\r\nEmitter.prototype.emit = function(event){\r\n  this._callbacks = this._callbacks || {};\r\n  var args = [].slice.call(arguments, 1)\r\n    , callbacks = this._callbacks['$' + event];\r\n\r\n  if (callbacks) {\r\n    callbacks = callbacks.slice(0);\r\n    for (var i = 0, len = callbacks.length; i < len; ++i) {\r\n      callbacks[i].apply(this, args);\r\n    }\r\n  }\r\n\r\n  return this;\r\n};\r\n\r\n/**\r\n * Return array of callbacks for `event`.\r\n *\r\n * @param {String} event\r\n * @return {Array}\r\n * @api public\r\n */\r\n\r\nEmitter.prototype.listeners = function(event){\r\n  this._callbacks = this._callbacks || {};\r\n  return this._callbacks['$' + event] || [];\r\n};\r\n\r\n/**\r\n * Check if this emitter has `event` handlers.\r\n *\r\n * @param {String} event\r\n * @return {Boolean}\r\n * @api public\r\n */\r\n\r\nEmitter.prototype.hasListeners = function(event){\r\n  return !! this.listeners(event).length;\r\n};\r\n","/**\n * Module dependencies.\n */\n\nvar keys = require('./keys');\nvar hasBinary = require('has-binary2');\nvar sliceBuffer = require('arraybuffer.slice');\nvar after = require('after');\nvar utf8 = require('./utf8');\n\nvar base64encoder;\nif (typeof ArrayBuffer !== 'undefined') {\n  base64encoder = require('base64-arraybuffer');\n}\n\n/**\n * Check if we are running an android browser. That requires us to use\n * ArrayBuffer with polling transports...\n *\n * http://ghinda.net/jpeg-blob-ajax-android/\n */\n\nvar isAndroid = typeof navigator !== 'undefined' && /Android/i.test(navigator.userAgent);\n\n/**\n * Check if we are running in PhantomJS.\n * Uploading a Blob with PhantomJS does not work correctly, as reported here:\n * https://github.com/ariya/phantomjs/issues/11395\n * @type boolean\n */\nvar isPhantomJS = typeof navigator !== 'undefined' && /PhantomJS/i.test(navigator.userAgent);\n\n/**\n * When true, avoids using Blobs to encode payloads.\n * @type boolean\n */\nvar dontSendBlobs = isAndroid || isPhantomJS;\n\n/**\n * Current protocol version.\n */\n\nexports.protocol = 3;\n\n/**\n * Packet types.\n */\n\nvar packets = exports.packets = {\n    open:     0    // non-ws\n  , close:    1    // non-ws\n  , ping:     2\n  , pong:     3\n  , message:  4\n  , upgrade:  5\n  , noop:     6\n};\n\nvar packetslist = keys(packets);\n\n/**\n * Premade error packet.\n */\n\nvar err = { type: 'error', data: 'parser error' };\n\n/**\n * Create a blob api even for blob builder when vendor prefixes exist\n */\n\nvar Blob = require('blob');\n\n/**\n * Encodes a packet.\n *\n *     <packet type id> [ <data> ]\n *\n * Example:\n *\n *     5hello world\n *     3\n *     4\n *\n * Binary is encoded in an identical principle\n *\n * @api private\n */\n\nexports.encodePacket = function (packet, supportsBinary, utf8encode, callback) {\n  if (typeof supportsBinary === 'function') {\n    callback = supportsBinary;\n    supportsBinary = false;\n  }\n\n  if (typeof utf8encode === 'function') {\n    callback = utf8encode;\n    utf8encode = null;\n  }\n\n  var data = (packet.data === undefined)\n    ? undefined\n    : packet.data.buffer || packet.data;\n\n  if (typeof ArrayBuffer !== 'undefined' && data instanceof ArrayBuffer) {\n    return encodeArrayBuffer(packet, supportsBinary, callback);\n  } else if (typeof Blob !== 'undefined' && data instanceof Blob) {\n    return encodeBlob(packet, supportsBinary, callback);\n  }\n\n  // might be an object with { base64: true, data: dataAsBase64String }\n  if (data && data.base64) {\n    return encodeBase64Object(packet, callback);\n  }\n\n  // Sending data as a utf-8 string\n  var encoded = packets[packet.type];\n\n  // data fragment is optional\n  if (undefined !== packet.data) {\n    encoded += utf8encode ? utf8.encode(String(packet.data), { strict: false }) : String(packet.data);\n  }\n\n  return callback('' + encoded);\n\n};\n\nfunction encodeBase64Object(packet, callback) {\n  // packet data is an object { base64: true, data: dataAsBase64String }\n  var message = 'b' + exports.packets[packet.type] + packet.data.data;\n  return callback(message);\n}\n\n/**\n * Encode packet helpers for binary types\n */\n\nfunction encodeArrayBuffer(packet, supportsBinary, callback) {\n  if (!supportsBinary) {\n    return exports.encodeBase64Packet(packet, callback);\n  }\n\n  var data = packet.data;\n  var contentArray = new Uint8Array(data);\n  var resultBuffer = new Uint8Array(1 + data.byteLength);\n\n  resultBuffer[0] = packets[packet.type];\n  for (var i = 0; i < contentArray.length; i++) {\n    resultBuffer[i+1] = contentArray[i];\n  }\n\n  return callback(resultBuffer.buffer);\n}\n\nfunction encodeBlobAsArrayBuffer(packet, supportsBinary, callback) {\n  if (!supportsBinary) {\n    return exports.encodeBase64Packet(packet, callback);\n  }\n\n  var fr = new FileReader();\n  fr.onload = function() {\n    exports.encodePacket({ type: packet.type, data: fr.result }, supportsBinary, true, callback);\n  };\n  return fr.readAsArrayBuffer(packet.data);\n}\n\nfunction encodeBlob(packet, supportsBinary, callback) {\n  if (!supportsBinary) {\n    return exports.encodeBase64Packet(packet, callback);\n  }\n\n  if (dontSendBlobs) {\n    return encodeBlobAsArrayBuffer(packet, supportsBinary, callback);\n  }\n\n  var length = new Uint8Array(1);\n  length[0] = packets[packet.type];\n  var blob = new Blob([length.buffer, packet.data]);\n\n  return callback(blob);\n}\n\n/**\n * Encodes a packet with binary data in a base64 string\n *\n * @param {Object} packet, has `type` and `data`\n * @return {String} base64 encoded message\n */\n\nexports.encodeBase64Packet = function(packet, callback) {\n  var message = 'b' + exports.packets[packet.type];\n  if (typeof Blob !== 'undefined' && packet.data instanceof Blob) {\n    var fr = new FileReader();\n    fr.onload = function() {\n      var b64 = fr.result.split(',')[1];\n      callback(message + b64);\n    };\n    return fr.readAsDataURL(packet.data);\n  }\n\n  var b64data;\n  try {\n    b64data = String.fromCharCode.apply(null, new Uint8Array(packet.data));\n  } catch (e) {\n    // iPhone Safari doesn't let you apply with typed arrays\n    var typed = new Uint8Array(packet.data);\n    var basic = new Array(typed.length);\n    for (var i = 0; i < typed.length; i++) {\n      basic[i] = typed[i];\n    }\n    b64data = String.fromCharCode.apply(null, basic);\n  }\n  message += btoa(b64data);\n  return callback(message);\n};\n\n/**\n * Decodes a packet. Changes format to Blob if requested.\n *\n * @return {Object} with `type` and `data` (if any)\n * @api private\n */\n\nexports.decodePacket = function (data, binaryType, utf8decode) {\n  if (data === undefined) {\n    return err;\n  }\n  // String data\n  if (typeof data === 'string') {\n    if (data.charAt(0) === 'b') {\n      return exports.decodeBase64Packet(data.substr(1), binaryType);\n    }\n\n    if (utf8decode) {\n      data = tryDecode(data);\n      if (data === false) {\n        return err;\n      }\n    }\n    var type = data.charAt(0);\n\n    if (Number(type) != type || !packetslist[type]) {\n      return err;\n    }\n\n    if (data.length > 1) {\n      return { type: packetslist[type], data: data.substring(1) };\n    } else {\n      return { type: packetslist[type] };\n    }\n  }\n\n  var asArray = new Uint8Array(data);\n  var type = asArray[0];\n  var rest = sliceBuffer(data, 1);\n  if (Blob && binaryType === 'blob') {\n    rest = new Blob([rest]);\n  }\n  return { type: packetslist[type], data: rest };\n};\n\nfunction tryDecode(data) {\n  try {\n    data = utf8.decode(data, { strict: false });\n  } catch (e) {\n    return false;\n  }\n  return data;\n}\n\n/**\n * Decodes a packet encoded in a base64 string\n *\n * @param {String} base64 encoded message\n * @return {Object} with `type` and `data` (if any)\n */\n\nexports.decodeBase64Packet = function(msg, binaryType) {\n  var type = packetslist[msg.charAt(0)];\n  if (!base64encoder) {\n    return { type: type, data: { base64: true, data: msg.substr(1) } };\n  }\n\n  var data = base64encoder.decode(msg.substr(1));\n\n  if (binaryType === 'blob' && Blob) {\n    data = new Blob([data]);\n  }\n\n  return { type: type, data: data };\n};\n\n/**\n * Encodes multiple messages (payload).\n *\n *     <length>:data\n *\n * Example:\n *\n *     11:hello world2:hi\n *\n * If any contents are binary, they will be encoded as base64 strings. Base64\n * encoded strings are marked with a b before the length specifier\n *\n * @param {Array} packets\n * @api private\n */\n\nexports.encodePayload = function (packets, supportsBinary, callback) {\n  if (typeof supportsBinary === 'function') {\n    callback = supportsBinary;\n    supportsBinary = null;\n  }\n\n  var isBinary = hasBinary(packets);\n\n  if (supportsBinary && isBinary) {\n    if (Blob && !dontSendBlobs) {\n      return exports.encodePayloadAsBlob(packets, callback);\n    }\n\n    return exports.encodePayloadAsArrayBuffer(packets, callback);\n  }\n\n  if (!packets.length) {\n    return callback('0:');\n  }\n\n  function setLengthHeader(message) {\n    return message.length + ':' + message;\n  }\n\n  function encodeOne(packet, doneCallback) {\n    exports.encodePacket(packet, !isBinary ? false : supportsBinary, false, function(message) {\n      doneCallback(null, setLengthHeader(message));\n    });\n  }\n\n  map(packets, encodeOne, function(err, results) {\n    return callback(results.join(''));\n  });\n};\n\n/**\n * Async array map using after\n */\n\nfunction map(ary, each, done) {\n  var result = new Array(ary.length);\n  var next = after(ary.length, done);\n\n  var eachWithIndex = function(i, el, cb) {\n    each(el, function(error, msg) {\n      result[i] = msg;\n      cb(error, result);\n    });\n  };\n\n  for (var i = 0; i < ary.length; i++) {\n    eachWithIndex(i, ary[i], next);\n  }\n}\n\n/*\n * Decodes data when a payload is maybe expected. Possible binary contents are\n * decoded from their base64 representation\n *\n * @param {String} data, callback method\n * @api public\n */\n\nexports.decodePayload = function (data, binaryType, callback) {\n  if (typeof data !== 'string') {\n    return exports.decodePayloadAsBinary(data, binaryType, callback);\n  }\n\n  if (typeof binaryType === 'function') {\n    callback = binaryType;\n    binaryType = null;\n  }\n\n  var packet;\n  if (data === '') {\n    // parser error - ignoring payload\n    return callback(err, 0, 1);\n  }\n\n  var length = '', n, msg;\n\n  for (var i = 0, l = data.length; i < l; i++) {\n    var chr = data.charAt(i);\n\n    if (chr !== ':') {\n      length += chr;\n      continue;\n    }\n\n    if (length === '' || (length != (n = Number(length)))) {\n      // parser error - ignoring payload\n      return callback(err, 0, 1);\n    }\n\n    msg = data.substr(i + 1, n);\n\n    if (length != msg.length) {\n      // parser error - ignoring payload\n      return callback(err, 0, 1);\n    }\n\n    if (msg.length) {\n      packet = exports.decodePacket(msg, binaryType, false);\n\n      if (err.type === packet.type && err.data === packet.data) {\n        // parser error in individual packet - ignoring payload\n        return callback(err, 0, 1);\n      }\n\n      var ret = callback(packet, i + n, l);\n      if (false === ret) return;\n    }\n\n    // advance cursor\n    i += n;\n    length = '';\n  }\n\n  if (length !== '') {\n    // parser error - ignoring payload\n    return callback(err, 0, 1);\n  }\n\n};\n\n/**\n * Encodes multiple messages (payload) as binary.\n *\n * <1 = binary, 0 = string><number from 0-9><number from 0-9>[...]<number\n * 255><data>\n *\n * Example:\n * 1 3 255 1 2 3, if the binary contents are interpreted as 8 bit integers\n *\n * @param {Array} packets\n * @return {ArrayBuffer} encoded payload\n * @api private\n */\n\nexports.encodePayloadAsArrayBuffer = function(packets, callback) {\n  if (!packets.length) {\n    return callback(new ArrayBuffer(0));\n  }\n\n  function encodeOne(packet, doneCallback) {\n    exports.encodePacket(packet, true, true, function(data) {\n      return doneCallback(null, data);\n    });\n  }\n\n  map(packets, encodeOne, function(err, encodedPackets) {\n    var totalLength = encodedPackets.reduce(function(acc, p) {\n      var len;\n      if (typeof p === 'string'){\n        len = p.length;\n      } else {\n        len = p.byteLength;\n      }\n      return acc + len.toString().length + len + 2; // string/binary identifier + separator = 2\n    }, 0);\n\n    var resultArray = new Uint8Array(totalLength);\n\n    var bufferIndex = 0;\n    encodedPackets.forEach(function(p) {\n      var isString = typeof p === 'string';\n      var ab = p;\n      if (isString) {\n        var view = new Uint8Array(p.length);\n        for (var i = 0; i < p.length; i++) {\n          view[i] = p.charCodeAt(i);\n        }\n        ab = view.buffer;\n      }\n\n      if (isString) { // not true binary\n        resultArray[bufferIndex++] = 0;\n      } else { // true binary\n        resultArray[bufferIndex++] = 1;\n      }\n\n      var lenStr = ab.byteLength.toString();\n      for (var i = 0; i < lenStr.length; i++) {\n        resultArray[bufferIndex++] = parseInt(lenStr[i]);\n      }\n      resultArray[bufferIndex++] = 255;\n\n      var view = new Uint8Array(ab);\n      for (var i = 0; i < view.length; i++) {\n        resultArray[bufferIndex++] = view[i];\n      }\n    });\n\n    return callback(resultArray.buffer);\n  });\n};\n\n/**\n * Encode as Blob\n */\n\nexports.encodePayloadAsBlob = function(packets, callback) {\n  function encodeOne(packet, doneCallback) {\n    exports.encodePacket(packet, true, true, function(encoded) {\n      var binaryIdentifier = new Uint8Array(1);\n      binaryIdentifier[0] = 1;\n      if (typeof encoded === 'string') {\n        var view = new Uint8Array(encoded.length);\n        for (var i = 0; i < encoded.length; i++) {\n          view[i] = encoded.charCodeAt(i);\n        }\n        encoded = view.buffer;\n        binaryIdentifier[0] = 0;\n      }\n\n      var len = (encoded instanceof ArrayBuffer)\n        ? encoded.byteLength\n        : encoded.size;\n\n      var lenStr = len.toString();\n      var lengthAry = new Uint8Array(lenStr.length + 1);\n      for (var i = 0; i < lenStr.length; i++) {\n        lengthAry[i] = parseInt(lenStr[i]);\n      }\n      lengthAry[lenStr.length] = 255;\n\n      if (Blob) {\n        var blob = new Blob([binaryIdentifier.buffer, lengthAry.buffer, encoded]);\n        doneCallback(null, blob);\n      }\n    });\n  }\n\n  map(packets, encodeOne, function(err, results) {\n    return callback(new Blob(results));\n  });\n};\n\n/*\n * Decodes data when a payload is maybe expected. Strings are decoded by\n * interpreting each byte as a key code for entries marked to start with 0. See\n * description of encodePayloadAsBinary\n *\n * @param {ArrayBuffer} data, callback method\n * @api public\n */\n\nexports.decodePayloadAsBinary = function (data, binaryType, callback) {\n  if (typeof binaryType === 'function') {\n    callback = binaryType;\n    binaryType = null;\n  }\n\n  var bufferTail = data;\n  var buffers = [];\n\n  while (bufferTail.byteLength > 0) {\n    var tailArray = new Uint8Array(bufferTail);\n    var isString = tailArray[0] === 0;\n    var msgLength = '';\n\n    for (var i = 1; ; i++) {\n      if (tailArray[i] === 255) break;\n\n      // 310 = char length of Number.MAX_VALUE\n      if (msgLength.length > 310) {\n        return callback(err, 0, 1);\n      }\n\n      msgLength += tailArray[i];\n    }\n\n    bufferTail = sliceBuffer(bufferTail, 2 + msgLength.length);\n    msgLength = parseInt(msgLength);\n\n    var msg = sliceBuffer(bufferTail, 0, msgLength);\n    if (isString) {\n      try {\n        msg = String.fromCharCode.apply(null, new Uint8Array(msg));\n      } catch (e) {\n        // iPhone Safari doesn't let you apply to typed arrays\n        var typed = new Uint8Array(msg);\n        msg = '';\n        for (var i = 0; i < typed.length; i++) {\n          msg += String.fromCharCode(typed[i]);\n        }\n      }\n    }\n\n    buffers.push(msg);\n    bufferTail = sliceBuffer(bufferTail, msgLength);\n  }\n\n  var total = buffers.length;\n  buffers.forEach(function(buffer, i) {\n    callback(exports.decodePacket(buffer, binaryType, true), i, total);\n  });\n};\n","import React, { Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\nimport { gettext } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport RepoTag from '../../models/repo-tag';\nimport CreateTagDialog from './create-tag-dialog';\nimport toaster from '../toast';\nrequire('../../css/repo-tag.css');\n\nconst TagItemPropTypes = {\n  repoID: PropTypes.string.isRequired,\n  repoTag: PropTypes.object.isRequired,\n  filePath: PropTypes.string.isRequired,\n  fileTagList: PropTypes.array.isRequired,\n  onFileTagChanged: PropTypes.func.isRequired,\n};\n\nclass TagItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      showSelectedTag: false\n    };\n  }\n\n  onMouseEnter = () => {\n    this.setState({\n      showSelectedTag: true\n    });\n  }\n\n  onMouseLeave = () => {\n    this.setState({\n      showSelectedTag: false\n    });\n  }\n\n  getRepoTagIdList = () => {\n    let repoTagIdList = [];\n    let fileTagList = this.props.fileTagList;\n    fileTagList.map((fileTag) => {\n      repoTagIdList.push(fileTag.repo_tag_id);\n    });\n    return repoTagIdList;\n  }\n\n  onEditFileTag = () => {\n    let { repoID, repoTag, filePath } = this.props;\n    let repoTagIdList = this.getRepoTagIdList();\n    if (repoTagIdList.indexOf(repoTag.id) === -1) {\n      let id = repoTag.id;\n      seafileAPI.addFileTag(repoID, filePath, id).then(() => {\n        repoTagIdList = this.getRepoTagIdList();\n        this.props.onFileTagChanged();\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    } else {\n      let fileTag = null;\n      let fileTagList = this.props.fileTagList;\n      for(let i = 0; i < fileTagList.length; i++) {\n        if (fileTagList[i].repo_tag_id === repoTag.id) {\n          fileTag = fileTagList[i];\n          break;\n        }\n      }\n      seafileAPI.deleteFileTag(repoID, fileTag.id).then(() => {\n        repoTagIdList = this.getRepoTagIdList();\n        this.props.onFileTagChanged();\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    }\n  }\n\n  render() {\n    let repoTag = this.props.repoTag;\n    let repoTagIdList = this.getRepoTagIdList();\n    let drakColor = Utils.getDarkColor(repoTag.color);\n    return (\n      <li key={repoTag.id} className=\"tag-list-item\" onClick={this.onEditFileTag} onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave}>\n        <div className=\"tag-demo\" style={{backgroundColor:repoTag.color}}>\n          <span className={`${this.state.showSelectedTag ? 'show-tag-selected': ''}`} style={{backgroundColor: drakColor}}></span>\n          <span className=\"tag-name\">{repoTag.name}</span>\n          {repoTagIdList.indexOf(repoTag.id) > -1 &&\n            <i className=\"fas fa-check tag-operation\"></i>\n          }\n        </div>\n      </li>\n    );\n  }\n\n}\n\nTagItem.propTypes = TagItemPropTypes;\n\nconst TagListPropTypes = {\n  repoID: PropTypes.string.isRequired,\n  filePath: PropTypes.string.isRequired,\n  fileTagList: PropTypes.array.isRequired,\n  onFileTagChanged: PropTypes.func.isRequired,\n  toggleCancel: PropTypes.func.isRequired,\n  createNewTag: PropTypes.func.isRequired,\n};\n\nclass TagList extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      repotagList: [],\n    };\n  }\n\n  componentDidMount() {\n    this.getRepoTagList();\n  }\n\n  getRepoTagList = () => {\n    let repoID = this.props.repoID;\n    seafileAPI.listRepoTags(repoID).then(res => {\n      let repotagList = [];\n      res.data.repo_tags.forEach(item => {\n        let repoTag = new RepoTag(item);\n        repotagList.push(repoTag);\n      });\n      this.setState({repotagList: repotagList});\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    return (\n      <Fragment>\n        <ModalHeader toggle={this.props.toggleCancel}>{gettext('Select Tags')}</ModalHeader>\n        <ModalBody>\n          <ul className=\"tag-list tag-list-container\">\n            {this.state.repotagList.map((repoTag) => {\n              return (\n                <TagItem\n                  key={repoTag.id}\n                  repoTag={repoTag}\n                  repoID={this.props.repoID}\n                  filePath={this.props.filePath}\n                  fileTagList={this.props.fileTagList}\n                  onFileTagChanged={this.props.onFileTagChanged}\n                />\n              );\n            })}\n          </ul>\n          <a href=\"#\" className=\"add-tag-link\" onClick={this.props.createNewTag}>{gettext('Create a new tag')}</a>\n        </ModalBody>\n        <ModalFooter>\n          <Button onClick={this.props.toggleCancel}>{gettext('Close')}</Button>\n        </ModalFooter>\n      </Fragment>\n    );\n  }\n}\n\nTagList.propTypes = TagListPropTypes;\n\nconst propTypes = {\n  repoID: PropTypes.string.isRequired,\n  filePath: PropTypes.string.isRequired,\n  fileTagList: PropTypes.array.isRequired,\n  toggleCancel: PropTypes.func.isRequired,\n  onFileTagChanged: PropTypes.func.isRequired,\n};\n\nclass EditFileTagDialog extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isCreateRepoTagShow: false,\n      isListRepoTagShow: true,\n    };\n  }\n\n  createNewTag = () => {\n    this.setState({\n      isCreateRepoTagShow: !this.state.isCreateRepoTagShow,\n      isListRepoTagShow: !this.state.isListRepoTagShow,\n    });\n  }\n\n  onRepoTagCreated = (repoTagID) => {\n    let {repoID, filePath} = this.props;\n    seafileAPI.addFileTag(repoID, filePath, repoTagID).then(() => {\n      this.props.onFileTagChanged();\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  render() {\n    return (\n      <Modal isOpen={true} toggle={this.props.toggleCancel}>\n        {this.state.isListRepoTagShow &&\n          <TagList\n            repoID={this.props.repoID}\n            filePath={this.props.filePath}\n            fileTagList={this.props.fileTagList}\n            onFileTagChanged={this.props.onFileTagChanged}\n            toggleCancel={this.props.toggleCancel}\n            createNewTag={this.createNewTag}\n          />\n        }\n        {this.state.isCreateRepoTagShow &&\n          <CreateTagDialog\n            repoID={this.props.repoID}\n            onClose={this.props.toggleCancel}\n            toggleCancel={this.createNewTag}\n            onRepoTagCreated={this.onRepoTagCreated}\n          />\n        }\n      </Modal>\n    );\n  }\n}\n\nEditFileTagDialog.propTypes = propTypes;\n\nexport default EditFileTagDialog;","import { MENU_SHOW, MENU_HIDE } from './actions';\nimport { uniqueId, hasOwnProp, canUseDOM } from './helpers';\n\nclass GlobalEventListener {\n\n  constructor() {\n    this.callbacks = {};\n\n    if (canUseDOM) {\n      window.addEventListener(MENU_SHOW, this.handleShowEvent);\n      window.addEventListener(MENU_HIDE, this.handleHideEvent);\n    }\n  }\n\n  handleShowEvent = (event) => {\n    for (const id in this.callbacks) {\n      if (hasOwnProp(this.callbacks, id)) this.callbacks[id].show(event);\n    }\n  }\n\n  handleHideEvent = (event) => {\n    for (const id in this.callbacks) {\n      if (hasOwnProp(this.callbacks, id)) this.callbacks[id].hide(event);\n    }\n  }\n\n  register = (showCallback, hideCallback) => {\n    const id = uniqueId();\n\n    this.callbacks[id] = {\n      show: showCallback,\n      hide: hideCallback\n    };\n\n    return id;\n  }\n\n  unregister = (id) => {\n    if (id && this.callbacks[id]) {\n      delete this.callbacks[id];\n    }\n  }\n}\n\nexport default new GlobalEventListener();\n"],"sourceRoot":""}